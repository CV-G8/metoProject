!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.WeatherDV=e()}}(function(){var define,module,exports;return function(){function e(t,r,n){function i(o,s){if(!r[o]){if(!t[o]){var u="function"==typeof require&&require;if(!s&&u)return u(o,!0);if(a)return a(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var c=r[o]={exports:{}};t[o][0].call(c.exports,function(e){return i(t[o][1][e]||e)},c,c.exports,e,t,r,n)}return r[o].exports}for(var a="function"==typeof require&&require,o=0;o<n.length;o++)i(n[o]);return i}return e}()({1:[function(e,t,r){"use strict";function n(e){return c||(c=new THREE.Matrix4),c.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),c}function i(e,t,r){var n=Cesium,i=n.Matrix4,a=n.Cartesian3;n.Matrix3;(0,m.default)();var o=e.matrixWorld.elements,s=e.matrixWorldInverse.elements;if(f||(f=new i,d=new i,u=new a,l=new a),r&&r.matrix?(e.modelMatrix=i.multiply(r.matrix,o,e.modelMatrix||new i),i.clone(e.modelMatrix,d),i.inverse(e.modelMatrix,f)):(i.clone(s,f),i.clone(o,d)),i.getTranslation(d,u),!e.isOrthographicCamera&&a.equals(a.ZERO,u)||(i.multiplyByPoint(d,_,l),a.subtract(l,u,l),u.clone(t.position),l.clone(t.direction)),i.clone(f,t.viewMatrix),i.clone(d,t.inverseViewMatrix),i.equals(t.frustum.projectionMatrix,e.projectionMatrix.elements))t.customCamera=void 0;else{var c=t.customCamera||{};c.projectionMatrix=i.clone(e.projectionMatrix.elements,c.projectionMatrix),t.customCamera=c}}function a(e,t,r){var n=Cesium.Matrix4,i=t.matrixWorld,a=e.inverseViewMatrix;if((0,m.default)(),!n.equals(a,t.modelMatrix)){if(r){if(!r.inverseMatrix){var s=new n;r.inverseMatrix=n.inverse(r.matrix,s)}i.multiplyMatrices(r.inverseMatrix,a)}else i.copy(a);if(i.decompose(t.position,t.quaternion,t.scale),t.updateMatrixWorld(),t.modelMatrix=n.clone(a,t.modelMatrix),e.customCamera){var u=e.customCamera;u.projectionMatrix&&(t.projectionMatrix.copy(u.projectionMatrix),t.projectionMatrixInverse.invert(t.projectionMatrix))}o(t)}}function o(e){var t=y.get(e);t||(t=new THREE.Frustum,y.set(e,t));var r=n(e);t.setFromProjectionMatrix(r)}var s=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var u,l,c,f,d,h=s(e("e_1")),p=s(e("s_2")),m=s(e("h_3")),v=function(){function e(){(0,h.default)(this,e)}return(0,p.default)(e,null,[{key:"getMirrorCamera",value:function(e,t,r,n){e instanceof Cesium.Camera&&(e=this.toPerspectiveCamera3js(e));var i=THREE,a=i.Vector3,o=i.Matrix4,s=i.PerspectiveCamera,u=new a,l=new a,c=new o,f=new a,d=new a,h=new a,p=new a,m={matrixWorld:t};return r=r||new s,u.setFromMatrixPosition(m.matrixWorld),l.setFromMatrixPosition(e.matrixWorld),c.extractRotation(m.matrixWorld),f.set(0,0,1),f.applyMatrix4(c),d.subVectors(u,l),d.reflect(f).negate(),d.add(u),c.extractRotation(e.matrixWorld),h.set(0,0,1),h.applyMatrix4(c),h.add(l),p.subVectors(u,h),p.reflect(f).negate(),p.add(u),r.position.copy(d),r.up.set(0,1,0),r.up.applyMatrix4(c),r.up.reflect(f),r.lookAt(p),r.updateMatrixWorld(),r.far=e.far,r.near=e.near,r.fov=e.fov,r.focus=e.focus,r.updateProjectionMatrix(),r.projectionMatrix.copy(e.projectionMatrix),r}},{key:"getCameraFromCache",value:function(e){return g.get(e)}},{key:"getFrustum3js",value:function(e){return e.isCamera||(e=g.get(e)),y.get(e)}},{key:"toPerspectiveCamera3js",value:function(e,t,r){r=r||e._referenceFrame;var n=e.frustum;return t||(g.has(e)?t=g.get(e):(t=new THREE.PerspectiveCamera,g.set(e,t))),t.aspect=n.aspectRatio,t.near=n.near,t.far=n.far,t.fov=Cesium.Math.toDegrees(n.fovy),t.updateProjectionMatrix(),a(e,t,r),t}},{key:"toOrthographicCamera3js",value:function(e,t,r){r=r||e._referenceFrame;var n=e.frustum;t||(g.has(e)?t=g.get(e):(t=new THREE.OrthographicCamera,g.set(e,t)));var i=e.frustum.width,o=i/n.aspectRatio;return t.right=i/2,t.left=-i/2,t.top=o/2,t.bottom=-o/2,t.near=n.near,t.far=n.far,t.updateProjectionMatrix(),a(e,t,r),t}},{key:"fromPerspectiveCamera3js",value:function(e,t,r,n){var a=Cesium;o(e),r=r||e._referenceFrame,n||(g.has(e)?n=g.get(e):(n=new a.Camera(t),n.frustum.xOffset=0,n.frustum.yOffset=0,g.set(e,n)));var s=n.frustum,u=a.Math.toRadians(e.fov);return s.aspectRatio=e.aspect,s.near=e.near,s.far=e.far,s.fov=2*Math.atan(Math.tan(.5*u)*s.aspectRatio),i(e,n,r),n}},{key:"fromOrthographicCamera3js",value:function(e,t,r,n){var a=Cesium,s=a.Camera,u=a.OrthographicFrustum;o(e),r=r||e._referenceFrame,n||(g.has(e)?n=g.get(e):(n=new s(t),n.frustum=new u,g.set(e,n)));var l=n.frustum,c=e.right-e.left,f=e.top-e.bottom;return l.aspectRatio=c/f,l.near=e.near||1e-16,l.far=e.far,l.width=c,i(e,n,r),n}}]),e}(),g=new WeakMap,y=new WeakMap,_={x:0,y:1,z:0},b=v;r.default=b},{h_3:7,e_1:235,s_2:236,M_0:241}],2:[function(e,t,r){"use strict";function n(e,t,r){if(!e||!t||!r)return console.warn(e,t,r),0;var n=Cesium.Cartesian3,i=n.distance(e,t),a=n.distance(t,r),o=n.distance(e,r),s=(i+a+o)/2;return Math.sqrt(s*(s-i)*(s-a)*(s-o))}function i(){}function a(e){var t=[];for(var r in e.attributes)e.attributes.hasOwnProperty(r)&&e.attributes[r]&&t.push(r);return t}function o(){if(!R){R=!0;var e=Cesium;_=e.Matrix3,b=e.Matrix4,M=e.Cartesian3,x=e.Cartesian2,w=e.BoundingSphere,S=e.GeometryAttribute,T=e.ComponentDatatype,C=new M,E=new b,A=new _,L=new M,P=new M,O=new M}}function s(e,t,r){var n=e,i=n.attributes,a=new THREE.BufferGeometry,o=u(e,t,r);for(var s in i){for(var l=i[s],c=l.itemSize,f=l.array,d=l.normalized,h=new f.constructor(o.length*c),p=0,m=0;m<o.length;m++)for(var v=o[m]*c,g=0;g<c;g++)h[p++]=f[v+g];var y=new THREE.BufferAttribute(h,c,d);a.setAttribute(s,y)}return o=null,a}function u(e,t,r){var n=e,i=n.attributes.position,a=n.groups,o=n.drawRange,s=n.index,u=[],l=i.count;if(s)if(a&&a.length>0)for(var c=0,f=a.length;c<f;c++){var d=a[c];if(r){if(d.materialIndex!=t)continue}else if(c!=t)continue;for(var h=Math.max(d.start,o.start),p=Math.min(s.count,d.start+d.count,o.start+o.count),m=h,v=p;m<v;m+=3){var g=s.getX(m),y=s.getX(m+1),_=s.getX(m+2);u.push(g,y,_)}}else for(var b=Math.max(0,o.start),M=Math.min(s.count,o.start+o.count),x=b,w=M;x<w;x+=3){var S=s.getX(x),T=s.getX(x+1),C=s.getX(x+2);u.push(S,T,C)}else if(a&&a.length>0)for(var E=0,A=a.length;E<A;E++){var L=a[E];if(r){if(L.materialIndex!=t)continue}else if(E!=t)continue;for(var P=Math.max(L.start,o.start),O=Math.min(i.count,L.start+L.count,o.start+o.count),R=P,I=O;R<I;R+=3){var D=R,B=R+1,U=R+2;u.push(D,B,U)}}else for(var N=Math.max(0,o.start),k=Math.min(i.count,o.start+o.count),j=N,G=k;j<G;j+=3){var V=j,F=j+1,z=j+2;u.push(V,F,z)}return u=l>65535?new Uint32Array(u):l>255?new Uint16Array(u):new Uint8Array(u)}function l(e,t,r,n){o();var i=e,a=i.attributes.position,s=a.array,u=s.constructor,l=i.groups,c=i.drawRange,f=i.index,d=[],h=a.count;if(!l||l.length<=1||"number"!=typeof t)i.boundingSphere||i.computeBoundingSphere(),n=w.clone(i.boundingSphere,n),d=f&&f.array;else if(d=[],f){for(var p=0,m=l.length;p<m;p++){var v=l[p];if(r){if(v.materialIndex!=t)continue}else if(p!=t)continue;for(var g=Math.max(v.start,c.start),y=Math.min(f.count,v.start+v.count,c.start+c.count),_=g,b=y;_<b;_++)d.push(f.getX(_))}for(var x=[],S=0;S<d.length;S++){var f=d[S],T=M.unpack(a.array,3*f);x.push(T)}n=w.fromPoints(x,n)}else{for(var C=[],E=0,A=l.length;E<A;E++){var L=l[E];if(r){if(L.materialIndex!=t)continue}else if(E!=t)continue;var P=Math.max(L.start,c.start),O=Math.min(a.count,L.start+L.count,c.start+c.count),R=P*a.itemSize*u.BYTES_PER_ELEMENT,I=(O-P)*a.itemSize,D=new u(s.buffer,R,I),B=w.fromVertices(D);C.push(B);for(var U=P,N=O;U<N;U++)d.push(U)}C.length>0&&(n=1==C.length?w.clone(C[0],n):w.fromBoundingSpheres(C,n))}return d&&!d.buffer&&(d=h>65535?new Uint32Array(d):h>255?new Uint16Array(d):new Uint8Array(d)),{indices:d,boundingSphere:n}}function c(e,t,r){t=t||0,r=r||1;for(var n=Number.MAX_VALUE,i=-Number.MAX_VALUE,a=t;a<e.length;a+=r){var o=e[a];isNaN(o)||o==1/0||o==-1/0||(n=Math.min(n,o),i=Math.max(i,o))}return{min:n,max:i}}function f(e,t,r,n,i){return o(),n||(n=new M),M.subtract(r,t,P),M.subtract(e,t,O),M.cross(P,O,n),0!=M.magnitude(n)&&0!=i&&M.normalize(n,n),n}function d(e){for(var t,r,n,i,a=e.attributes.normal.values,o=0;o<a.length;o+=3)t=a[o],r=a[o+1],n=a[o+2],i=1/Math.sqrt(t*t+r*r+n*n),a[o]=t*i,a[o+1]=r*i,a[o+2]=n*i}function h(e){if(1==e.length)return e[0];var t,r=[],n=[],i=[],a=[],o=[],s=[],u=[],l=[],c=0,f=[],d=e[0];t=d.primitiveType;for(var h in d.attributes)if(d.attributes.hasOwnProperty(h)&&d.attributes[h]){var p=d.attributes[h];r.push(h),o.push(p.componentsPerAttribute),i.push(p.componentDatatype),a.push(p.values.constructor),s.push(p.normalize),f.push(0),u.push(0)}for(var m=0;m<e.length;m++)for(var v=e[m],g=0;g<r.length;g++){var y=r[g];f[g]+=v.attributes[y].values.length}for(var _=0;_<r.length;_++)n.push(new a[_](f[_]));e[0].indices||(l=null);for(var b=0;b<e.length;b++){for(var M=e[b],x=0;x<r.length;x++){var w=r[x],S=n[x],T=M.attributes[w].values;S.set(T,u[x]),u[x]+=T.length}if(M.indices){for(var C=0;C<M.indices.length;C++){var E=M.indices[C];l.push(E+c)}c+=M.attributes.position.values.length/3}}for(var A={},L=0;L<r.length;L++){A[r[L]]={values:n[L],componentsPerAttribute:o[L],componentDatatype:i[L],normalize:s[L]}}if(l){l=n[0]/o[0]<65535?new Uint16Array(l):new Uint32Array(l)}return d=new Cesium.Geometry({attributes:A,indices:l,primitiveType:t})}function p(e){var t=THREE,r=e[0].clone(),n=r.attributes;for(var i in n){for(var a=n[i],o=0,s=0,l=0;l<e.length;l++){var c=e[l],f=c.attributes[i];o+=f.count,s+=f.array.length}a.count=o,a.array=new a.array.constructor(s);for(var d=a.array,h=0,p=0;p<e.length;p++){var m=e[p],v=m.attributes[i],g=v.array;d.set(g,h),h+=g.length}}for(var y=[],_=0,b=0;b<e.length;b++){var M=e[b],x=u(M,0,!0);y.push(x),_+=x.length}var w,S,T=n.position.count;T>65535?(w=new Uint32Array(_),S=t.Uint32BufferAttribute):T>255?(w=new Uint16Array(_),S=t.Uint16BufferAttribute):(w=new Uint8Array(_),S=t.Uint8BufferAttribute);for(var h=0,C=0,E=!0,A=-1,L=0;L<y.length;L++){for(var P=y[L],O=0;O<P.length;O++){var R=P[O]+h;w[C++]=R,R-A!=1&&(E=!1),A=R}h+=e[L].attributes.position.count}return E?r.index=null:r.setIndex(new S(w,1,!1)),r.computeBoundingSphere(),r.computeBoundingBox(),r}function m(e,t,r,n){var i,a=0;for(i=0;i<e.length;i+=3){if(e[i]===r.x&&e[i+1]===r.y&&e[i+2]===r.z)return a;a++}return e.push(r.x,r.y,r.z),t.push(n.x,n.y,n.z),a}function v(e,t,r,n){var i,a,o,s=THREE.ShapeUtils,u=n,l=r,c=l.length,f=e.slice(),d=t.map(function(e){return e.slice()});for(!1===s.isClockWise(f)&&(f=f.reverse()),i=0,a=d.length;i<a;i++)o=d[i],!0===s.isClockWise(o)&&(d[i]=o.reverse());var h=s.triangulateShape(f,d);for(i=0,a=d.length;i<a;i++)o=d[i],f=f.concat(o);for(i=0,a=f.length;i<a;i++){var p=f[i];l.push(p)}for(i=0,a=h.length;i<a;i++){var m=h[i],v=m[0]+c,g=m[1]+c,y=m[2]+c;u.push(v,g,y)}}function g(e){var t,r=e.index,n=e.groups;if(r)t=r.array;else if(n&&n.length>1){t=[];for(var i=0;i<n.length;i++)for(var a=u(e,i,!1),o=0;o<a.length;o++)t.push(a[o])}else t=u(e,0,!0);return t}function y(e){function t(e){var t=[e.x,e.y,e.z].join(","),r=M.get(t);return void 0==r&&(r=b.length,M.set(t,r),b.push(e.clone())),r}function r(e,t){var r=e.slice();r.sort(function(e,t){return e-t});var n=r.join(","),i=w.get(n);i||(i={edge:r,triangles:[]},x.push(i),w.set(n,i)),i.triangles.push(t)}function n(e,t){e.fromBufferAttribute(p,t)}var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=THREE,o=a.Vector3,s=a.BufferGeometry,u=a.BufferAttribute,l=a.MathUtils,c=void 0==i.angleEpsilon?1:i.angleEpsilon;c=l.DEG2RAD*c;for(var d=void 0==i.removeCoplanar||i.removeCoplanar,h=e,p=h.getAttribute("position"),m=g(h),v=new o,y=new o,_=new o,b=[],M=new Map,x=[],w=new Map,S=0;S<m.length;S+=3){var T=m[S],C=m[S+1],E=m[S+2];n(v,T),n(y,C),n(_,E),function(e,n,i){e=t(e),n=t(n),i=t(i);var a={a:e,b:n,c:i};r([e,n],a),r([n,i],a),r([i,e],a)}(v,y,_)}for(var A=[],L=new o,P=0;P<x.length;P++){var O=x[P],R=O.triangles;if(R.length>1){var I=!0;if(d){R.forEach(function(e){if(!e.normal){var t=e.a,r=e.b,n=e.c;t=b[t],r=b[r],n=b[n],f(t,r,n,L,!1),e.normal=L.clone()}});for(var D=R[0].normal,B=1;B<R.length;B++){var U=R[B];if(D.angleTo(U.normal)>c){I=!1;break}}}if(I)continue}A.push(O.edge[0],O.edge[1])}p=[],A.forEach(function(e){var t=b[e];p.push(t.x,t.y,t.z)});var h=new s;return p=new u(new Float32Array(p),3,!1),h.setAttribute("position",p),x.length=0,w.clear(),b.length=0,M.clear(),A.length=0,h}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var _,b,M,x,w,S,T,C,E,A,L,P,O,R=!1;i.extractGeometry=s,i.genGeometryIndices=u,i.computeBoundingSphereAndIndices=l,i.pointRotateX=function(e,t){o(),_.fromRotationX(t,A),b.fromRotationTranslation(A,M.ZERO,E),b.multiplyByPoint(E,e,e)},i.pointRotateY=function(e,t){o(),_.fromRotationY(t,A),b.fromRotationTranslation(A,M.ZERO,E),b.multiplyByPoint(E,e,e)},i.pointRotateZ=function(e,t){o(),_.fromRotationZ(t,A),b.fromRotationTranslation(A,M.ZERO,E),b.multiplyByPoint(E,e,e)},i.rotateX=function(e,t){o();var r=e.attributes.position.values;_.fromRotationX(t,A),b.fromRotationTranslation(A,M.ZERO,E);for(var n=0;n<r.length;n+=3)C.x=r[n],C.y=r[n+1],C.z=r[n+2],b.multiplyByPoint(E,C,C),r[n]=C.x,r[n+1]=C.y,r[n+2]=C.z},i.rotateY=function(e,t){o();var r=e.attributes.position.values;_.fromRotationY(t,A),b.fromRotationTranslation(A,M.ZERO,E);for(var n=0;n<r.length;n+=3)C.x=r[n],C.y=r[n+1],C.z=r[n+2],b.multiplyByPoint(E,C,C),r[n]=C.x,r[n+1]=C.y,r[n+2]=C.z},i.rotateZ=function(e,t){o();var r=e.attributes.position.values;_.fromRotationZ(t,A),b.fromRotationTranslation(A,M.ZERO,E);for(var n=0;n<r.length;n+=3)C.x=r[n],C.y=r[n+1],C.z=r[n+2],b.multiplyByPoint(E,C,C),r[n]=C.x,r[n+1]=C.y,r[n+2]=C.z},i.isValidVertex=function(e,t){return t*=3,!isNaN(e[t])&&!isNaN(e[t+1])&&!isNaN(e[t+2])},i.isValidTriangle=function(e,t,r,n){var i=this.isValidVertex(e,t)&&this.isValidVertex(e,r)&&this.isValidVertex(e,n);t=M.unpack(e,3*t),r=M.unpack(e,3*r),n=M.unpack(e,3*n);var a=M.subtract(r,t,new M),o=M.subtract(n,t,new M),s=M.cross(a,o,new M);return M.equals(s,M.ZERO)&&(i=!1),i},i.removeInvalidVertices=function(e){function t(e){o.forEach(function(t){for(var r=i[t],n=a[t],o=r.itemSize,s=o*e,u=0;u<o;u++)n.array.push(r.array[s+u])})}function r(e,r,n){t(e),t(r),t(n)}if(!e.isBufferGeometry)return console.warn("unsupport geometry type"),e;var n=e.clone(),i=e.attributes,a=n.attributes,o=[];for(var s in a)if(a.hasOwnProperty(s)&&a[s]){var u=a[s],l=u.array.constructor;u.array=[],u.array._srcType=l,o.push(s)}var c=e.attributes.position,f=c.count;if(c=c.array||c.values,e.index)for(var d=e.index.array,h=0;h<d.length;h+=3){var p=d[h],m=d[h+1],v=d[h+2];this.isValidTriangle(c,p,m,v)&&r(p,m,v)}else for(var g=0;g<f;g+=3){var y=g,_=g+1,b=g+2;this.isValidTriangle(c,y,_,b)&&r(y,_,b)}for(var M in a)if(a.hasOwnProperty(M)&&a[M]){var x=a[M],w=x.array._srcType;x.array=new w(x.array),x.count=x.array.length/x.itemSize,delete x.array._srcType}return n},i.forceIndices=function(e,t,r){if("undefined"==typeof THREE)throw new Error("强制索引功能依赖threejs，但是上下文未找到THREE模块 ");if(e.index)return void console.warn("该几何已有索引");if(e.groups&&e.groups.length>1)return void console.warn("该几何无法强制使用索引");void 0===r&&(r=!0);var n=[],i=new Map,a=e.attributes,o=a.position,s=o.count;o=o.array;var u=e.clone(),l=u.attributes,c=[];for(var f in l)if(r&&"uv3"==f||t&&"uv2"==f)delete l[f];else if(l.hasOwnProperty(f)&&l[f]){var d=l[f],h=d.array.constructor;d.array=[],d.array._srcType=h,c.push(f)}for(var p=0,m=0;m<s;m++){var v=function(e){var t=[o[3*e],o[3*e+1],o[3*e+2]].join(",");if(l.uv){var r=a.uv.array;t+=","+[r[2*e],r[2*e+1]].join(",")}if(l.uv2){var n=a.uv2.array;t+=","+[n[2*e],n[2*e+1]].join(",")}return i.has(t)||(c.forEach(function(t){for(var r=a[t],n=l[t],i=r.itemSize,o=i*e,s=0;s<i;s++)n.array.push(r.array[o+s])}),i.set(t,p),p++),i.get(t)}(m);n.push(v)}n=p>65535?new Uint32Array(n):p>255?new Uint16Array(n):new Uint8Array(n),i.clear(),u.groups=[{start:0,count:1/0,materialIndex:0}],u.index=new THREE.BufferAttribute(n,1,!1);for(var g in l)if(l.hasOwnProperty(g)&&l[g]){var y=l[g],_=y.array._srcType;y.array=new _(y.array),y.count=y.array.length/y.itemSize,delete y.array._srcType}return u},i.clampToIndices=function(e){if(e.index){var t=e.index.array,r=c(t),n=r.max,i=e.attributes;for(var a in i)if(i.hasOwnProperty(a)){var o=i[a],s=o.array,u=o.itemSize,l=o.count;if(l==n+1)continue;var f=u*(n+1)*s.constructor.BYTES_PER_ELEMENT,d=s.buffer.slice(0,f);s=new s.constructor(d),i[a].array=s}}return e},i.computeSurfaceArea=function(e){if(!(e instanceof Cesium.Geometry||e.isBufferGeometry))return console.warn("unsupport geometry type"),-1;var t=e.attributes.position,r=e.indices||e.index;r&&(r=r.array||r),t=t.array||t.values,t=M.unpackArray(t);var i=0;if(r)for(var a=0;a<r.length;a+=3){var o=r[a],s=r[a+1],u=r[a+2];i+=n(t[o],t[s],t[u])}else for(var l=0;l<t.length;l+=3){var c=t[l],f=t[l+1],d=t[l+2];i+=n(c,f,d)}return i},i.geometryEquals=function(e,t){e=e.attributes.position.array,t=t.attributes.position.array;var r=e.length==t.length;if(r)for(var n=e.length,i=0;i<n;i++)if(e[i]!=t[i]){r=!1;break}return r},i.simplify=function(e,t,r){if("undefined"==typeof THREE)throw new Error("模型简化功能依赖threejs，但是上下文未找到THREE模块 ");if(!t)throw new Error("缺少参数simplifyFactor");var n=e.attributes.position.count,a=t*n;e=simplify_three(e,a,r);var o=e.attributes.position.count;if(o-n<0){for(var s=e.attributes.position.array,u=!0,l=0;l<o;l++)if(!this.isValidVertex(s,l)){u=!1;break}u||(e=i.removeInvalidVertices(e))}return e};var I=function(){function e(e,t){return t.x-e.x}function t(e){var t,r,n,i,a,o=e.length;e:for(;o;)for(r=e[--o],t=e[--o],n=o;n;)if(a=e[--n],i=e[--n],t===i&&r===a||t===a&&r===i){e.splice(o,2),e.splice(n,2),o-=2;continue e}}function r(r){if(r.length<3)return[];r.sort(e);for(var i,a,o,s,u,l,c=r.length-1,f=r[c].x,d=r[0].x,h=r[c].y,p=h;c--;)r[c].y<h&&(h=r[c].y),r[c].y>p&&(p=r[c].y);var m,v=d-f,g=p-h,y=v>g?v:g,_=.5*(d+f),b=.5*(p+h),M=[new n({__sentinel:!0,x:_-20*y,y:b-y},{__sentinel:!0,x:_,y:b+20*y},{__sentinel:!0,x:_+20*y,y:b-y})],x=[],w=[];for(c=r.length;c--;){for(w.length=0,m=M.length;m--;)v=r[c].x-M[m].x,v>0&&v*v>M[m].r?(x.push(M[m]),M.splice(m,1)):(g=r[c].y-M[m].y,v*v+g*g>M[m].r||(w.push(M[m].a,M[m].b,M[m].b,M[m].c,M[m].c,M[m].a),M.splice(m,1)));for(t(w),m=w.length;m;)a=w[--m],i=w[--m],o=r[c],s=a.x-i.x,u=a.y-i.y,l=2*(s*(o.y-a.y)-u*(o.x-a.x)),Math.abs(l)>1e-12&&M.push(new n(i,a,o))}for(Array.prototype.push.apply(x,M),c=x.length;c--;)(x[c].a.__sentinel||x[c].b.__sentinel||x[c].c.__sentinel)&&x.splice(c,1);return x}var n=function(){function e(e,t,r){this.a=e,this.b=t,this.c=r;var n,i,a=t.x-e.x,o=t.y-e.y,s=r.x-e.x,u=r.y-e.y,l=a*(e.x+t.x)+o*(e.y+t.y),c=s*(e.x+r.x)+u*(e.y+r.y),f=2*(a*(r.y-t.y)-o*(r.x-t.x));this.x=(u*l-o*c)/f,this.y=(a*c-s*l)/f,n=this.x-e.x,i=this.y-e.y,this.r=n*n+i*i}return e}();return r}();i.triangulate=I,i.computeNormal=f,i.computeVertexNormals=function(e){o();var t=e.indices,r=e.attributes;if(r.position){var n=r.position.values,i=t?t.length:n.length/3;if(void 0===r.normal)r.normal=new S({componentDatatype:T.FLOAT,componentsPerAttribute:3,values:new Float32Array(n.length)});else{var a=r.normal.values;if(t)for(var s,u=0;u<i;u++)s=t[u],a[3*s]=0,a[3*s+1]=0,a[3*s+2]=0;else for(var u=0;u<i;u++)a[u]=0}for(var l,c,f,h=r.normal.values,p=new M,m=new M,v=new M,g=new M,y=new M,u=0;u<i;u+=3)l=t?3*t[u+0]:3*u,c=t?3*t[u+1]:3*(u+1),f=t?3*t[u+2]:3*(u+2),M.fromArray(n,l,p),M.fromArray(n,c,m),M.fromArray(n,f,v),M.subtract(v,m,g),M.subtract(p,m,y),M.cross(g,y,g),h[l]+=g.x,h[l+1]+=g.y,h[l+2]+=g.z,h[c]+=g.x,h[c+1]+=g.y,h[c+2]+=g.z,h[f]+=g.x,h[f+1]+=g.y,h[f+2]+=g.z;d(e),r.normal.needsUpdate=!0}return e},i.mergeGeometries=function(e){if(!e||!e.length)throw new Error("缺少geometries参数");if(1==e.length)return e[0];for(var t=[],r=!1,n=!1,i=e[0].primitiveType,o=0;o<e.length;o++){if(t[o]=a(e[o]),o>0){if(i!=e[o].primitiveType){n=!0;break}var s=t[o-1];if(!(r=s.length!=t[o].length))for(var u=0;u<s.length;u++)if(s[u]!=t[o][u]){r=!0;break}}if(i=e[o].primitiveType,r||n)break}if(n)throw new Error("待合并的几何体中primitiveType属性不完全一致");if(r)throw new Error("待合并的几何体中属性数量和和名称不完全一致");return h(e)},i.mergeGroupedGeometries=function(e){var t=Cesium,r=i.cloneGeometryAttributes(e[0].attributes);for(var n in r)!function(n){if(r.hasOwnProperty(n)){var i=r[n],a=i.componentsPerAttribute,o=i.componentDatatype,s=[];e.forEach(function(e){for(var t=e.attributes[n],r=t.values,i=0;i<e.indices.length;i++)for(var o=e.indices[i],u=0;u<a;u++)s.push(r[o*a+u])}),r[n].values=t.ComponentDatatype.createTypedArray(o,s)}}(n);return new t.Geometry({attributes:r,primitiveType:e[0].primitiveType})},i.mergeGeometries3js=p,i.translate=function(e,t){o(),Array.isArray(t)?(L.x=t[0],L.y=t[1],L.z=t[2]):M.clone(t,L);for(var r=0;r<e.attributes.position.values.length;r+=3)e.attributes.position.values[r]+=L.x,e.attributes.position.values[r+1]+=L.y,e.attributes.position.values[r+2]+=L.z},i.getAttributeComponentType=function(e){var t=Cesium.ComponentDatatype,r=t.SHORT;return e instanceof Int8Array?r=t.BYTE:e instanceof Uint8Array||e instanceof Uint8ClampedArray?r=t.UNSIGNED_BYTE:e instanceof Int16Array?r=t.SHORT:e instanceof Uint16Array?r=t.UNSIGNED_SHORT:e instanceof Int32Array?r=t.INT:e instanceof Uint32Array?r=t.UNSIGNED_INT:e instanceof Float32Array?r=t.FLOAT:e instanceof Float64Array&&(r=t.DOUBLE),r},i.cloneGeometryAttributes=function(e){var t={};for(var r in e)if(e.hasOwnProperty(r)&&e[r]){var n=e[r];t[r]={componentDatatype:n.componentDatatype,componentsPerAttribute:n.componentsPerAttribute,normalize:n.normalize,values:[]}}return t},i.cloneGeometry=function(e){var t=this.cloneGeometryAttributes(e.attributes);for(var r in t)if(t.hasOwnProperty(r)){var n=t[r],i=e.attributes[r].values;n.values=new i.constructor(i)}var a=e.indices?new e.indices.constructor(e.indices):void 0;return new Cesium.Geometry({attributes:t,indices:a,primitiveType:e.primitiveType,boundingSphere:e.boundingSphere?e.boundingSphere.clone():void 0})},i.isGeometry3js=function(e){return"undefined"!=typeof THREE&&e.isBufferGeometry||e.attributes&&e.attributes.position&&e.index||e.vertices&&e.faces},i.parseBufferGeometry3js=function(e,t){var r=Cesium,n=r.GeometryAttribute,a=(r.PrimitiveType,r.Geometry),o={};e.attributes.normal||e.computeVertexNormals();for(var s in e.attributes)if(e.attributes.hasOwnProperty(s)){var u=e.getAttribute(s);u&&u.array.length>0&&(o[s]=new n({componentDatatype:i.getAttributeComponentType(u.array),componentsPerAttribute:u.itemSize,values:u.array,normalize:u.normalized}))}var l,c=4;if(void 0!==e.GeometryMode&&(c=e.GeometryMode),e.index)l=e.index.array;else{var f=o.position.values.length/3;e.groups&&e.groups.length?(l=[],e.groups.forEach(function(e){e.start+e.count>f&&console.warn("group.count>ptCount");for(var t=0;t<e.count&&t+e.start<f;t++)l.push(t+e.start)})):t.isLine?c=t.isLineSegments?1:t.isLineLoop?2:3:t.isPoints&&(c=0),l&&(l=f>65535?new Uint32Array(l):new Uint16Array(l))}var d=new a({attributes:o,indices:l,primitiveType:c});return e.boundingSphere&&(d.boundingSphere=w.clone(e.boundingSphere)),d},i.fromGeometry3js=function(e,t,r){e.attributes&&(e.index||e.groups.length)||(e.isBufferGeometry||(e=(new THREE.BufferGeometry).fromGeometry(e)),e.attributes.normal||r||!e.computeVertexNormals||e.computeVertexNormals());var n=Cesium,a=i.parseBufferGeometry3js(e,t);return r&&!a.attributes.normal&&4==a.primitiveType&&n.GeometryPipeline.computeNormal(a),a},i.toBufferGeometry3js=function(e,t){var r=THREE,n=r.BufferGeometry,i=r.BufferAttribute,a=r.Sphere;t||(t=new n);var o=e.attributes;for(var s in o)if(o.hasOwnProperty(s)&&o[s]){var u=o[s],l=u.values;l instanceof Float64Array&&(l=new Float32Array(l));var c=new i(l,u.componentsPerAttribute,u.normalize);t.setAttribute(s,c)}if(o.st&&(t.attributes.uv=t.attributes.st,t.deleteAttribute("st")),e.indices){var f=new i(e.indices,1,!1);t.setIndex(f)}if(e.boundingSphere){var d=e.boundingSphere;t.boundingSphere||(t.boundingSphere=new a),t.boundingSphere.center.copy(d.center),t.boundingSphere.radius=d.radius}return t},i.toGeometry3js=function(e){if("undefined"==typeof THREE)throw new Error("THREE 未加载");for(var t=THREE,r=t.Geometry,n=t.Vector3,i=t.Face3,a=e.attributes.position.values,o=0,s=new r,u=0;u<a.length;u+=3)o=3*u,s.vertices.push(new n(a[o],a[o+2],a[o+1]));for(var u=0;u<e.indices.length;u+=3){var l=e.indices[u],c=e.indices[u+1],f=e.indices[u+2];s.faces.push(new i(l,c,f))}return s},i.toCSG=function(e,t){if("undefined"!=typeof THREE&&e.isBufferGeometry)return i._toCSG3js(e,t);var r=Cesium;if(t||(t={x:0,y:0,z:0}),e.attributes.normal||(e=r.GeometryPipeline.computeNormal(e)),4!==e.primitiveType)throw new Error("暂不支持此类几何体");if(!CSG)throw new Error("CSG 库未加载。请从 https://github.com/evanw/csg.js 获取");for(var n=(e.indices.length,[]),a=[],o=e.attributes.position.values,s=e.attributes.normal.values,u=0,l=0,c=0;c<e.indices.length;c+=3){a=[];var f=e.indices[c],d=e.indices[c+1],h=e.indices[c+2];l=3*f,u=3*f,a.push(new CSG.Vertex([o[l++]+t.x,o[l++]+t.y,o[l++]+t.z],[s[u++],s[u++],s[u++]])),l=3*d,u=3*d,a.push(new CSG.Vertex([o[l++]+t.x,o[l++]+t.y,o[l++]+t.z],[s[u++],s[u++],s[u++]])),l=3*h,u=3*h,a.push(new CSG.Vertex([o[l++]+t.x,o[l++]+t.y,o[l++]+t.z],[s[u++],s[u++],s[u++]])),n.push(new CSG.Polygon(a))}return CSG.fromPolygons(n)},i.fromCSG=function(e,t){if("undefined"!=typeof THREE&&t)return i._fromCSG3js(e);var r,n,a,o=e.toPolygons();if(!CSG)throw new Error("CSG 库未加载。请从 https://github.com/evanw/csg.js 获取");var s=Cesium,u=s.GeometryAttribute,l=(s.PrimitiveType,s.Geometry),c=[],f=[],d=[];for(r=0;r<o.length;r++){for(a=[],n=0;n<o[r].vertices.length;n++)a.push(m(c,f,o[r].vertices[n].pos,o[r].plane.normal));a[0]===a[a.length-1]&&a.pop();for(var n=2;n<a.length;n++)d.push(a[0],a[n-1],a[n])}c=new Float32Array(c),f=new Float32Array(f),d=new Int32Array(d);var h={};return h.position=new u({componentDatatype:T.FLOAT,componentsPerAttribute:3,values:c}),h.normal=new u({componentDatatype:T.FLOAT,componentsPerAttribute:3,values:f}),new l({attributes:h,indices:d,primitiveType:4})},i._toCSG3js=function(e,t,r){if("undefined"==typeof THREE)throw new Error("THREE 未加载");var n,i,a,o,s;if(!CSG)throw"CSG library not loaded. Please get a copy from https://github.com/evanw/csg.js";var u=THREE,l=u.Mesh,c=u.Geometry,f=u.Euler,d=u.Vector3,h=u.Matrix4,p=u.Face3,m=u.Face4,v=CSG.Vertex,g=v.Vertex,y=v.Polygon;if(e instanceof l)i=e.geometry,t=t||e.position,r=r||e.rotation;else if(e instanceof c)i=e,t=t||new d(0,0,0),r=r||new f(0,0,0);else{if(!e.isBufferGeometry)throw"Model type not supported.";i=(new c).fromBufferGeometry(e),t=t||new d(0,0,0),r=r||new f(0,0,0)}s=(new h).makeRotationFromEuler(r);var a=[],_=i.faces,b=i.vertices;for(n=0;n<_.length;n++){var M=_[n],x=M.a,w=M.b,S=M.c,T=M.d,C=M.normal,E=[C.x,C.y,C.z];if(M instanceof p)o=[],o.push(new g(b[x].clone().add(t).applyMatrix4(s),E)),o.push(new g(b[w].clone().add(t).applyMatrix4(s),E)),o.push(new g(b[S].clone().add(t).applyMatrix4(s),E)),a.push(new y(o));else{if(!(M instanceof m))throw"Model contains unsupported face.";o=[],o.push(new g(b[x].clone().add(t).applyMatrix4(s),E)),o.push(new g(b[w].clone().add(t).applyMatrix4(s),E)),o.push(new g(b[T].clone().add(t).applyMatrix4(s),E)),a.push(new y(o)),o=[],o.push(new g(b[w].clone().add(t).applyMatrix4(s),E)),o.push(new g(b[S].clone().add(t).applyMatrix4(s),E)),o.push(new g(b[T].clone().add(t).applyMatrix4(s),E)),a.push(new y(o))}}return CSG.fromPolygons(a)},i._fromCSG3js=function(e){if("undefined"==typeof THREE)throw new Error("THREE 未加载");var t,r,n,a,o=new THREE.Geometry,s=e.toPolygons();if(!CSG)throw"CSG library not loaded. Please get a copy from https://github.com/evanw/csg.js";var u=THREE,l=u.Vector3,c=u.Vector2,f=u.Face3;for(t=0;t<s.length;t++){for(n=[],r=0;r<s[t].vertices.length;r++)n.push(i._getGeometryVertice3js(o,s[t].vertices[r].pos));n[0]===n[n.length-1]&&n.pop();for(var r=2;r<n.length;r++)a=new f(n[0],n[r-1],n[r],(new l).copy(s[t].plane.normal)),o.faces.push(a),o.faceVertexUvs[0].push(new c)}return o.computeBoundingBox(),o},i._getGeometryVertice3js=function(e,t){var r;for(r=0;r<e.vertices.length;r++)if(e.vertices[r].x===t.x&&e.vertices[r].y===t.y&&e.vertices[r].z===t.z)return r;return e.vertices.push(new THREE.Vector3(t.x,t.y,t.z)),e.vertices.length-1},i.triangulateShape=v,i.genGeometryIndicesAll=g,i.toOutlineGeometry3js=y;var D=i;r.default=D},{}],3:[function(e,t,r){"use strict";function n(){this.selected=[]}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,Object.assign(n.prototype,{isIEffect:!0,preUpdate:function(e,t,r,n){console.warn("IEffect.preRender not implemeted")},postUpdate:function(e,t,r,n){console.warn("IEffect.postRender not implemeted")}});var i=n;r.default=i},{}],4:[function(e,t,r){"use strict";var n=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("e_1")),a=n(e("s_2")),o=(n(e("._7")),function(){function e(){(0,i.default)(this,e),this.isIRenderable=!0,this.visualizer=null}return(0,a.default)(e,[{key:"onRemoved",value:function(e){}},{key:"onAdded",value:function(e){}},{key:"render",value:function(e,t){throw new Error("IRenderable.render not implemented.")}}]),e}());r.default=o},{"._7":5,e_1:235,s_2:236,M_0:241}],5:[function(e,t,r){"use strict";function n(){if(!z){z=!0;var e=Cesium;u=e.Matrix4,l=e.Matrix3,c=e.Matrix2,f=e.defaultValue,d=e.defined,h=e.Texture,p=e.PixelFormat,m=e.PixelDatatype,v=e.Cartesian3,g=e.Color,y=e.Ray,_=e.Transforms,b=e.Event,x=e.PrimitiveType,M=Cesium.CubeMap,T=e.Renderbuffer,C=e.Framebuffer,E=e.RenderbufferFormat,w=e.Intersect,S=e.BoundingSphere,(0,F.default)(),A=new u,L=new v,P=new v,O=new v,R=new v,I=new y,D=new u,B=new v}}function i(e){var t=e.material;e.needsUpdate=!1,e.modelMatrixNeedsUpdate=!1,e.instances&&e.instances.forEach(function(e){e.modelMatrixNeedsUpdate=!1}),1==t.needsUpdate&&(t.needsUpdate=!1)}function a(e){n(),e=e||{},!e.modelMatrix&&e.position&&(e.modelMatrix=_.eastNorthUpToFixedFrame(e.position));var t=this;t._modelMatrix=e.modelMatrix?e.modelMatrix:u.IDENTITY.clone(),t._children=[],t.isMeshVisualizer=!0,t._actualModelMatrix=u.clone(t._modelMatrix),t._actualModelMatrixYup=new u,t._actualModelMatrixXup=new u,t._actualModelMatrixInverse=new u,t._actualModelMatrixYupInverse=new u,t._actualModelMatrixXupInverse=new u,t._modelMatrixNeedsUpdate=!0,t._ready=!0,t._isWireframe=!1,t._debug=!1,t._show=f(e.show,!0),t._center=u.getTranslation(t._modelMatrix,new v),t._textureCache={},t._pickIds=[],t.beforeUpdate=new b,t.afterUpdate=new b,t.beforeDestroy=new b,t._scene=e.scene,t.optimizeCommandInit=f(e.optimizeCommandInit,!1),t.optimizeInitCount=f(e.optimizeInitCount,10);var r=THREE;t._defaultAmbientLight=new r.AmbientLight("white",1);var i=new r.DirectionalLight(g.WHITE.clone(),2);i.castShadow=!0,i.name="sunLight",t._sunLight=i,this.sunLightShadowRange=e.sunLightShadowRange||500,this.sunLightShadowFar=e.sunLightShadowFar||1e4,this.sunLightShadowSize=e.sunLightShadowSize||2048,t._sunPositionLC=new v,t._sunTargetPositionLC=new v,t._sunTargetPositionWC=new v,t._sunDirectionLC=new v,t.useSunLight=f(e.useSunLight,!1),t.renderer=new N.default(t),t._lights=new V.default,t.maxChangingCount=10,t.useEncodedPosition=f(e.useEncodedPosition,!1),t.defaultTexture=null,t.defaultCubeMap=null,t.defaultShadowMap=null,t._environment=null,t._environmentChanged=!1,t.environment=e.environment,t._backgroundMesh=null,t._background=null,t._backgroundSize=1,t.backgroundIsSkybox=!1,t.backgroundVisibleDistance=1e4,t.effects=[],t.fixedLights=[],t.partialLights=[],t._fixedWebGLLights=new V.default,t._partialWebGLLights=new V.default,t._minRange=f(e.minRange,8),t.isMoonVisible=f(e.isMoonVisible,!0),t.isSunVisible=f(e.isSunVisible,!0),t.initBackground(),t.updateModelMatrix()}function o(e,t,r){if(e.length)for(var n=0;n<e.length;n++){var i=e[n];o(i,t,e)}else{t(e,r);var a=e.children;if(!a)return;for(var s=a.length,u=0;u<s;u++){o(a[u],t,e)}}}var s=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var u,l,c,f,d,h,p,m,v,g,y,_,b,M,x,w,S,T,C,E,A,L,P,O,R,I,D,B,U=s(e("o_9")),N=s(e("m_10")),k=s(e("M_11")),j=s(e("e_12")),G=(s(e("s_13")),s(e("h_14")),s(e("-_15")),s(e("3_16")),
s(e("D_17"))),V=s(e("._18")),F=(s(e("C_19")),s(e("o_20")),s(e("h_3"))),z=!1;a.prototype={init:function(e){var t=this;if(e=e.frameState||e,this.renderer.init(e),this._scene||(this._scene=e.camera._scene),!this._onCameraChanged){var r=null;this._onCameraChanged=function(){t._cameraChanged=!0,r&&(r=clearTimeout(r)),r=setTimeout(function(){t._cameraChanged=!1},2e3)},e.camera.changed.addEventListener(this._onCameraChanged)}if(this.frameState||(this._frameState=e),!this.defaultTextureImage){var n=document.createElement("canvas");this.defaultTextureImage=n,n.width=2,n.height=2;var i=n.getContext("2d");i.fillStyle="white",i.fillRect(0,0,2,2)}if(!this.defaultCubeMap){var a=this.defaultTextureImage;a||(a=document.createElement("canvas"),a.width=2,a.height=2,this.defaultTextureImage=a),this.defaultCubeMap=new M({context:e.context,source:{positiveX:a,negativeX:a,positiveY:a,negativeY:a,positiveZ:a,negativeZ:a}})}if(this.defaultTexture||(this.defaultTexture=new h({context:e.context,source:this.defaultTextureImage})),null==this.defaultShadowMap){var n=document.createElement("canvas");n.width=256,n.height=256,this.defaultShadowMap=new h({context:e.context,source:n})}if(!this.defaultFramebuffer){var o=e.context,s=new h({context:o,width:256,height:256}),u=new T({context:o,width:256,height:256,format:33189});this.defaultFramebuffer=new C({context:o,colorTextures:[s],depthRenderbuffer:u})}this.initBackground(),this.updateEnvironment()},initBackground:function(){if("undefined"!=typeof THREE&&!this._backgroundMesh){var e=THREE,t=this.renderer,r=this.defaultTextureImage;r||(r=document.createElement("canvas"),r.width=2,r.height=2,this.defaultTextureImage=r);var n=new e.Mesh(new e.BoxBufferGeometry(2,2,2),new e.ShaderMaterial({name:"BackgroundCubeMaterial",uniforms:e.UniformsUtils.clone(e.ShaderLib.cube.uniforms),vertexShader:e.ShaderLib.cube.vertexShader,fragmentShader:e.ShaderLib.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1}));n.geometry.deleteAttribute("normal"),n.geometry.deleteAttribute("uv"),n.pass=0,n.frustumCulled=!1,Object.defineProperty(n.material,"envMap",{get:function(){return this.uniforms.envMap.value},set:function(e){e&&(e=t._cubemaps.get(e),this.uniforms.envMap.value=e,this.uniforms.flipEnvMap.value=e.isCubeTexture&&e._needsFlipEnvMap?-1:1)}}),n.material.uniforms.flipEnvMap.value=1;var i=this.background||new e.CubeTexture([this.defaultTextureImage,this.defaultTextureImage,this.defaultTextureImage,this.defaultTextureImage,this.defaultTextureImage,this.defaultTextureImage]);n.material.uniforms.envMap.value=i,n.material.uniforms.flipEnvMap.value=i.isCubeTexture&&i._needsFlipEnvMap?-1:1,n.scale.setScalar(this._backgroundSize),n.visible=!!this.background,this._backgroundMesh=n,this._background=null}},updateEnvironment:function(e){var t=this;if(!(e=e||this._frameState))return void console.warn("frameState  is required,this function will be called in the next frame");if(this._environmentChanged&&this._environment&&this._environment.isTexture){var r=this._environment.uuid,n=this._textureCache[r];if(!n){var i=k.default.fromTexure3js(this._environment),a=!1;this._environment.isCubeTexture?(n=k.default.createCubeTexture(i,e.context),a=!0):i.isEmptyTextureUniform||(i.target=3553,n=k.default.createTexture(i,e.context),a=!0),a&&(i.onDispose(function(){n.isDestroyed()||n.destroy(),delete t._textureCache[r]}),n.__createByVisualizer=!0,this._textureCache[r]=n)}}},add:function(e){e.visualizer=this,this._children.push(e),e.isIRenderable&&e.onAdded(this)},remove:function(e,t){for(var r=this,n=Cesium,i=(n.Pass,n.destroyObject,0);i<this._children.length;i++)this._children[i]==e&&this._children.splice(i,1);o(e,function(e){if(e.isObject3D){var n=e.geometry,i=e.material;if(i&&n)if(t){var a=Array.isArray(i)?i:[i];a.forEach(function(e){return e.dispose()}),n.dispose(),e.dispatchEvent({type:"dispose"},e)}else r.renderer._cesiumVertextArrays.delete(n)}else if(t&&e.isRuntimeMesh&&e.destroy&&e.destroy(),e.renderItems){var o=Array.isArray(e.renderItems)?e.renderItems:[e.renderItems];o.forEach(function(e){e.destroy&&e.destroy(),e.material=null}),delete e.renderItems}if(e.pickId||e.pickObject){var s=e.pickId||e.pickObject.pickId;if(s){var u=r._pickIds.indexOf(s);u>=0&&r._pickIds.splice(u,1),delete e.pickId,s.destroy&&s.destroy()}e.pickObject&&(delete e.pickObject.pickId,delete e.pickObject)}});var a=this._scene,s=[0,7,8,4];a._view.frustumCommandsList.forEach(function(e){s.forEach(function(t){var r=e.commands[t],n=[];r.forEach(function(e){e.isDestroyed&&e.isDestroyed()||e.vertexArray.isDestroyed()||n.push(e)}),r.length=0,n.forEach(function(e){r.push(e)})})}),a._shaderFrameCount=199,e.isIRenderable&&e.onRemoved(this)},pickPosition:function(e,t){if(this._scene&&(L=this._scene.pickPosition(e,L)))return this.worldCoordinatesToLocal(L,L),v.clone(L,t),t},getPickRay:function(e,t,r){if(this._scene){var n=Cesium,i=n.Cartesian3,a=n.Ray;if(t||(t=a()),this._scene.camera.getPickRay(e,I),L=this._scene.pickPosition(e,L))return i.clone(I.direction,P),this.worldCoordinatesToLocal(I.origin,R,r),this.worldCoordinatesToLocal(L,L,r),i.add(R,P,O),i.subtract(L,O,P),i.clone(L,t.origin),i.clone(P,t.direction),t}},worldCoordinatesToLocal:function(e,t,r){t||(t=new v);var n=this._actualModelMatrix;return r&&(r.y?n=this._actualModelMatrixYup:r.x&&(n=this._actualModelMatrixXup)),u.inverseTransformation(n,A),u.multiplyByPoint(A,e,t),t},localToWorldCoordinates:function(e,t,r){t||(t=new v);var n=this._actualModelMatrix;return r&&(r.y?n=this._actualModelMatrixYup:r.x&&(n=this._actualModelMatrixXup)),u.multiplyByPoint(n,e,t),t},computeModelMatrix:function(e){if(e.modelMatrixNeedsUpdate){var t=e.matrixWorld.elements,r=e.modelMatrix,n=this;e.up.y?u.multiply(n._actualModelMatrixYup,t,r):e.up.x?u.multiply(n._actualModelMatrixXup,t,r):u.multiply(n._actualModelMatrix,t,r),e.forward&&e.forward.z&&u.multiplyTransformation(r,Cesium.Axis.Z_UP_TO_X_UP,r)}},updateModelMatrix:function(){var e=this,t=e._actualModelMatrix,r=e._actualModelMatrixYup,n=e._actualModelMatrixXup;u.clone(e.modelMatrix,t),U.default.yUp2Zup(t,r),u.multiplyTransformation(t,Cesium.Axis.X_UP_TO_Z_UP,n),u.inverse(t,e._actualModelMatrixInverse),u.inverse(r,e._actualModelMatrixYupInverse),u.inverse(n,e._actualModelMatrixXupInverse),u.getTranslation(t,e._center)},computeObjectVisibility:function(e,t,r){if(0==e.frustumCulled){if(e.isCustomInstancedMesh){var n=e._availableInstances||[];e._availableInstances=n,n.length=0,e.instances.forEach(function(e){n.push(e)})}return void(e.mvis_visibility=0)}if(!e.isInstancedMesh&&e.geometry){var i=e.modelMatrixNeedsUpdate;if(i||r){var a=t.camera,o=t.cullingVolume,s=G.default.get(e.geometry),l=s.boundingSphere,c=s.boundingVolume;if(e.isCustomInstancedMesh){var f=e.instances,d=e._availableInstances||[];e._availableInstances=d,d.length=0,f.forEach(function(t){if(t.show){var r=t.boundingSphere;r.radius=l.radius*t.scale;if(t.modelMatrixNeedsUpdate&&u.getTranslation(t.modelMatrix,r.center),t.mvis_distanceToCamera=a.distanceToBoundingSphere(r),t.mvis_visibility=1,e.maxVisibleDistance&&t.mvis_distanceToCamera>e.maxVisibleDistance)return void(t.mvis_visibility=-1);t.mvis_visibility=o.computeVisibility(r),-1!=t.mvis_visibility&&d.push(t)}})}else{if(i){var h=e.modelMatrix;u.multiplyByPoint(h,l.center,c.center),c.radius=l.radius*u.getMaximumScale(e.modelMatrix)}e.mvis_distanceToCamera=a.distanceToBoundingSphere(c),e.mvis_visibility=1;U.default.computeRange(e.mvis_distanceToCamera,c.radius,t)<this.minRange?e.mvis_visibility=-1:e.maxVisibleDistance&&e.mvis_distanceToCamera>e.maxVisibleDistance&&(e.mvis_visibility=-1),-1!=e.mvis_visibility&&(e.mvis_visibility=o.computeVisibility(c))}}}},isRenderItemVisible:function(e,t){if(!e.frustumCulled)return!0;var r=e.boundingVolume,n=t.camera.distanceToBoundingSphere(r),i=U.default.computeRange(n,r.radius,t);if(e.distanceToCamera=n,i<this.minRange)return!1;if(0==e.object.mvis_visibility){if(-1==t.cullingVolume.computeVisibility(r))return!1}return!0},isLightVisible:function(e,t){var r=e.boundingSphere;return!e.modelMatrixNeedsUpdate&&r||(r||(r=new S,e.boundingSphere=r),u.getTranslation(e.modelMatrix,r.center),r.radius=e.distance),(this._cameraChanged||e.modelMatrixNeedsUpdate)&&(e._exVisible=-1!=t.cullingVolume.computeVisibility(r)),e._exVisible},updateExtensionLight:function(e,t){e.matrixAutoUpdate&&e.updateMatrixWorld(),!e.modelMatrixNeedsUpdate&&e.boundingSphere||this.computeModelMatrix(e),this.isLightVisible(e,t),e.modelMatrixNeedsUpdate=!1},projectObject:function(e,t,r,n,i){if(e.isObject3D&&(e.show||e.visible))if(e.isGroup||e.isScene)for(var a=e.children,o=0;o<a.length;o++)this.projectObject(a[o],t,r,n,i);else{if(e.isLOD)!0===e.autoUpdate&&e.update(r);else if(e.isLight)e.isPointLight?this.updateExtensionLight(e,t):this.computeModelMatrix(e),n.pushLight(e),e.target&&(e.target.matrixAutoUpdate&&e.target.updateMatrixWorld(),this.computeModelMatrix(e.target)),e.castShadow&&n.pushShadow(e);else if(e.isMesh||e.isLine||e.isPoints||e.Sprite){e.isCustomInstancedMesh||this.computeModelMatrix(e),this.computeObjectVisibility(e,t,this._cameraChanged,i);var s=-1!=e.mvis_visibility;!s||t.passes.pick&&(0==e.allowPick||0==e.material.allowPick)?e.modelMatrixNeedsUpdate=!1:n.pushRenderable(e)}for(var u=e.children,l=0;l<u.length;l++)this.projectObject(u[l],t,r,n,i)}},updateBackground:function(e,t,r){var n=this._backgroundMesh;if(n&&n.visible){if(this.backgroundIsSkybox){n.scale.setScalar(1),n.updateMatrixWorld(),n.matrixWorld.copyPosition(t.matrixWorld);var i=v.distance(e.camera.positionWC,this._center);i>this.backgroundVisibleDistance?n.material.uniforms.opacity.value=1-(i-this.backgroundVisibleDistance)/this.backgroundVisibleDistance:n.material.uniforms.opacity.value=1}else n.updateMatrixWorld();this.computeModelMatrix(n),this.renderer._webglRenderItems.getAndUpdate(n,e,!1,r,t)}},updateSunLight:function(e){if(this._sunLight){var t=this,r=t._scene,n=r.light,i=t._sunLight,a=i.shadow,o=a.camera,s=(e.shadowState,e.context.uniformState),u=s._sunPositionWC,l=s._sunDirectionWC,c=t._sunPositionLC,f=t._sunTargetPositionLC,d=t._sunTargetPositionWC,h=t._sunDirectionLC;if(this.worldCoordinatesToLocal(u,c,{y:1}),v.subtract(u,l,d),this.worldCoordinatesToLocal(d,f,{y:1}),v.subtract(c,f,h),i){var p=i.target;g.clone(i.color,n.color),i.intensity=n.intensity;var m=this.sunLightShadowFar,y=this.sunLightShadowRange,_=this.sunLightShadowSize;i.position.copy(c).normalize().multiplyScalar(m),i.updateMatrixWorld(),p.updateMatrixWorld(),this.computeModelMatrix(i),this.computeModelMatrix(p),_!=a.mapSize.x&&(a.mapSize.set(_,_),a.__mapVersion=0),o.left=-y,o.right=y,o.top=y,o.bottom=-y,o.far=2*m,o.near=.1,o.updateProjectionMatrix()}}},projectObjects:function(e,t,r,n,i){var a=this,o=n.dynamicRenderables;if(e.children.forEach(function(e){"function"==typeof e.render&&e.render(t,o,a.renderer,r,n),(e.visible||e.show)&&e.isObject3D&&(e.matrixAutoUpdate||e.modelMatrixNeedsUpdate)&&(e.updateMatrixWorld(),a.computeModelMatrix(e))}),e.isMeshVisualizer)for(var s=e.children,u=0;u<s.length;u++)this.projectObject(s[u],t,r,n,i);else this.projectObject(e,t,r,n,i);if(this.useSunLight&&this._sunLight){for(var l=this._sunLight,c=l.children,f=0;f<c.length;f++)this.projectObject(c[f],t,r,n,i);this.projectObject(l.shadow.camera,t,r,n,i)}for(var d=0;d<o.length;d++)this.projectObject(o[d],t,r,n,i)},createOrUpdateCommands:function(e,t,r,n){var i=e.camera._scene._globe._surface.tileProvider._debug.wireframe;this._sysWireframe,this._sysWireframe=i;var a=e.camera,o=a.frustum,s=this._cameraChanged;u.multiply(o.projectionMatrix,a.viewMatrix,D);for(var l=t.renderList,c=t.renderables,f=this.renderer._webglRenderItems,d=this.optimizeInitCount,h=this.optimizeCommandInit,p=[],m=0,v=c.length;m<v;m++){var g=c[m];if(!(h&&p.length>=d)){var y=f.getAndUpdate(g,e,i,t,r),_=g.modelMatrixNeedsUpdate||this.modelMatrixNeedsUpdate,b=_||s;1==y.length&&(y[0].visible=!0,b=!1);for(var M=0,x=y.length;M<x;M++){var w=y[M],S=w.boundingVolume;if(u.multiplyByPoint(D,S.center,B),w.z=B.z,0!=w.material.visible&&((b||void 0==w.visible)&&(w.visible=this.isRenderItemVisible(w,e,n)),0!=w.visible)){if(!w.loaded){if(h&&p.length>=d)return;p.push(w),w.loaded=!0}g!=this._backgroundMesh&&l.push(w)}}}}l.sort()},getAndUpdateRenderState:function(e,t,r,n){var i=this.renderer._webglRenderStates,a=i.get(e,t.camera);return a.init(),this.updateSunLight(t),this.updateBackground(t,r,a),this.projectObjects(e,t,r,a,n),a},update:function(e,t,r){var n=this;if(e.mode===Cesium.SceneMode.SCENE3D&&(this.init(e),this._ready&&(t||this.show)&&(t=t||this,t.geometry||0!=t.children.length))){var a=!!r,o=e.camera;this.updateSunLight(e),!a&&e.passes.render&&(this.mainCamera=o,this.beforeUpdate.raiseEvent(e));var s=this.renderer,u=s.shadowMap,l=s._webglRenderStates,c=l.get(t,o),f=c.renderList,d=this._backgroundMesh,h=a?r:e.commandList;if(e.passes.offscreen||e.passes.depth||e.passes.pick)return void(this.mainCamera?l.get(t,this.mainCamera).getDrawCommands(h,e):f.getDrawCommands(h,e));c.lights=this._lights,c.init(),s._webglRenderItems.changingState.maxChangingCount=this.maxChangingCount,this._modelMatrixNeedsUpdate&&(this._backgroundMesh&&(this._backgroundMesh.modelMatrixNeedsUpdate=!0),this.updateModelMatrix());var p,m=o._referenceFrame||{matrix:this._actualModelMatrixYup,inverseMatrix:this._actualModelMatrixYupInverse},v=!1,g=!1,y=s._clipping;p=o.isOrthographicCamera?j.default.toOrthographicCamera3js(o,null,m):j.default.toPerspectiveCamera3js(o,null,m),o._referenceFrame||(p._referenceFrame=m),v=s.localClippingEnabled,g=y.init(s.clippingPlanes,v,p),c.clippingEnabled=g,c.localClippingEnabled=v,!a&&e.passes.render&&t.children.forEach(function(t){t.isIRenderable&&t.onBeforeRender&&t.onBeforeRender(e,n.renderer,p,c)});var _=a?j.default.getFrustum3js(p):null;this.projectObjects(t,e,p,c,_);var b=c.dynamicRenderables,M=c.renderables,x=c.shadowsArray,w=c.lightsArray;!0===g&&y.beginShadows();var S=null,T=o._referenceFrame;S=o.isOrthographicCamera?j.default.toOrthographicCamera3js(o,null,m):j.default.toPerspectiveCamera3js(o,null,m);for(var C=0;C<M.length;C++){var E=M[C];if(E.visible&&E.onBeforeRender&&E.onBeforeRender!=THREE.Object3D.prototype.onBeforeRender){var m=T||{matrix:this._actualModelMatrixYup,inverseMatrix:this._actualModelMatrixYupInverse};S._referenceFrame=m,E.onBeforeRender(s,t,S,this._scene),S._referenceFrame=T}}this.useSunLight&&this._sunLight&&this._sunLight.castShadow&&!e.shadowState.shadowsEnabled&&c.pushShadow(this._sunLight),u.enabled||(x.length=0),u.autoUpdate&&u.render(x,t,e,this),0==w.length&&c.pushLight(this._defaultAmbientLight),this.useSunLight&&this._sunLight&&c.pushLight(this._sunLight),c.setupLights(o),this.fixedLights.forEach(function(t){n.updateExtensionLight(t,e)}),this.partialLights.forEach(function(t){n.updateExtensionLight(t,e)}),this._fixedWebGLLights.setup(this.fixedLights,null,o,e),this._partialWebGLLights.setup(this.partialLights,null,o,e),!0===g&&y.endShadows(),this.createOrUpdateCommands(e,c,p,_);var A;d&&(this.updateBackground(e,p,c),A=d.renderItems,!this.backgroundIsSkybox&&A&&f.push(A[0])),f.getDrawCommands(h,e);for(var L=0;L<this.effects.length;L++){var P=this.effects[L];if(P.enabled&&(P.preUpdate||P.preUpdate)){P.name||(P.name="effect-"+Cesium.createGuid()),P.preUpdate(t,p,e,c);for(var O=P.selected?P.selected:M,R=0;R<O.length;R++){var I=O[R];if(!I.isRuntimeMesh)for(var D=I.renderItems,B=G.default.get(I.geometry),U=I.material,N=Array.isArray(U),k=0;k<D.length;k++){var V=D[k],F=V.materialIndex,z=N?U[F]:U;I.onBeforeRender&&I.onBeforeRender(s,t,p,B,z);var H=s._webglRenderItems.getAndUpdateDerived(I,B,z,V,P.name,e,c,p);H&&(I.onAfterRender&&I.onAfterRender(s,t,p,B,z),h.push(H))}}P.postUpdate&&P.postUpdate(t,p,e,c)}}var W=this._scene._environmentState,Y=this.backgroundIsSkybox&&d&&d.visible&&d.renderItems;if(a){if(W.isMoonVisible&&this.isMoonVisible&&h.unshift(W.moonCommand),W.isSunVisible&&this.isSunVisible&&h.unshift(W.sunDrawCommand),Y){var X=A[0].drawCommand;h.unshift(X)}this.mainCamera!=o&&c.init()}else{for(var q=0;q<M.length;q++){var K=M[q];K.onBeforeFinalRender&&K.onBeforeFinalRender(s,t,S,this._scene),i(M[q])}for(var Z=0;Z<w.length;Z++)w[Z].modelMatrixNeedsUpdate=!1;if(W.skyAtmosphereCommand&&Y){var X=A[0].drawCommand;W.isSkyAtmosphereVisible=!0,d.material.uniforms.opacity.value>.5&&(W.skyAtmosphereCommand=X)}this.afterUpdate.raiseEvent(e),M.length=0,b.length=0,w.length=0,x.length=0}this._modelMatrixNeedsUpdate=!1,this.frameNumber=e.frameNumber,this._environmentChanged=!1}},destroy:function(){var e=this;this.beforeDestroy.raiseEvent(this),this._ready=!1,a.traverseObject3D(this,function(t){e.remove(t),t.dispose&&t.dispose(),t.destroy&&t.destroy()},!1),this.renderer.dispose();for(var t in this._textureCache)this._textureCache.hasOwnProperty(t)&&delete this._textureCache[t];if(this._textureCache={},this._pickIds)for(t=0;t<this._pickIds.length;++t)this._pickIds[t].destroy&&this._pickIds[t].destroy();this._pickIds.splice(0)},traverse:function(e){o(this,e)}},a.traverse=function(e,t,r,n){if(e&&(n||(n={cancelCurrent:!1,cancelAll:!1}),n.cancelCurrent=!1,!r||e.show||e.visible)){e instanceof a||!(e.geometry&&e.material||e.isLight||e.isGroup||e.isObject3D||e.isScene)||t(e,n);var i=e.children;if(i){for(var o=0;o<i.length;o++)if(!n.cancelCurrent){if(n.cancelAll)break;a.traverse(e.children[o],t,r,n)}}else e.scene&&a.traverse(e.scene,t,r,n)}},a.prototype.traverseObject3D=o,Object.defineProperties(a.prototype,{children:{get:function(){return this._children}},modelMatrix:{get:function(){return this._modelMatrix},set:function(e){e&&(this._modelMatrix=e)}},sunPositionLC:{get:function(){return this._sunPositionLC}},sunDirectionLC:{get:function(){return this._sunDirectionLC}},background:{get:function(){return this._background},set:function(e){if(!e||!e.isColor){this._background=e;var t=this._backgroundMesh;if(t)if(e){var r=t.material;r.envMap!=e&&(r.needsUpdate=!0),r.envMap=e,t.visible=!0}else t.visible=!1}}},backgroundSize:{get:function(){return this._backgroundSize},set:function(e){e=e||1,this._backgroundSize=e;var t=this._backgroundMesh;t&&t.scale.setScalar(e)}},backgroundMesh:{get:function(){return this._backgroundMesh}},environment:{get:function(){return this._environment},set:function(e){var t=this,r=t._environment;if(e&&e.isTexture)t._environment=e,t._environmentChanged=!0;else if(r){var n=r.uuid,i=t._textureCache[n];i&&i._createByMeshVisualizer&&(i.destroy(),delete t._textureCache[n]),t._environment=e,t._environmentChanged=!0}}},pickIds:{get:function(){return this._pickIds}},scene:{set:function(e){this._scene=e},get:function(){return this._scene}},frameState:{get:function(){if(this._scene)return this._frameState}},show:{get:function(){return this._show},set:function(e){this._show=e}},ready:{get:function(){return this._ready}},minRange:{get:function(){return this._minRange},set:function(e){var t=this;t._minRange!=e&&(t._minRange=e,t._cameraChanged=!0,requestAnimationFrame(function(){t._cameraChanged=!1}))}}});var H=a;r.default=H},{e_12:1,C_19:3,o_20:4,o_9:6,h_3:7,M_11:17,D_17:22,"._18":23,s_13:29,"3_16":30,"-_15":32,h_14:33,m_10:35,M_0:241}],6:[function(e,t,r){"use strict";function n(){}function i(e){if(e.validateFramebuffer){var t=e._gl,r=t.checkFramebufferStatus(t.FRAMEBUFFER);if(r!==t.FRAMEBUFFER_COMPLETE){var n;switch(r){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:n="Framebuffer is not complete.  Incomplete attachment: at least one attachment point with a renderbuffer or texture attached has its attached object no longer in existence or has an attached image with a width or height of zero, or the color attachment point has a non-color-renderable image attached, or the depth attachment point has a non-depth-renderable image attached, or the stencil attachment point has a non-stencil-renderable image attached.  Color-renderable formats include GL_RGBA4, GL_RGB5_A1, and GL_RGB565. GL_DEPTH_COMPONENT16 is the only depth-renderable format. GL_STENCIL_INDEX8 is the only stencil-renderable format.";break;case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:n="Framebuffer is not complete.  Incomplete dimensions: not all attached images have the same width and height.";break;case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:n="Framebuffer is not complete.  Missing attachment: no images are attached to the framebuffer.";break;case t.FRAMEBUFFER_UNSUPPORTED:n="Framebuffer is not complete.  Unsupported: the combination of internal formats of the attached images violates an implementation-dependent set of restrictions."}throw new DeveloperError(n)}}}function a(e,t){var r=Cesium;if(t!==e._currentFramebuffer){"undefined"!=typeof WebGLRenderingContext&&(h=[1029]),e._currentFramebuffer=t;var n=h;if(r.defined(t))t._bind(),i(e),n=t._getActiveColorAttachments();else{var a=e._gl;a.bindFramebuffer(a.FRAMEBUFFER,null)}e.drawBuffers&&e.glDrawBuffers(n)}}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o,s,u,l,c,f;n.computeRange=function(e,t,r,n){var i=Cesium,a=i.defaultValue(n,1),o=r.camera,s=r.context,u=s.drawingBufferHeight*a,l=Math.max(e,i.Math.EPSILON7),c=o.frustum.sseDenominator,f=t,d=f*u/(l*c);return d/=r.pixelRatio};var d;n.projectSphere=function(e,t,r){var n=Cesium;d||(d=new n.Cartesian4);var i=n.Matrix4.multiplyByPoint(t,e.center,d),a=e.radius*e.radius,o=i.z*i.z,s=n.Cartesian3.dot(i,i);return-Math.PI*r*r*a*Math.sqrt(Math.abs((s-a)/(a-o)))/(a-o)},n.renderToTexture=function(e,t,r,n){var i=Cesium,a=i.Framebuffer,o=i.Texture,s=(i.PixelFormat,i.PixelDatatype,i.ClearCommand),u=i.Color,l=Array.isArray(e)?e:[e],c=t.context,d=null,h=!1;r instanceof a&&(d=r),d||(n&&n.width==r.width&&n.height==r.height||(n=new o({context:c,width:r.width,height:r.height,pixelFormat:6402,pixelDatatype:5123})),d=new a({context:c,colorTextures:[r],destroyAttachments:!1,depthTexture:n}),h=!0),f||(f=new s({color:new u(0,0,0,0)}));var p=f;p.framebuffer=d,p.renderState=t.renderState,p.execute(c),l.forEach(function(e){e.framebuffer=d,e.execute(c)}),h&&d.destroy()},n.renderToPixels=function(e,t,r,i,a){var o=Cesium,s=o.Framebuffer,u=o.Texture,l=(o.PixelFormat,o.PixelDatatype,o.ClearCommand),c=o.Color,d=Array.isArray(e)?e:[e],h=t.context,p=null,m=!1;if(r instanceof s&&(p=r),!p){var v=new u({context:h,width:r.width,height:r.height,pixelFormat:6402,pixelDatatype:5123});p=new s({context:h,colorTextures:[r],depthTexture:h.depthTexture?v:void 0,destroyAttachments:!1}),m=!0}f||(f=new l({color:new c(0,0,0,0)}));var g=f;return g.framebuffer=p,g.renderState=t.renderState,g.execute(h),d.forEach(function(e){e.framebuffer=p,e.execute(h)}),i=i||{},a=n.readPixels(t,Object.assign(i,{framebuffer:p}),a),delete i.framebuffer,m&&p.destroy(),a};var h,p,m;n.readPixels=function(e,t,r){var n=Cesium,i=n.DeveloperError,o=(n.Framebuffer,n.Texture,n.PixelFormat,n.PixelDatatype,n.ClearCommand,n.Color,e.context._gl);t=t||{};var s=Math.max(t.x||0,0),u=Math.max(t.y||0,0),l=t.width||o.drawingBufferWidth,c=t.height||o.drawingBufferHeight,f=t.pixelDatatype||5121,d=t.pixelFormat||6408,h=t.framebuffer||e.frameNumber;if(l<=0)throw new i("readState.width must be greater than zero.");if(c<=0)throw new i("readState.height must be greater than zero.");a(this,h);var v=4;return 6407==d?v=3:6406==d&&(v=1),r||(5126==f?(f=o.FLOAT,r=new Float32Array(v*l*c)):r=5121==f?new Uint8Array(v*l*c):new Uint16Array(v*l*c)),o.readPixels(s,u,l,c,d,f,r),p=d,m=f,r};var v;n.yUp2Zup=function(e,t){var r=Cesium,n=r.Matrix4,i=r.Matrix3;return o||(o=n.fromRotationTranslation(i.fromRotationX(r.Math.PI_OVER_TWO)),v=n.inverse(o,new n)),n.multiplyTransformation(e,o,t)},n.zUp2YUp=function(e,t){var r=Cesium,n=r.Matrix4,i=r.Matrix3;return o||(o=n.fromRotationTranslation(i.fromRotationX(r.Math.PI_OVER_TWO)),v=n.inverse(o,new n)),n.multiplyTransformation(e,v,t)},n.computeModelMatrix=function(e,t,r,n,i){if(0==arguments.length)return e;var a=Cesium,o=a.Matrix4,f=a.Cartesian3,d=a.Quaternion;if(s||(s=new f),u||(u=new d),l||(l=new f),c||(c=new o),i||(i=new o),o.clone(e,i),t||(s.x=0,s.y=0,s.z=0),s.x=t.x,s.y=t.y,s.z=t.z,n||(l.x=1,l.y=1,l.z=1),l.x=n.x,l.y=n.y,l.z=n.z,r instanceof d)d.clone(r,u);else{var h=r.axis,p=r.angle;d.fromAxisAngle(new f(h.x,h.y,h.z),a.Math.toRadians(p),u)}return o.fromTranslationQuaternionRotationScale(s,u,l,c),o.multiplyTransformation(i,c,i),i};var g=n;r.default=g},{}],7:[function(e,t,r){"use strict";function n(){function e(e){for(var t=e,r=t._gl,n=t._uniformsByName,i=t._program,a=r.getProgramParameter(i,r.ACTIVE_UNIFORMS),o=0;o<a;o++){var s=r.getActiveUniform(i,o),u=s.name,l=u.indexOf("[");if(l>=0){var c=n[u.slice(0,l)];if(d(c))continue;if(!n[s.name]){var f=r.getUniformLocation(i,s.name),p=h(r,s,s.name,f);t._uniformsByName[s.name]=p,t._uniforms.push(p),t._manualUniforms.push(p)}}}}if(!i){i=!0;var t=Cesium,r=t.Matrix4,n=t.Matrix3,a=t.Matrix2,o=t.Cartesian3,s=t.Cartesian2,u=t.Quaternion,l=t.OrthographicFrustum,c=t.Camera,f=t.ShaderProgram,d=t.defined,h=t.createUniform;if(o.prototype.set=function(e,t,r){return this.x=e,this.y=t,this.z=r,this},o.prototype.copy=function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},s.prototype.set=function(e,t){return this.x=e,this.y=t,this},s.prototype.copy=function(e){return this.x=e.x,this.y=e.y,this},u.prototype.set=function(e,t,r,n){return this.x=e,this.y=t,this.z=r,this.w=n,this},u.prototype.copy=function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this},l.prototype.isOrthographicFrustum||(l.prototype.isOrthographicFrustum=!0,Object.defineProperties(c.prototype,{isOrthographicCamera:{get:function(){return this.frustum&&1==this.frustum.isOrthographicFrustum}}})),f.prototype._setUniforms=function(t,r,n){var i,a;if(d(t)){this._makeSupportStructureUniformsDone||(e(this),this._makeSupportStructureUniformsDone=!0);var o=this._manualUniforms;for(i=o.length,a=0;a<i;++a){var s=o[a];t[s.name]||console.error("uniform "+s.name+" is undefined"),s.value=t[s.name]()}}var u=this._automaticUniforms;for(i=u.length,a=0;a<i;++a){var l=u[a];l.uniform.value=l.automaticUniform.getValue(r)}var c=this._uniforms;for(i=c.length,a=0;a<i;++a)c[a].set();if(n){var f=this._gl,h=this._program;f.validateProgram(h)}},r.prototype.__patched__||(r.prototype.__patched__=!0,Object.defineProperties(r.prototype,{elements:{get:function(){return this}}}),Object.defineProperties(n.prototype,{elements:{get:function(){return this}}}),Object.defineProperties(a.prototype,{elements:{get:function(){return this}}})),"undefined"!=typeof THREE&&!THREE.Material.prototype.__patched__){var p=THREE,m=p.Material,v=p.Color,g=p.Object3D;m.prototype.__patched__=!0,Object.defineProperties(m.prototype,{renderStateNeedsUpdate:{set:function(){this.renderStateVersion++}},renderStateVersion:{get:function(){return void 0==this._renderStateVersion&&(this._renderStateVersion=0),this._renderStateVersion},set:function(e){this._renderStateVersion=e}},autoRefresh:{get:function(){return void 0==this._autoRefresh&&(this._autoRefresh=!0),this._autoRefresh},set:function(e){this._autoRefresh=e}},translucent:{get:function(){return void 0==this._translucent&&(this._translucent=!1),this._translucent},set:function(e){this._translucent!=e&&(this._translucent=e,this.needsUpdate=!0)}}}),Object.defineProperties(v.prototype,{red:{get:function(){return this.r},set:function(e){this.r=e}},green:{get:function(){return this.g},set:function(e){this.g=e}},blue:{get:function(){return this.b},set:function(e){this.b=e}},alpha:{get:function(){return 1},set:function(e){}}});var y=[],_=[];Object.defineProperties(g.prototype,{modelMatrixNeedsUpdate:{get:function(){return void 0==this._modelMatrixNeedsUpdate&&(this._modelMatrixNeedsUpdate=!0),this._modelMatrixNeedsUpdate},set:function(e){this._modelMatrixNeedsUpdate=e}},modelMatrix:{get:function(){return void 0==this._modelMatrix&&(this._modelMatrix=r.IDENTITY.clone()),this._modelMatrix},set:function(e){this._modelMatrix=e}},maxVisibleDistance:{get:function(){return this._maxVisibleDistance||(this._maxVisibleDistance=1/0),this._maxVisibleDistance},set:function(e){if(this._maxVisibleDistance!=e){this._maxVisibleDistance=e;for(var t=this.children,r=0;r<t;r++){var n=this.children[r];n._maxVisibleDistance==1/0&&(n.maxVisibleDistance=e)}}}},instances:{get:function(){return this._instances||(this._instances=y),this._instances},set:function(e){if(this._instances!=e){this._instances=e;for(var t=this.children.length,r=0;r<t;r++){var n=this.children[r];n._instances==y&&(n.instances=e)}e&&e.length>0?this._isCustomInstancedMesh=!0:this._isCustomInstancedMesh=!1}}},instancedAttributes:{get:function(){return this._instancedAttributes||(this._instancedAttributes=_),this._instancedAttributes},set:function(e){if(this._instancedAttributes!=e){this._instancedAttributes=e;for(var t=this.children,r=0;r<t;r++){var n=this.children[r];n._instancedAttributes==_&&(n.instancedAttributes=e)}}}},isCustomInstancedMesh:{get:function(){return void 0==this._isCustomInstancedMesh&&(this._isCustomInstancedMesh=!1),this._isCustomInstancedMesh}}}),g.prototype._updateMatrixWorld=g.prototype.updateMatrixWorld,g.prototype.updateMatrixWorld=function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0,this.modelMatrixNeedsUpdate=!0);for(var t=this.children,r=0;r<t.length;r++)t[r].updateMatrixWorld(e)}}}}Object.defineProperty(r,"__esModule",{value:!0}),r.default=n;var i=!1},{}],8:[function(e,t,r){"use strict";function n(e){var t=e._visualizer,r=e._uniforms,n=e._cesiumRenderStates,i=e._cesiumShaderPrograms,u=e._cesiumVertextArrays;this.create=function(e,o,l,c,f,d){var h,p=t.frameState,m=(p.context,a.default.get(e.geometry)),v=m.groups,g=e.material,y=Cesium,_=y.defined,b=y.Matrix4,M=(y.PrimitiveType,y.DrawCommand);y.Pass;h=e.isMesh?g.wireframe?1:4:e.isLine?e.isLineSegments?1:e.isLineLoop?2:3:e.isPoints?0:4;var x=e.instances,w=e._availableInstances,S=new M({modelMatrix:x&&x.length>0?void 0:b.clone(t.modelMatrix),owner:e,castShadows:!0,pickId:"czm_pickColor",receiveShadows:!0,primitiveType:h,cull:!1,instanceCount:x&&x.length>0?w.length:void 0}),T=u.create(m,e,c,f,d),C=T._attributeLocations;T.instanceCount&&(S.instanceCount=T.instanceCount),S.vertexArray=T;var E=c,A=null;Array.isArray(g)&&(d||(A=c,E=v[A].materialIndex),g=g[E]),S.shaderProgram=i.get(g,C,e,o,l);var L=e.pass;return("number"!=typeof L||L<0||L>8)&&(L=g.translucent?8:4),S.pass=g.translucent?8:g.stencilWrite?5:4,S._v_pass=g.translucent||g.transparent?8:L,_(g.allowPick)||(g.allowPick=!0),S.renderState=n.create(g,e),S._renderStateOptions=g._renderStateOptions,S.uniformMap=r.getUniformMap(g,e,p,o,l),e.uniformMapLoadedCallback&&e.uniformMapLoadedCallback(S.uniformMap,p,e),new s.default(S,g,E,e,m,t,A)},this.createArray=function(e,t,r){for(var n=[],i=a.default.get(e.geometry,e.material),s=i.groupsOptimized,u=0;u<s.length;u++){var l=s[u],c=l.materialIndex,f=o.default.computeBoundingSphereAndIndices(i,c,!0),d=f.boundingSphere,h=f.indices,p=this.create(e,t,r,c,h,!0);p.boundingSphere=d,n.push(p)}return n},this.update=function(e,r){var n=Cesium,i=n.BoundingSphere,a=n.Matrix4;r=r||e.geometry;var o=Array.isArray(e.renderItems)?e.renderItems:[e.renderItems],s=Array.isArray(e.material);o.forEach(function(n){var o=n.drawCommand,u=n.material||e.material;if(e.isInstancedMesh&&(o.instanceCount=e.count),e.instances&&e.instances.length){if(0!=e.frustumCulled&&!o.boundingVolume){var l=i.clone(e._boundingSphere);o.boundingVolume=l}o.instanceCount=e._availableInstances.length}else if(0!=e.frustumCulled||u.translucent||u.transparent){var l=s&&o.__boundingSphere?o.__boundingSphere:r.boundingSphere;if(!l)if(r.computeBoundingSphere)r.computeBoundingSphere(),l=r.boundingSphere;else{var c=r.attributes.position;l=i.fromVertices(c.values||c.array),r.boundingSphere=l}o.boundingVolume||(o.boundingVolume=i.clone(l)),(t._modelMatrixNeedsUpdate||e.modelMatrixNeedsUpdate||!o.boundingVolume._multiplyByModelMatrix)&&(a.multiplyByPoint(e.modelMatrix,l.center,o.boundingVolume.center),o.boundingVolume.radius=l.radius*a.getMaximumScale(e.modelMatrix),o.boundingVolume._multiplyByModelMatrix=!0)
;var f=r.maxInstancedCount||r.instanceCount;f&&(o.instanceCount=f)}o.modelMatrix=e.modelMatrix}),s&&o.forEach(function(r){var n=r.material;t.renderer._uniforms.refresh(n,e)})}}var i=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=n;var a=i(e("e_23")),o=i(e("s_24")),s=i(e("h_25"));i(e("-_26")),i(e("3_27"))},{s_24:2,e_23:22,"-_26":23,h_25:29,"3_27":35,M_0:241}],9:[function(e,t,r){"use strict";function n(e){function t(t,r){var n=e._capabilities,i=e._extensions,o=a.default.equationMap,s=Cesium,u=(s.WebGLConstants,s.StencilFunction,s.StencilOperation,s.StencilConstants),l=s.defined,c=s.defaultValue,f=(s.CullFace,s.BlendingState),d=(THREE,a.default.factorMap),h=a.default.depthFuncMap,p=t,m=1===p.side;if(r&&(m=!m),n.isWebGL2)o[103]=32775,o[104]=32776;else{var v=i.get("EXT_blend_minmax");null!==v&&(o[103]=v.MIN_EXT,o[104]=v.MAX_EXT)}if(l(p.side)||(p.side=2),p.onCreateRenderState){var g=p.onCreateRenderState();if(g)return g}return{frontFace:r&&m?2304:2305,cull:{enabled:2!=p.side,face:1==p.side?1028:1029},lineWidth:1,polygonOffset:{enabled:p.polygonOffset,factor:p.polygonOffsetFactor,units:p.polygonOffsetUnits},depthRange:p.depthRange||{near:0,far:1},depthTest:{enabled:p.depthTest,func:c(h[p.depthFunc],515)},colorMask:{red:p.colorWrite,green:p.colorWrite,blue:p.colorWrite,alpha:p.colorWrite},depthMask:c(p.depthWrite,!0),blending:function(){if(0==p.blending)return f.DISABLED;var e=p.blendEquation,t=p.blendEquationAlpha||p.blendEquation;if(5===p.blending)return{enabled:0==p.blending,equationRgb:o[e],equationAlpha:o[t],functionSourceRgb:d[p.blendSrc],functionSourceAlpha:d[p.blendSrcAlpha],functionDestinationRgb:d[p.blendDst],functionDestinationAlpha:d[p.blendDstAlpha]};if(p.premultipliedAlpha)switch(p.blending){case 1:return{enabled:!0,equationRgb:o[e],equationAlpha:o[t],functionSourceRgb:1,functionSourceAlpha:1,functionDestinationRgb:771,functionDestinationAlpha:771};case 2:return{enabled:!0,equationRgb:o[e],equationAlpha:o[t],functionDestinationAlpha:1,functionDestinationRgb:1,functionSourceAlpha:1,functionSourceRgb:770};case 3:return{enabled:!0,equationRgb:o[e],equationAlpha:o[t],functionSourceRgb:0,functionSourceAlpha:769,functionDestinationRgb:0,functionDestinationAlpha:771};case 4:return{enabled:!0,equationRgb:o[e],equationAlpha:o[t],functionSourceRgb:0,functionSourceAlpha:0,functionDestinationRgb:768,functionDestinationAlpha:770};default:console.error("RenderSateUtils: Invalid blending: ",p.blending)}else switch(p.blending){case 1:return{enabled:!0,equationRgb:o[e],equationAlpha:o[t],functionSourceRgb:770,functionSourceAlpha:1,functionDestinationRgb:771,functionDestinationAlpha:771};case 2:return f.ADDITIVE_BLEND;default:console.error("RenderSateUtils: Invalid blending: ",p.blending)}}(),stencilMask:p.stencilWrite?p.stencilWriteMask:u.CESIUM_3D_TILE_MASK,stencilTest:p.stencilWrite?{enabled:p.stencilWrite,frontFunction:p.stencilFunc,backFunction:p.stencilFunc,reference:c(p.stencilRef,0),mask:c(p.stencilFuncMask,-1),frontOperation:{fail:p.stencilFail,zFail:p.stencilZFail,zPass:p.stencilZPass},backOperation:{fail:p.stencilFail,zFail:p.stencilZFail,zPass:p.stencilZPass}}:{backFunction:519,backOperation:{fail:7680,zFail:7680,zPass:7681},enabled:!0,frontFunction:519,frontOperation:{fail:7680,zFail:7680,zPass:7681},mask:128,reference:128}}}function r(e,r){var n=r.matrixWorld.determinant()<0,a=t(e,n);return e._renderStateOptions=a,i.fromCache(a)}var n=Cesium,i=n.RenderState,o=new Map;this.create=function(e,t,n){var i;return n?(i=o.get(e))||(i=r(e,t),o.set(e,i),e.material3js.addEventListener("dispose",function(){o.delete(e,i)})):i=r(e,t),i}}var i=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=n;var a=i(e("._29"));i(e("3_27"))},{"._29":12,"3_27":35,M_0:241}],10:[function(e,t,r){"use strict";function n(e){function t(e){var t=n._fixedWebGLLights,r=n._partialWebGLLights,i=t.state.point.length,o=r.state.point.length;if(i>0||o>0){var l=e.fragmentShader;l=a.default.insertAfter(l,/uniform vec3 lightProbe\[ 9 \];/g,s.default.replace(/NUM_STATIC_POINT_LIGHTS/g,i).replace(/NUM_PAITIAL_POINT_LIGHTS/g,o)),l=a.default.insertAfter(l,/IncidentLight directLight;/g,u.default.replace(/NUM_STATIC_POINT_LIGHTS/g,i).replace(/NUM_PAITIAL_POINT_LIGHTS/g,o)),e.fragmentShader=l}}function r(t,r,i,a){var o=n;a=a||null;var s=e._programs,u=s.getParameters(t,t.lightMap?l:i.state,a,o,r),f=s.getUniforms(t);if(u.uniforms=f,"function"==typeof t.onBeforeCompile&&t.onBeforeCompile(u,e),t.isNodeMaterial){f=u.uniforms,u=s.getParameters(t,t.lightMap?l:i.state,a,o,r),u.uniforms=f;var d=c.get(t);d.needsLights=t.lights,d.clipping=t.clipping}var h=s.getProgramCacheKey(u),p=e._programs.acquireProgram(u,h);return p.uniforms=u.uniforms,p}var n=e._visualizer,i=e._uniforms,c=e._properties,f=Cesium,d=f.ShaderSource,h=f.ShaderProgram;this.get=function(s,u,l,c,f){var p,m=n.frameState.context,v=l.instances;p=r(s,l,c,f),a.default.processInstanceShader(l,p);var g=v&&v.length?"varying":s.pickColorQualifier||"uniform",y=g+" vec4 czm_pickColor;\n";p.vertexShader="\n                #define CESIUM_MESH_VISUALIZER\n                uniform vec3 u_cameraPositionLC;\n                uniform mat4 matrixWorld;\n                uniform mat3 normalMatrixWorld;\n                uniform mat4 viewMatrixThree;\n                uniform mat4 modelViewMatrixInverse;\n                uniform mat4 _CesiumModel2ThreeModel;\n                uniform mat3 _CesiumNormal2ThreeNormal;\n                uniform mat4 _ThreeModel2CesiumModel;\n                uniform mat3 _ThreeNormal2CesiumNormal;\n                "+p.vertexShader;var _="\n                #define CESIUM_MESH_VISUALIZER\n                uniform mat4 matrixWorld;\n                uniform mat3 normalMatrixWorld;\n                uniform mat4 viewMatrixThree;\n                uniform mat4 modelViewMatrixInverse;\n                uniform mat4 _CesiumModel2ThreeModel;\n                uniform mat3 _CesiumNormal2ThreeNormal;\n                uniform mat4 _ThreeModel2CesiumModel;\n                uniform mat3 _ThreeNormal2CesiumNormal;\n"+p.fragmentShader;if(p.fragmentShader=_,n.useEncodedPosition&&a.default.modifyEncodedPosition(l,p),a.default.modifyShadowWorldPosition(l,p),a.default.modifyEnvMapQueryVec(l,p),t(p),p.fragmentShader=(0,o.unrollLoops)(p.fragmentShader),s.onAfterCompile&&s.onAfterCompile(p,e),"varying"==s.pickColorQualifier&&-1==p.vertexShader.indexOf("czm_pickColor")){var b=s.pickColorName||"pickColor";p.vertexShader=a.default.insertBeforeMain(p.vertexShader,"attribute vec4 "+b+";\nvarying vec4 czm_pickColor;\n"),p.vertexShader=a.default.insertAfterMain(p.vertexShader,"czm_pickColor="+b+";\n")}i.set(s,p.uniforms,l,c,f);var M=new d({sources:[p.vertexShader]}),_=new d({sources:[y+p.fragmentShader,"#ifdef GL_EXT_frag_depth \n#extension GL_EXT_frag_depth : enable \n#endif \n\n"]});return!(s.translucent||s.transparent)&&m.fragmentDepth&&_.defines.push("WRITE_DEPTH"),h.fromCache({context:m,fragmentShaderSource:_,vertexShaderSource:M,attributeLocations:u})}}var i=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=n;var a=i(e("m_32")),o=(i(e("M_33")),i(e("3_27")),e("s_35")),s=(i(e("h_36")),i(e("-_26")),i(e("3_38"))),u=i(e("D_39")),l={directional:[],point:[],spot:[],rectArea:[],hemi:[],directionalShadowMap:[],pointShadowMap:[],spotShadowMap:[]}},{M_33:5,m_32:14,"3_38":15,D_39:16,"-_26":23,s_35:26,h_36:27,"3_27":35,M_0:241}],11:[function(e,t,r){"use strict";function n(){var e=new WeakMap;this.get=function(t){return e.get(t)},this.set=function(t,r,n){function i(){e.delete(t),n.removeEventListener("dispose",i)}n.addEventListener("dispose",i),e.set(t,r)},this.delete=function(t){e.delete(t)}}function i(e){function t(e,t){var r=t?e._instances:e._availableInstances,n=r.length,i=e._center,a=e._vertexBufferTypedArray;(!b(a)||12*n>a.length)&&(a=new Float32Array(12*n)),e._vertexBufferTypedArray=a;for(var o=0;o<n;++o){var s=r[o].modelMatrix,u=_.clone(s,I);u[12]-=i.x,u[13]-=i.y,u[14]-=i.z;var l=12*o;a[l+0]=u[0],a[l+1]=u[4],a[l+2]=u[8],a[l+3]=u[12],a[l+4]=u[1],a[l+5]=u[5],a[l+6]=u[9],a[l+7]=u[13],a[l+8]=u[2],a[l+9]=u[6],a[l+10]=u[10],a[l+11]=u[14]}return a}function r(e,t,r){var n,i=r?e._instances:e._availableInstances,a=i.length,o=e._pickIdBufferTypedArray;for((!o||4*a>o.length)&&(o=new Uint8Array(4*a)),e._pickIdBufferTypedArray=o,n=0;n<a;++n){var s=i[n],u=e._pickIds[s.instanceId];u||(u=t.createPickId(s),e._pickIds[s.instanceId]=u);var l=u.color,c=4*n;o[c]=E.floatToByte(l.red),o[c+1]=E.floatToByte(l.green),o[c+2]=E.floatToByte(l.blue),o[c+3]=E.floatToByte(l.alpha)}return o}function i(e,t,r){var n,i,a=r?e._instances:e._availableInstances,o=a.length,s=t.name,u=t.default instanceof E;"number"==typeof t.default?i=1:t.default instanceof T?i=2:t.default instanceof S?i=3:t.default instanceof C?i=4:u&&(i=4);var l=e["_"+s+"BufferTypedArray"];if((!l||o*i>l.length)&&(l=u?new Uint8Array(o*i):new Float32Array(o*i)),e["_"+s+"BufferTypedArray"]=l,u)for(n=0;n<o;++n){var c=a[n],f=c[s],d=n*i;l[d]=E.floatToByte(f.red),l[d+1]=E.floatToByte(f.green),l[d+2]=E.floatToByte(f.blue),l[d+3]=E.floatToByte(f.alpha)}else if("number"==typeof t.default)for(n=0;n<o;++n){var c=a[n],f=c[s];l[n]=f}else if(t.default instanceof T)for(n=0;n<o;++n){var c=a[n],f=c[s],d=n*i;l[d]=f.x,l[d+1]=f.y}else if(t.default instanceof S)for(n=0;n<o;++n){var c=a[n],f=c[s],d=n*i;l[d]=f.x,l[d+1]=f.y,l[d+2]=f.z}else if(t.default instanceof C)for(n=0;n<o;++n){var c=a[n],f=c[s],d=n*i;l[d]=f.x,l[d+1]=f.y,l[d+2]=f.z,l[d+3]=f.w}return l}function a(e,t,r,n,a){return e.instancedAttributes.forEach(function(o){var s=o.name;n[s]=++a;var u=A.createVertexBuffer({context:t,typedArray:i(e,o,!0),usage:35044});o._buffer=u;var l={index:n[o.name],vertexBuffer:u,componentsPerAttribute:4,componentDatatype:L.FLOAT,normalize:!1,offsetInBytes:0,strideInBytes:0,instanceDivisor:1};"number"==typeof o.default?l.componentsPerAttribute=1:o.default instanceof T?l.componentsPerAttribute=2:o.default instanceof S?l.componentsPerAttribute=3:o.default instanceof C?l.componentsPerAttribute=4:o.default instanceof E&&(l.componentDatatype=L.UNSIGNED_BYTE,l.normalize=!0,l.componentsPerAttribute=4),r.push(l)}),a}function u(e,n){var i=r(e,n,!0);e._pickIdBuffer=A.createVertexBuffer({context:n,typedArray:i,usage:35044});var a=t(e,!0);e._vertexBuffer=A.createVertexBuffer({context:n,typedArray:a,usage:35044})}function l(e,t,r){r=r||0;var n=e._gl,i=e._bufferTarget;n.bindBuffer(i,e._buffer),n.bufferData(i,t,n.DYNAMIC_DRAW),n.bindBuffer(i,null)}function c(e,n){var a=t(e);l(e._vertexBuffer,a);var o=r(e,n);l(e._pickIdBuffer,o),e.instancedAttributes.forEach(function(t){var r=i(e,t);l(t._buffer,r)})}function f(e,t){for(var r=e._instances,n=r.length,i=new Array(n),a=0;a<n;++a)i[a]=t.createPickId(r[a]);return i}function d(e){for(var t=e._instances.length,r=new Array(t),n=0;n<t;++n)r[n]=_.getTranslation(e._instances[n].modelMatrix,new S);e._boundingSphere=P.fromPoints(r),S.clone(e._boundingSphere.center,e._center)}function h(e,t,r,n){var i=t.data,a=i.stride,s=t.offset,u=i.array,l=u.constructor.BYTES_PER_ELEMENT,c=A.createVertexBuffer({context:n,typedArray:u,usage:i.usage}),f={index:r[e],vertexBuffer:c,componentDatatype:o.default.getAttributeComponentType(u),componentsPerAttribute:t.itemSize,normalize:t.normalized,offsetInBytes:s*l,strideInBytes:a*l};return i&&i.isInstancedInterleavedBuffer&&(f.instanceDivisor=i.meshPerAttribute||1),f}function p(e,t,r,n,i,a){try{var s=t.array;s instanceof Uint32Array&&(s=new Float32Array(s),console.warn("Mesh3D.CesiumVertextArrays：暂不支持Uint32Array类型顶点数组，已经强制替换为Float32Array（这会增加内存开销）"));var u=A.createVertexBuffer({context:n,typedArray:s,usage:t.usage||i}),l={index:r[e],vertexBuffer:u,componentDatatype:o.default.getAttributeComponentType(s),componentsPerAttribute:t.itemSize,normalize:t.normalized};return t.isInstancedBufferAttribute&&(l.offsetInBytes=0,l.strideInBytes=0,l.instanceDivisor=t.meshPerAttribute||1),l}catch(e){throw e}}function m(e){var t,r=e.geometry,n=r.groups,i=w(e.bufferUsage,35048),a=e.context,s=e.group,u=e.groupOptimized,l=e.indices,c=r.index;if(l||(void 0!==s&&n.length>1?l=o.default.genGeometryIndices(r,s,u):c&&(l=c.array)),l&&l.length>0){var f=5123;l instanceof Uint8Array?f=5121:l instanceof Uint32Array&&(f=5125),t=A.createIndexBuffer({context:a,typedArray:l,usage:i,indexDatatype:f})}return t}function v(e){var t=e.geometry,r=t.groups,n=e.context,i=e.attributeLocations,a=e.group,o=e.groupOptimized,s=w(e.bufferUsage,35048),u=[].concat(e.vertexArrayAttributes||[]),l=t.attributes;if(e.useEncodedPosition){l=Object.assign({},t.attributes);var c=l.position,f=c.array,d=l.positionHigh=Object.assign({},c),v=l.positionLow=Object.assign({},c);d.array=new Float32Array(f.length),v.array=new Float32Array(f.length);var g={high:0,low:0};f.forEach(function(e,t){Cesium.EncodedCartesian3.encode(1e6*e,g),d.array[t]=g.high,v.array[t]=g.low}),delete l.position}var y,_=m({geometry:t,context:n,group:a,groupOptimized:o,bufferUsage:s,indices:e.indices}),M=a&&r.length>1;for(var S in l)if(l.hasOwnProperty(S)&&b(l[S])){var T=l[S],C=M?R.get(T):void 0;C||(C=T.isInterleavedBufferAttribute?h(S,T,i,n):p(S,T,i,n,s,a),C.instanceDivisor&&(y=C.instanceDivisor*T.count),R.set(T,C,t)),u.push(C)}var E=new x({context:n,attributes:u,indexBuffer:_});return E._attributeLocations=i,E.instanceCount=y,l=null,E}function g(e,t,r,n){var i=e._attributeLocations[t];if(void 0==i)return!1;var a=e._attributes[i],o=a.vertexBuffer,s=r.values||r.array,u=s.constructor.BYTES_PER_ELEMENT;return o._sizeInBytes==s.length*u&&(o.copyFromArrayView(s,0),!0)}var y=Cesium,_=y.Matrix4,b=y.defined,M=y.GeometryPipeline,x=(y.BufferUsage,y.VertexArray),w=y.defaultValue,S=y.Cartesian3,T=y.Cartesian2,C=y.Cartesian4,E=y.Color,A=y.Buffer,L=y.ComponentDatatype,P=(y.IndexDatatype,y.BoundingSphere),O=e._visualizer,R=new n,I=new _;this.create=function(e,t,r,n,i){var o=O.frameState,s=o.context,l=O.useEncodedPosition,c=t,h=e.attributes;c&&l&&(h=Object.assign({},e.attributes),h.positionHigh=h.position,h.positionLow=h.position,delete h.position);var m,g,y=M.createAttributeLocations({attributes:h}),_=0;for(var b in y)y.hasOwnProperty(b)&&(_=Math.max(_,y[b]));var w;if(t._instances&&t._instances.length){d(t),w=[],t._pickIds=f(t,s),u(t,s);var S=12,T=L.getSizeInBytes(L.FLOAT),C={czm_modelMatrixRow0:{index:_+1,vertexBuffer:t._vertexBuffer,componentsPerAttribute:4,componentDatatype:L.FLOAT,normalize:!1,offsetInBytes:0,strideInBytes:T*S,instanceDivisor:1},czm_modelMatrixRow1:{index:_+2,vertexBuffer:t._vertexBuffer,componentsPerAttribute:4,componentDatatype:L.FLOAT,normalize:!1,offsetInBytes:4*T,strideInBytes:T*S,instanceDivisor:1},czm_modelMatrixRow2:{index:_+3,vertexBuffer:t._vertexBuffer,componentsPerAttribute:4,componentDatatype:L.FLOAT,normalize:!1,offsetInBytes:8*T,strideInBytes:T*S,instanceDivisor:1}};C.a_pickColor={index:_+4,vertexBuffer:t._pickIdBuffer,componentsPerAttribute:4,componentDatatype:L.UNSIGNED_BYTE,normalize:!0,offsetInBytes:0,strideInBytes:0,instanceDivisor:1};for(var b in C)C.hasOwnProperty(b)&&(y[b]=++_,w.push(C[b]));_=a(t,s,w,y,_)}else if(c.isInstancedMesh){w=[];for(var E=c.instanceMatrix,P=c.instanceColor,S=16,T=L.getSizeInBytes(L.FLOAT),R=A.createVertexBuffer({context:s,typedArray:E.array,usage:35044}),C={},I=0;I<4;I++){var b="instanceMatrix"+(I||""),D=++_,B={index:D,vertexBuffer:R,componentsPerAttribute:4,componentDatatype:L.FLOAT,normalize:!1,offsetInBytes:I*S,strideInBytes:T*S,instanceDivisor:1};w.push(B),y[b]=D}if(c.instanceColor){y.instanceColor=++_;var P=p("instanceColor",c.instanceColor,y,s,r,35044);P.instanceDivisor=1,w.push(P)}m=c.count}if(e.isBufferGeometry)g=v({context:s,geometry:e,attributeLocations:y,bufferUsage:35044,vertexArrayAttributes:w,group:r,indices:n,groupOptimized:i,useEncodedPosition:l});else{h=e.attributes;for(var U in h){var N=h[U];N?N.componentDatatype==L.DOUBLE&&(N.values=new Float32Array(N.values)):delete h[U]}g=x.fromGeometry({context:s,geometry:e,attributeLocations:y,bufferUsage:35044,vertexArrayAttributes:w})}return w&&w.length&&(g._cacehVertexArrayAttributes=w),g._attributeLocations=y,m&&(g.instanceCount=m),g._attributes.sort(function(e,t){return e.index-t.index}),g},this.update=function(e,t,r,n){var i=O.frameState,a=i.context,o=e;!r&&o&&(r=s.default.get(o.geometry));var u=e.geometry,l=u.attributes,f=r&&r.attributes,d=t.vertexArray,h=!1,p=!1,m=!1;if(o&&(p=o.material.morphTargets||o.material.morphNormals,m=o.isSkinnedMesh),!m&&!p)for(var v in l){var y=l[v];if(y){var _=n||0!=y.needsUpdate;if(f||0!=_){if(!g(d,v,f&&f[v]||y,_)){h=!0;break}y.needsUpdate=!1}}}if(!h&&u.indexNeedsUpdate){var b=d.indexBuffer;u.indexNeedsUpdate=!1,b.copyFromArrayView(u.indices,0)}if(!h&&e._instances&&e._instances.length&&c(e,a),h){var d=t.vertexArray;if(!d.isDestroyed()&&(d.destroy(),R))for(var v in f)f.hasOwnProperty(v)&&f[v]&&R.delete(f[v]);t.vertexArray=this.create(e,a);for(var v in l)l.hasOwnProperty(v)&&l[v]&&(l[v].needsUpdate=!1);e.geometry.indexNeedsUpdate=!1}else if(o&&o.isInstancedMesh){var M=o.instanceMatrix,x=o.instanceColor;d._attributes[d._attributeLocations.instanceMatrix].version!=M.version&&g(d,"instanceMatrix",M),x&&d._attributes[d._attributeLocations.instanceColor].version!=x.version&&g(d,"instanceColor",x)}return h},this.updateVerexBuffer=function(e,t,r){var n=e.renderItems;n&&n.forEach(function(e){if(e){g(e.drawCommand.vertexArray,t,r,!0)}})},this.delete=function(e){if(R){var t=e.attributes;for(var r in t)t.hasOwnProperty(r)&&t[r]&&R.delete(t[r])}}}var a=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=a(e("s_24")),s=a(e("e_23")),u=(a(e("3_27")),i);r.default=u},{s_24:2,e_23:22,"3_27":35,M_0:241}],12:[function(e,t,r){"use strict";var n=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("e_45")),a=n(e("e_1")),o=n(e("s_2")),s=function(){function e(){(0,a.default)(this,e)}return(0,o.default)(e,null,[{key:"init",value:function(){var e,t,r,n,a,o,s,u;this.hasInit||(this.hasInit=!0,this._formatsMap=(e={},(0,i.default)(e,1022,6407),(0,i.default)(e,1023,6408),(0,i.default)(e,1026,6402),(0,i.default)(e,1021,6406),(0,i.default)(e,1027,34041),(0,i.default)(e,1024,6409),(0,i.default)(e,1025,6410),(0,i.default)(e,33777,33777),(0,i.default)(e,33778,33778),(0,i.default)(e,33779,33779),(0,i.default)(e,35843,35843),(0,i.default)(e,35842,35842),(0,i.default)(e,33776,33776),(0,i.default)(e,36196,36196),(0,i.default)(e,35841,35841),(0,i.default)(e,35840,35840),e),this._typesMap=(t={},(0,i.default)(t,1015,5126),(0,i.default)(t,1009,5121),(0,i.default)(t,1016,36193),(0,i.default)(t,1014,5125),(0,i.default)(t,1020,34042),(0,i.default)(t,1012,5123),(0,i.default)(t,1017,32819),(0,i.default)(t,1018,32820),(0,i.default)(t,1019,33635),t),this._minFilterMap=(r={},(0,i.default)(r,1006,9729),(0,i.default)(r,1008,9987),(0,i.default)(r,1005,9986),(0,i.default)(r,1003,9728),(0,i.default)(r,1007,9985),(0,i.default)(r,1004,9984),r),this._magFilterMap=(n={},(0,i.default)(n,1003,9728),(0,i.default)(n,1006,9729),n),this._textureWrapMap=(a={},(0,i.default)(a,1001,33071),(0,i.default)(a,1002,33648),(0,i.default)(a,1e3,10497),a),this._depthFuncMap=(o={},(0,i.default)(o,0,512),(0,i.default)(o,1,519),(0,i.default)(o,2,513),(0,i.default)(o,3,515),(0,i.default)(o,4,514),(0,i.default)(o,5,518),(0,i.default)(o,6,516),(0,i.default)(o,7,517),o),this._factorMap=(s={},(0,i.default)(s,200,0),(0,i.default)(s,201,1),(0,i.default)(s,202,768),(0,i.default)(s,204,770),(0,i.default)(s,210,776),(0,i.default)(s,208,774),(0,i.default)(s,206,772),(0,i.default)(s,203,769),(0,i.default)(s,205,771),(0,i.default)(s,209,775),(0,i.default)(s,207,773),s),this._equationMap=(u={},(0,i.default)(u,100,32774),(0,i.default)(u,101,32778),(0,i.default)(u,102,32779),(0,i.default)(u,103,32775),(0,i.default)(u,104,32776),u))}},{key:"formatsMap",get:function(){return this.init(),this._formatsMap}},{key:"typesMap",get:function(){return this.init(),this._typesMap}},{key:"magFilterMap",get:function(){return this.init(),this._magFilterMap}},{key:"minFilterMap",get:function(){return this.init(),this._minFilterMap}},{key:"textureWrapMap",get:function(){return this.init(),this._textureWrapMap}},{key:"depthFuncMap",get:function(){return this.init(),this._depthFuncMap}},{key:"factorMap",get:function(){return this.init(),this._factorMap}},{key:"equationMap",get:function(){return this.init(),this._equationMap}}]),e}(),u=s;r.default=u},{e_1:235,s_2:236,e_45:237,M_0:241}],13:[function(e,t,r){"use strict";function n(){if(!a){var e=Cesium;a=e.Cartesian2,o=e.Check,s=e.createGuid,u=e.defaultValue,l=e.defined,c=e.destroyObject,f=e.DeveloperError,d=e.Math,h=e.PixelFormat,p=e.WebGLConstants,m=e.ContextLimits,v=e.MipmapHint,g=e.PixelDatatype,y=e.Sampler,_=e.TextureMagnificationFilter,b=e.TextureMinificationFilter}}function i(e){n(),e=u(e,u.EMPTY_OBJECT);var t=e.context,r=e.width,i=e.height,o=e.source;l(o)&&(l(r)||(r=u(o.videoWidth,o.width)),l(i)||(i=u(o.videoHeight,o.height)));var c=u(e.pixelFormat,6408),f=u(e.pixelDatatype,5121),d=c,p=h.isCompressedFormat(d);if(t.webgl2)if(34041===c?d=35056:6402===c&&(5123===f?d=33189:5125===f&&(d=33190)),5126===f)switch(c){case 6408:d=34836;break;case 6407:d=34837;break;case h.RG:d=33328;break;case h.R:d=33326}else if(36193===f)switch(c){case 6408:d=34842;break;case 6407:d=34843;break;case h.RG:d=33327;break;case h.R:d=33325}var m=e.preMultiplyAlpha||6407===c||6409===c,v=u(e.flipY,!0),g=!0,_=t._gl,b=_.TEXTURE_2D,M=_.createTexture();_.activeTexture(_.TEXTURE0),_.bindTexture(b,M);var x=4;l(o)&&l(o.arrayBufferView)&&!p&&(x=h.alignmentInBytes(c,f,r)),_.pixelStorei(_.UNPACK_ALIGNMENT,x);var w=Math.floor;if(l(o))if(l(o.arrayBufferView)){_.pixelStorei(_.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),_.pixelStorei(_.UNPACK_FLIP_Y_WEBGL,!1);var S=o.arrayBufferView;if(p){if(_.compressedTexImage2D(b,0,d,r,i,0,S),l(o.mipLevels))for(var T=r,C=i,E=0;E<o.mipLevels.length;++E)T=0|w(T/2),T<1&&(T=1),C=0|w(C/2),C<1&&(C=1),_.compressedTexImage2D(b,E+1,d,T,C,0,o.mipLevels[E])}else if(v&&(S=h.flipY(S,c,f,r,i)),_.texImage2D(b,0,d,r,i,0,c,f,S),l(o.mipLevels))for(var T=r,C=i,E=0;E<o.mipLevels.length;++E)T=0|w(T/2),T<1&&(T=1),C=0|w(C/2),C<1&&(C=1),_.texImage2D(b,E+1,d,T,C,0,c,f,o.mipLevels[E])}else l(o.framebuffer)?(_.pixelStorei(_.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),_.pixelStorei(_.UNPACK_FLIP_Y_WEBGL,!1),o.framebuffer!==t.defaultFramebuffer&&o.framebuffer._bind(),_.copyTexImage2D(b,0,d,o.xOffset,o.yOffset,r,i,0),o.framebuffer!==t.defaultFramebuffer&&o.framebuffer._unBind()):(_.pixelStorei(_.UNPACK_PREMULTIPLY_ALPHA_WEBGL,m),_.pixelStorei(_.UNPACK_FLIP_Y_WEBGL,v),_.texImage2D(b,0,d,c,f,o));else _.texImage2D(b,0,d,r,i,0,c,f,null),g=!1;_.bindTexture(b,null);var A;A=p?h.compressedTextureSizeInBytes(c,r,i):h.textureSizeInBytes(c,f,r,i),this._id=s(),this._context=t,this._textureFilterAnisotropic=t._textureFilterAnisotropic,this._textureTarget=b,this._texture=M,this._pixelFormat=c,this._pixelDatatype=f,this._width=r,this._height=i,this._dimensions=new a(r,i),this._hasMipmap=!1,this._sizeInBytes=A,this._preMultiplyAlpha=m,this._flipY=v,this._initialized=g,this._sampler=void 0,this.sampler=l(e.sampler)?e.sampler:new y}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var a,o,s,u,l,c,f,d,h,p,m,v,g,y,_,b;i.create=function(e){return new i(e)},i.fromFramebuffer=function(e){e=u(e,u.EMPTY_OBJECT);var t=e.context,r=t._gl,n=u(e.pixelFormat,6407),a=u(e.framebufferXOffset,0),o=u(e.framebufferYOffset,0),s=u(e.width,r.drawingBufferWidth),c=u(e.height,r.drawingBufferHeight),f=e.framebuffer;return new i({context:t,width:s,height:c,pixelFormat:n,source:{framebuffer:l(f)?f:t.defaultFramebuffer,xOffset:a,yOffset:o,width:s,height:c}})},Object.defineProperties(i.prototype,{id:{get:function(){return this._id}},sampler:{get:function(){return this._sampler},set:function(e){var t=e.minificationFilter,r=e.magnificationFilter,n=9984===t||9986===t||9985===t||9987===t,i=this._context,a=this._pixelDatatype;(5126===a&&!i.textureFloatLinear||36193===a&&!i.textureHalfFloatLinear)&&(t=n?9984:9728,r=9728);var o=i._gl,s=this._textureTarget;o.activeTexture(o.TEXTURE0),o.bindTexture(s,this._texture),o.texParameteri(s,o.TEXTURE_MIN_FILTER,t),o.texParameteri(s,o.TEXTURE_MAG_FILTER,r),o.texParameteri(s,o.TEXTURE_WRAP_S,e.wrapS),o.texParameteri(s,o.TEXTURE_WRAP_T,e.wrapT),l(this._textureFilterAnisotropic)&&o.texParameteri(s,this._textureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,e.maximumAnisotropy),o.bindTexture(s,null),this._sampler=e}},pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},dimensions:{get:function(){return this._dimensions}},preMultiplyAlpha:{get:function(){return this._preMultiplyAlpha}},flipY:{get:function(){return this._flipY}},width:{get:function(){return this._width}},height:{get:function(){return this._height}},sizeInBytes:{get:function(){return this._hasMipmap?Math.floor(4*this._sizeInBytes/3):this._sizeInBytes}},_target:{get:function(){return this._textureTarget}}}),i.prototype.copyFrom=function(e,t,r){t=u(t,0),r=u(r,0);var n=this._context._gl,i=this._textureTarget;n.activeTexture(n.TEXTURE0),n.bindTexture(i,this._texture);var a=e.width,o=e.height,s=e.arrayBufferView,c=this._width,f=this._height,d=this._pixelFormat,p=this._pixelDatatype,m=this._preMultiplyAlpha,v=this._flipY,g=4;l(s)&&(g=h.alignmentInBytes(d,p,a)),n.pixelStorei(n.UNPACK_ALIGNMENT,g);var y=!1;if(!this._initialized){if(0===t&&0===r&&a===c&&o===f)l(s)?(n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!1),v&&(s=h.flipY(s,d,p,c,f)),n.texImage2D(i,0,d,c,f,0,d,p,s)):(n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,m),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,v),n.texImage2D(i,0,d,d,p,e)),y=!0;else{n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!1);var _=h.createTypedArray(d,p,c,f);n.texImage2D(i,0,d,c,f,0,d,p,_)}this._initialized=!0}y||(l(s)?(n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!1),v&&(s=h.flipY(s,d,p,a,o)),n.texSubImage2D(i,0,t,r,a,o,d,p,s)):(n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,m),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,v),n.texSubImage2D(i,0,t,r,d,p,e))),n.bindTexture(i,null)},i.prototype.copyFromFramebuffer=function(e,t,r,n,i,a){e=u(e,0),t=u(t,0),r=u(r,0),n=u(n,0),i=u(i,this._width),a=u(a,this._height);var o=this._context._gl,s=this._textureTarget;o.activeTexture(o.TEXTURE0),o.bindTexture(s,this._texture),o.copyTexSubImage2D(s,0,e,t,r,n,i,a),o.bindTexture(s,null),this._initialized=!0},i.prototype.generateMipmap=function(e){e=u(e,4352),this._hasMipmap=!0;var t=this._context._gl,r=this._textureTarget;t.hint(t.GENERATE_MIPMAP_HINT,e),t.activeTexture(t.TEXTURE0),t.bindTexture(r,this._texture),t.generateMipmap(r),t.bindTexture(r,null)},i.prototype.isDestroyed=function(){return!1},i.prototype.destroy=function(){return this._context._gl.deleteTexture(this._texture),c(this)};var M=i;r.default=M},{}],14:[function(e,t,r){"use strict";function n(){}function i(e,t){var r=t+"\nvoid main()";return e.replace(/void\s+main\s*\(\s*(?:void)?\s*\)/g,r)}function a(e,t){var r="void main(){\n"+t;return e.replace(/void\s+main\s*\(\s*(?:void)?\s*\)\s*{/g,r)}function o(e,t){if(!t)return e;var r=e.lastIndexOf("}");if(r>=0&&t.length){var n=e.substring(0,r),i=e.substring(r);e="\n"!=t[t.length-1]?n+t+"\n"+i:n+t+i}return e}function s(e,t,r){var n=t;"string"==typeof t&&(n=new RegExp(t,"g"));var i=n.exec(e);if(i){var a=i.index;e=e.substring(0,a)+r+e.substring(a)}return e}function u(e,t,r){var n=t;"string"==typeof t&&(n=new RegExp(t,"g"));var i=n.exec(e);if(i){var a=i.index+i[0].length;e=e.substring(0,a)+r+e.substring(a)}return e}Object.defineProperty(r,"__esModule",{value:!0}),r.insertBeforeMain=i,r.insertAfterMain=a,r.appendMain=o,r.insertBefore=s,r.insertAfter=u,r.default=void 0,n.insertBeforeMain=i,n.insertAfterMain=a,n.appendMain=o,n.replaceIncludes=function(e,t,r){return e.replace(t,r)},n.insertBefore=s,n.insertAfter=u;var l=/attribute\s+vec(?:3|4)\s+(.*)3DHigh;/g;n._modifyShaderPosition=function(e,t,r){for(var n,i="",a="",o="";null!==(n=l.exec(t));){var s=n[1],u="vec4 czm_compute"+s[0].toUpperCase()+s.substr(1)+"()";"vec4 czm_computePosition()"!==u&&(i+=u+";\n"),defined(e.rtcCenter)?(t=t.replace(/attribute\s+vec(?:3|4)\s+position3DHigh;/g,""),t=t.replace(/attribute\s+vec(?:3|4)\s+position3DLow;/g,""),i+="uniform mat4 u_modifiedModelView;\n",a+="attribute vec4 position;\n",o+=u+"\n{\n    return u_modifiedModelView * position;\n}\n\n",t=t.replace(/czm_modelViewRelativeToEye\s+\*\s+/g,""),t=t.replace(/czm_modelViewProjectionRelativeToEye/g,"czm_projection")):r?o+=u+"\n{\n    return czm_translateRelativeToEye("+s+"3DHigh, "+s+"3DLow);\n}\n\n":(a+="attribute vec3 "+s+"2DHigh;\nattribute vec3 "+s+"2DLow;\n",o+=u+"\n{\n    vec4 p;\n    if (czm_morphTime == 1.0)\n    {\n        p = czm_translateRelativeToEye("+s+"3DHigh, "+s+"3DLow);\n    }\n    else if (czm_morphTime == 0.0)\n    {\n        p = czm_translateRelativeToEye("+s+"2DHigh.zxy, "+s+"2DLow.zxy);\n    }\n    else\n    {\n        p = czm_columbusViewMorph(\n                czm_translateRelativeToEye("+s+"2DHigh.zxy, "+s+"2DLow.zxy),\n                czm_translateRelativeToEye("+s+"3DHigh, "+s+"3DLow),\n                czm_morphTime);\n    }\n    return p;\n}\n\n")}return[i,a,t,o].join("\n")},n.modifyShaderPosition=function(e,t){var r=t.vertexShader;r.includes("transformed")&&(r=r.replace("gl_Position = projectionMatrix * mvPosition","vec4 mvis_positionEC = vec4( transformed, 1.0 );\n        #ifdef USE_INSTANCING\n            mvis_positionEC = instanceMatrix * mvis_positionEC;\n        #endif\n        mvis_positionEC=vec4(mvis_positionEC.xyz - u_cameraPositionLC,1.);\n        gl_Position = czm_modelViewProjectionRelativeToEye * mvis_positionEC;\n        "),t.vertexShader=r)},n.modifyEncodedPosition=function(e,t){var r=t.vertexShader;r=r.replace(/attribute\s?vec3\s?position\s?;/g,"         attribute vec3 positionHigh;\n         attribute vec3 positionLow;\n         vec3 position;\n        "),t.vertexShader=this.insertAfterMain(r,"position=(positionHigh+positionLow)*1e-6;\n")},n.modifyShadowWorldPosition=function(e,t){var r=t.vertexShader;/vec4\s?shadowWorldPosition;/g.test(r)&&(r=r.replace(/vec4\s?shadowWorldPosition;/g,"vec4 shadowWorldPosition;\n\t\tvec4 worldPositionThree = vec4( transformed, 1.0 );\n\t\t#ifdef USE_INSTANCING\n\t\t\tworldPositionThree = instanceMatrix * worldPositionThree;\n        #endif\n        // vec3 transformedNormalThree = objectNormal;\n        // #ifdef USE_INSTANCING\n        //     mat3 m = mat3( instanceMatrix );\n        //     transformedNormalThree /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n        //     transformedNormalThree = m * transformedNormalThree;\n        // #endif\n        // shadowWorldNormal= normalMatrixWorld*transformedNormalThree;\n        worldPositionThree=matrixWorld*worldPositionThree;\n"),r=r.replace(/shadowWorldPosition\s?=\s?worldPosition\s?\+\s?/g,"shadowWorldPosition = worldPositionThree + ")),r.includes("#define DISTANCE")&&(r=r.replace(/vWorldPosition\s?=\s?worldPosition.xyz\s?;/g,"\n        vec4 worldPositionThree = vec4(transformed, 1.0 );\n        #ifdef USE_INSTANCING\n            worldPositionThree = instanceMatrix * worldPositionThree;\n        #endif\n        worldPositionThree = matrixWorld * worldPositionThree;\n        vWorldPosition=worldPositionThree.xyz;\n")),t.vertexShader=r},n.modifyEnvMapQueryVec=function(e,t){var r=(Cesium.Matrix4,t.fragmentShader);r=r.replace(/textureCube\s?\(\s?envMap\s?,\s?vec3\s?\(\s?flipEnvMap\s?\*\s?reflectVec.x\s?,\s?reflectVec.yz\s?\)\s\)/g," textureCube( envMap,vec3( flipEnvMap *(_CesiumNormal2ThreeNormal* reflectVec).x, (_CesiumNormal2ThreeNormal*reflectVec).yz ) )"),r=r.replace(/\(\s?envMap\s?,\s?reflectVec/g,"( envMap,_CesiumNormal2ThreeNormal * reflectVec"),r=r.replace(/\(\s?envMap\s?,\s?queryVec/g,"( envMap,_CesiumNormal2ThreeNormal* queryVec"),r=r.replace(/\(\s?envMap\s?,\s?queryReflectVec/g,"( envMap,_CesiumNormal2ThreeNormal* queryReflectVec"),
r=r.replace(/equirectUv\(\s?reflectVec\s?\)/g,"equirectUv( _CesiumNormal2ThreeNormal* reflectVec )"),r=r.replace(/equirectUv\(\s?direction\s?\)/g,"equirectUv( _CesiumNormal2ThreeNormal* direction )"),/textureCubeUV\s?\(\s?envMap\s?,\s?reflectVec/g.test(r)&&(r=r.replace(/textureCubeUV\s?\(\s?envMap\s?,\s?reflectVec/g,"textureCubeUV(envMap, _CesiumNormal2ThreeNormal* reflectVec")),/textureCubeUV\s?\(\s?envMap\s?,\s?worldNormal/g.test(r)&&(r=r.replace(/textureCubeUV\s?\(\s?envMap\s?,\s?worldNormal/g,"textureCubeUV(envMap, _CesiumNormal2ThreeNormal* worldNormal")),t.fragmentShader=r},n.processInstanceShader=function(e,t){if(e._instances&&e._instances.length){var r=t.vertexShader,n=Cesium.ShaderSource.replaceMain(r,"czm_instancing_main");n=n.replace(/.*uniform\s+mat4\s+modelViewMatrix/g,"mat4 modelViewMatrix").replace(/.*uniform\s+mat4\s+u_modelViewMatrix/g,"mat4 u_modelViewMatrix").replace(/.*uniform\s+mat4\s+modelMatrix/g,"mat4 modelMatrix").replace(/.*uniform\s+mat4\s+u_modelMatrix/g,"mat4 u_modelMatrix");var i="",a=[],o="";i="\n        mat3 inverse_mat3(mat3 m)\n            {\n                float Determinant = \n                      m[0][0] * (m[1][1] * m[2][2] - m[2][1] * m[1][2])\n                    - m[1][0] * (m[0][1] * m[2][2] - m[2][1] * m[0][2])\n                    + m[2][0] * (m[0][1] * m[1][2] - m[1][1] * m[0][2]);\n                    \n                mat3 Inverse;\n                Inverse[0][0] = + (m[1][1] * m[2][2] - m[2][1] * m[1][2]);\n                Inverse[1][0] = - (m[1][0] * m[2][2] - m[2][0] * m[1][2]);\n                Inverse[2][0] = + (m[1][0] * m[2][1] - m[2][0] * m[1][1]);\n                Inverse[0][1] = - (m[0][1] * m[2][2] - m[2][1] * m[0][2]);\n                Inverse[1][1] = + (m[0][0] * m[2][2] - m[2][0] * m[0][2]);\n                Inverse[2][1] = - (m[0][0] * m[2][1] - m[2][0] * m[0][1]);\n                Inverse[0][2] = + (m[0][1] * m[1][2] - m[1][1] * m[0][2]);\n                Inverse[1][2] = - (m[0][0] * m[1][2] - m[1][0] * m[0][2]);\n                Inverse[2][2] = + (m[0][0] * m[1][1] - m[1][0] * m[0][1]);\n                Inverse /= Determinant;\n                \n                return Inverse;\n            }\n            \n           mat3 transpose (mat3 m) {\n            \n                float tmp;\n                 \n                tmp = m[0][ 1 ]; m[0][ 1 ] = m[1][ 0 ]; m[1][ 0 ] = tmp;\n                tmp = m[0][ 2 ]; m[0][ 2 ] = m[2][ 0 ]; m[2][ 0 ] = tmp;\n                tmp = m[1][ 2 ]; m[1][ 2 ] = m[2][ 1 ]; m[2][ 1 ] = tmp;\n                \n                return m;\n            }\n            \n            ",n=n.replace(/.*uniform\s+mat3\s+u_normalMatrix/g,"mat3 u_normalMatrix").replace(/.*uniform\s+mat3\s+normalMatrix/g,"mat3 normalMatrix"),/mat3\s+normalMatrix/g.test(n)||a.push("mat3 normalMatrix;"),/mat3\s+u_normalMatrix/g.test(n)||a.push("mat3 u_normalMatrix;"),o="\n                   normalMatrix=mat3(modelViewMatrix);\n                   normalMatrix=transpose(inverse_mat3(normalMatrix));\n                   u_normalMatrix=normalMatrix;\n                ",/mat4\s+u_modelMatrix/g.test(n)||a.push("mat4 u_modelMatrix;"),/mat4\s+u_modelViewMatrix/g.test(n)||a.push("mat4 u_modelViewMatrix;");r="attribute vec4 czm_modelMatrixRow0;\nattribute vec4 czm_modelMatrixRow1;\nattribute vec4 czm_modelMatrixRow2;\nuniform mat4 czm_instanced_modifiedModelView;\n"+a.join("\n")+"attribute vec4 a_pickColor;\nvarying vec4 czm_pickColor;\n"+n+i+"void main()\n{\n    modelMatrix = mat4(czm_modelMatrixRow0.x, czm_modelMatrixRow1.x, czm_modelMatrixRow2.x, 0.0, czm_modelMatrixRow0.y, czm_modelMatrixRow1.y, czm_modelMatrixRow2.y, 0.0, czm_modelMatrixRow0.z, czm_modelMatrixRow1.z, czm_modelMatrixRow2.z, 0.0, czm_modelMatrixRow0.w, czm_modelMatrixRow1.w, czm_modelMatrixRow2.w, 1.0);\n    modelViewMatrix = czm_instanced_modifiedModelView * modelMatrix;\n    u_modelMatrix =modelMatrix;\n    u_modelViewMatrix = modelViewMatrix ;\n"+o+"    czm_instancing_main();\n    czm_pickColor = a_pickColor;\n}\n",t.vertexShader=r}},n.processOcclusionCulling=function(e,t){if(!e.material.transparent){t.fragmentShader=Cesium.ShaderSource.replaceMain(t.fragmentShader,"mvis_OcclusionCulling");t.fragmentShader+="\n    uniform sampler2D occlusionCullingMap;\n    uniform bool occlusionCullingToggle;\n    uniform vec2 occlusionCullingResolution;\n    void main(){\n        if(occlusionCullingToggle){\n            vec4 tPkColor=texture2D(occlusionCullingMap,gl_FragCoord.xy/occlusionCullingResolution);\n            if(tPkColor.r!=czm_pickColor.r||tPkColor.g!=czm_pickColor.g||tPkColor.b!=czm_pickColor.b||tPkColor.a!=czm_pickColor.a){\n               discard;\n            }\n            // gl_FragColor=tPkColor;\n        }\n        else{\n            mvis_OcclusionCulling();\n        }\n    }"}};var c=n;r.default=c},{}],15:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;r.default="\n#if NUM_STATIC_POINT_LIGHTS > 0 || NUM_PAITIAL_POINT_LIGHTS > 0\n    struct ExtensionPointLight {\n        vec3 position;\n        vec3 color;\n        vec2 decayDist;\n    };\n\n    #if NUM_STATIC_POINT_LIGHTS > 0 \n        #if defined(OES_texture_float_linear) &&  NUM_STATIC_POINT_LIGHTS>100\n            uniform sampler2D fixedPointLightMap;\n        #else \n            uniform vec3 fixedPointLightPositions[NUM_STATIC_POINT_LIGHTS];\n            uniform vec3 fixedPointLightColors[NUM_STATIC_POINT_LIGHTS];\n            uniform vec2 fixedPointLightDecayDists[NUM_STATIC_POINT_LIGHTS];\n        #endif \n        uniform bool fixedPointLightVisibles[NUM_STATIC_POINT_LIGHTS];\n    #endif\n\n    #if NUM_PAITIAL_POINT_LIGHTS > 0 \n        #if defined(OES_texture_float_linear) &&  NUM_PAITIAL_POINT_LIGHTS>100\n            uniform sampler2D partialPointLightMap;\n        #else \n            uniform vec3 partialPointLightPositions[NUM_PAITIAL_POINT_LIGHTS];\n            uniform vec3 partialPointLightColors[NUM_PAITIAL_POINT_LIGHTS];\n            uniform vec2 partialPointLightDecayDists[NUM_PAITIAL_POINT_LIGHTS];\n        #endif\n        uniform bool partialPointLightVisibles[NUM_PAITIAL_POINT_LIGHTS];\n    #endif\n\n    // directLight is an out parameter as having it as a return value caused compiler errors on some devices\n\tvoid getExtPointDirectLightIrradiance( const in ExtensionPointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\n        vec3 lVector = pointLight.position - geometry.position; \n        float lightDistance = length( lVector );\n\t\tdirectLight.direction = normalize( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.decayDist.y, pointLight.decayDist.x );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\n    }\n    void getExtPointDirectLightIrradiance( const in vec4 posDecay,const in vec4 colorDist, const in GeometricContext geometry, out IncidentLight directLight ) {\n\n        vec3 lVector = posDecay.xyz - geometry.position; \n        float lightDistance = length( lVector );\n\t\tdirectLight.direction = normalize( lVector );\n\t\tdirectLight.color = colorDist.rgb;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, colorDist.a, posDecay.w );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\n    }\n#endif\n"},{}],16:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;r.default="\n#if ( NUM_STATIC_POINT_LIGHTS > 0 || NUM_PAITIAL_POINT_LIGHTS > 0) && defined( RE_Direct )\n\n    ExtensionPointLight ex_pointLight;\n    vec2 ex_uv1=vec2(0.,0.8);\n    vec2 ex_uv2=vec2(0.,0.4);\n    vec2 ex_uv3=vec2(0.,0.15);\n    #if (NUM_STATIC_POINT_LIGHTS > 0) \n\n        #if defined(OES_texture_float_linear)&&  NUM_STATIC_POINT_LIGHTS>100\n            vec4 ex_fixed_posDecay;\n            vec4 ex_fixed_colorDist;\n            float ex_num=float(NUM_STATIC_POINT_LIGHTS);\n            for ( int i = 0; i < NUM_STATIC_POINT_LIGHTS; i ++ ) {\n                ex_uv1.x=(float(i)+0.5)/ex_num;\n                ex_uv3.x=ex_uv1.x; \n                #if NUM_STATIC_POINT_LIGHTS>200\n                   if(texture2D(fixedPointLightMap, ex_uv3).a==1.){\n                #else \n                  if(fixedPointLightVisibles[i]){ \n                #endif\n                    ex_uv2.x=ex_uv1.x;\n                    ex_fixed_posDecay=texture2D(fixedPointLightMap, ex_uv1);\n                    ex_fixed_colorDist=texture2D(fixedPointLightMap,ex_uv2);\n                    getExtPointDirectLightIrradiance( ex_fixed_posDecay,ex_fixed_colorDist, geometry, directLight );\n                    RE_Direct( directLight, geometry, material, reflectedLight );\n                }\n            }\n        #else\n            for ( int i = 0; i < NUM_STATIC_POINT_LIGHTS; i ++ ) {\n                if(fixedPointLightVisibles[i]){ \n                    ex_pointLight.position = fixedPointLightPositions[ i ];\n                    ex_pointLight.color = fixedPointLightColors[ i ];\n                    ex_pointLight.decayDist= fixedPointLightDecayDists[ i ];\n                    getExtPointDirectLightIrradiance( ex_pointLight, geometry, directLight );\n                    RE_Direct( directLight, geometry, material, reflectedLight );\n                }\n            }\n        #endif\n            \n\t#endif\n    \n    #if (NUM_PAITIAL_POINT_LIGHTS > 0) \n        #if defined(OES_texture_float_linear)&&  NUM_PAITIAL_POINT_LIGHTS>100\n            vec4 ex_partial_posDecay;\n            vec4 ex_partial_colorDist;\n            float ex_num=float(NUM_PAITIAL_POINT_LIGHTS);\n            for ( int i = 0; i < NUM_PAITIAL_POINT_LIGHTS; i ++ ) {\n                   ex_uv1.x=(float( i )+0.5)/ex_num;\n                   ex_uv3.x=ex_uv1.x; \n                #if NUM_PAITIAL_POINT_LIGHTS>200\n                  if(texture2D(partialPointLightMap, ex_uv3).a==1.){\n                #else \n                  if(partialPointLightVisibles[ i ]){ \n                #endif \n                    ex_uv2.x=ex_uv1.x;\n                    ex_partial_posDecay=texture2D(partialPointLightMap, ex_uv1);\n                    ex_partial_colorDist=texture2D(partialPointLightMap,ex_uv2);\n                    getExtPointDirectLightIrradiance( ex_partial_posDecay,ex_partial_colorDist, geometry, directLight );\n                    RE_Direct( directLight, geometry, material, reflectedLight );\n                }\n            }\n        #else\n            for ( int i = 0; i < NUM_PAITIAL_POINT_LIGHTS; i ++ ) {\n                if(partialPointLightVisibles[i]){ \n                    ex_pointLight.position = partialPointLightPositions[ i ];\n                    ex_pointLight.color = partialPointLightColors[ i ];\n                    ex_pointLight.decayDist= partialPointLightDecayDists[ i ];\n                    getExtPointDirectLightIrradiance( ex_pointLight, geometry, directLight );\n                    RE_Direct( directLight, geometry, material, reflectedLight );\n                }\n            }\n        #endif\n            \n    #endif\n     \n#endif\n"},{}],17:[function(e,t,r){"use strict";function n(){}var i=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var a=i(e("._29")),o=i(e("D_50"));n.getPixelDataType=function(e){return a.default.typesMap[e]},n.getPixelFormat=function(e){return a.default.formatsMap[e]},n.createTexture=function(e,t,r){var i=Cesium,a=i.Texture,s=(i.TextureMinificationFilter,i.TextureWrap,i.PixelFormat),u=(i.WebGLConstants,i.ContextLimits),l=Cesium.Math,c=e,f=c.sampler,d=9984===f.minificationFilter||9986===f.minificationFilter||9985===f.minificationFilter||9987===f.minificationFilter,h=d||10497===f.wrapS||33648===f.wrapS||10497===f.wrapT||33648===f.wrapT,p=c.source,m=c.width,v=c.height,g=p&&(!l.isPowerOfTwo(p.width)||!l.isPowerOfTwo(p.height));if(h&&g){var y=document.createElement("canvas");y.width=l.nextPowerOfTwo(p.width),y.height=l.nextPowerOfTwo(p.height);y.getContext("2d").drawImage(p,0,0,p.width,p.height,0,0,y.width,y.height),p=y,m=y.width,v=y.height}var _,b=c.internalFormat||c.format,M=s.isCompressedFormat(b),x=M?o.default:a,w=!1;if(r=r||u.maximumTextureSize,m>r&&(m=r,w=!0,console.warn("Mesh3D.TextureUtils:Width should be less than or equal to the maximum texture size ("+r+").  Check maximumTextureSize.")),v>r?(console.warn("Mesh3D.TextureUtils:Height should be less than or equal to the maximum texture size ("+r+").  Check maximumTextureSize."),v=r,w||(m=r*(m/v)),w=!0):w&&(v=r*(v/m)),w){console.warn("Mesh3D.TextureUtils:Width and height must be less than or equal to the maximum texture size ("+r+").  Check maximumTextureSize.");var y=n._resampleImage(p,m,v,d);p=y,m=y.width,v=y.height}return _=new x({context:t,source:p,width:m,height:v,pixelFormat:b,pixelDatatype:c.type,sampler:f,flipY:c.flipY,preMultiplyAlpha:c.preMultiplyAlpha}),d&&!M&&_.generateMipmap(),_},n.createCubeTexture=function(e,t){var r=e.value;return new Cesium.CubeMap({context:t,source:{positiveX:r[0],negativeX:r[1],positiveY:r[2],negativeY:r[3],positiveZ:r[4],negativeZ:r[5]},pixelFormat:e.format,pixelDatatype:e.type,preMultiplyAlpha:e.preMultiplyAlpha,flipY:e.flipY})},n.fromTexure3js=function(e,t){if(e.isTexture){var r={};r.minificationFilter=a.default.minFilterMap[e.minFilter],r.magnificationFilter=a.default.magFilterMap[e.magFilter],r.wrapS=a.default.textureWrapMap[e.wrapS],r.wrapT=a.default.textureWrapMap[e.wrapT],r.maximumAnisotropy=e.anisotropy,t||(t={uuid:e.uuid},t._disposeCallbacks=[],t.onDispose=function(e){-1==this._disposeCallbacks.indexOf(e)&&this._disposeCallbacks.push(e)},t.destroy=function(){for(var e=0;e<this._disposeCallbacks.length;e++){this._disposeCallbacks[e].call(this)}this._disposeCallbacks.splice(0)}),t.getCacheKey||(t.getCacheKey=function(){var e=this,t=e.uuid||"string"!=typeof e.value?e.uuid:e.value;return t||e.value.uuid&&(e._value instanceof HTMLImageElement||e.value instanceof HTMLCanvasElement||e.value instanceof HTMLVideoElement||e.value instanceof OffscreenCanvas)&&(t=e._value.uuid),t}),t.value=e.image;var n=t.version!=e.version,i=t.getCacheKey();n||t.cacheKey==i||(n=!0);var o=!1;if(e.isDataTexture)t.width=e.image.width,t.height=e.image.height,t.source={arrayBufferView:e.image.data,width:e.image.width,height:e.image.height},t.needsUpdate=!!e.image.data;else if(e.isCompressedTexture)if(e.image.width&&e.image.height){if(t.width=e.image.width,t.height=e.image.height,t.value={width:e.image.width,height:e.image.height,arrayBufferView:e.image.data},n&&e.mipmaps&&e.mipmaps.length>0){for(var s=[],u=1;u<e.mipmaps.length;u++)s.push(e.mipmaps[u].data);t.source={arrayBufferView:e.mipmaps[0].data,width:e.image.width,height:e.image.height,mipLevels:s}}}else{var l=e.image;if(Array.isArray(l)&&l.length>0&&l[0].width&&l[0].width){if(n){t.value=l,t.source=[],t.width=l[0].width,t.height=l[0].height;for(var c=0;c<l.length;c++){for(var f=l[c],d=[],h=1;h<f.mipmaps.length;h++)d.push(f.mipmaps[h].data);var p={arrayBufferView:f.mipmaps[0].data,width:f.width,height:f.height,mipLevels:d};t.source.push(p)}}}else t.value=null,t.source=null,o=!0}else if(e.isCanvasTexture||e.image instanceof ImageData)t.width=e.image.width,t.height=e.image.height,t.source=e.image;else if(Array.isArray(t.value)){var m=t.value,v=!1;m=m.map(function(e){if(e||(v=!0),e.isDataTexture){var t=e;return{width:t.image.width,height:t.image.height,arrayBufferView:t.image.data}}return e}),o=!m.length&&!v}else o=!0;return t.type=a.default.typesMap[e.type],t.format=a.default.formatsMap[e.format],t.sampler=r,t.flipY=e.flipY,t.preMultiplyAlpha=e.premultiplyAlpha,t.needsUpdate=!0,t.isEmptyTextureUniform=o||!t.value&&!t.source,t.version=e.version,t.cacheKey=i,t}return e},n.initTexture=function(e,t,r,i,a,o,s){var u=Cesium,l=(u.WebGLConstants,u.Sampler),c=!0,f=[];if(s=s||1024,t.traverse(function(e){if(e.material){var t=e.material,n=t.map;if(n){var i=n.image;if((i.width>=s||i.height>=s)&&(n.minFilter=1006),a&&!n.uuid.startsWith(a)&&(n.uuid=a+n.uuid),r[n.uuid]){var o=r[n.uuid];o.referenceCount=(o.referenceCount||0)+1}else f.push(n)}t.lightMap&&!r[t.lightMap.uuid]&&(t.lightMap.minFilter=1006,t.lightMap.__isLightMap=!0,f.push(t.lightMap))}}),f.length>0){var d={},h=f.shift();n.fromTexure3js(h,d);var p=d.value,m=6407;(p instanceof HTMLCanvasElement||p instanceof HTMLVideoElement||p.src&&p.src.toLocaleLowerCase().indexOf(".png")>=0)&&(m=6408);var v=d.sampler,g=n.createTexture({context:e.context,source:d.source||p,width:d.width||p.width,height:d.height||p.height,format:d.format||m,flipY:d.flipY,type:d.type,sampler:new l(v),preMultiplyAlpha:d.preMultiplyAlpha},e.context,h.__isLightMap?void 0:o);delete h.__isLightMap,r[h.uuid]=g,c=0==f.length,h.addEventListener("dispose",function(){g.referenceCount?g.referenceCount--:(g.isDestroyed&&g.isDestroyed()||g.destroy(),delete r[h.uuid])}),i&&i.push(h.uuid)}return c},n.clampToUV=function(e,t){var r=e.geometry,n=e.material,i=r.getAttribute("uv");if(i&&n.map&&n.map.image){for(var a=Number.MAX_VALUE,o=-Number.MAX_VALUE,s=Number.MAX_VALUE,u=-Number.MAX_VALUE,l=0;l<i.array.length;l+=2){var c=i.array[l],f=i.array[l+1];o=Math.max(o,c),a=Math.min(a,c),u=Math.max(u,f),s=Math.min(s,f)}var d=Cesium.Math,h=o-a,p=u-s;if((h<1||p<=1)&&a>=0&&d.lessThanOrEquals(o,1,d.EPSILON2)&&s>=0&&d.lessThanOrEquals(u,1,d.EPSILON2)){e=e.clone(),r=r.clone(),n=n.clone(),e.material=n,e.geometry=r,i=i.clone(),r.setAttribute("uv",i);for(var m=0;m<i.array.length;m+=2){var v=i.array[m],g=i.array[m+1];v=(v-a)/h,g=(g-s)/p,i.array[m]=v,i.array[m+1]=g}var y=n.map.clone(),_=y.image;y.wrapT=y.wrapS=1001,y.uuid=THREE.Math.generateUUID();var b=Math.ceil(h*_.width),M=Math.ceil(p*_.height),x=-Math.floor(a*_.width),w=-Math.floor(s*_.height);!t||d.isPowerOfTwo(b)&&d.isPowerOfTwo(M)||(b=d.nextPowerOfTwo(b),M=d.nextPowerOfTwo(M));var S=document.createElement("canvas");S.width=b,S.height=M;return S.getContext("2d").drawImage(_,x,w),S.src=_.src,y.image=S,n.map=y,e}}},n.resampleTexture=function(e,t,r){var n=e.image,i=e.minFilter;THREE;r||(r=1006!=i&&1003!=i);var a=this.resampleImage(n,t,r);return e.width=a.width,e.height=a.height,e.image=a,e},n.resampleImage=function(e,t,r){var n,i=Cesium.Math,a=e.width,o=e.height,s=parseInt(a*t),u=parseInt(o*t);if(1!=t)n=this._resampleImage(e,s,u,r);else{r&&(s=i.nextPowerOfTwo(s),u=i.nextPowerOfTwo(u)),n=document.createElement("canvas"),n.width=s,n.height=u;n.getContext("2d").drawImage(e,0,0,a,o,0,0,s,u)}return n},n._resampleImage=function(e,t,r,n){var i=Cesium.Math,a=e.width,o=e.height,s=t,u=r,l=document.createElement("canvas");n&&(s=i.nextPowerOfTwo(s),u=i.nextPowerOfTwo(u)),l.width=s,l.height=u;var c,f=l.getContext("2d"),d=e;e instanceof HTMLCanvasElement?c=d.getContext("2d"):(d=document.createElement("canvas"),d.width=a,d.height=o,c=d.getContext("2d"),c.drawImage(e,0,0));for(var h=c.getImageData(0,0,a,o),p=f.getImageData(0,0,s,u),m=0,v=a/s,g=o/u,y=0,_=0,b=0,M=0;M<u;M++)for(var x=0;x<s;x++){y=parseInt(M*g),_=parseInt(x*v),b=4*(y*a+_);for(var w=0;w<4;w++)p.data[m+w]=h.data[b+w];m+=4}return f.putImageData(p,0,0),l},n.copyFromCompressData=function(e,t){var r=(e._size,e._pixelFormat),n=e._pixelDatatype,i=(e._preMultiplyAlpha,e._flipY,e._gl||e._context._gl),a=e._textureTarget,o=e._texture,s="number"==typeof e._targetFace?e._targetFace:a,u=t.width,l=t.height,c=t.arrayBufferView;i.activeTexture(i.TEXTURE0),i.bindTexture(a,o);i.pixelStorei(i.UNPACK_ALIGNMENT,4),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,!1);var c=t.arrayBufferView,f=Cesium,d=f.PixelFormat,h=f.defined,p=d.isCompressedFormat(r);if(p?i.compressedTexImage2D(s,0,r,u,l,0,c):i.texImage2D(s,0,r,u,l,0,r,n,c),h(t.mipLevels))for(var m=u,v=l,g=0;g<t.mipLevels.length;++g)m=0|Math.floor(m/2),m<1&&(m=1),v=0|Math.floor(v/2),v<1&&(v=1),p?i.compressedTexImage2D(s,g+1,r,m,v,0,t.mipLevels[g]):i.texImage2D(s,g+1,r,m,v,0,r,n,t.mipLevels[g]);i.bindTexture(a,null)};var s=n;r.default=s},{"._29":12,D_50:13,M_0:241}],18:[function(e,t,r){"use strict";function n(e,t,r){function n(){if(void 0!==a)return a;var r=t.get("EXT_texture_filter_anisotropic");return a=null!==r?e.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}function i(t){if("highp"===t){if(e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var a,o="undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&e instanceof WebGL2ComputeRenderingContext,s=void 0!==r.precision?r.precision:"highp",u=i(s);u!==s&&(console.warn("Mesh3D.WebGLRenderer:",s,"not supported, using",u,"instead."),s=u);var l=!0===r.logarithmicDepthBuffer,c=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),f=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS),d=e.getParameter(e.MAX_TEXTURE_SIZE),h=e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),p=e.getParameter(e.MAX_VERTEX_ATTRIBS),m=e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),v=e.getParameter(e.MAX_VARYING_VECTORS),g=e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),y=f>0,_=o||!!t.get("OES_texture_float"),b=y&&_,M=o?e.getParameter(e.MAX_SAMPLES):0;return{gl:e,isWebGL2:o,getMaxAnisotropy:n,getMaxPrecision:i,precision:s,logarithmicDepthBuffer:l,maxTextures:c,maxVertexTextures:f,maxTextureSize:d,maxCubemapSize:h,maxAttributes:p,maxVertexUniforms:m,maxVaryings:v,maxFragmentUniforms:g,vertexTextures:y,floatFragmentTextures:_,floatVertexTextures:b,maxSamples:M}}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n;r.default=i},{}],19:[function(e,t,r){"use strict";function n(e,t){function r(){p.value!==u&&(p.value=u,p.needsUpdate=l>0),s.numPlanes=l,s.numIntersection=0}function n(e,t,r,n){var i=null!==e?e.length:0,a=null;if(0!==i){if(a=p.value,!0!==n||null===a){var o=r+4*i,u=t.matrixWorldInverse;h.getNormalMatrix(u),(null===a||a.length<o)&&(a=new Float32Array(o));for(var l=0,c=r;l!==i;++l,c+=4)d.copy(e[l]).applyMatrix4(u,h),d.normal.toArray(a,c),a[c+3]=d.constant}p.value=a,p.needsUpdate=!0}return s.numPlanes=i,s.numIntersection=0,a}var i=THREE,a=i.Matrix3,o=i.Plane,s=(i.Vector3,this),u=null,l=0,c=!1,f=!1,d=new o,h=new a,p={value:null,needsUpdate:!1};this.uniform=p,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t,r){var i=0!==e.length||t||0!==l||c;return c=t,u=n(e,r,0),l=e.length,i},this.beginShadows=function(){f=!0,n(null)},this.endShadows=function(){f=!1,r()},this.setState=function(t,i,a){var o=t.clippingPlanes,s=t.clipIntersection,d=t.clipShadows,h=e.get(t);if(!c||null===o||0===o.length||f&&!d)f?n(null):r();else{var m=f?0:l,v=4*m,g=h.clippingState||null;p.value=g,g=n(o,i,v,a);for(var y=0;y!==v;++y)g[y]=u[y];h.clippingState=g,this.numIntersection=s?this.numPlanes:0,this.numPlanes+=m}}}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n;r.default=i},{}],20:[function(e,t,r){"use strict";function n(e){function t(e,t){return t===u?e.mapping=o:t===l&&(e.mapping=s),e}function r(r){if(r&&r.isTexture){var i=r.mapping;if(i===u||i===l){if(f.has(r)){return t(f.get(r).texture,r.mapping)}var a=r.image;if(a&&a.height>0){var o=e.getRenderTarget(),s=e.renderState,d=e.autoConvertCamera,h=new c(a.height/2);return e.autoConvertCamera=!0,h.fromEquirectangularTexture(e,r),f.set(r,h),e.autoConvertCamera=d,e.setRenderTarget(o),e.renderState=s,r.addEventListener("dispose",n),t(h.texture,r.mapping)}return null}}return r}function n(e){var t=e.target;t.removeEventListener("dispose",n);var r=f.get(t);void 0!==r&&(f.delete(t),r.dispose())}function i(){f=new WeakMap}if("undefined"==typeof THREE)return{get:function(e){return e},dispose:function(){}};var a=THREE,o=301,s=302,u=303,l=304,c=a.WebGLCubeRenderTarget,f=new WeakMap;return{get:r,dispose:i}}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n;r.default=i},{}],21:[function(e,t,r){"use strict";function n(e){var t={};return{has:function(r){if(void 0!==t[r])return null!==t[r];var n;switch(r){case"WEBGL_depth_texture":n=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:n=e.getExtension(r)}return t[r]=n,null!==n},get:function(e){return this.has(e)||console.warn("Mesh3D.WebGLRenderer: "+e+" extension not supported."),t[e]}}}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n;r.default=i},{}],22:[function(e,t,r){"use strict";function n(){}function i(e){if(0===e.length)return-1/0;for(var t=e[0],r=1,n=e.length;r<n;++r)e[r]>t&&(t=e[r]);return t}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,n.getWireframeAttribute=function(){function e(e){function t(){r.delete(e),e.addEventListener("dispose",t)}var n=[],a=e.index,o=e.attributes.position,s=0;if(null!==a){var u=a.array;s=a.version;for(var l=0,c=u.length;l<c;l+=3){var f=u[l+0],d=u[l+1],h=u[l+2];n.push(f,d,d,h,h,f)}}else{var u=o.array;s=o.version;for(var l=0,c=u.length/3-1;l<c;l+=3){var f=l+0,d=l+1,h=l+2;n.push(f,d,d,h,h,f)}}var p=THREE,m=p.Uint32BufferAttribute,v=p.Uint16BufferAttribute,g=new(i(n)>65535?m:v)(n,1);g.version=s;var y=r.get(e);y&&y.onGeometryDispose(),g.onGeometryDispose=t,e.addEventListener("dispose",t),r.set(e,g)}function t(t){var n=r.get(t);if(n){var i=t.index;null!==i&&n.version<i.version&&e(t)}else e(t);return r.get(t)}var r=new WeakMap;return t}(),n.get=function(){function e(e,r){var n;if(e.isBufferGeometry||e instanceof Cesium.Geometry)n=e;else if(!(n=t.get(e))){var i=function r(){n.dispose(),t.delete(e),n.removeEventListener("dispose",r)};n=new THREE.BufferGeometry,n.fromGeometry(e),n.addEventListener("dispose",i),t.set(e,n)}var a=Cesium.BoundingSphere;if(!n.boundingSphere)if(n.computeBoundingSphere)n.computeBoundingSphere();else{var o=n.attributes.position;e.boundingSphere=a.fromVertices(o.values||o.array)}n.boundingVolume||(n.boundingVolume=a.clone(n.boundingSphere));var s=n.groups;if(s&&s.length>0&&!n.groupsOptimized){var u=[],l={},c=[];s.forEach(function(e,t){var r=e.materialIndex;l[r]||(c.push(r),u.push({materialIndex:r,groupIndex:t}),l[r]=!0)}),n.groupsOptimized=u,n.materialIndicesUsed=c}return n}var t=new WeakMap;return e}();var a=n;r.default=a},{}],23:[function(e,t,r){"use strict";function n(){function e(e,r,i,a){for(var l=0,d=0,g=0,x=0;x<9;x++)v.probe[x].set(0,0,0);var w=0,S=0,T=0,C=0,E=0,A=0,L=0,P=0,O=i.viewMatrix;e.sort(o),m.point.positions.length=0,m.point.colors.length=m.point.decalDists.length=0;for(var x=0,R=e.length;x<R;x++){var I=e[x],D=I.color,B=I.intensity,U=I.distance,N=I.shadow&&I.shadow.map?I.shadow.map.texture:null;if(I.isAmbientLight)l+=D.red*B,d+=D.green*B,g+=D.blue*B;else if(I.isLightProbe)for(var k=0;k<9;k++)v.probe[k].x=I.sh.coefficients[k].x*B,v.probe[k].y=I.sh.coefficients[k].y*B,v.probe[k].z=I.sh.coefficients[k].z*B;else if(I.isDirectionalLight){var j=h.get(I);if(f.multiplyByScalar(D,B,j.color),n.getTranslation(I.modelMatrix,j.direction),n.getTranslation(I.target.modelMatrix,y),c.subtract(j.direction,y,j.direction),s(j.direction,O),j.shadow=I.castShadow,I.castShadow){var G=I.shadow,V=p.get(I);V.shadowBias=G.bias,V.shadowNormalBias=G.normalBias,V.shadowRadius=G.radius,V.shadowMapSize=G.mapSize,v.directionalShadow[w]=V,v.directionalShadowMap[w]=N;var F=I.shadow.matrix;v.directionalShadowMatrix[w]=n.clone(F.elements||F,v.directionalShadowMatrix[w]),A++}v.directional[w]=j,w++}else if(I.isSpotLight){var j=h.get(I);if(n.getTranslation(I.modelMatrix,j.position),n.multiplyByPoint(O,j.position,j.position),f.multiplyByScalar(D,B,j.color),j.distance=U,n.getTranslation(I.modelMatrix,j.direction),n.getTranslation(I.target.modelMatrix,y),c.subtract(j.direction,y,j.direction),s(j.direction,O),j.coneCos=Math.cos(I.angle),j.penumbraCos=Math.cos(I.angle*(1-I.penumbra)),j.decay=I.decay,j.shadow=I.castShadow,I.castShadow){var z=I.shadow,H=p.get(I);H.shadowBias=z.bias,H.shadowNormalBias=z.normalBias,H.shadowRadius=z.radius,H.shadowMapSize=z.mapSize,v.spotShadow[T]=H,v.spotShadowMap[T]=N;var W=I.shadow.matrix;v.spotShadowMatrix[T]=n.clone(W.elements||W,v.spotShadowMatrix[T]),P++}v.spot[T]=j,T++}else if(I.isRectAreaLight){var j=h.get(I);f.multiplyByScalar(D,B,j.color),n.getTranslation(I.modelMatrix,j.position),n.multiplyByPoint(O,j.position,j.position),n.IDENTITY.clone(b),n.clone(I.modelMatrix,_),n.multiply(O,_,_),n.multiplyByMatrix3(b,n.getMatrix3(_,M),b),c.fromElements(.5*I.width,0,0,j.halfWidth),c.fromElements(0,.5*I.height,0,j.halfHeight),n.multiplyByPoint(b,j.halfWidth,j.halfWidth),n.multiplyByPoint(b,j.halfHeight,j.halfHeight),v.rectArea[C]=j,C++}else if(I.isPointLight){var j=h.get(I);n.getTranslation(I.modelMatrix,j.position),n.multiplyByPoint(O,j.position,j.position),f.multiplyByScalar(D,B,j.color),j.distance=I.distance,j.decay=I.decay,j.shadow=I.castShadow,j.visible=I._exVisible?1:0;var Y=m.point;if(Y.positions[S]=j.position,Y.colors[S]=j.color,Y.decalDists[S]=j.decalDist,j.decalDist.x=I.decay,j.decalDist.y=I.distance,Y.visibles[S]=j.visible,I.castShadow){var X=I.shadow,q=p.get(I);q.shadowBias=X.bias,q.shadowNormalBias=X.normalBias,q.shadowRadius=X.radius,q.shadowMapSize.copy(X.mapSize),q.shadowCameraNear=X.camera.near,q.shadowCameraFar=X.camera.far,v.pointShadow[S]=q,v.pointShadowMap[S]=N;var K=I.shadow.matrix;v.pointShadowMatrix[S]=n.clone(K.elements||K,v.pointShadowMatrix[S]),L++}v.point[S]=j,S++}else if(I.isHemisphereLight){var j=h.get(I);n.getTranslation(I.modelMatrix,j.direction),s(j.direction,O),c.normalize(j.direction,j.direction),f.multiplyByScalar(D,B,j.skyColor),f.multiplyByScalar(I.groundColor,B,j.groundColor),v.hemi[E]=j,E++}}v.ambient.red=l,v.ambient.green=d,v.ambient.blue=g;var Z=v.hash;Z.directionalLength===w&&Z.pointLength===S&&Z.spotLength===T&&Z.rectAreaLength===C&&Z.hemiLength===E&&Z.numDirectionalShadows===A&&Z.numPointShadows===L&&Z.numSpotShadows===P||(v.directional.length=w,v.spot.length=T,v.rectArea.length=C,v.point.length=S,v.hemi.length=E,v.directionalShadowMap.length=A,v.pointShadowMap.length=L,v.spotShadowMap.length=P,v.directionalShadowMatrix.length=A,v.pointShadowMatrix.length=L,v.spotShadowMatrix.length=P,Z.directionalLength=w,Z.pointLength=S,Z.spotLength=T,Z.rectAreaLength=C,Z.hemiLength=E,Z.numDirectionalShadows=A,Z.numPointShadows=L,Z.numSpotShadows=P,v.version=u++),t(a),t(a)}function t(e){var t=m.point,r=t.map,n=t.array,i=v.hash.pointLength;if(e&&i){if(!r||t.length!=i){r&&!r.isDestroyed&&r.destroy(),t.length=i;var a=e.context,o=Cesium;r=new d({context:a,width:2*i,height:6,pixelDatatype:5126,pixelFormat:6408,sampler:new o.Sampler({wrapS:33071,wrapT:33071,magnificationFilter:9729,minificationFilter:9729})}),t.map=r,n=new Float32Array(r.width*r.height*4),t.array=n}i*=2;for(var s=0;s<i;s+=2){for(var u=t.positions[s/2],l=t.decalDists[s/2],c=t.colors[s/2],f=t.visibles[s/2],h=0;h<2;h++)for(var p=0;p<2;p++){var g=4*(i*h+s+p);n[g]=u.x,n[g+1]=u.y,n[g+2]=u.z,n[g+3]=l.x}for(var y=2;y<4;y++)for(var _=0;_<2;_++){var g=4*(i*y+s+_);n[g]=c.red,n[g+1]=c.green,n[g+2]=c.blue,n[g+3]=l.y}for(var b=4;b<6;b++)for(var M=0;M<2;M++){var g=4*(i*b+s+M);n[g]=f,n[g+1]=f,n[g+2]=f,n[g+3]=f}}r.copyFrom({width:r.width,height:r.height,arrayBufferView:n})}}for(var r=Cesium,n=r.Matrix4,l=r.Matrix3,c=r.Cartesian3,f=r.Color,d=r.Texture,h=(r.PixelDatatype,r.PixelFormat,new i),p=new a,m={point:{positions:[],colors:[],decalDists:[],visibles:[],map:null,array:null}},v={
version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:new f(0,0,0,1),probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},g=0;g<9;g++)v.probe.push(new c);var y=new c,_=new n,b=new n,M=new l;this.setup=e,this.state=v,this.uniforms={ambientLightColor:{value:v.ambient},directionalLights:{value:v.directional},spotLights:{value:v.spot},rectAreaLights:{value:v.rectArea},pointLights:{value:v.point},hemisphereLights:{value:v.hemi},directionalShadowMap:{value:v.directionalShadowMap},directionalShadowMatrix:{value:v.directionalShadowMatrix},spotShadowMap:{value:v.spotShadowMap},spotShadowMatrix:{value:v.spotShadowMatrix},pointShadowMap:{value:v.pointShadowMap},pointShadowMatrix:{value:v.pointShadowMatrix},lightProbe:{value:v.probe}},this.extensionState=m}function i(){var e={},t=Cesium,r=t.Cartesian2,n=t.Cartesian3,i=t.Color;return{get:function(t){if(void 0!==e[t.id])return e[t.id];var a;switch(t.type){case"DirectionalLight":a={direction:new n,color:new i,shadow:!1};break;case"SpotLight":a={position:new n,direction:new n,color:new i,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1};break;case"PointLight":a={position:new n,color:new i,distance:0,decay:0,shadow:!1,decalDist:new r,visible:1};break;case"HemisphereLight":a={direction:new n,skyColor:new i,groundColor:new i};break;case"RectAreaLight":a={color:new i,position:new n,halfWidth:new n,halfHeight:new n}}return e[t.id]=a,a}}}function a(){var e={},t=Cesium,r=(t.Cartesian3,t.Color,t.Cartesian2);return{get:function(t){if(void 0!==e[t.id])return e[t.id];var n;switch(t.type){case"DirectionalLight":case"SpotLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new r};break;case"PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new r,shadowCameraNear:1,shadowCameraFar:1e3}}return e[t.id]=n,n}}}function o(e,t){return(t.castShadow?1:0)-(e.castShadow?1:0)}function s(e,t){var r=e.x,n=e.y,i=e.z,a=t;return e.x=a[0]*r+a[4]*n+a[8]*i,e.y=a[1]*r+a[5]*n+a[9]*i,e.z=a[2]*r+a[6]*n+a[10]*i,Cesium.Cartesian3.normalize(e,e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var u=0,l=n;r.default=l},{}],24:[function(e,t,r){"use strict";function n(e){function t(e,t){e.fogColor.value.copy(t.color),t.isFog?(e.fogNear.value=t.near,e.fogFar.value=t.far):t.isFogExp2&&(e.fogDensity.value=t.density)}function r(e,t,r,g){t.isMeshBasicMaterial?n(e,t):t.isMeshLambertMaterial?(n(e,t),u(e,t)):t.isMeshToonMaterial?(n(e,t),c(e,t)):t.isMeshPhongMaterial?(n(e,t),l(e,t)):t.isMeshStandardMaterial?(n(e,t),t.isMeshPhysicalMaterial?d(e,t):f(e,t)):t.isMeshMatcapMaterial?(n(e,t),h(e,t)):t.isMeshDepthMaterial?(n(e,t),p(e,t)):t.isMeshDistanceMaterial?(n(e,t),m(e,t)):t.isMeshNormalMaterial?(n(e,t),v(e,t)):t.isLineBasicMaterial?(i(e,t),t.isLineDashedMaterial&&a(e,t)):t.isPointsMaterial?o(e,t,r,g):t.isSpriteMaterial?s(e,t):t.isShadowMaterial?(e.color.value.copy(t.color),e.opacity.value=t.opacity):t.isShaderMaterial&&(t.uniformsNeedUpdate=!1)}function n(t,r){t.opacity.value=r.opacity,r.color&&t.diffuse.value.copy(r.color),r.emissive&&t.emissive.value.copy(r.emissive).multiplyScalar(r.emissiveIntensity),r.map&&(t.map.value=r.map),r.alphaMap&&(t.alphaMap.value=r.alphaMap),r.specularMap&&(t.specularMap.value=r.specularMap);var n=e.get(r).envMap;if(n){t.envMap.value=n,t.flipEnvMap.value=n.isCubeTexture&&n._needsFlipEnvMap?-1:1,t.reflectivity.value=r.reflectivity,t.refractionRatio.value=r.refractionRatio;var i=e.get(n).__maxMipLevel;void 0!==i&&(t.maxMipLevel.value=i)}r.lightMap&&(t.lightMap.value=r.lightMap,t.lightMapIntensity.value=r.lightMapIntensity),r.aoMap&&(t.aoMap.value=r.aoMap,t.aoMapIntensity.value=r.aoMapIntensity);var a;r.map?a=r.map:r.specularMap?a=r.specularMap:r.displacementMap?a=r.displacementMap:r.normalMap?a=r.normalMap:r.bumpMap?a=r.bumpMap:r.roughnessMap?a=r.roughnessMap:r.metalnessMap?a=r.metalnessMap:r.alphaMap?a=r.alphaMap:r.emissiveMap?a=r.emissiveMap:r.clearcoatMap?a=r.clearcoatMap:r.clearcoatNormalMap?a=r.clearcoatNormalMap:r.clearcoatRoughnessMap&&(a=r.clearcoatRoughnessMap),void 0!==a&&(a.isWebGLRenderTarget&&(a=a.texture),!0===a.matrixAutoUpdate&&a.updateMatrix(),t.uvTransform.value.copy(a.matrix));var o;r.aoMap?o=r.aoMap:r.lightMap&&(o=r.lightMap),void 0!==o&&(o.isWebGLRenderTarget&&(o=o.texture),!0===o.matrixAutoUpdate&&o.updateMatrix(),t.uv2Transform.value.copy(o.matrix))}function i(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity}function a(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}function o(e,t,r,n){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*r,e.scale.value=.5*n,t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap);var i;t.map?i=t.map:t.alphaMap&&(i=t.alphaMap),void 0!==i&&(!0===i.matrixAutoUpdate&&i.updateMatrix(),e.uvTransform.value.copy(i.matrix))}function s(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap);var r;t.map?r=t.map:t.alphaMap&&(r=t.alphaMap),void 0!==r&&(!0===r.matrixAutoUpdate&&r.updateMatrix(),e.uvTransform.value.copy(r.matrix))}function u(e,t){t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap)}function l(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===g&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===g&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}function c(e,t){t.gradientMap&&(e.gradientMap.value=t.gradientMap),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===g&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===g&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}function f(t,r){t.roughness.value=r.roughness,t.metalness.value=r.metalness,r.roughnessMap&&(t.roughnessMap.value=r.roughnessMap),r.metalnessMap&&(t.metalnessMap.value=r.metalnessMap),r.emissiveMap&&(t.emissiveMap.value=r.emissiveMap),r.bumpMap&&(t.bumpMap.value=r.bumpMap,t.bumpScale.value=r.bumpScale,r.side===g&&(t.bumpScale.value*=-1)),r.normalMap&&(t.normalMap.value=r.normalMap,t.normalScale.value.copy(r.normalScale),r.side===g&&t.normalScale.value.negate()),r.displacementMap&&(t.displacementMap.value=r.displacementMap,t.displacementScale.value=r.displacementScale,t.displacementBias.value=r.displacementBias),e.get(r).envMap&&(t.envMapIntensity.value=r.envMapIntensity)}function d(e,t){f(e,t),e.reflectivity.value=t.reflectivity,e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.sheen&&e.sheen.value.copy(t.sheen),t.clearcoatMap&&(e.clearcoatMap.value=t.clearcoatMap),t.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap.value=t.clearcoatRoughnessMap),t.clearcoatNormalMap&&(e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),e.clearcoatNormalMap.value=t.clearcoatNormalMap,t.side===g&&e.clearcoatNormalScale.value.negate()),e.transmission.value=t.transmission,t.transmissionMap&&(e.transmissionMap.value=t.transmissionMap)}function h(e,t){t.matcap&&(e.matcap.value=t.matcap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===g&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===g&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}function p(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}function m(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias),e.referencePosition.value.copy(t.referencePosition),e.nearDistance.value=t.nearDistance,e.farDistance.value=t.farDistance}function v(e,t){t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===g&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===g&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}if("undefined"==typeof THREE)return{refreshFogUniforms:function(){},refreshMaterialUniforms:function(){}};var g=(THREE,1);return{refreshFogUniforms:t,refreshMaterialUniforms:r}}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n;r.default=i},{}],25:[function(e,t,r){"use strict";function n(e,t){return e[0]-t[0]}function i(e,t){return Math.abs(t[1])-Math.abs(e[1])}function a(e,t){function r(e,t,r,o){t=s.default.get(t);var l=u(e),c=l.morphTargetInfluences,h=e.morphTargetInfluences,p=void 0===h?0:h.length,m=f[t.id];if(void 0===m){m=[];for(var v=0;v<p;v++)m[v]=[v,0];f[t.id]=m}for(var g=0;g<p;g++){var y=m[g];y[0]=g,y[1]=h[g]}m.sort(i);for(var _=0;_<8;_++)_<p&&m[_][1]?(d[_][0]=m[_][0],d[_][1]=m[_][1]):(d[_][0]=Number.MAX_SAFE_INTEGER,d[_][1]=0);d.sort(n);for(var b=r.morphTargets&&t.morphAttributes.position,M=r.morphNormals&&t.morphAttributes.normal,x=0,w=0;w<8;w++){var S=d[w],T=S[0],C=S[1];T!==Number.MAX_SAFE_INTEGER&&C?(b&&t.getAttribute("morphTarget"+w)!==b[T]&&(b[T].id=T,t.setAttribute("morphTarget"+w,b[T])),M&&t.getAttribute("morphNormal"+w)!==M[T]&&t.setAttribute("morphNormal"+w,M[T]),c[w]=C,x+=C):(b&&void 0!==t.getAttribute("morphTarget"+w)&&t.deleteAttribute("morphTarget"+w),M&&void 0!==t.getAttribute("morphNormal"+w)&&t.deleteAttribute("morphNormal"+w),c[w]=0)}var E=t.morphTargetsRelative?1:1-x;l.morphTargetBaseInfluence=E,l.morphTargetInfluences=c,a(l,t)}function a(e,t){var r=m.get(e),n=t.attributes;for(var i in n)!function(e){var t=n[e];(e.includes("morphTarget")||e.includes("morphNormal"))&&r.forEach(function(r){c.updateVerexBuffer(r,e,t)})}(i)}function o(e,t){var r=m.get(e);r||(r=[],m.set(e,r)),r.includes(t)||(r.push(t),t.geometry.addEventListener("dispose",function(){var e=r.indexOf(t);e>=0&&r.splice(e,1)}))}function u(e){var t=p.get(e);return t||(t={morphTargetBaseInfluence:1,morphTargetInfluences:new Float32Array(8)},e.geometry.addEventListener("dispose",function(){p.delete(e)}),p.set(e,t),o(t,e)),t}function l(e,t){if(t&&e){if(p.get(e)==t)return;e.geometry.addEventListener("dispose",function(){p.delete(e)}),p.set(e,t),o(t,e)}}for(var c=t._cesiumVertextArrays,f={},d=[],h=0;h<8;h++)d[h]=[h,0];var p=new WeakMap,m=new WeakMap;return{setUniforms:l,getUniforms:u,update:r}}var o=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=o(e("e_23")),u=(o(e("3_27")),a);r.default=u},{e_23:22,"3_27":35,M_0:241}],26:[function(e,t,r){"use strict";function n(e){if(!$){$=!0;var t=THREE;S=t.ShaderChunk,T=0,C=2,E=1,A=0,L=304,P=302,O=303,R=307,I=306,D=301,B=2,U=1,N=3,k=4,j=3,G=5,V=2,F=1,z=3007,H=3006,W=3005,Y=3004,X=3002,q=3001,K=3e3,Z=3003,J=THREE.GLSL3}}function i(e){switch(e){case K:return["Linear","( value )"];case q:return["sRGB","( value )"];case X:return["RGBE","( value )"];case Y:return["RGBM","( value, 7.0 )"];case W:return["RGBM","( value, 16.0 )"];case H:return["RGBD","( value, 256.0 )"];case z:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case Z:return["LogLuv","( value )"];default:return console.warn("Mesh3D.WebGLProgram: Unsupported encoding:",e),["Linear","( value )"]}}function a(e,t){var r=i(t);return"vec4 "+e+"( vec4 value ) { return "+r[0]+"ToLinear"+r[1]+"; }"}function o(e,t){var r=i(t);return"vec4 "+e+"( vec4 value ) { return LinearTo"+r[0]+r[1]+"; }"}function s(e,t){var r;switch(t){case F:r="Linear";break;case V:r="Reinhard";break;case j:r="OptimizedCineon";break;case k:r="ACESFilmic";break;case G:r="Custom";break;default:console.warn("Mesh3D.WebGLProgram: Unsupported toneMapping:",t),r="Linear"}return"vec3 "+e+"( vec3 color ) { return "+r+"ToneMapping( color ); }"}function u(e){return[e.extensionDerivatives||e.envMapCubeUV||e.bumpMap||e.tangentSpaceNormalMap||e.clearcoatNormalMap||e.flatShading||"physical"===e.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(c).join("\n")}function l(e){var t=[];for(var r in e){var n=e[r];!1!==n&&t.push("#define "+r+" "+n)}return t.join("\n")}function c(e){return""!==e}function f(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function d(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}function h(e){return e.replace(ee,p)}function p(e,t){var r;if(void 0===(r=S[t]))throw new Error("Can not resolve #include <"+t+">");return h(r)}function m(e){return e.replace(re,g).replace(te,v)}function v(e,t,r,n){return console.warn("Mesh3D.WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),g(e,t,r,n)}function g(e,t,r,n){for(var i="",a=parseInt(t);a<parseInt(r);a++)i+=n.replace(/\[\s*i\s*\]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a).replace(/\(\s*i\s*\)/g," "+a+" ");return i}function y(e){var t="precision "+e.precision+" float;\nprecision "+e.precision+" int;";return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function _(e){var t="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===U?t="SHADOWMAP_TYPE_PCF":e.shadowMapType===B?t="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===N&&(t="SHADOWMAP_TYPE_VSM"),t}function b(e){var t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case D:case P:t="ENVMAP_TYPE_CUBE";break;case I:case R:t="ENVMAP_TYPE_CUBE_UV"}return t}function M(e){var t="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case P:case R:t="ENVMAP_MODE_REFRACTION"}return t}function x(e){var t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case A:t="ENVMAP_BLENDING_MULTIPLY";break;case E:t="ENVMAP_BLENDING_MIX";break;case C:t="ENVMAP_BLENDING_ADD"}return t}function w(e,t,r){n();var i,p,v=r.defines,g=r.vertexShader,w=r.fragmentShader,C=_(r),E=b(r),A=M(r),L=x(r),P=e.gammaFactor>0?e.gammaFactor:1,O=r.isWebGL2?"":u(r),R=l(v),I=r.glslVersion?"#version "+r.glslVersion+"\n":"";r.isRawShaderMaterial?(i=[R].filter(c).join("\n"),i.length>0&&(i+="\n"),p=[O,R].filter(c).join("\n"),p.length>0&&(p+="\n")):(i=[y(r),"#define SHADER_NAME "+r.shaderName,R,r.instancing?"#define USE_INSTANCING":"",r.instancingColor?"#define USE_INSTANCING_COLOR":"",r.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+P,"#define MAX_BONES "+r.maxBones,r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+A:"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMap&&r.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",r.normalMap&&r.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.displacementMap&&r.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.vertexTangents?"#define USE_TANGENT":"",r.vertexColors?"#define USE_COLOR":"",r.vertexUvs?"#define USE_UV":"",r.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",r.flatShading?"#define FLAT_SHADED":"",r.skinning?"#define USE_SKINNING":"",r.useVertexTexture?"#define BONE_TEXTURE":"",r.morphTargets?"#define USE_MORPHTARGETS":"",r.morphNormals&&!1===r.flatShading?"#define USE_MORPHNORMALS":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+C:"",r.sizeAttenuation?"#define USE_SIZEATTENUATION":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&r.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(c).join("\n"),p=[O,y(r),"#define SHADER_NAME "+r.shaderName,R,r.alphaTest?"#define ALPHATEST "+r.alphaTest+(r.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+P,r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.matcap?"#define USE_MATCAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+E:"",r.envMap?"#define "+A:"",r.envMap?"#define "+L:"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMap&&r.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",r.normalMap&&r.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.sheen?"#define USE_SHEEN":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.vertexTangents?"#define USE_TANGENT":"",r.vertexColors||r.instancingColor?"#define USE_COLOR":"",r.vertexUvs?"#define USE_UV":"",r.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",r.gradientMap?"#define USE_GRADIENTMAP":"",r.flatShading?"#define FLAT_SHADED":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+C:"",r.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",r.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&r.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(r.extensionShaderTextureLOD||r.envMap)&&r.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",r.toneMapping!==T?"#define TONE_MAPPING":"",r.toneMapping!==T?S.tonemapping_pars_fragment:"",r.toneMapping!==T?s("toneMapping",r.toneMapping):"",r.dithering?"#define DITHERING":"",S.encodings_pars_fragment,r.map?a("mapTexelToLinear",r.mapEncoding):"",r.matcap?a("matcapTexelToLinear",r.matcapEncoding):"",r.envMap?a("envMapTexelToLinear",r.envMapEncoding):"",r.emissiveMap?a("emissiveMapTexelToLinear",r.emissiveMapEncoding):"",r.lightMap?a("lightMapTexelToLinear",r.lightMapEncoding):"",o("linearToOutputTexel",r.outputEncoding),r.depthPacking?"#define DEPTH_PACKING "+r.depthPacking:"","\n"].filter(c).join("\n")),g=h(g),g=f(g,r),g=d(g,r),w=h(w),w=f(w,r),w=d(w,r),g=m(g),w=m(w),r.isWebGL2&&!0!==r.isRawShaderMaterial&&(I="#version 300 es\n",i=["#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+i,p=["#define varying in",r.glslVersion===J?"":"out highp vec4 pc_fragColor;",r.glslVersion===J?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+p);var D=I+i+g,B=I+p+w;return this.name=r.shaderName,this.id=Q++,this.cacheKey=t,this.usedTimes=1,this.vertexShader=D,this.fragmentShader=B,this}Object.defineProperty(r,"__esModule",{value:!0}),r.unrollLoops=m,r.default=void 0;var S,T,C,E,A,L,P,O,R,I,D,B,U,N,k,j,G,V,F,z,H,W,Y,X,q,K,Z,J,Q=0,$=!1,ee=/^[ \t]*#include +<([\w\d./]+)>/gm,te=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,re=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g,ne=w;r.default=ne},{}],27:[function(e,t,r){"use strict";function n(e,t,r,n,i){function o(e){var t=e.skeleton,r=t.bones;if(E)return 1024;var n=A,i=Math.floor((n-20)/4),a=Math.min(i,r.length);return a<r.length?(console.warn("Mesh3D.WebGLRenderer: Skeleton has "+r.length+" bones. This GPU supports "+a+"."),0):a}function s(e){var t;return e?e.isTexture?t=e.encoding:e.isWebGLRenderTarget&&(console.warn("Mesh3D.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),t=e.texture.encoding):t=b,t}function u(a,u,l,c,f){var d=c.fog,h=a.isMeshStandardMaterial?c.environment:null,m=t.get(a.envMap||h),b=O[a.type],S=f.isSkinnedMesh?o(f):0;null!==a.precision&&(P=n.getMaxPrecision(a.precision))!==a.precision&&console.warn("Mesh3D.WebGLProgram.getParameters:",a.precision,"not supported, using",P,"instead.");var A,R;if(b){var I=p[b];A=I.vertexShader,R=I.fragmentShader}else A=a.vertexShader,R=a.fragmentShader;var D=e.getRenderTarget();return{isWebGL2:T,shaderID:b,shaderName:a.type,vertexShader:A,fragmentShader:R,defines:a.defines,isRawShaderMaterial:!0===a.isRawShaderMaterial,glslVersion:a.glslVersion,precision:P,instancing:!0===f.isInstancedMesh,instancingColor:!0===f.isInstancedMesh&&null!==f.instanceColor,supportsVertexTextures:L,outputEncoding:null!==D?s(D.texture):e.outputEncoding,map:!!a.map,mapEncoding:s(a.map),matcap:!!a.matcap,matcapEncoding:s(a.matcap),envMap:!!m,envMapMode:m&&m.mapping,envMapEncoding:s(m),envMapCubeUV:!!m&&(m.mapping===_||m.mapping===y),lightMap:!!a.lightMap,lightMapEncoding:s(a.lightMap),aoMap:!!a.aoMap,emissiveMap:!!a.emissiveMap,emissiveMapEncoding:s(a.emissiveMap),bumpMap:!!a.bumpMap,normalMap:!!a.normalMap,objectSpaceNormalMap:a.normalMapType===M,tangentSpaceNormalMap:a.normalMapType===x,clearcoatMap:!!a.clearcoatMap,clearcoatRoughnessMap:!!a.clearcoatRoughnessMap,clearcoatNormalMap:!!a.clearcoatNormalMap,displacementMap:!!a.displacementMap,roughnessMap:!!a.roughnessMap,metalnessMap:!!a.metalnessMap,specularMap:!!a.specularMap,alphaMap:!!a.alphaMap,gradientMap:!!a.gradientMap,sheen:!!a.sheen,transmissionMap:!!a.transmissionMap,combine:a.combine,vertexTangents:a.normalMap&&a.vertexTangents,vertexColors:a.vertexColors,vertexUvs:!!(a.map||a.bumpMap||a.normalMap||a.specularMap||a.alphaMap||a.emissiveMap||a.roughnessMap||a.metalnessMap||a.clearcoatMap||a.clearcoatRoughnessMap||a.clearcoatNormalMap||a.displacementMap||a.transmissionMap),uvsVertexOnly:!(a.map||a.bumpMap||a.normalMap||a.specularMap||a.alphaMap||a.emissiveMap||a.roughnessMap||a.metalnessMap||a.clearcoatNormalMap||a.transmissionMap||!a.displacementMap),fog:!!d,useFog:a.fog,fogExp2:d&&d.isFogExp2,flatShading:a.flatShading,sizeAttenuation:a.sizeAttenuation,logarithmicDepthBuffer:C,skinning:(a.skinning||f.isSkinnedMesh)&&S>0,maxBones:S,useVertexTexture:E,morphTargets:a.morphTargets,morphNormals:a.morphNormals,maxMorphTargets:e.maxMorphTargets,maxMorphNormals:e.maxMorphNormals,numDirLights:u.directional.length,numPointLights:u.point.length,numSpotLights:u.spot.length,numRectAreaLights:u.rectArea.length,numHemiLights:u.hemi.length,numDirLightShadows:u.directionalShadowMap.length,numPointLightShadows:u.pointShadowMap.length,numSpotLightShadows:u.spotShadowMap.length,numClippingPlanes:i.numPlanes,numClipIntersection:i.numIntersection,dithering:a.dithering,shadowMapEnabled:e.shadowMap.enabled&&l.length>0,shadowMapType:e.shadowMap.type,toneMapping:a.toneMapped?e.toneMapping:w,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:a.premultipliedAlpha,alphaTest:a.alphaTest,doubleSided:a.side===g,flipSided:a.side===v,depthPacking:void 0!==a.depthPacking&&a.depthPacking,index0AttributeName:a.index0AttributeName,extensionDerivatives:a.extensions&&a.extensions.derivatives,extensionFragDepth:a.extensions&&a.extensions.fragDepth,extensionDrawBuffers:a.extensions&&a.extensions.drawBuffers,extensionShaderTextureLOD:a.extensions&&a.extensions.shaderTextureLOD,rendererExtensionFragDepth:T||r.has("EXT_frag_depth"),rendererExtensionDrawBuffers:T||r.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:T||r.has("EXT_shader_texture_lod"),customProgramCacheKey:a.customProgramCacheKey()}}function l(t){var r=[];if(t.shaderID?r.push(t.shaderID):(r.push(t.fragmentShader),r.push(t.vertexShader)),void 0!==t.defines)for(var n in t.defines)r.push(n),r.push(t.defines[n]);if(!1===t.isRawShaderMaterial){for(var i=0;i<R.length;i++)r.push(t[R[i]]);r.push(e.outputEncoding),r.push(e.gammaFactor)}return r.push(t.customProgramCacheKey),r.join()}function c(e){var t,r=O[e.type];if(r){var n=p[r];t=m.clone(n.uniforms)}else t=e.uniforms;return t}function f(t,r){return new a.default(e,r,t)}function d(e){if(0==--e.usedTimes){var t=S.indexOf(e);S[t]=S[S.length-1],S.pop()}}var h=THREE,p=h.ShaderLib,m=h.UniformsUtils,v=1,g=2,y=307,_=306,b=3e3,M=1,x=0,w=0,S=[],T=n.isWebGL2,C=n.logarithmicDepthBuffer,E=n.floatVertexTextures,A=n.maxVertexUniforms,L=n.vertexTextures,P=n.precision,O={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},R=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen","transmissionMap"];return{getParameters:u,getProgramCacheKey:l,getUniforms:c,acquireProgram:f,releaseProgram:d,programs:S}}var i=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var a=i(e("s_35")),o=n;r.default=o},{s_35:26,M_0:241}],28:[function(e,t,r){"use strict";function n(){function e(e,t){var r=n.get(e);if(void 0===r){var i=function t(){n.delete(e),e.removeEventListener("dispose",t)};r=t||{},n.set(e,r),e.addEventListener("dispose",i)}return r}function t(e){n.delete(e)}function r(e,t,r){n.get(e)[t]=r}var n=new WeakMap;this.properties=n,this.get=e,this.remove=t,this.update=r,this.dispose=function(){n=new WeakMap,this.properties=n}}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n;r.default=i},{}],29:[function(e,t,r){"use strict";function n(e){return e.isGroup?e.renderOrder:e.parent?n(e.parent):e.renderOrder}function i(e,t,r,i,a,o,s){function u(e,t){var r=e.vertexArray,n=e.shaderProgram;r.isDestroyed()||r.destroy(),n.isDestroyed&&n.isDestroyed()||n.destroy(),e.isDestroyed=function(){return!0},e.uniformMap=void 0,e.renderState=h.removeFromCache(e.renderState);var i=e.derivedCommands;if(!i)return t.delete(e);for(var a in i)if(i.hasOwnProperty(a)){var o=i[a];o=o.drawCommand||o,!o.isDestroyed&&o instanceof d&&(o.uniformMap=void 0,u(o,t)),i[a]=void 0}t.delete(e)}var l=Cesium,c=l.destroyObject,f=l.BoundingSphere,d=l.DrawCommand,h=l.RenderState;e.derivedProperties={},this.id=i?i.id:0,this.drawCommand=e,this.material=t||null,this.geometry=a,this.materialIndex=r,this.groupIndex=s,this.object=i||null,this.groupOrder=i?n(i)||0:0,this.renderOrder=i?i.renderOrder||0:0,this.visualizer=o,this.currentScene=null,this.currentCamera=null,this.boundingSphere=new f,this.boundingVolume=new f,this.materialVersion=-1,this.renderVersion=-1,this.programCacheKey=null,this.wireframeIndices=null,this.frustumCulled=!0,this.z=-1,this.distanceToCamera=-1,this.visible=void 0,this.loaded=!1,this.initialized=!1,this.destroy=function(){var t=o.renderer;t._cesiumRenderStateCache.delete(e),u(e,t._cesiumRenderStateCache),c(e);for(var r in this)this[r]=null}}var a=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;a(e("M_33"));Object.defineProperties(i.prototype,{pass:{get:function(){return this.drawCommand._v_pass}},renderPass:{get:function(){return this.drawCommand.pass}},modelMatrix:{get:function(){return this.drawCommand.modelMatrix}}}),i.prototype.update=function(e,t,r,n){var i=Cesium,a=this,o=a.boundingVolume,s=e.isInstancedMesh,u=e.frustumCulled,l=e.modelMatrix
;if(s?t.instanceCount=e.count:isFinite(r.instanceCount)&&(t.instanceCount=r.instanceCount),t.instanceCount?a.frustumCulled=!1:a.frustumCulled=u,e.isCustomInstancedMesh)t.instanceCount=e._availableInstances.length,u&&i.BoundingSphere.clone(e._boundingSphere,o);else if(n||e.modelMatrixNeedsUpdate||!a.initialized){var c=this.boundingSphere,f=i.Matrix4;f.multiplyByPoint(l,c.center,o.center),o.radius=c.radius*f.getMaximumScale(l),a.initialized=!0}t.boundingVolume=u?o:void 0,t.modelMatrix=l};var o=i;r.default=o},{M_33:5,M_0:241}],30:[function(e,t,r){"use strict";function n(){this.fog=null,this.environment=null,this.lightsStateVersion=0,this.numClippingPlanes=0,this.numIntersection=0,this.clippingUniform={value:[]},this.clippingState=[],this.outputEncoding=-1,this.envMap=null,this.version=0,this.renderVersion=0,this.wireframe=!1}function i(e){function t(){P=new u.default,O=new WeakMap,R=new WeakMap}function r(e,t,r){function n(){i.delete(t),0==--i.useTimes&&(O.delete(e),R.delete(e))}var i=O.get(e),a=R.get(e);i||(i=new WeakMap,a=[],O.set(e,i),R.set(e,a)),i.useTimes=i.useTimes||0,r.forEach(function(e){function t(){e.destroy();var a=r.indexOf(e);a>=0&&r.splice(a,1),0==r.length&&n(),i.removeEventListener("dispose",t)}var i=e.material;i.addEventListener("dispose",t)}),i.useTimes++,i.set(t,r),a.push(t)}function i(t,r,n,i){var a=S.get(t);if(t.isSkinnedMesh&&a.skinningFrameNumber!=i.frameNumber){a.skinningFrameNumber=i.frameNumber;var o=t.skeleton;o.update(),o.boneTextureCesium&&(o.boneTextureCesium.needsUpdate=!0)}(t.material.morphTargets||t.material.morphNormals)&&a.morphtargetFrameNumber!=i.frameNumber&&(a.morphtargetFrameNumber=i.frameNumber,e.morphtargets.update(t,r,n))}function a(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights}function o(t,r,i,o,s){var u=e._clipping,l=e.getRenderTarget(),c=x.fog,f=t.isMeshStandardMaterial?x.environment:null,d=null===l?e.outputEncoding:l.texture.encoding,h=T.get(t.envMap||f),p=S.get(t,s?new n:void 0);p.needsLights=a(t),p.fog=c,p.environment=f,p.lightsStateVersion=i.state.version,p.numClippingPlanes=u.numPlanes,p.numIntersection=u.numIntersection,p.outputEncoding=d,p.envMap=h,p.shadows=o.length,p.wireframe=r,p.version=t.version,p.shadowMapType=e.shadowMap.type,p.rendererVersion=e.version}function c(e,t){var r=e.pickObjects,n=e.material;if(!e.pickObject&&!r&&Array.isArray(n)){var i=n;r=[];for(var a=0;a<i.length;a++){var o=i[a];r.push({primitive:x,id:e,mesh:e,material:o,materialIndex:a})}e.pickObjects=r}if(r&&r.length){for(var s=[],u=0;u<r.length;u++){var l=r[u],c=l.pickId;void 0==c&&(c=t.createPickId(l));var f=x._pickIds;f.includes(c)||f.push(c),l.pickId=c,s.push(c)}e.pickIds=s}else{var d=e.pickObject?e.pickObject:{primitive:x,id:e,mesh:e};e.pickObject=d;var c=d.pickId;void 0==c&&(c=t.createPickId(d));var h=x._pickIds;h.includes(c)||h.push(c),d.pickId=c,e.pickId=c}}function f(e,t,r){var n=e._attributeLocations[t],i=e._attributes[n],a=i.vertexBuffer;if(a._sizeInBytes!=r.length*r.constructor.BYTES_PER_ELEMENT)return void console.warn("Mesh3D.WebGLRenderItems:vertexBuffer ["+t+"] size has changed");r instanceof Uint32Array&&(r=new Float32Array(r),console.warn("Mesh3D.WebGLRenderItems：暂不支持Uint32Array类型顶点数组，已经强制替换为Float32Array（这会增加内存开销）")),a.copyFromArrayView(r,0)}function d(e,t,r,n){var i=n.material,a=i.morphTargets||i.morphNormals,o=n.isSkinnedMesh,s=x.useEncodedPosition;if(!o&&!a)for(var u in e){var l=t[u],c=e[u];if(l.version!=c.version){var d=c.array;if("position"==u&&s){for(var h=new Float32Array(d.length),p=new Float32Array(d.length),m={high:0,low:0},v=0;v<d.length;v++){var g=d[v];Cesium.EncodedCartesian3.encode(1e6*g,m),h[v]=m.high,p[v]=m.low}for(var y=0;y<r.length;y++){var _=r[y];f(_,"positionHigh",h),f(_,"positionLow",p)}}else for(var b=0;b<r.length;b++){var M=r[b];f(M,u,d)}l.version=c.version}}if(n.isInstancedMesh){var w=n.instanceMatrix,S=n.instanceColor;if(t.instanceMatrix||(t.instanceMatrix={version:-1}),S&&!t.instanceColor&&(t.instanceColor={version:-1}),t.instanceMatrix.version!=w.version){for(var T=w.array,C=0;C<r.length;C++){f(r[C],"instanceMatrix",T)}t.instanceMatrix.version=w.version}if(S&&t.instanceColor.version!=S.version){for(var E=S.array,A=0;A<r.length;A++){f(r[A],"instanceColor",E)}t.instanceColor.version=S.version}}}function h(t,r,n,i){var a=e._clipping;n=n&&t.id===B,S.get(t,i),a.setState(t,r,n),B=t.id}function p(t,r){r=r||S.get(t);var n=e._clipping,i=n.uniform.value,a=r.clippingUniform.value;i?M.unpackArray(i,a):a.length=0}function m(t,a,u,f,m){I.frameNumber!=a.frameNumber&&(I.changingCount=0,I.frameNumber=a.frameNumber),u=!!u&&!t.isLine&&!t.isPoints;var v=u,g=a.context,y=s.default.get(t.geometry,t.material),_=(y.groupsOptimized,y.materialIndicesUsed),b=e._programs,M=f.lights,R=e._clipping,B=f.shadowsArray,U=t.material,N=y.attributes,k=S.get(t),j=P.get(t),G=y.drawRange;if(!N.position.count||0==U.visible||0==G.count)return[];var V=m!==D,F=f.clippingEnabled,z=f.localClippingEnabled,H=!1;!0===F&&(!0===z||V)&&(H=!0),D=m,i(t,y,U,a);var W=t.renderItems;if(k.material!=t.material){var Y=O.get(t);W=Y&&Y.get(U),k.material=t.material}var X=y.index;if(void 0==W){if(c(t,g),Array.isArray(U))_.forEach(function(e){U[e].wireframe&&(v=!0)}),_.forEach(function(e){var t=U[e];H&&h(t,m,!V,new n),o(t,v,M,B,!H),p(t)}),v&&(y.index=s.default.getWireframeAttribute(y)),W=E.createArray(t,M,B);else{v=v||!!U.wireframe,v&&(y.index=s.default.getWireframeAttribute(y)),H&&h(U,m,!V,new n),o(U,v,M,B,!0),p(U);var q=E.create(t,M,B);q.boundingSphere=y.boundingSphere,W=[q]}y.index!=X&&(y.index=X);for(var K=0;K<W.length;K++){var Z=W[K],J=Z.drawCommand,Q=Z.material,$=b.getParameters(Q,M.state,B,x,t),ee=b.getProgramCacheKey($);v&&(Z.primitiveType=J.primitiveType,J.primitiveType=1),Z.renderVersion=S.get(Q).renderVersion,Z.programCacheKey=ee,Z.materialVersion=Q.version,Z.wireframe=v,Z.update(t,J,y,x.modelMatrixNeedsUpdate)}r(t,U,W);for(var te in N)N.hasOwnProperty(te)&&(j[te]={version:N[te].version})}else{var re=!1;for(var ne in N)ne in j||(re=!0,j[ne]={version:N[ne].version});var ie=N.position.version!=j.position.version;ie&&y.computeBoundingSphere();for(var ae=[],oe=e.getRenderTarget(),se=x.fog,ue=null===oe?e.outputEncoding:oe.texture.encoding,le=0;le<W.length;le++){var ce=W[le],fe=ce.material,de=ce.drawCommand,he=ce.materialIndex,pe=ce.groupIndex,me=S.get(fe);H&&h(fe,m,!V),p(fe,me);var ve=!1,ge=fe.isMeshStandardMaterial?x.environment:null,ye=T.get(fe.envMap||ge),_e=!1;if(ce.materialVersion==fe.version?(fe.fog&&me.fog!==se?ve=!0:me.environment!==ge?ve=!0:me.needsLights&&me.lightsStateVersion!==M.state.version?ve=!0:void 0===me.numClippingPlanes||me.numClippingPlanes===R.numPlanes&&me.numIntersection===R.numIntersection?me.outputEncoding!==ue?ve=!0:me.envMap!==ye?ve=!0:me.shadows!==B.length?ve=!0:me.shadowMapType!=e.shadowMap.type?ve=!0:me.rendererVersion!=e.version&&(ve=!0):ve=!0,ve?(isFinite(me.renderVersion),me.renderVersion++):(ce.renderVersion!=me.renderVersion&&(ve=!0),ce.renderStateVersion!=fe.renderStateVersion&&(ce.renderStateVersion=fe.renderStateVersion,_e=!0))):ve=!0,v=fe.wireframe||u,ve)if(I.maxChangingCount>I.changingCount){o(fe,v,M,B);var be=b.getParameters(fe,M.state,B,x,t),Me=b.getProgramCacheKey(be);ve=ce.programCacheKey!==Me,ce.programCacheKey=Me,ce.renderVersion=me.renderVersion,ce.materialVersion=fe.version,I.changingCount++}else ve=!1;var xe=ce.wireframe!=v,we=ce.geometry!=t.geometry;if(re||ve||xe||we){var Se=ce.wireframeIndices;if(v&&!Se){y.index=s.default.getWireframeAttribute(y);var Te=l(y,fe.transparent?pe:he,!fe.transparent,ce.boundingSphere);Se=Te.indices,ce.wireframeIndices=Se,ce.boundingSphere=Te.boundingSphere,y.index=X}else if(ie){var Te=l(y,fe.transparent?pe:he,!fe.transparent,ce.boundingSphere);ce.boundingSphere=Te.boundingSphere}if(re||xe||we){var Ce=de.vertexArray;if(!Ce.isDestroyed())if(le>0||xe){var Ee=Ce._indexBuffer;defined(Ee)&&!Ee.isDestroyed()&&Ee.vertexArrayDestroyable&&Ee.destroy()}else Ce.destroy();Ce=L.create(y,t,he,v?Se:void 0),de.vertexArray=Ce}var Ae=de.shaderProgram;Ae.isDestroyed&&Ae.isDestroyed()||Ae.destroy();var Le=de.vertexArray._attributeLocations;Ae=A.get(fe,Le,t,M,B),de.shaderProgram=Ae,de.renderState=C.create(fe,t),de.uniformMap=w.getUniformMap(fe,t,a,M),v?(void 0==ce.primitiveType&&(ce.primitiveType=de.primitiveType),de.primitiveType=1):void 0!=ce.primitiveType&&(de.primitiveType=ce.primitiveType),ce.wireframe=v}else if(_e&&(de.renderState=C.create(fe,t)),w.refresh(fe,t),ae.push(de.vertexArray),ie){var Te=l(y,fe.transparent?pe:he,!fe.transparent,ce.boundingSphere);ce.boundingSphere=Te.boundingSphere}ce.update(t,de,y,x.modelMatrixNeedsUpdate)}d(N,j,ae,t)}return t.renderItems=W,W}function v(e){var t=S.get(e),r=e.material;if(t.material){if(t.material==r)return e.renderItems;var n=O.get(e);return n&&n.get(r)}}function g(t,r,i,a,o,u,l,c){var f=l.lights,m=l.shadowsArray;r=s.default.get(r);var v=r.attributes,g=P.get(t),y=e._clipping,_=c!==D,M=l.clippingEnabled,T=l.localClippingEnabled,E=!1;!0===M&&(!0===T||_)&&(E=!0),D=c;var L=a.drawCommand,O=L.derivedCommands[o],R=L.derivedProperties,I=R[o];I||(I={},R[o]=I);var B=L.vertexArray._attributeLocations,U=!O;if(U||(I.materialVersion!=a.materialVersion||I.renderStateVersion!=a.material.renderStateVersion?(U=!0,I.materialVersion=a.materialVersion,I.renderStateVersion=a.material.renderStateVersion):U=O.vertexArray._attributeLocations!=B,U&&O.onMaterialDispose&&O.onMaterialDispose()),U){var N=function e(){O.shaderProgram.destroy();var t=L.isDestroyed;t&&t()||delete L.derivedCommands[o],i.removeEventListener("dispose",e)};E?h(i,c,!_,new n):S.get(i,new n),p(i),O=b.shallowClone(L),L.derivedCommands[o]=O,O.shaderProgram=A.get(i,B,t,f,m),O.uniformMap=w.getUniformMap(i,t,u,f),O.renderState=C.create(i,t,!1),i._isShadowDepthMaterial?t.addEventListener("dispose",N):i.addEventListener("dispose",N),O.onMaterialDispose=N}else{if(E&&h(i,c,!_,new n),p(i),void 0!==I.numClippingPlanes&&(I.numClippingPlanes!==y.numPlanes||I.numIntersection!==y.numIntersection)){var k=O.shaderProgram;k.isDestroyed&&k.isDestroyed()||k.destroy(),O.shaderProgram=A.get(i,B,t,f,m),O.uniformMap=w.getUniformMap(i,t,u,f),O.renderState=C.create(i,t,!1)}w.refresh(i,t),O.vertexArray=L.vertexArray}return I.numClippingPlanes=y.numPlanes,I.numIntersection=y.numIntersection,a.update(t,O,r,x.modelMatrixNeedsUpdate),d(v,g,[O.vertexArray],t),O}function y(e){var t=R.get(e),r=O.get(e);t&&r&&t.forEach(function(e){var t=r.get(e);t&&t.forEach(function(e){var t=e.wireframeIndexBuffer,r=t.isDestroyed;r&&r()||t.destroy(),delete e.wireframeIndexBuffer,delete e.indexBuffer})}),R.delete(e),O.delete(e)}var _=Cesium,b=_.DrawCommand,M=_.Cartesian4,x=e._visualizer,w=e._uniforms,S=e._properties,T=e._cubemaps,C=e._cesiumRenderStates,E=e._cesiumCommands,A=e._cesiumShaderPrograms,L=e._cesiumVertextArrays,P=new u.default,O=new WeakMap,R=new WeakMap,I={frameNumber:-1,changingCount:0,maxChangingCount:x.maxChangingCount};Object.defineProperties(this,{changingState:{get:function(){return I}},objectDrawAttributes:{get:function(){return P}},renderItemsCache:{get:function(){return O}},materialsUsed:{get:function(){return R}}});var D,B;this.get=v,this.remove=y,this.getAndUpdate=m,this.getAndUpdateDerived=g,this.dispose=t}var a=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=a(e("s_24")),s=a(e("e_23")),u=a(e("D_61")),l=(a(e("3_27")),a(e("h_25")),a(e("o_64")),o.default.computeBoundingSphereAndIndices),c=i;r.default=c},{s_24:2,e_23:22,D_61:28,h_25:29,o_64:32,"3_27":35,M_0:241}],31:[function(e,t,r){"use strict";function n(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function i(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function a(){function e(){l.length=0,c.length=0,f.length=0}function t(e){if(0==e.pass)l.push(e);else{var t=e.material;(!0===t.transparent||t.translucent?f:c).push(e)}}function r(e){if(0==e.pass)l.unshift(e);else{var t=e.material;(!0===t.transparent||t.translucent?f:c).unshift(e)}}function a(e,t){l.length>1&&l.sort(e||n),c.length>1&&c.sort(e||n),f.length>1&&f.sort(t||i)}function o(e,t){var r=e.object,n=e.material;return(!t.passes.pick||0!=r.allowPick)&&(r.visible&&n.visible)}function s(e,t){for(var r=0,n=l.length;r<n;r++)o(l[r],t)&&e.push(l[r].drawCommand);for(var i=0,a=c.length;i<a;i++)o(c[i],t)&&e.push(c[i].drawCommand);for(var s=0,u=f.length;s<u;s++)o(f[s],t)&&e.push(f[s].drawCommand)}function u(e,t){for(var r=0,n=l.length;r<n;r++)l[r].currentScene=e,l[r].currentCamera=t;for(var i=0,a=c.length;i<a;i++)c[i].currentScene=e,c[i].currentCamera=t;for(var o=0,s=f.length;o<s;o++)f[o].currentScene=e,f[o].currentCamera=t}var l=[],c=[],f=[];this.environment=l,this.opaque=c,this.transparent=f,this.init=e,this.push=t,this.unshift=r,this.sort=a,this.getDrawCommands=s,this.setCurrentScene=u}var o=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=(o(e("h_25")),a);r.default=s},{h_25:29,M_0:241}],32:[function(e,t,r){"use strict";function n(){function e(){l.init(),c.length=0,f.length=0,h.length=0,d.length=0}function t(e){h.push(e)}function r(e){d.push(e)}function n(e){c.push(e)}function i(e){m.lights.setup(h,d,e)}function s(e,t){l.setCurrentScene(e,t)}function u(e,t){l.getDrawCommands(e,t)}var l=new o.default,c=[],f=[],d=[],h=[],p=new a.default,m=this;this.renderList=l,this.renderables=c,this.dynamicRenderables=f,this.shadowsArray=d,this.lightsArray=h,this.lights=p,this.init=e,this.pushRenderable=n,this.setupLights=i,this.pushShadow=r,this.pushLight=t,this.setCurrentScene=s,this.getDrawCommands=u}var i=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var a=i(e("-_26")),o=i(e("h_69")),s=n;r.default=s},{"-_26":23,h_69:31,M_0:241}],33:[function(e,t,r){"use strict";function n(){var e=new WeakMap;this.get=function(t,r){var n,i=e.get(t);return void 0===i?(n=new a.default,e.set(t,new WeakMap),e.get(t).set(r,n)):void 0===(n=i.get(r))&&(n=new a.default,n.camera=r,i.set(r,n)),n},this.dispose=function(){e=new WeakMap},Object.defineProperties(this,{states:{get:function(){return e}}})}var i=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var a=i(e("o_64")),o=n;r.default=o},{o_64:32,M_0:241}],34:[function(e,t,r){"use strict";function n(e){function t(t,r){var a=e.frameState,u=a.context,l=t.width||u.drawingBufferWidth,c=t.height||u.drawingBufferHeight;if(!r){var f=o.default.fromTexure3js(t.texture);r=o.default.createTexture({target:3553,width:l,height:c,format:f.format,flipY:f.flipY,type:f.type,sampler:new n(f.sampler),preMultiplyAlpha:f.preMultiplyAlpha},u),r.name=t.texture.name}var d;if(t.depthTexture){var h=o.default.fromTexure3js(t.depthTexture);d=o.default.createTexture({target:3553,width:l,height:c,format:h.format,flipY:h.flipY,type:h.type,sampler:new n(h.sampler),preMultiplyAlpha:h.preMultiplyAlpha},u)}var p,m;return t.stencilBuffer?m=new i({context:u,format:34041,width:l,height:c}):t.depthBuffer&&(p=new i({context:u,format:33189,width:l,height:c})),new s({context:u,colorTextures:[r],destroyAttachments:!1,depthTexture:d,depthRenderbuffer:p,depthStencilRenderbuffer:m})}var r=Cesium,n=(r.WebGLConstants,r.Sampler),i=(r.RenderbufferFormat,r.Renderbuffer),s=r.Framebuffer,u=new Map;this.set=function(r){function n(){c.forEach(function(e){e.destroy()}),u.delete(r);var t=e._textureCache[s.uuid];t&&(t.isDestroyed&&t.isDestroyed()||t.destroy(),delete e._textureCache[s.uuid]),r.removeEventListener("dispose",n)}var i=e.frameState,o=i.context;if(!u.has(r)){var s=r.texture,l=r.depthTexture,c=[];if(r.isWebGLCubeRenderTarget){var f=a.default.formatsMap[s.format],d={width:r.width,height:r.height,arrayBufferView:new Uint8Array(4*r.width*r.height)},h=new Cesium.CubeMap({context:o,source:{positiveX:d,negativeX:d,positiveY:d,negativeY:d,positiveZ:d,negativeZ:d},width:r.width,height:r.height,pixelDatatype:a.default.typesMap[s.type],pixelFormat:f,flipY:s.flipY,preMultiplyAlpha:s.premultiplyAlpha});e._textureCache[s.uuid]=h;for(var p=[h.positiveX,h.negativeX,h.positiveY,h.negativeY,h.positiveZ,h.negativeZ],m=0;m<6;m++){var v=t(r,p[m]);c.push(v)}}else{var g=t(r);e._textureCache[s.uuid]=g.getColorTexture(0),l&&(e._textureCache[l.uuid]=g.depthTexture),c.push(g)}u.set(r,c),r.__onDispose=n,r.addEventListener("dispose",n)}},this.get=function(e){return u.has(e)||this.set(e),u.get(e)},this.dispose=function(){u.forEach(function(e,t){t.__onDispose&&(t.__onDispose(),delete t.__onDispose)}),u.clear()}}var i=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=n;var a=(i(e("M_33")),i(e("._29"))),o=i(e("o_75"))},{M_33:5,"._29":12,o_75:17,M_0:241}],35:[function(e,t,r){"use strict";var n=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i,a=n(e("e_1")),o=n(e("s_2")),s=n(e("s_79")),u=n(e("h_80")),l=n(e("h_36")),c=n(e("3_82")),f=n(e("D_83")),d=n(e("._84")),h=n(e("C_85")),p=n(e("D_61")),m=n(e("m_87")),v=n(e("M_88")),g=n(e("._29")),y=n(e("s_90")),_=n(e("h_91")),b=n(e("-_92")),M=n(e("3_93")),x=(n(e("M_33")),n(e("._95"))),w=(n(e("o_64")),n(e("o_97"))),S=n(e("m_98")),T=n(e("M_99")),C=n(e("e_100")),E=n(e("s_101")),A=function(){function e(t){function r(){var e=new WeakMap;this.get=function(t,r){var n=e.get(t);void 0==n&&(n=new WeakMap,e.set(t,n));var i=n.get(r);return void 0==i&&(i=new N(t.renderState),n.set(r,i)),i},this.delete=function(t){e.delete(t)},this.dispose=function(){e=new WeakMap}}function n(){return z._capabilities.gl}function o(e){var t=e.context._gl;if(!this._capabilities){var r=this._extensions=new s.default(t),n=this._capabilities=new u.default(t,r,{});!1===n.isWebGL2&&(r.get("WEBGL_depth_texture"),r.get("OES_texture_float"),r.get("OES_texture_half_float"),r.get("OES_texture_half_float_linear"),r.get("OES_standard_derivatives"),r.get("OES_element_index_uint"),r.get("ANGLE_instanced_arrays")),this.shadowMap.maxTextureSize=n.maxTextureSize,r.get("OES_texture_float_linear"),this._clipping=new m.default(this._properties,this._visualizer),this._programs=new l.default(this,this._cubemaps,r,n,this._clipping),this.morphtargets=new f.default(t,this)}this._pixelRatio=e.pixelRatio,this._frameState||(this._frameState=e)}function A(e,t,r){var n=this;if(r=r||this._frameState,!e)throw new Error("WebGLRenderer.render:缺少参数scene");if(!r)throw new Error("WebGLRenderer.render:MeshVisualizer未初始化，需要传递参数frameState");var i=this._currentRenderTarget,a=this._visualizer;if(!i)throw new Error("WebGLRenderer.render:未设置renderTarget");this.autoClear&&this.clear(null,1,0);var o,s=q.get(i),u=s[this._currentActiveCubeFace||0],l=r.context,f=l.uniformState,d=r.camera,p=r.cullingVolume;this.autoConvertCamera&&(o={},o.matrix=a._actualModelMatrixYup||a.modelMatrix,o.inverseMatrix=a._actualModelMatrixYupInverse||a._actualModelMatrixInverse);var m;!t||t instanceof B||(t.isPerspectiveCamera?t=h.default.fromPerspectiveCamera3js(t,a._scene,o):t.isOrthographicCamera?t=h.default.fromOrthographicCamera3js(t,a._scene,o):(a.traverseObject3D(e,function(e){e.currentFrustumCulled=e.frustumCulled,e.frustumCulled=!1,e.modelMatrixNeesUpdate=!1}),m={camera:t,_normalMatrix:new V,cameraPosition:new F},d.customCamera=m,t=null));var v=t||d,g=v!=d;r.camera=v,g&&f.update(r),this.overrideModelMatrix&&a.traverseObject3D(e,function(e){e.currentFrustumCulled=e.frustumCulled,e.frustumCulled=!1,e.modelMatrix=U.multiply(e.matrixWorld.elements,n.overrideModelMatrix,e.modelMatrix||new U),e.up.y&&c.default.yUp2Zup(e.modelMatrix,e.modelMatrix),e.modelMatrixNeesUpdate=!1});var y=[];a.update(r,e,y),y.forEach(function(e){if(m){var t=e.owner;t=t.mesh3js||t,m.modelMatrix=t.matrixWorld.elements,t.modelViewMatrix.multiplyMatrices(m.camera.matrixWorldInverse,t.matrixWorld),m.modelViewMatrix=t.modelViewMatrix.elements,m.projectionMatrix=m.camera.projectionMatrix.elements,m._normalMatrix.getNormalMatrix(t.modelViewMatrix),m.normalMatrix=m._normalMatrix.elements,m.cameraPosition.setFromMatrixPosition(m.camera.matrixWorld)}var r=e.renderState,a=e.renderState,o=i.viewport;if(a=Object.assign({},a),n.renderState&&(a=Object.assign(a,n.renderState)),o&&(a.viewport=o),i.stencilBuffer||(a.stencilTest={enabled:!1}),i.depthBuffer||i.depthTexture||(a.depthTest={enabled:!1}),i.scissorTest){var s=i.scissor;a.scissorTest={enabled:!0,rectangle:{x:s.x,y:s.y,width:s.width,height:s.height}}}else a.scissorTest={enabled:!1};a=new N(a);var c=e.framebuffer;e.renderState=a,e.framebuffer=u,e.execute(l),e.framebuffer=c,e.renderState=r}),(d.customCamera||this.overrideModelMatrix)&&a.traverseObject3D(e,function(e){e.frustumCulled=e.currentFrustumCulled}),delete d.customCamera,r.camera=d,g&&(r.cullingVolume=p,f.update(r)),y.length=0}function L(e,t,r,n,i,a,o,s,u,l){if(!(l=this._frameState||l))throw new Error("WebGLRenderer.renderBufferDirect:MeshVisualizer未初始化，需要传递参数frameState");var c=X.get(i,o.camera);if(c){var f=this._currentRenderTarget,d=this._visualizer,p=d._scene;if(!f)throw new Error("WebGLRenderer.renderBufferDirect:未设置renderTarget");this.autoClear&&this.clear();var m=q.get(f),v=m[this._currentActiveCubeFace||0],g=l.context,y=g.uniformState,_=l.camera;if(e&&!(e instanceof B))if(e.isPerspectiveCamera)e=h.default.fromPerspectiveCamera3js(e,null,p);else{if(!e.isOrthographicCamera)throw new Error("unsupport camera "+e.type);e=h.default.fromOrthographicCamera3js(e,null,p)}var b=e||_;l.camera=b,b!==_&&y.update(l),(i.modelMatrixNeesUpdate||i.needsUpdate)&&d.computeModelMatrix(i,l);var M=c.length>1?a.renderItemIndex:0;u=u||["_renderBufferDirect",n.uuid,r.uuid,M].join("_");var x=c[M],w=X.getAndUpdateDerived(i,r,n,x,u,l,o,s),S=!!w;if(S&&x.frustumCulled){x.boundingVolume}if(S){var T=w.renderState,C=f.viewport,E=this._cesiumRenderStateCache.get(w,b);E.depthMask=!0,E.depthTest.enabled=!0,E.stencilTest.enabled=!1,E.blending.enabled=!1,E.viewport=C,w.renderState=E;var A=g._gl;N.apply(A,E,g._defaultPassState),w.framebuffer=v,w.execute(g),w.framebuffer=null,w.renderState=T}l.camera=_,b!==_&&y.update(l)}}function P(e,t,r){if(i||(i=new k({color:new j(0,0,0,0)})),e?j.clone(e,i.color):j.clone(j.TRANSPARENT,i.color),this._currentRenderTarget){var n=q.get(this._currentRenderTarget);if(!n)return;var a=n[this._currentActiveCubeFace||0];if(!a)return;var o=this._frameState,s=i;s.depth="number"==typeof t?t:this.autoClearDepth?1:void 0,s.stencil="number"==typeof r?r:this.autoClearStencil?0:void 0,s.framebuffer=a,s.renderState=o.context._defaultRenderState,s.execute(o.context)}}function O(e,t){e=e||this._currentRenderTarget,t=t||this._currentActiveCubeFace;var r=q.get(e);if(r){var n=r[t||0];return c.default.readPixels(this._frameState,{framebuffer:n,x:0,y:0,width:e.width,height:e.height})}}function R(e,t,r,n,i,a,o){e=e||this._currentRenderTarget,o=o||this._currentActiveCubeFace;var s=e.texture,u=q.get(e);if(u){var l=u[o||0];return c.default.readPixels(this._frameState,{framebuffer:l,x:t||0,y:r||0,width:n||e.width,height:i||e.height,pixelFormat:g.default.formatsMap[s.format],pixelDatatype:g.default.typesMap[s.type]},a)}}function I(){X.dispose(),q.dispose()}(0,a.default)(this,e);var D=Cesium,B=D.Camera,U=D.Matrix4,N=D.RenderState,k=D.ClearCommand,j=D.Color,G=THREE,V=G.Matrix3,F=G.Vector3,z=this,H={setMask:function(e){},setLocked:function(e){},setClear:function(e,t,r,n,i){},reset:function(){}},W={setTest:function(e){var t=n(),r=t.DEPTH_TEST;e?t.enable(r):t.disable(r)},setMask:function(e){},setFunc:function(e){},setLocked:function(e){},setClear:function(e){},reset:function(){}},Y={setTest:function(e){},setMask:function(e){},setFunc:function(e,t,r){},setOp:function(e,t,r){},setLocked:function(e){},setClear:function(e){},reset:function(){}};this.state={buffers:{color:H,depth:W,stencil:Y},viewport:function(e){n().viewport(e.x,e.y,e.width,e.height)}},this._visualizer=t,this.gammaOutput=!1,this.gammaInput=!1,this._nClipPlanes=0,this._nClipIntersection=0,this._currentRenderTarget=null,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this._outputEncoding=null,this._physicallyCorrectLights=!1,this._toneMapping=null,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4,this._outputEncoding=3e3,this._toneMapping=0,this.vr={enabled:!1},this.xr={enabled:!1},this.shadowMap=new d.default(this,null,16e3),this._cubemaps=new v.default(this),this._properties=new p.default,this._materials=new _.default(this._properties),this._textures=new b.default(t),this._uniforms=new y.default(this),this._cesiumRenderStateCache=new r,this._cesiumRenderStates=new S.default(this),this._cesiumShaderPrograms=new C.default(this),this._cesiumVertextArrays=new E.default(this),this._cesiumCommands=new T.default(this);var X=this._webglRenderItems=new M.default(this);this._webglRenderStates=new x.default;var q=new w.default(t);this._clipping=null,this._programs=null,this._capabilities=null,this._extensions=null,this._pixelRatio=1,this.morphtargets=null,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this._currentActiveCubeFace=0,this._currentActiveMipmapLevel=0,this.renderState=null,this.autoConvertCamera=!1,this.overrideModelMatrix=null,this._clearColor=new G.Color("black"),this._clearAlpha=0,this.isCesiumRenderer=!0,this.version=0,this.init=o,this.render=A,this.renderBufferDirect=L,this.clear=P,this.readPixels=O,this.readRenderTargetPixels=R,this.dispose=I}return(0,o.default)(e,[{key:"capabilities",get:function(){return this._capabilities}},{key:"extensions",get:function(){return this._extensions}},{key:"needsUpdate",set:function(e){e&&this.version++}},{key:"outputEncoding",get:function(){return this._outputEncoding},set:function(e){e!=this._outputEncoding&&(this._outputEncoding=e,this.needsUpdate=!0)}},{key:"toneMapping",get:function(){return this._toneMapping},set:function(e){e!=this._toneMapping&&(this._toneMapping=e,this.needsUpdate=!0)}},{key:"physicallyCorrectLights",get:function(){return this._physicallyCorrectLights},set:function(e){e!=this._physicallyCorrectLights&&(this._physicallyCorrectLights=e,this.needsUpdate=!0)}},{key:"setRenderTarget",value:function(e,t,r){this._currentActiveCubeFace=t,this._currentActiveMipmapLevel=r,this._currentRenderTarget!=e&&(this._currentRenderTarget=e)}},{key:"getClearAlpha",value:function(){return this._clearAlpha}},{key:"setClearAlpha",value:function(e){this._clearAlpha=e}},{key:"getClearColor",value:function(){return this._clearColor}},{key:"setClearColor",value:function(e){this._clearColor.isColor?this._clearColor.set(e):this._clearColor=e}},{key:"getRenderTarget",value:function(){return this._currentRenderTarget}},{key:"getActiveCubeFace",value:function(){return this._currentActiveCubeFace}},{key:"getActiveMipmapLevel",value:function(){return this._currentActiveMipmapLevel}},{key:"getContext",value:function(){if(this._frameState)return this._frameState.context._gl}},{key:"setPixelRatio",value:function(e){this._pixelRatio=e}},{key:"copy",value:function(e){this.autoClear=e.autoClear,this.autoClearColor=e.autoClearColor,this.autoClearDepth=e.autoClearDepth,this.autoClearStencil=e.autoClearStencil,this.shadowMap.enabled=e.shadowMap.enabled,this.shadowMap.type=e.shadowMap.type,this.shadowMap.autoUpdate=e.shadowMap.autoUpdate,this.outputEncoding=e.outputEncoding,this.physicallyCorrectLights=e.physicallyCorrectLights,this.toneMapping=e.toneMapping,this.toneMappingExposure=e.toneMappingExposure,this.maxMorphTargets=e.maxMorphTargets,this.maxMorphNormals=e.maxMorphNormals,this.clippingPlanes=e.clippingPlanes,this.localClippingEnabled=e.localClippingEnabled}},{key:"compile",value:function(e,t){}},{key:"setSize",value:function(){}},{key:"clearDepth",value:function(){}}]),e}(),L=A;r.default=L},{C_85:1,M_33:5,"3_82":6,M_99:8,m_98:9,e_100:10,s_101:11,"._29":12,h_80:18,m_87:19,M_88:20,s_79:21,h_91:24,D_83:25,h_36:27,D_61:28,"3_93":30,o_64:32,"._95":33,o_97:34,"._84":36,"-_92":37,s_90:38,e_1:235,s_2:236,M_0:241}],36:[function(e,t,r){"use strict";function n(e,t,r){function n(e,t){var r=z.get(e);void 0===r&&(r=new WeakMap,z.set(e,r),e.addEventListener("dispose",function(){z.delete(e)}));var n=r.get(t);return void 0==n&&(n=new x(e,t),t.addEventListener("dispose",function(){r.delete(t)}),r.set(t,n)),n}function i(t,r){var i=Cesium.Color,a=N.geometry;D.uniforms.shadow_pass.value=t.map.texture,D.uniforms.resolution.value=t.mapSize,D.uniforms.radius.value=t.radius,e.renderState.depthTest.enabled=!1,e.renderState.depthMask=!1,e.shadowMap.enabled=!1,e.setRenderTarget(t.mapPass),e.clear(i.WHITE,1,0);var o=n(a,D);o.frustumCulled=!1,e.render(o,r),B.uniforms.shadow_pass.value=t.mapPass.texture,B.uniforms.resolution.value=t.mapSize,B.uniforms.radius.value=t.radius,e.setRenderTarget(t.map),e.clear(i.WHITE,1,0),o=n(a,B),o.frustumCulled=!1,e.render(o,r),e.shadowMap.enabled=!0,e.renderState.depthTest.enabled=!0,e.renderState.depthMask=!0}function l(e,t,r){var n=e<<0,i=P[n];return void 0===i&&(i=new g({depthPacking:m,morphTargets:e}),P[n]=i),i}function c(e,t,r){var n=e<<0,i=O[n];return void 0===i&&(i=new y({morphTargets:e}),O[n]=i),i}function f(t,r,n,i,a,o,s){var u=null,f=l,d=t.customDepthMaterial;if(!0===i.isPointLight&&(f=c,d=t.customDistanceMaterial),void 0===d){var h=!1;!0===n.morphTargets&&(h=r.morphAttributes&&r.morphAttributes.position&&r.morphAttributes.position.length>0);u=f(h,!1,!0===t.isInstancedMesh)}else u=d;if(e.localClippingEnabled&&!0===n.clipShadows&&0!==n.clippingPlanes.length){var m=u.uuid,v=n.uuid,g=R[m];void 0===g&&(g={},R[m]=g);var y=g[v];void 0===y&&(y=u.clone(),g[v]=y),u=y}return u.visible=n.visible,u.wireframe=n.wireframe,u.side=s===p?null!==n.shadowSide?n.shadowSide:n.side:null!==n.shadowSide?n.shadowSide:I[n.side],u.clipShadows=n.clipShadows,u.clippingPlanes=n.clippingPlanes,u.clipIntersection=n.clipIntersection,u.wireframeLinewidth=n.wireframeLinewidth,u.linewidth=n.linewidth,!0===i.isPointLight&&!0===u.isMeshDistanceMaterial&&(u.referencePosition.setFromMatrixPosition(i.matrixWorld),u.nearDistance=a,u.farDistance=o),u._isShadowDepthMaterial=!0,u}function d(t,r,n,i,a,s,u,l){if(!1!==t.visible){if((!t.layers||!r.layers||t.layers.test(r.layers))&&(t.isMesh||t.isLine||t.isPoints)&&(t.castShadow||t.receiveShadow&&a===p)){if(t.frustumCulled&&!C.intersectsObject(t))return;var c=o.default.get(t.geometry,t.material),h=t.material;if(Array.isArray(h))for(var m=c.groupsOptimized,v=0;v<m.length;v++){var g=m[v],y=g.materialIndex,_=g.groupIndex,b=h[y];if(b.visible){var M=f(t,c,b,i,l.near,l.far,a);e.renderBufferDirect(n,null,c,M,t,{materialIndex:y,groupIndex:_,renderItemIndex:v},u,l,H+i.uuid)}}else if(h.visible){var x=f(t,c,h,i,l.near,l.far,a);e.renderBufferDirect(n,null,c,x,t,null,u,l,H+i.uuid)}}var w=t.children;if(0!=s&&w)for(var S=0,T=w.length;S<T;S++)d(w[S],r,n,i,a,s,u,l)}}if(this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.initialized=!1,"undefined"==typeof THREE)return void(this.render=function(){});var h=THREE,p=3,m=3201,v=h.WebGLRenderTarget,g=h.MeshDepthMaterial,y=h.MeshDistanceMaterial,_=h.ShaderMaterial,b=h.BufferAttribute,M=h.BufferGeometry,x=h.Mesh,w=h.Vector4,S=h.Vector2,T=h.Frustum,C=new T,E=new S,A=new S,L=new w,P=[],O=[],R={},I={0:1,1:0,2:2},D=new _({defines:{SAMPLE_RATE:.25,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new S},radius:{value:4}},vertexShader:u,fragmentShader:s});D.autoRefresh=!0;var B=D.clone();B.defines.HORIZONAL_PASS=1,B.autoRefresh=!0;var U=new M;U[U.setAttribute?"setAttribute":"addAttribute"]("position",new b(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var N=new x(U,D),k=this;Object.defineProperty(this,"maxTextureSize",{get:function(){return r},set:function(e){r=e}});var j=1,G=0;Object.defineProperties(this,{mapNeedsUpdate:{set:function(e){e&&G++}},type:{get:function(){return j},set:function(e){e!=j&&(j=e,this.mapNeedsUpdate=!0)}}});var V,F={blending:{enabled:!1},scissorTest:{enabled:!1},depthTest:{enabled:!0},depthMask:!0,colorMask:{
red:!0,green:!0,blue:!0,alpha:!0},stencilTest:{enabled:!1}};try{V=new Cesium.RenderState(F)}catch(e){V.lineWidth=0,V=new Cesium.RenderState(F)}this.render=function(t,n,o,s){var u=this;if((!1!==k.autoUpdate||!1!==k.needsUpdate)&&0!==t.length){t=t.slice();var l=o.context.uniformState,c=o.camera,f=o.cullingVolume,h=e._webglRenderStates.get(n,c),m=e.getRenderTarget(),g=e.getActiveCubeFace(),y=e.getActiveMipmapLevel(),_=e.autoClear,b=e.renderState;e.autoClear=!1;var M=V;e.renderState=M;var x=this._referenceFrame||{};this._referenceFrame=x,x.matrix=s._actualModelMatrixYup||s.modelMatrix,x.inverseMatrix=s._actualModelMatrixYupInverse||s._actualModelMatrixInverse;for(var w=0,S=t.length;w<S;w++){var T;(function(n,m){var g=t[n],y=g.shadow,_=void 0,b=y.camera;if(!1===y.autoUpdate&&!1===y.needsUpdate)return"continue";if(void 0===y)return console.warn("Mesh3D.WebGLShadowMap:",g,"has no shadow."),"continue";if(!b.isPerspectiveCamera&&!b.isOrthographicCamera)return console.warn("Mesh3D.WebGLShadowMap:",g,"camera is not supported."),"continue";E.copy(y.mapSize);var w=y.getFrameExtents();if(E.multiply(w),A.copy(y.mapSize),(E.x>r||E.y>r)&&(E.x>r&&(A.x=Math.floor(r/w.x),E.x=A.x*w.x,y.mapSize.x=A.x),E.y>r&&(A.y=Math.floor(r/w.y),E.y=A.y*w.y,y.mapSize.y=A.y)),T=y.__mapVersion!=G,T&&(y.mapPass&&(y.mapPass.texture.dispose(),y.mapPass.dispose(),y.mapPass=null),y.map&&(y.map.dispose(),y.map.texture.dispose(),y.map=null),y.__mapVersion=G),u.type!==p&&y.mapPass&&(y.map&&(y.map.texture.dispose(),y.map.dispose(),y.map=null),y.mapPass.dispose(),y.mapPass.texture.dispose(),y.mapPass=null),null===y.mapPass&&!y.isPointLightShadow&&u.type===p){y.map&&(y.map.texture.dispose(),y.map.dispose());var S={minFilter:1006,magFilter:1006,format:1023,stencilBuffer:!1};y.map=new v(E.x,E.y,S),y.map.texture.name=g.name+".shadowMap",y.mapPass=new v(E.x,E.y,S),y.camera.updateProjectionMatrix()}if(null===y.map){var P={minFilter:1003,magFilter:1003,format:1023,stencilBuffer:!1};y.map=new v(E.x,E.y,P),y.map.texture.name=g.name+".shadowMap",y.camera.updateProjectionMatrix()}if(e.setRenderTarget(y.map),e.clear(Cesium.Color.WHITE,1,0),u.enabled){for(var O=y.getViewportCount(),R=0;R<O;R++){var I=y.getViewport(R);L.set(A.x*I.x,A.y*I.y,A.x*I.z,A.y*I.w);var D=y.map.viewport;y.map.viewport=L,y.updateMatrices(g,R),y.camera.isPerspectiveCamera?_=a.default.fromPerspectiveCamera3js(b,s._scene,x):y.camera.isOrthographicCamera&&(_=a.default.fromOrthographicCamera3js(b,s._scene,x)),C=y.getFrustum(),o.camera=_,l.update(o),M.viewport=L,h.renderables.forEach(function(e){d(e,c,_,g,u.type,!1,h,y.camera)}),o.camera=c,o.cullingVolume=f,l.update(o),y.map.viewport=D,y.camera._referenceFrame=null}y.isPointLightShadow||u.type!==p||i(y,c),y.needsUpdate=!1,y.onCameraChanged&&y.onCameraChanged(y.map)}})(w)}e.renderState=b,e.autoClear=_,k.needsUpdate=!1,e.setRenderTarget(m,g,y)}};var z=new WeakMap,H="shadowMap"}var i=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var a=i(e("C_85")),o=(i(e("M_33")),i(e("e_23"))),s=(i(e("3_27")),"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy ) / resolution ) );\n\tfor ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {\n\t\t#ifdef HORIZONAL_PASS\n\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );\n\t\tmean += distribution.x;\n\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, i ) * radius ) / resolution ) );\n\t\tmean += depth;\n\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean * HALF_SAMPLE_RATE;\n\tsquared_mean = squared_mean * HALF_SAMPLE_RATE;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"),u="void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",l=n;r.default=l},{C_85:1,M_33:5,e_23:22,"3_27":35,M_0:241}],37:[function(e,t,r){"use strict";function n(e){function t(e,t){var r=(e._size,e._pixelFormat),n=e._pixelDatatype,i=(e._preMultiplyAlpha,e._flipY,e._gl||e._context._gl),a=e._textureTarget,o=e._texture,s="number"==typeof e._targetFace?e._targetFace:a,u=t.width,l=t.height,c=t.arrayBufferView;i.activeTexture(i.TEXTURE0),i.bindTexture(a,o);i.pixelStorei(i.UNPACK_ALIGNMENT,4),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,!1);var c=t.arrayBufferView,f=p.isCompressedFormat(r);if(f?i.compressedTexImage2D(s,0,r,u,l,0,c):i.texImage2D(s,0,r,u,l,0,r,n,c),m(t.mipLevels))for(var d=u,h=l,v=0;v<t.mipLevels.length;++v)d=0|Math.floor(d/2),d<1&&(d=1),h=0|Math.floor(h/2),h<1&&(h=1),f?i.compressedTexImage2D(s,v+1,r,d,h,0,t.mipLevels[v]):i.texImage2D(s,v+1,r,d,h,0,r,n,t.mipLevels[v]);i.bindTexture(a,null)}function r(e){var t={};return t.minificationFilter=a.default.minFilterMap[e.minFilter],t.magnificationFilter=a.default.magFilterMap[e.magFilter],t.wrapS=a.default.textureWrapMap[e.wrapS],t.wrapT=a.default.textureWrapMap[e.wrapT],t.maximumAnisotropy=e.anisotropy,new h(t)}function n(e,t){var n=w[e.format],i=S[e.type],a=e.premultiplyAlpha,o=e.flipY,s=r(e),u=e.image,l=e.mipmaps,c=u.width,f=u.height,h=l&&l.length>0,p=9984===s.minificationFilter||9986===s.minificationFilter||9985===s.minificationFilter||9987===s.minificationFilter,m=p||10497===s.wrapS||33648===s.wrapS||10497===s.wrapT||33648===s.wrapT,g=u,_=g&&(!y.isPowerOfTwo(g.width)||!y.isPowerOfTwo(g.height));if(m&&_){var b=document.createElement("canvas");b.width=y.nextPowerOfTwo(g.width),b.height=y.nextPowerOfTwo(g.height);var M=b.getContext("2d");M.drawImage(g,0,0,g.width,g.height,0,0,b.width,b.height),g=b,c=b.width,f=b.height}var x=!1;if(c>d.maximumTextureSize&&(c=d.maximumTextureSize,x=!0,console.warn("Mesh3D.WebGLTextures:Width should be less than or equal to the maximum texture size ("+d.maximumTextureSize+").  Check maximumTextureSize.")),f>d.maximumTextureSize&&(console.warn("Mesh3D.WebGLTextures:Height should be less than or equal to the maximum texture size ("+d.maximumTextureSize+").  Check maximumTextureSize."),f=d.maximumTextureSize,x=!0),x){console.warn("Mesh3D.WebGLTextures:Width and height must be less than or equal to the maximum texture size ("+d.maximumTextureSize+").  Check maximumTextureSize.");var b=document.createElement("canvas");b.width=c,b.height=f;var M=b.getContext("2d");M.drawImage(g,0,0,g.width,g.height,0,0,b.width,b.height),g=b,c=b.width,f=b.height}var T=new v({context:t,source:h?void 0:g,width:c,height:f,pixelFormat:n,pixelDatatype:i,sampler:s,flipY:o,preMultiplyAlpha:a});return p&&T.generateMipmap(),T}function i(e,n){var i=w[e.format],a=S[e.type],o=e.premultiplyAlpha,s=e.flipY,u=r(e),l=e.image,c=e.mipmaps,f=l.width>1?l.width:1,d=l.height>1?l.height:1,h=c&&c.length>0,p=new v({context:n,source:h?void 0:{arrayBufferView:l.data,width:f,height:d},width:f,height:d,pixelFormat:i,pixelDatatype:a,sampler:u,flipY:s,preMultiplyAlpha:o});if(h){var m={width:f,height:d};if(m.arrayBufferView=c[0].data,c.length>1){for(var g=[],y=1;y<c.length;y++)g.push(c[y].data);m.mipLevels=g}p._pixelFormat=i,t(p,m),p._initialized=!0}return p}function o(e,n){var i=w[e.format],a=S[e.type],o=e.premultiplyAlpha,s=e.flipY,u=r(e),l=e.image,c=e.mipmaps,f=l.width,d=l.height,h=p.isCompressedFormat(i),m=new v({context:n,width:f,height:d,pixelFormat:h?6408:i,pixelDatatype:a,sampler:u,flipY:s,preMultiplyAlpha:o}),g={width:f,height:d};if(g.arrayBufferView=c[0].data,c.length>1){for(var y=[],_=1;_<c.length;_++)y.push(c[_].data);g.mipLevels=y}return m._pixelFormat=i,t(m,g),m._initialized=!0,m}function s(e,t){var r=w[e.format],n=S[e.type],i=e.image,a=e.mipmaps;i=i.map(function(e){return e.isDataTexture?{arrayBufferView:e.data,width:e.data,height:e.height}:e});var o=new g({context:t,source:{positiveX:i[0],negativeX:i[1],positiveY:i[2],negativeY:i[3],positiveZ:i[4],negativeZ:i[5]},pixelFormat:r,pixelDatatype:n,preMultiplyAlpha:e.preMultiplyAlpha,flipY:e.flipY});return a&&a.length,o}function u(e,r){var n=w[e.format],i=S[e.type],a=e.premultiplyAlpha,o=e.flipY,s=e.image,u=s.width||s[0].width,l=s.height||s[0].height,c=p.isCompressedFormat(n),f=new g({width:u,height:l,context:r,pixelFormat:c?6408:n,pixelDatatype:i,preMultiplyAlpha:a,flipY:o});return["positiveX","negativeX","positiveY","negativeY","positiveZ","negativeZ"].forEach(function(e,r){var i=f[e],a=s[r],o=a.mipmaps,c={width:u,height:l};if(c.arrayBufferView=o[0].data,o.length>1){for(var d=[],h=1;h<o.length;h++)d.push(o[h].data);c.mipLevels=d}i._pixelFormat=n,t(i,c),i._initialized=!0}),f}function l(e,t){var r=w[e.format],n=S[e.type],i=e.premultiplyAlpha,a=e.flipY,o=e.image.map(function(e){if(e.isDataTexture){var t=e;return{width:t.image.width,height:t.image.height,arrayBufferView:t.image.data}}return e});return new g({context:t,source:{positiveX:o[0],negativeX:o[1],positiveY:o[2],negativeY:o[3],positiveZ:o[4],negativeZ:o[5]},pixelFormat:r,pixelDatatype:n,preMultiplyAlpha:i,flipY:a})}function c(e){var t=e.image,r=!0;if(!t||!t.length)return!1;for(var n=0;n<t.length;n++){if(!t[n]){r=!1;break}}return r}var f=Cesium,d=(f.TextureMinificationFilter,f.TextureWrap,f.ContextLimits),h=f.Sampler,p=f.PixelFormat,m=f.defined,v=f.Texture,g=f.CubeMap,y=Cesium.Math,_=e._textureCache,b=new WeakMap,M=new WeakMap,x=new WeakMap;if(this.has=function(e){return b.has(e)},this.get=function(t,r,a){if(_[t.uuid])return _[t.uuid];var f=r.context,d=b.get(t);if(d&&d.version!=t.version&&(d=this.delete(t)),!d){var h=e.defaultTexture,p=e.defaultCubeMap,m=t.image;if(t.isCanvasTexture||t.isVideoTexture){if(!m)return h;d=n(t,f)}else if(t.isDataTexture){if(!m||!m.data)return a||h;d=i(t,f)}else if(t.isCubeTexture){if(6!=m.length||!c(t))return p;d=s(t,f)}else if(t.isCompressedTexture){if(!m)return h;if(Array.isArray(m))if(t.mipmaps)d=o(t,f);else{if(!c(t))return a||p;d=u(t,f)}else d=o(t,f)}else if(Array.isArray(m)){if(!c(t))return a||p;d=l(t,f)}else{if(!m||!(m instanceof HTMLCanvasElement||m instanceof HTMLVideoElement||m instanceof HTMLImageElement||m instanceof ImageData||m instanceof OffscreenCanvas||m instanceof ImageBitmap))return a||h;d=n(t,f)}this.set(t,d)}return d},this.set=function(e,t){function r(){var t=b.get(e);void 0!==t&&(t.isDestroyed&&t.isDestroyed()||t.destroy(),b.delete(e)),e.removeEventListener("dispose",r),x.delete(e)}if(!t||!e)return void console.warn("Mesh3D.WebGLTextures:texture3js or texture is empty");t.version=e.version,b.set(e,t),e.addEventListener("dispose",r),x.set(e,r)},this.delete=function(e){var t=x.get(e);t&&t()},this.addReference=function(e){var t=M.get(e)||0;M.set(e,++t)},this.removeReference=function(e){var t=M.get(e);void 0!=t&&(t--,0==t?(this.delete(e),M.delete(e)):M.set(e,t))},Object.defineProperties(this,{textures:{get:function(){return b}},textureReferences:{get:function(){return M}}}),"undefined"!=typeof THREE)var w=a.default.formatsMap,S=a.default.typesMap}var i=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var a=i(e("._29")),o=n;r.default=o},{"._29":12,M_0:241}],38:[function(e,t,r){"use strict";function n(e,t){var r=r;return function(){return t._rtcTransform||(t._rtcTransform=new r),t._rtcModelView||(t._rtcModelView=new r),r.multiplyByTranslation(t.modelMatrix,t._center,t._rtcTransform),r.multiply(e.uniformState.view,t._rtcTransform,t._rtcModelView)}}function i(e){function t(e,t){return function(){return e[t]}}function r(e,r,n){for(var i in r)if(r.hasOwnProperty(i)){var a=e+"."+i;n[a]=t(r,i)}}function i(e){var t=(0,o.default)(e);return"undefined"!=t&&null!=e&&("number"==t||"boolean"==t||e instanceof b||e instanceof M||e instanceof x||e instanceof w||e instanceof _||e instanceof y||e instanceof g||e instanceof v||e.isColor||e.isVector2||e.isVector3||e.isVector4||e.isCartesian2||e.isCartesian3||e.isCartesian4||e.isMatrix2||e.isMatrix3||e.isMatrix4)}function a(e){return!(!Array.isArray(e)||!e.length)&&!i(e[0])}function s(e,t,n){if(a(t))for(var i=0;i<t.length;i++){var o=t[i],u=e+"["+i+"]";a(o)?s(u,o,n):r(u,o,n)}else n[e]=function(){return t}}function u(t,r,n,i){var a=r.pickId,o=r.pickIds;if(o){var s=r.material,u=Array.isArray(s)?s.indexOf(t):0;-1!=u&&(a=o[u]||a)}i.czm_pickColor=function(){return a.color},i.cameraPosition=function(){var e=n.camera.customCamera;return e&&e.cameraPosition?e.cameraPosition:n.camera.position},i.u_cameraPosition=i.cameraPosition,i.cameraPositionLC=function(){var e=n.camera,t=e.customCamera;return t&&t.cameraPosition?t.cameraPosition:(S.worldCoordinatesToLocal(e.position,N,r.up),N)},i.u_cameraPositionLC=i.cameraPositionLC,i.normalMatrix=function(){var e=n.camera.customCamera;return e&&e.normalMatrix?e.normalMatrix:n.context.uniformState.normal},i.u_normalMatrix=i.normalMatrix,i.projectionMatrix=function(){var e=n.camera.customCamera;return e&&e.projectionMatrix?e.projectionMatrix:n.context.uniformState.projection},i.u_projectionMatrix=i.projectionMatrix,i.modelViewMatrix=function(){var e=n.camera.customCamera;return e&&e.modelViewMatrix?e.modelViewMatrix:n.context.uniformState.modelView},i.u_modelViewMatrix=i.modelViewMatrix;var l=new g;i.modelViewMatrixInverse=function(){var e=n.context.uniformState.modelView;return g.inverse(e,l)},i.modelMatrix=function(){var e=n.camera.customCamera;return e&&e.modelMatrix?e.modelMatrix:n.context.uniformState.model},i.u_modelMatrix=i.modelMatrix;var c=new g;i.matrixWorld=function(){var e=i._CesiumModel2ThreeModel();return g.multiply(e,n.context.uniformState.model,c)};var f=new y;i.normalMatrixWorld=function(){var e=i._CesiumNormal2ThreeNormal();return y.multiply(e,n.context.uniformState.normal,f)};var d=1==r.up.y;i._CesiumModel2ThreeModel=function(){return d?S._actualModelMatrixYupInverse:S._actualModelMatrixInverse},i._ThreeModel2CesiumModel=function(){return d?S._actualModelMatrixYup:S._actualModelMatrix};var h=new y;i._CesiumNormal2ThreeNormal=function(){return d?g.getMatrix3(S._actualModelMatrixYupInverse,h):g.getMatrix3(S._actualModelMatrixInverse,h)};var p=new y;i._ThreeNormal2CesiumNormal=function(){return 1==r.up.y?g.getMatrix3(that._actualModelMatrixYup,p):g.getMatrix3(that._actualModelMatrix,p)},i.viewMatrix=function(){return n.context.uniformState.view},i.u_viewMatrix=i.viewMatrix,i.logDepthBufFC=function(){return 2/(Math.log(n.camera.frustum.far+1)/Math.LN2)},i.isOrthographic=function(){return 1==n.camera.isOrthographicCamera},i.toneMappingExposure=function(){return e.toneMappingExposure},i.toneMappingWhitePoint=function(){return e.toneMappingWhitePoint},i.receiveShadow=function(){return 1==r.receiveShadow},i.center=function(){return!!r.center},t.uniformStateUsed&&t.uniformStateUsed.length&&t.uniformStateUsed.forEach(function(e){if(!i[e.glslVarName]){if(!n.context.uniformState[e.uniformStateName])throw new Error(e.uniformStateName+"不是Cesium引擎的内置对象");i[e.glslVarName]=function(){return n.context.uniformState[e.uniformStateName]}}})}function l(e,t,r,n,i,a){if(E.get(e).needsLights){var o=function(e){return function(){return s[e].map(function(e){return e?T.get(e):S.defaultShadowMap})}},s=a.state,u={};u.lightProbe={value:s.probe},u.directionalLights={value:s.directional},u.directionalLightShadows={value:s.directionalShadow},u.spotLights={value:s.spot},u.spotLightShadows={value:s.spotShadow},u.rectAreaLights={value:s.rectArea},u.pointLights={value:s.point},u.pointLightShadows={value:s.pointShadow},u.hemisphereLights={value:s.hemi},n.directionalShadowMap=o("directionalShadowMap"),n.directionalShadowMatrix=function(){return s.directionalShadowMatrix},n.spotShadowMap=o("spotShadowMap"),n.spotShadowMatrix=function(){return s.spotShadowMatrix},n.pointShadowMap=o("pointShadowMap"),n.pointShadowMatrix=function(){return s.pointShadowMatrix},p(u,r,n),i.ambientLightColor&&(e.lightMap?n.ambientLightColor=function(){return b.BLACK}:n.ambientLightColor=function(){return s.ambient}),n.ltc_1=function(){return T.get(O,r)||S.defaultTexture},n.ltc_2=function(){return T.get(R,r)||S.defaultTexture};var l=S._fixedWebGLLights.extensionState,c=S._partialWebGLLights.extensionState;n.fixedPointLightMap=function(){return l.point.map},n.partialPointLightMap=function(){return c.point.map},n.fixedPointLightPositions=function(){return l.point.positions},n.fixedPointLightColors=function(){return l.point.colors},n.fixedPointLightDecayDists=function(){return l.point.decalDists},n.partialPointLightPositions=function(){return c.point.positions},n.partialPointLightColors=function(){return c.point.colors},n.partialPointLightDecayDists=function(){return c.point.decalDists},n.partialPointLightDecayDists=function(){return c.point.decalDists},n.fixedPointLightVisibles=function(){return l.point.visibles},n.partialPointLightVisibles=function(){return c.point.visibles}}}function c(e,t,r,n){if(!e.isShaderMaterial&&!e.isRawShaderMaterial||!0===e.clipping){var i=E.get(e).clippingUniform;n.clippingPlanes=function(){return i?i.value:[]}}}function f(e,t,r,n){if(e&&(e.skinning||t.isSkinnedMesh)){var i=t;n.bindMatrix=function(){return i.bindMatrix.elements},n.bindMatrixInverse=function(){return i.bindMatrixInverse.elements};var a=i.skeleton;if(a){var o=a.bones;if(A.floatVertexTextures){var s=a.boneTextureCesium,u=a.boneTexture;if(void 0===u||null===u){if(a.computeBoneTexture)a.computeBoneTexture(),u=a.boneTexture;else{var l=Math.sqrt(4*o.length);l=U.ceilPowerOfTwo(l),l=Math.max(l,4);var c=new Float32Array(l*l*4);c.set(a.boneMatrices),u=new D(c,l,l,1023,1015),a.boneMatrices=c,a.boneTexture=u,a.boneTextureSize=l}s=T.get(a.boneTexture,r),s.name="boneTexture",a.boneTextureCesium=s}n.boneTexture=function(){if(s.version!=u.version){var e=u.image;e.arrayBufferView=e.data;try{s.copyFrom({source:e})}catch(t){s.copyFrom(e)}s.version=u.version}else s.version=u.version;return s},n.boneTextureSize=function(){return a.boneTextureSize}}else n.boneMatrices=function(){return a.boneMatrices.elements}}}}function d(t,r,n){if(t&&(t.morphTargets||t.morphNormals)){var i=e.morphtargets.getUniforms(r);n.morphTargetBaseInfluence=function(){return i.morphTargetBaseInfluence},n.morphTargetInfluences=function(){return i.morphTargetInfluences}}}function h(e,t,r){var n=t.value,a=(0,o.default)(n);if("f"==t.type)return function(){return t.value||0};if("number"==a||"boolean"==a)return function(){return t.value};if(!n){var s="envMap"==e?S.defaultCubeMap:S.defaultTexture;return function(){var e=t.value;if(e){return T.get(e,r,s)}return s}}if(n.isTexture){var s="envMap"==e?S.defaultCubeMap:S.defaultTexture;return function(){return T.get(t.value,r,s)}}if(n.isVector2|n.isVector3|n.isVector4|n.isColor)return function(){return t.value};if(n.isMatrix2|n.isMatrix3|n.isMatrix4)return function(){return t.value.elements};if(Array.isArray(n)){if(!n.length)return;if(i(n[0]))return function(){return t.value}}}function p(e,t,n){for(var i in e){var o=e[i];if(e.hasOwnProperty(i)&&o){var u=o.value,l=h(i,o,t);l?n[i]=l:a(u)?s(i,u,n):r(i,u,n)}}e.datetime&&(n.datetime=function(){return performance.now()})}var m=Cesium,v=(m.OrthographicFrustum,m.Texture),g=m.Matrix4,y=m.Matrix3,_=m.Matrix2,b=m.Color,M=m.Cartesian2,x=m.Cartesian3,w=m.Cartesian4,S=e._visualizer,T=e._textures,C=e._materials,E=e._properties,A=e._capabilities,L=e._extensions,P=new WeakMap;Object.defineProperties(this,{uniforms:{get:function(){return P}}});var O,R,I=THREE,D=I.DataTexture,B=I.UniformsLib,U=I.MathUtils,N=new x;this.getUniformMap=function(e,t,r,i){var a={},o=r.context,s=P.get(e);if(!s||!s.has(t))return a;var h=s.get(t);return p(h,r,a),u(e,t,r,a),l(e,t,r,a,h,i),c(e,t,r,a),d(e,t,a),f(e,t,r,a),t._instances&&(a.czm_instanced_modifiedModelView=n(o,t)),t.uniformMapLoadedCallback&&t.uniformMapLoadedCallback(a,r,t),a},this.set=function(t,r,n){function i(){a.delete(n),t._isShadowDepthMaterial?n.removeEventListener("dispose",i):t.removeEventListener("dispose",i),0==--a.useTimes&&P.delete(t);for(var e in r){var o=r[e];if(r.hasOwnProperty(e)&&o){var s=o.value;s&&s.isTexture&&T.removeReference(s)}}}A||(A=e.capabilities),L||(L=e.extensions);var a=P.get(t);a||(a=new WeakMap,a.useTimes=0,P.set(t,a)),a.useTimes++;var o=a.get(n);o&&o.materialDisposeCallback(),r.materialDisposeCallback=i,t._isShadowDepthMaterial?n.addEventListener("dispose",i):t.addEventListener("dispose",i),a.set(n,r),this.refresh(t,n);for(var s in r){var u=r[s];if(r.hasOwnProperty(s)&&u){var l=u.value;l&&l.isTexture&&T.addReference(l)}}A.isWebGL2?(O=B.LTC_FLOAT_1,R=B.LTC_FLOAT_2):!0===L.has("OES_texture_float_linear")?(O=B.LTC_FLOAT_1,R=B.LTC_FLOAT_2):!0===L.has("OES_texture_half_float_linear")?(O=B.LTC_HALF_1,R=B.LTC_HALF_2):console.error("WebGLUniforms: Unable to use RectAreaLight. Missing WebGL extensions.")},this.refresh=function(t,r,n){if(!n){n=P.get(t).get(r)}if(n&&(n.version!=t.version||0!=t.autoRefresh)){S.fog&&n.fogColor&&C.refreshFogUniforms(n,S.fog);var i=A.gl.canvas.height,a=e._pixelRatio;C.refreshMaterialUniforms(n,t,a,i),n.version=t.version}}}var a=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=a(e("M_110")),s=(a(e("M_33")),a(e("-_26")),a(e("3_27")),i);r.default=s},{M_33:5,"-_26":23,"3_27":35,M_0:241,M_110:245}],39:[function(e,t,r){"use strict";var n=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"CameraUtils",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(r,"GeometryUtils",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(r,"IEffect",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(r,"IRenderable",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(r,"MeshVisualizer",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(r,"polyfill",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(r,"RendererUtils",{enumerable:!0,get:function(){return c.default}}),r.default=void 0;var i=n(e("3_115")),a=n(e("D_116")),o=n(e("._117")),s=n(e("C_118")),u=n(e("o_119")),l=n(e("m_120")),c=n(e("M_121")),f={MeshVisualizer:u.default,polyfill:l.default,GeometryUtils:a.default,CameraUtils:i.default,IEffect:o.default,IRenderable:s.default,RendererUtils:c.default};r.default=f},{"3_115":1,D_116:2,"._117":3,C_118:4,o_119:5,M_121:6,m_120:7,M_0:241}],40:[function(e,t,r){"use strict";function n(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=i(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){u=!0,o=e},f:function(){try{s||null==r.return||r.return()}finally{if(u)throw o}}}}function i(e,t){if(e){if("string"==typeof e)return a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(e,t):void 0}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function o(e){function t(e){for(var t=-1,r=0;r<O.length;r++){if(O[r]==e){t=r;break}}return t}function r(e,t,r,n,i,a){if(y&&!y.isDestroyed()){var o;e instanceof f?(o=e,a=n,i=r,n=t):o=f.fromDegrees(e,t,r);var s=d.eastNorthUpToFixedFrame(o);E.constrainedAxis=f.UNIT_Z,E.lookAtTransform(s,new f(n,i,a)),setTimeout(function(){E.lookAtTransform(h.IDENTITY)},100)}}var i=this,a=Cesium,o=a.Camera,s=a.Viewer,f=a.Cartesian3,d=a.Transforms,h=a.Matrix4,p=a.Rectangle,m=a.TileProviderError,v=e.container,g=e.viewBox;g=g||[70,-1,140,60],o.DEFAULT_VIEW_RECTANGLE=g?p.fromDegrees(g[0],g[1],g[2],g[3]):new p(1.28283693362122,.05999788534537946,2.3577393069441595,.9348140736573897);var y=new s(v,e),_=y.homeButton,b=y.baseLayerPicker,M=y.scene,x=y.entities,w=y.imageryLayers,S=y.postProcessStages,T=M.globe,C=M.primitives,E=M.camera;if(b){var A=b.viewModel.imageryProviderViewModels;v=y.container,b.viewModel.selectedImagery=A[A.length-1]}S.fxaa.enabled=!0,M.highDynamicRangeSupported&&e.highDynamicRange&&(M.highDynamicRange=!0);var L=null,P=[],O=[];this.look=r,this.flyTo=function(e,t){if(e)return e.boundingSphere?y.camera.flyToBoundingSphere(e.boundingSphere,t):e instanceof Cesium.Rectangle||e instanceof Cesium.Cartesian3?y.camera.flyTo(Object.assign(t||{},{destination:e})):e?y.flyTo(e,t):void 0},this.addLocalScene=function(e){return e=e instanceof u.default?e:new u.default(e),e.init(y.scene.frameState),M.primitives.add(e),P.push(e),e},this.removeLocalScene=function(e){if(e){var t=P.indexOf(e);-1!==t&&(M.primitives.remove(e),P.splice(t,1))}},this.addLayer=function(e){return t(e)>=0?void console.warn("图层 `"+e.name+"` 已经存在，不能重复添加。"):(e.load(this),O.push(e),e)},this.removeLayer=function(e){var r=t(e);return-1!=r&&(O.splice(r,1),e.unload(this),!0)},this.addImageryLayer=function(e){return e instanceof l.default||(e=new l.default(e)),this.addLayer(e),(0,c.default)(w),e},this.removeImageryLayer=function(e){this.removeLayer(e)&&(0,c.default)(w)},this.updateOrder=function(){(0,c.default)(w)},this.onHomeClick=new Cesium.Event,_.viewModel.command.beforeExecute.addEventListener(function(e){i.onHomeClick.raiseEvent(e)});var R=m.handleError;m.handleError=function(e,t,r,n,i,a,o,s,u){"VectorTileImageryProvider"!=t.constructor.name&&R(e,t,r,n,i,a,o,s,u)};var I=new Cesium.Rectangle;Object.defineProperties(this,{maxTileLevel:{enumerable:!1,get:function(){var e,t=T._surface._tilesToRender,r=-1,i=n(t);try{for(i.s();!(e=i.n()).done;){var a=e.value;r=Math.max(a.level,r)}}catch(e){i.e(e)}finally{i.f()}return r}},viewRectangle:{enumerable:!1,get:function(){var e=T._surface._tilesToRender;0==e.length&&p.clone(p.MAX_VALUE,I),p.clone(e[0]._rectangle,I);for(var t=1;t<e.length;t++){var r=e[t];p.union(r._rectangle,I,I)}return I}},viewer:{enumerable:!1,get:function(){return y}},scene:{enumerable:!1,get:function(){return M}},globalScene:{enumerable:!1,get:function(){return L=new u.default,L.init(y.scene.frameState),L.useSunLight=!0,C.add(L),L}},localScenes:{enumerable:!1,get:function(){return P}},globe:{enumerable:!1,get:function(){return T}},layers:{enumerable:!1,get:function(){return O}},imageryLayers:{enumerable:!1,get:function(){return w}},entities:{enumerable:!1,get:function(){return x}},primitives:{enumerable:!1,get:function(){return C}},postProcessStages:{enumerable:!1,get:function(){return S}}})}var s=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var u=s(e("s_123")),l=s(e("h_124")),c=s(e("-_125")),f=o;r.default=f},{s_123:5,h_124:56,"-_125":58,M_0:241}],41:[function(e,t,r){"use strict";function n(e){e=e||{},this.inclinationRange=e.inclinationRange||[.4913,.5509],this.turbidityRange=e.turbidityRange||[.01,.2],this.rayleighRange=e.rayleighRange||[.12,2.4],this.enabled="boolean"!=typeof e.enabled||e.enabled}Object.defineProperty(r,"__esModule",{value:!0}),r.LocalSkyBoxAnimation=n,r.LocalSkyBox=void 0;var i=function e(t){function r(e,t){return"number"==typeof e?e:t}t=t||{};var i=THREE,a=i.BoxBufferGeometry,o=i.Mesh,s=i.ShaderMaterial,u=i.Vector3,l=i.WebGLCubeRenderTarget,c=i.CubeCamera,f=i.MathUtils,d=Cesium,h=d.JulianDate,p=d.Event,m=e.SkyShader,v=new s({name:"SkyShader",fragmentShader:m.fragmentShader,vertexShader:m.vertexShader,uniforms:{turbidity:{value:r(t.turbidity,2)},rayleigh:{value:r(t.rayleigh,1)},mieCoefficient:{value:r(t.mieCoefficient,.005)},mieDirectionalG:{value:r(t.mieDirectionalG,.8)},sunPosition:{value:new u},up:{value:new u(0,1,0)}},side:1,depthWrite:!1}),g=t.inclination,y=t.azimuth,_=t.lockCesiumSun,b=t.animation,M=!0;"boolean"==typeof b&&b&&(b=new n);var x=new o(new a(1,1,1),v);x.modelMatrixNeedsUpdate=!1,x.frustumCulled=!1;var w,S,T,C=new u,E=new l(512,{generateMipmaps:!0,minFilter:1008}),A=new c(.1,1,E);this.update=function(){var e=w;if(e){var t=Math,r=e.renderer;if(_){C.copy(e.sunDirectionLC);var n=t.acos(C.x),i=t.sin(n);0!=i&&(i=f.clamp(C.y/i,-1,1),i=t.asin(i)),g=i/t.PI+.5,y=n/(2*t.PI)+.5,this.sunPositionChanged.raiseEvent(this)}else{var a=t.PI*(g-.5),o=2*t.PI*(y-.5);C.x=t.cos(o),C.y=t.sin(o)*t.sin(a),C.z=t.sin(o)*t.cos(a)}b&&(b.update(this),this.animationTick.raiseEvent(this)),L.sunPosition.value.copy(C),A.update(r,x)}},this.load=function(e){var t=this;w=e,e.background=E.texture,e.backgroundIsSkybox=!0,e.backgroundVisibleDistance=1e4,e.environment=e.background,this.update(e),S=e.beforeUpdate.addEventListener(function(e){(M||!T||_&&!h.equals(T,e.time))&&(t.update(),M=!1,T=h.clone(e.time,T))})},this.unload=function(){S&&(w.background=null,w.environment=null,w.backgroundIsSkybox=!1,w=null,T=null,S())},this.animationTick=new p,this.sunPositionChanged=new p;var L=v.uniforms;Object.defineProperties(this,{texture:{get:function(){return E.texture}},lockCesiumSun:{get:function(){return _},set:function(e){_=e,M=!0}},inclination:{get:function(){return g},set:function(e){g=e,M=!0}},azimuth:{get:function(){return y},set:function(e){y=e,M=!0}},turbidity:{get:function(){return L.turbidity.value},set:function(e){L.turbidity.value=e,M=!0}},rayleigh:{get:function(){return L.rayleigh.value},set:function(e){L.rayleigh.value=e,M=!0}},mieCoefficient:{get:function(){return L.mieCoefficient.value},set:function(e){L.mieCoefficient.value=e,M=!0}},mieDirectionalG:{get:function(){return L.mieDirectionalG.value},set:function(e){L.mieDirectionalG.value=e,M=!0}},sunPosition:{get:function(){return L.sunPosition.value},set:function(e){L.sunPosition.value.copy(e),M=!0}},animation:{get:function(){return b&&b.enabled},set:function(e){b&&b.enabled!=e&&(b.enabled=e,M=!0)}}})};r.LocalSkyBox=i,i.SkyShader={vertexShader:["uniform vec3 sunPosition;","uniform float rayleigh;","uniform float turbidity;","uniform float mieCoefficient;","uniform vec3 up;","varying vec3 vWorldPosition;","varying vec3 vSunDirection;","varying float vSunfade;","varying vec3 vBetaR;","varying vec3 vBetaM;","varying float vSunE;","const float e = 2.71828182845904523536028747135266249775724709369995957;","const float pi = 3.141592653589793238462643383279502884197169;","const vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );","const vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );","const float v = 4.0;","const vec3 K = vec3( 0.686, 0.678, 0.666 );","const vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );","const float cutoffAngle = 1.6110731556870734;","const float steepness = 1.5;","const float EE = 1000.0;","float sunIntensity( float zenithAngleCos ) {","\tzenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );","\treturn EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );","}","vec3 totalMie( float T ) {","\tfloat c = ( 0.2 * T ) * 10E-18;","\treturn 0.434 * c * MieConst;","}","void main() {","\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );","\tvWorldPosition = worldPosition.xyz;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","\tgl_Position.z = gl_Position.w;","\tvSunDirection = normalize( sunPosition );","\tvSunE = sunIntensity( dot( vSunDirection, up ) );","\tvSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );","\tfloat rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );","\tvBetaR = totalRayleigh * rayleighCoefficient;","\tvBetaM = totalMie( turbidity ) * mieCoefficient;","}"].join("\n"),
fragmentShader:["varying vec3 vWorldPosition;","varying vec3 vSunDirection;","varying float vSunfade;","varying vec3 vBetaR;","varying vec3 vBetaM;","varying float vSunE;","uniform float mieDirectionalG;","uniform vec3 up;","const vec3 cameraPos = vec3( 0.0, 0.0, 0.0 );","const float pi = 3.141592653589793238462643383279502884197169;","const float n = 1.0003;","const float N = 2.545E25;","const float rayleighZenithLength = 8.4E3;","const float mieZenithLength = 1.25E3;","const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;","const float THREE_OVER_SIXTEENPI = 0.05968310365946075;","const float ONE_OVER_FOURPI = 0.07957747154594767;","float rayleighPhase( float cosTheta ) {","\treturn THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );","}","float hgPhase( float cosTheta, float g ) {","\tfloat g2 = pow( g, 2.0 );","\tfloat inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );","\treturn ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );","}","void main() {","\tvec3 direction = normalize( vWorldPosition - cameraPos );","\tfloat zenithAngle = acos( max( 0.0, dot( up, direction ) ) );","\tfloat inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );","\tfloat sR = rayleighZenithLength * inverse;","\tfloat sM = mieZenithLength * inverse;","\tvec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );","\tfloat cosTheta = dot( direction, vSunDirection );","\tfloat rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );","\tvec3 betaRTheta = vBetaR * rPhase;","\tfloat mPhase = hgPhase( cosTheta, mieDirectionalG );","\tvec3 betaMTheta = vBetaM * mPhase;","\tvec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );","\tLin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );","\tfloat theta = acos( direction.y ); // elevation --\x3e y-axis, [-pi/2, pi/2]","\tfloat phi = atan( direction.z, direction.x ); // azimuth --\x3e x-axis [-pi/2, pi/2]","\tvec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );","\tvec3 L0 = vec3( 0.1 ) * Fex;","\tfloat sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );","\tL0 += ( vSunE * 19000.0 * Fex ) * sundisk;","\tvec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );","\tvec3 retColor = pow( texColor, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );","\tgl_FragColor = vec4( retColor, 1.0 );","#include <tonemapping_fragment>","#include <encodings_fragment>","}"].join("\n")},n.prototype.update=function(e){if(this.enabled){var t=e.inclination,r=this.inclinationRange[1]-this.inclinationRange[0],n=(t-this.inclinationRange[0])/r;n>1?n=1:n<0&&(n=0);var i=this.turbidityRange[1]-(this.turbidityRange[1]-this.turbidityRange[0])*n;e.turbidity=i,e.rayleigh=this.rayleighRange[1]-(this.rayleighRange[1]-this.rayleighRange[0])*n}}},{}],42:[function(e,t,r){"use strict";function n(e){var t=i();return function(){var r,n=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,l.default)(this,r)}}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var a=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=a(e("e_1")),s=a(e("s_2")),u=a(e("C_129")),l=a(e("o_130")),c=a(e("m_131")),f=a(e("M_132")),d=function(e){function t(e){var n;return(0,o.default)(this,t),n=r.call(this,e),n.options=e,n}(0,u.default)(t,e);var r=n(t);return(0,s.default)(t,[{key:"generateExtrudedUvNormal",get:function(){return this.options.generateExtrudedUvNormal},set:function(e){this.options.generateExtrudedUvNormal=e}}],[{key:"createGeometry",value:function(e){var t=Cesium.PolygonGeometry;return e=e.options.generateExtrudedUvNormal?this.createGeometryWithExtrudedUvNormal(e):t.createGeometry(e)}},{key:"createGeometryWithExtrudedUvNormal",value:function(e){var t=Cesium,r=t.PolygonGeometry,n=(t.GeometryAttribute,t.ComponentDatatype,t.Cartesian3,t.Cartesian2,t.Geometry,t.Cartographic,t.Ellipsoid,t.BoundingSphere,t.PrimitiveType,t.Math.EPSILON5,e.options.height||0),i=r.createGeometry(e);return i=this.createExtrudedUvNormal(i,n)}},{key:"createExtrudedUvNormal",value:function(e,t,r,n,i,a){t=t||0;var o=Cesium,s=o.GeometryAttribute,u=o.ComponentDatatype,l=o.Cartesian3,c=o.Cartesian2,d=o.Geometry,h=o.Cartographic,p=o.Ellipsoid,m=o.BoundingSphere,v=(o.PrimitiveType,o.defaultValue),g=o.Math.EPSILON5,y=f.default.cloneGeometryAttributes(e.attributes),_=e.indices,b=e.attributes,M=l.unpackArray(b.position.values),x=l.unpackArray(b.normal.values),w=c.unpackArray(b.st.values);i=v(i,!0),a=v(a,!0);for(var S=new h,T=new h,C=new h,E=p.WGS84,A=[],L=[],P=[],O=[],R=[],I=0;I<_.length;I+=3){var D=_[I],B=_[I+1],U=_[I+2],N=M[D],k=M[B],j=M[U],G=x[D],V=x[B],F=x[U],z=w[D],H=w[B],W=w[U];h.fromCartesian(N,E,S),h.fromCartesian(k,E,T),h.fromCartesian(j,E,C),A.push(N,k,j),L.push(G,V,F),P.push(z,H,W),z=z.clone(),H=H.clone(),W=W.clone(),O.push(z,H,W);var Y={cartographic:[S,T,C],position:[N,k,j],st:[z,H,W],normal:[0,0,0]},X=[],q=[];if(S.height-t>=g?X.push(0):q.push(0),T.height-t>=g?X.push(1):q.push(1),C.height-t>=g?X.push(2):q.push(2),2==X.length){var K=X[0],Z=X[1],J=q[0];if(z=Y.st[K],H=Y.st[Z],W=Y.st[J],r){S=Y.cartographic[K],T=Y.cartographic[Z],C=Y.cartographic[J],N=Y.position[K],k=Y.position[Z],j=Y.position[J];var Q=S.height-t,$=l.distance(N,k);z.x=0,H.x=r.x?1*$/r.x:1,W.x=0,z.y=r.y?1*Q/r.y:1,H.y=r.y?1*Q/r.y:1,W.y=0}else z.x=0,H.x=1,W.x=0,z.y=1,H.y=1,W.y=0}else if(2==q.length){var ee=q[0],te=q[1],re=X[0];if(z=Y.st[ee],H=Y.st[te],W=Y.st[re],r){S=Y.cartographic[ee],T=Y.cartographic[te],C=Y.cartographic[re],N=Y.position[ee],k=Y.position[te],j=Y.position[re];var Q=C.height-t,$=l.distance(N,k);z.x=0,H.x=r.x?1*$/r.x:1,W.x=r.x?1*$/r.x:1,z.y=0,H.y=0,W.y=r.y?1*Q/r.y:1}else z.x=0,H.x=1,W.x=1,z.y=0,H.y=0,W.y=1}else if(a&&3==q.length)Y.normal.fill(-1),z.x=0,H.x=0,W.x=0,z.y=0,H.y=0,W.y=0;else if(i)if(Y.normal.fill(1),r){var ne=r.y?(S.height-t)/r.y:1;z.x=1,H.x=1,W.x=1,z.y=1*ne,H.y=1*ne,W.y=1*ne}else z.x=1,H.x=1,W.x=1,z.y=1,H.y=1,W.y=1;R.push(Y.normal[0],Y.normal[1],Y.normal[2])}if(A=l.packArray(A,new Float32Array(3*A.length)),L=l.packArray(L,new Float32Array(3*L.length)),P=c.packArray(P,new Float32Array(2*P.length)),R=new Int8Array(R),O=c.packArray(O,new Float32Array(2*O.length)),r&&n)for(var ie=0;ie<O.length;ie++)O[ie]=function(e){return Math.abs(e)<1||e%1==0?e:Math.abs(e)%1<.5?Math.floor(e):Math.ceil(e)}(O[ie]);return y.position.values=A,y.normal.values=L,y.st.values=P,y.extrudedNormal=new s({componentDatatype:u.BYTE,componentsPerAttribute:1,values:R,normalize:!1}),y.extrudedUv=new s({componentDatatype:u.FLOAT,componentsPerAttribute:2,values:O,normalize:!1}),e=new d({attributes:y,primitiveType:4,boundingSphere:m.fromVertices(A)})}}]),t}(Cesium.PolygonGeometry);r.default=d},{M_132:2,e_1:235,s_2:236,m_131:239,C_129:240,M_0:241,o_130:242}],43:[function(e,t,r){"use strict";function n(e,t,r,n,i){for(var a=Cesium,o=a.Cartesian3,s=a.PolygonHierarchy,u=a.PolygonGeometry,l=e[0].map(function(e){return o.fromDegrees(e[0],e[1])}),c=[],f=1;f<e.length;f++){var d=e[f].map(function(e){return o.fromDegrees(e[0],e[1])});c.push(new new s(d))}"boolean"!=typeof i&&(i=!0);var h=new u({polygonHierarchy:new s(l,c),extrudedHeight:r,height:t,arcType:Cesium.ArcType.RHUMB,granularity:.1*Cesium.Math.RADIANS_PER_DEGREE,closeTop:i,closeBottom:i}),p=u.createGeometry(h);if(n){var m=p.attributes.position.values,v=n.generate(m);v.length/2==m.length/3?p.attributes.st.values=new Float32Array(v):console.warn("返回的uv与顶点数量不一致")}return p}function i(e,t,r,a,o){var s=e.type;if("Polygon"==s)e=n(e.coordinates,t,r,a,o);else if("MultiPolygon"==s){var l=e.coordinates.map(function(e){return n(e,t,r,a,o)});e=u.default.mergeGeometries(l)}else if("MultiGeometry"==s){var c=e.geometry.map(function(e){return i(e,t,r,a,o)});e=u.default.mergeGeometries(c)}return e}var a=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=a(e("e_1")),s=a(e("s_2")),u=a(e("M_132")),l=function(){function e(t,r,n,i){(0,o.default)(this,e),this.geojsonGeometry=t,this.height=r,this.extrudedHeight=n,this.uvGenerator=i}return(0,s.default)(e,null,[{key:"createGeometry",value:function(e){return i(e.geojsonGeometry,e.height,e.extrudedHeight,e.uvGenerator)}},{key:"fromFeature",value:function(e,t,r,n,a){if(e.geometry){return i(e.geometry,t,r,n,a)}}},{key:"fromFeatures",value:function(e,t,r,n){for(var a=[],o=0;o<e.length;o++){var s=e[o];if(s.geometry){var l=i(s.geometry,t,r,n);a.push(l)}}var l=u.default.mergeGeometries(a);return l}}]),e}();r.default=l},{M_132:2,e_1:235,s_2:236,M_0:241}],44:[function(e,t,r){"use strict";function n(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(n=function(e){return e?r:t})(e)}function i(e,t,r,n){for(var i=e.geometry.coordinates,a=(0,l.default)(e,t/2,{units:"meters"}).geometry.coordinates,o=(0,l.default)(e,-t/2,{units:"meters"}).geometry.coordinates,s=[],c=[],f=[],d=0;d<i.length;d++){var h=i[d],p=a[d],m=o[d];s.push(Cesium.Cartesian3.fromDegrees(h[0],h[1],n?h[2]:void 0)),c.push(Cesium.Cartesian3.fromDegrees(p[0],p[1],n?h[2]:void 0)),f.push(Cesium.Cartesian3.fromDegrees(m[0],m[1],n?h[2]:void 0))}for(var v=[0],g=0,y=1;y<i.length;y++){var _=s[y-1],b=s[y];g+=Cesium.Cartesian3.distance(_,b),v.push(g)}g=r?r.x:g;for(var M=[],x=[],w=[],S=0;S<i.length;S++){var T=v[S]/g,b=c[S],C=f[S];M.push(T,0),M.push(T,1),x.push(b.x,b.y,b.z),x.push(C.x,C.y,C.z),w.push(c[S],f[S])}for(var E=[],A=1;A<i.length;A++){var L=2*(A-1),P=2*A-1,O=2*A,R=2*A+1,I=a[A-1],D=o[A-1],B=a[A],U=o[A];u.default.isClockWise([I,D,U,B])?E.push(L,R,P,L,O,R):E.push(R,L,P,R,O,L)}M=new Float32Array(M),x=new Float32Array(x);var N=new THREE.BufferGeometry;return N.setAttribute("position",new THREE.BufferAttribute(x,3,!1)),N.setAttribute("uv",new THREE.BufferAttribute(M,2,!1)),N.setIndex(E),s=[],c=[],f=[],N}var a=e("M_0"),o=e("M_110");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=a(e("M_132")),u=a(e("C_140")),l=a(e("o_141")),c=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==o(e)&&"function"!=typeof e)return{default:e};var r=n(t);if(r&&r.has(e))return r.get(e);var i={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var u=a?Object.getOwnPropertyDescriptor(e,s):null;u&&(u.get||u.set)?Object.defineProperty(i,s,u):i[s]=e[s]}return i.default=e,r&&r.set(e,i),i}(e("m_142")),f=a(e("M_143"));i.union=function(e,t){function r(e,r){var n=c.point(e),i=c.point(r),a={units:"kilometers"};return(0,f.default)(n,i,a)<=t}function n(e){return e.geometry.coordinates[0]}function i(e){var t=e.geometry.coordinates;return t[t.length-1]}function a(e,t,r,n){var i=e.geometry.coordinates.slice(),a=t.geometry.coordinates.slice();return r&&(a=a.reverse()),n&&(i=i.reverse()),i.pop(),{type:"Feature",geometry:{type:"LineString",coordinates:i.concat(a),properties:Object.assign({},e.properties,t.properties)}}}t="number"==typeof t?t:.01,t<0&&(t=0),t/=1e3;var o=e.slice(),s=[];do{for(var u=o.pop(),l=o.slice(),d=!1;l.length;){var h=l.pop(),p=!1;if(r(n(h),i(u))?(u=a(u,h),p=!0):r(i(h),n(u))?(u=a(h,u),p=!0):r(i(h),i(u))?(u=a(h,u,!0),p=!0):r(n(h),n(u))&&(u=a(h,u,!1,!0),p=!0),p){var m=o.indexOf(h);o.splice(m,1),d=!0}}d?o.push(u):s.push(u)}while(o.length);return s},i.fromFeature=function(e,t,r,n){if(e.geometry)return new i(e,t,r,n)},i.fromFeatures=function(e,t,r){var n=[];try{var a=r.union,o=r.unionEpsilon,u=r.uvUnit,l=r.clampToGround;a&&(e=this.union(e,o));for(var c=0;c<e.length;c++){var f=new i(e[c],t,u,l);n.push(f)}var d=s.default.mergeGeometries3js(n);return d.computeVertexNormals(),d.computeBoundingSphere(),d}catch(e){console.error(e)}};var d=i;r.default=d},{M_143:213,m_142:214,o_141:216,M_132:2,C_140:199,M_0:241,M_110:245}],45:[function(e,t,r){"use strict";function n(e,t,r,n,i){this.id=i,n=n||[0,0,0,0],this.position=new THREE.Vector3(e,t,r),this.center=(new THREE.Vector4).fromArray(n),this.edges=[],this.onSharedLine=!1}function i(e,t,r){this.id=r,this.v1=e,this.v2=t,this.isShared=!1,this.triangles=[]}function a(e,t,r){this.a=e,this.b=t,this.c=r,this.normal=null,this.edges=[],this.vertices=[e,t,r]}function o(e,t){function r(e,t){h.fromBufferAttribute(o,e);var r=h.x,n=h.y,i=h.z;c.push(r,n,i),d.push(t[0],t[1],t[2],t[3])}if(t)return new s(e);var n=THREE,i=n.BufferGeometry,a=n.BufferAttribute;e.isGeometry&&(e=(new i).fromGeometry(e));for(var o=e.attributes.position,u=l.default.genGeometryIndicesAll(e),c=[],d=[],h=new THREE.Vector3,p=0;p<u.length;p+=3){var m=u[p],v=u[p+1],g=u[p+2];r(m,f[0]),r(v,f[1]),r(g,f[2])}return c=new Float32Array(c),d=new Float32Array(d),e=new THREE.BufferGeometry,e.setAttribute("position",new a(c,3,!1)),e.setAttribute("center",new a(d,4,!1)),e}function s(e){function t(e,t){var r=e.position,n=r.x,i=r.y,a=r.z;m.push(n,i,a),v.push(t[0],t[1],t[2],t[3])}function r(e,t){var r=3*e,i=h[r],a=h[r+1],o=h[r+2],s=i+","+a+","+o,u=M.get(s);return void 0==u&&(u=new n(i,a,o,t,b.length),b.push(u),M.set(s,u)),u}function o(e,t,r){var n=e.id,a=t.id,o=e,s=t,u=n>a?[a,e]:[e,t];n>a?(s=e,o=t,u=[a,n].join(",")):u=[n,a].join(",");var l=_.get(u);return void 0==l&&(l=new i(o,s,y.length),y.push(l),o.edges.push(l),s.edges.push(l),_.set(u,l)),l.triangles.push(r),r.edges.push(l),l}var s=THREE,u=s.BufferGeometry,d=s.BufferAttribute;e.isGeometry&&(e=(new u).fromGeometry(e));for(var h=e.attributes.position.array,p=l.default.genGeometryIndicesAll(e),m=[],v=[],g=[],y=[],_=new Map,b=[],M=new Map,x=0;x<p.length;x+=3){var w=p[x],S=p[x+1],T=p[x+2];!function(e,t,n){e=r(e,[1,0,0,0]),t=r(t,[0,1,0,0]),n=r(n,[0,0,1,0]);var i=new a(e,t,n);o(e,t,i),o(t,n,i),o(n,e,i),g.push(i)}(w,S,T)}for(var C=new THREE.Vector3,E=0;E<y.length;E++){var A=y[E],L=A.triangles;if(L.length>1){var P=!0;L.forEach(function(e){if(!e.normal){var t=e.a,r=e.b,n=e.c;t=t.position,r=r.position,n=n.position,l.default.computeNormal(t,r,n,C,!1),e.normal=C.clone()}});for(var O=L[0].normal,R=1;R<L.length;R++){var I=L[R];if(O.angleTo(I.normal)>1){P=!1;break}}P&&(A.isShared=!0)}}for(var D=[],B=0;B<y.length;B++){var U=y[B];if(U.isShared){D.length=0;var N=!1,g=U.triangles;if(g.forEach(function(e){e._done&&(N=!0)}),N)continue;g.forEach(function(e){e.vertices.forEach(function(e){var r=D.indexOf(e);-1==r&&(r=D.length,D.push(e)),t(e,c[r])}),e._done=!0})}}for(var k=0;k<g.length;k++){var j=g[k];if(!j._done){var w=j.a,S=j.b,T=j.c;t(w,f[0]),t(S,f[1]),t(T,f[2])}}return m=new Float32Array(m),v=new Float32Array(v),e=new THREE.BufferGeometry,e.setAttribute("position",new d(m,3,!1)),e.setAttribute("center",new d(v,4,!1)),e}var u=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=o;var l=u(e("M_132")),c=[[1,0,0,1],[1,1,0,1],[0,0,0,1],[0,1,0,1]],f=[[1,0,0,0],[0,1,0,0],[0,0,1,0]]},{M_132:2,M_0:241}],46:[function(e,t,r){"use strict";function n(e,t,r){this.contour=e||[],this.holes=t||[],this.height=r||0}function i(e,t){var r=THREE,n=r.BufferGeometry,i=r.BufferAttribute,a=new Float32Array(3*e.length),o=0;e.forEach(function(e){a[o++]=e.x,a[o++]=e.y,a[o++]=e.z});var s=new n;return s.setAttribute("position",new i(a,3,!1)),s.setIndex(t),s.computeVertexNormals(),s}function a(e,t,r,n){for(var i=THREE.Vector3,a=e[0],o=[],s=1;s<e.length;s++)o.push(e[s]);a=a.map(function(e){return Array.isArray(e)?new i(e[0],e[1],t):e}),o=o.map(function(e){return e.map(function(e){return Array.isArray(e)?new i(e[0],e[1],t):e})}),u(a,o,r,n)}var o=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=o(e("M_132")),u=s.default.triangulateShape;n.createGeometry=function(e){var t=THREE.Vector3,r=e.contour,n=e.holes,a=e.height,o=[],s=[];return r=r.map(function(e){return Array.isArray(e)?new t(e[0],e[1],a):e}),n=n.map(function(e){return e.map(function(e){return Array.isArray(e)?new t(e[0],e[1],a):e})}),u(r,n,o,s),i(o,s)},n.fromFeature=function(e,t){var r=[],n=[];if(t=t||.01,e.geometry){var o=e.geometry,s=o.type,u=o.coordinates;if("Polygon"==s?a(u,t,r,n):"MultiPolygon"==s&&u.forEach(function(e){a(e,t,r,n)}),r.length)return i(r,n)}},n.fromFeatures=function(e,t){var r=[],n=[];if(t=t||.01,e.forEach(function(e){if(e.geometry){var i=e.geometry,o=i.type,s=i.coordinates;"Polygon"==o?a(s,t,r,n):"MultiPolygon"==o&&s.forEach(function(e){a(e,t,r,n)})}}),r.length)return i(r,n)};var l=n;r.default=l},{M_132:2,M_0:241}],47:[function(e,t,r){"use strict";function n(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(n=function(e){return e?r:t})(e)}function i(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==o(e)&&"function"!=typeof e)return{default:e};var r=n(t);if(r&&r.has(e))return r.get(e);var i={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var u=a?Object.getOwnPropertyDescriptor(e,s):null;u&&(u.get||u.set)?Object.defineProperty(i,s,u):i[s]=e[s]}return i.default=e,r&&r.set(e,i),i}var a=e("M_0"),o=e("M_110");Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"Earth",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(r,"GeoPolygonGeometry",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(r,"GeoPolylineGeometry",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(r,"ExtrudedPolygonGeometry",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(r,"SolidWireframeGeometry",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(r,"VectorPolygonGeometry",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(r,"SolidWireframeMaterial",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(r,"TiandituLayer",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(r,"TiandituImgLayer",{enumerable:!0,get:function(){return p.TiandituImgLayer}}),Object.defineProperty(r,"TiandituTerLayer",{enumerable:!0,get:function(){return p.TiandituTerLayer}}),Object.defineProperty(r,"TiandituVecLayer",{enumerable:!0,get:function(){return p.TiandituVecLayer}}),Object.defineProperty(r,"C3DTilesLayer",{enumerable:!0,get:function(){return m.default}}),Object.defineProperty(r,"OsgbLayer",{enumerable:!0,get:function(){return v.default}}),Object.defineProperty(r,"GeoMesh",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(r,"GeoPolygonMesh",{enumerable:!0,get:function(){return y.default}}),Object.defineProperty(r,"GeoPolylineMesh",{enumerable:!0,get:function(){return _.default}}),Object.defineProperty(r,"GeoWaterMesh",{enumerable:!0,get:function(){return b.default}}),Object.defineProperty(r,"Vector2dLayer",{enumerable:!0,get:function(){return M.default}}),Object.defineProperty(r,"HighlightPolygonLayer",{enumerable:!0,get:function(){return M.HighlightPolygonLayer}}),Object.defineProperty(r,"SealandVec2dLayer",{enumerable:!0,get:function(){return M.SealandVec2dLayer}}),Object.defineProperty(r,"HighlightMarkerLayer",{enumerable:!0,get:function(){return M.HighlightMarkerLayer}}),Object.defineProperty(r,"LabelVec2dLayer",{enumerable:!0,get:function(){return M.LabelVec2dLayer}}),Object.defineProperty(r,"CountryVec2dLayer",{enumerable:!0,get:function(){return M.CountryVec2dLayer}}),Object.defineProperty(r,"Vector3dLayer",{enumerable:!0,get:function(){return x.default}}),Object.defineProperty(r,"ImageTileLayer",{enumerable:!0,get:function(){return w.default}}),Object.defineProperty(r,"ILayer",{enumerable:!0,get:function(){return S.default}}),Object.defineProperty(r,"LocalSkyBox",{enumerable:!0,get:function(){return T.LocalSkyBox}}),Object.defineProperty(r,"LocalSkyBoxAnimation",{enumerable:!0,get:function(){return T.LocalSkyBoxAnimation}}),Object.defineProperty(r,"interactive",{enumerable:!0,get:function(){return C.default}}),Object.defineProperty(r,"getPoint",{enumerable:!0,get:function(){return C.getPoint}}),Object.defineProperty(r,"getLine",{enumerable:!0,get:function(){return C.getLine}}),Object.defineProperty(r,"getPolyline",{enumerable:!0,get:function(){return C.getPolyline}}),Object.defineProperty(r,"getRactangle",{enumerable:!0,get:function(){return C.getRactangle}}),Object.defineProperty(r,"pickPosition",{enumerable:!0,get:function(){return C.pickPosition}}),Object.defineProperty(r,"MeshVisualizer",{enumerable:!0,get:function(){return E.MeshVisualizer}}),Object.defineProperty(r,"polyfill",{enumerable:!0,get:function(){return E.polyfill}}),Object.defineProperty(r,"GeometryUtils",{enumerable:!0,get:function(){return E.GeometryUtils}}),Object.defineProperty(r,"CameraUtils",{enumerable:!0,get:function(){return E.CameraUtils}}),Object.defineProperty(r,"IEffect",{enumerable:!0,get:function(){return E.IEffect}}),Object.defineProperty(r,"IRenderable",{enumerable:!0,get:function(){return E.IRenderable}}),Object.defineProperty(r,"RendererUtils",{enumerable:!0,get:function(){return E.RendererUtils}}),Object.defineProperty(r,"MeshVisModel",{enumerable:!0,get:function(){return A.MeshVisModel}}),Object.defineProperty(r,"MeshVisModelUtil",{enumerable:!0,get:function(){return A.MeshVisModelUtil}}),Object.defineProperty(r,"releaseResources",{enumerable:!0,get:function(){return A.releaseResources}}),Object.defineProperty(r,"VISMLoader",{enumerable:!0,get:function(){return A.VISMLoader}}),Object.defineProperty(r,"OSGLoader",{enumerable:!0,get:function(){return A.OSGLoader}}),Object.defineProperty(r,"GLTFLoader",{enumerable:!0,get:function(){return A.GLTFLoader}}),Object.defineProperty(r,"DDSLoader",{enumerable:!0,get:function(){return A.DDSLoader}}),Object.defineProperty(r,"TGALoader",{enumerable:!0,get:function(){return A.TGALoader}}),Object.defineProperty(r,"BMPLoader",{enumerable:!0,get:function(){return A.BMPLoader}}),Object.defineProperty(r,"DRACOLoader",{enumerable:!0,get:function(){return A.DRACOLoader}}),Object.defineProperty(r,"RGBELoader",{enumerable:!0,get:function(){return A.RGBELoader}}),Object.defineProperty(r,"BmpDecoder",{enumerable:!0,get:function(){return A.BmpDecoder}}),Object.defineProperty(r,"Osg",{enumerable:!0,get:function(){return A.Osg}}),Object.defineProperty(r,"parseOsg",{enumerable:!0,get:function(){return A.parseOsg}}),Object.defineProperty(r,"readOsg",{enumerable:!0,get:function(){return A.readOsg}}),Object.defineProperty(r,"GLTFExporter",{enumerable:!0,get:function(){return A.GLTFExporter}}),Object.defineProperty(r,"DRACOExporter",{enumerable:!0,get:function(){return A.DRACOExporter}}),Object.defineProperty(r,"VISMExporter",{enumerable:!0,get:function(){return A.VISMExporter}}),Object.defineProperty(r,"PagedLOD",{enumerable:!0,get:function(){return A.PagedLOD}}),Object.defineProperty(r,"QuadtreeLOD",{enumerable:!0,get:function(){return A.QuadtreeLOD}}),Object.defineProperty(r,"QuadtreeLODUtil",{enumerable:!0,get:function(){return A.QuadtreeLODUtil}}),Object.defineProperty(r,"LODUtils",{enumerable:!0,get:function(){return A.LODUtils}}),Object.defineProperty(r,"QuadtreeNode",{enumerable:!0,get:function(){return A.QuadtreeNode}}),Object.defineProperty(r,"QuatreeContentSet",{enumerable:!0,get:function(){return A.QuatreeContentSet}}),Object.defineProperty(r,"BuildingVector3DLoader",{enumerable:!0,get:function(){return A.BuildingVector3DLoader}}),Object.defineProperty(r,"CameraHelper",{enumerable:!0,get:function(){return A.CameraHelper}}),Object.defineProperty(r,"computeArea",{enumerable:!0,get:function(){return L.computeArea}}),Object.defineProperty(r,"defineProperty",{enumerable:!0,get:function(){return L.defineProperty}}),Object.defineProperty(r,"determinant",{enumerable:!0,get:function(){return L.determinant}}),Object.defineProperty(r,"esExtends",{enumerable:!0,get:function(){return L.esExtends}}),Object.defineProperty(r,"GenericWorker",{enumerable:!0,get:function(){return L.GenericWorker}}),Object.defineProperty(r,"geojsonHelper",{enumerable:!0,get:function(){return L.geojsonHelper}}),Object.defineProperty(r,"ImageUtils",{enumerable:!0,get:function(){return L.ImageUtils}}),Object.defineProperty(r,"isTypedArray",{enumerable:!0,get:function(){return L.isTypedArray}}),Object.defineProperty(r,"lineBufferDir3",{enumerable:!0,get:function(){return L.lineBufferDir3}}),Object.defineProperty(r,"MathUtils",{enumerable:!0,get:function(){return L.MathUtils}}),Object.defineProperty(r,"matrix4LookAt",{enumerable:!0,get:function(){return L.matrix4LookAt}}),Object.defineProperty(r,"mergeBuffers",{enumerable:!0,get:function(){return L.mergeBuffers}}),Object.defineProperty(r,"parseDefines",{enumerable:!0,get:function(){return L.parseDefines}}),Object.defineProperty(r,"decodeGeojson",{enumerable:!0,get:function(){return L.decodeGeojson}}),Object.defineProperty(r,"decodeGeojsonAsync",{enumerable:!0,get:function(){return L.decodeGeojsonAsync}}),Object.defineProperty(r,"decodeGeojsonCoords",{enumerable:!0,get:function(){return L.decodeGeojsonCoords}}),Object.defineProperty(r,"decodeGeojsonCoordsAsync",{enumerable:!0,get:function(){return L.decodeGeojsonCoordsAsync}}),Object.defineProperty(r,"decodeObject",{enumerable:!0,get:function(){return L.decodeObject}}),Object.defineProperty(r,"encodeGeojson",{enumerable:!0,get:function(){return L.encodeGeojson}}),Object.defineProperty(r,"encodeGeojsonCoords",{enumerable:!0,get:function(){return L.encodeGeojsonCoords}}),Object.defineProperty(r,"encodeObject",{enumerable:!0,get:function(){return L.encodeObject}}),Object.defineProperty(r,"encodeObjectValues",{enumerable:!0,get:function(){return L.encodeObjectValues}}),Object.defineProperty(r,"Path",{enumerable:!0,get:function(){return L.Path}}),Object.defineProperty(r,"save",{enumerable:!0,get:function(){return L.save}}),Object.defineProperty(r,"saveArrayBuffer",{enumerable:!0,get:function(){return L.saveArrayBuffer}}),Object.defineProperty(r,"saveString",{enumerable:!0,get:function(){return L.saveString}}),Object.defineProperty(r,"stringToArrayBuffer",{enumerable:!0,get:function(){return L.stringToArrayBuffer}}),Object.defineProperty(r,"StringUtil",{enumerable:!0,get:function(){return L.StringUtil}}),Object.defineProperty(r,"triangulate",{enumerable:!0,get:function(){return L.triangulate}}),Object.defineProperty(r,"traverse",{enumerable:!0,get:function(){return L.traverse}}),Object.defineProperty(r,"getPaddedBuffer",{enumerable:!0,get:function(){return L.getPaddedBuffer}}),Object.defineProperty(r,"getPaddedBufferSize",{enumerable:!0,get:function(){return L.getPaddedBufferSize}});var s=a(e("._150")),u=a(e("C_151")),l=a(e("o_152")),c=a(e("m_153")),f=a(e("M_154")),d=a(e("e_155")),h=a(e("s_156")),p=i(e("h_157")),m=a(e("-_158")),v=a(e("3_159")),g=a(e("D_160")),y=a(e("._161")),_=a(e("C_162")),b=a(e("o_163")),M=i(e("m_164")),x=a(e("M_165")),w=a(e("h_124")),S=a(e("s_167")),T=e("h_168"),C=i(e("-_169")),E=e("3_170"),A=e("D_171"),L=e("._172")},{"3_170":39,D_171:187,"._172":209,"._150":40,h_168:41,m_153:42,C_151:43,o_152:44,M_154:45,e_155:46,"-_169":53,s_167:55,h_124:56,h_157:57,"-_158":59,D_160:60,"._161":61,C_162:62,o_163:63,"3_159":64,m_164:66,M_165:69,s_156:70,M_0:241,M_110:245}],48:[function(e,t,r){"use strict";function n(e,t,r){function n(t){return e.entities.add({position:new f(function(){return T[t]},!1),point:{show:new f(function(){return 0==t?T.length>0:T.length>1},!1),pixelSize:M,color:b,heightReference:p.CLAMP_TO_GROUND}})}function i(r){S[v]?y.setInputAction(S[v],v):y.removeInputAction(v),S[g]?y.setInputAction(S[g],g):y.removeInputAction(g),e.entities.remove(C);for(var n=0;n<E.length;n++)e.entities.remove(E[n]);if(!r){var i=[{polyline:{positions:T,clampToGround:!0,width:1.5,material:_}}];T=T.map(function(e){return i.push({position:e,point:{pixelSize:M,color:b,heightReference:p.CLAMP_TO_GROUND}}),m.fromCartesian(e)}),t(T,i)}E=C=null,S=T=null}function s(){i(!0)}var u;if(!t)throw new Error("缺少callback参数");r=r||{};var l=Cesium,c=l.ScreenSpaceEventType,f=l.CallbackProperty,d=l.Color,h=l.Cartesian3,p=l.HeightReference,m=l.Cartographic,v=c.LEFT_CLICK,g=c.MOUSE_MOVE,y=e.screenSpaceEventHandler,_=r.lineColor||d.DARKORANGE,b=r.pointColor||d.DARKORANGE,M=r.pointSize||8,x=r.onMove,w=r.onStart,S=(u={},(0,a.default)(u,v,y.getInputAction(v)),(0,a.default)(u,g,y.getInputAction(g)),u),T=[],C=e.entities.add({show:!1,polyline:{positions:new f(function(){return T},!1),show:new f(function(){return C.show&&T.length>1},!1),clampToGround:!0,width:1.5,material:_}}),E=[n(0),n(1)];return y.setInputAction(function(t){if(2==T.length)return i();var r=(0,o.default)(e.scene,t.position);r&&!h.equals(r,T[1])&&(0==T.length?(T[0]=r,w&&w(m.fromCartesian(r))):T[1]=r)},v),y.setInputAction(function(t){if(0!=T.length){var r=(0,o.default)(e.scene,t.endPosition);r&&!h.equals(r,T[1])&&(T[1]=r,C.show=!0,x&&x(T.map(function(e){return m.fromCartesian(e)})))}},g),s}var i=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=n;var a=i(e("e_45")),o=i(e("m_175"))},{m_175:54,e_45:237,M_0:241}],49:[function(e,t,r){"use strict";function n(e,t,r){function n(r){M[m]?g.setInputAction(M[m],m):g.removeInputAction(m),M[v]?g.setInputAction(M[v],v):g.removeInputAction(v),e.entities.remove(T),r||t(p.fromCartesian(x,S,w),{position:x,point:{pixelSize:y,color:f.fromAlpha(_,1),outlineColor:_,outlineWidth:1.5,outline:!0,heightReference:h.CLAMP_TO_GROUND}}),M=T=x=w=null}function i(){n(!0)}var s;if(!t)throw new Error("缺少callback参数");r=r||{};var u=Cesium,l=u.ScreenSpaceEventType,c=u.CallbackProperty,f=u.Color,d=u.Cartesian3,h=u.HeightReference,p=u.Cartographic,m=l.LEFT_CLICK,v=l.MOUSE_MOVE,g=e.screenSpaceEventHandler,y=r.pointSize||8,_=r.pointColor||f.DARKORANGE,b=r.onMove,M=(s={},(0,a.default)(s,m,g.getInputAction(m)),(0,a.default)(s,v,g.getInputAction(v)),s),x=new d,w=new p,S=e.scene.globe.ellipsoid,T=e.entities.add({position:new c(function(){return x},!1),show:!1,point:{pixelSize:y,color:f.fromAlpha(_,1),outlineColor:_,outlineWidth:1.5,outline:!0,heightReference:h.CLAMP_TO_GROUND}});return g.setInputAction(function(t){var r=(0,o.default)(e.scene,t.position);r&&(x=r,n())},m),g.setInputAction(function(t){var r=(0,o.default)(e.scene,t.endPosition);r&&(x=r,T.show=!0,b&&b(p.fromCartesian(x,S,w)))},v),i}var i=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=n;var a=i(e("e_45")),o=i(e("m_175"))},{m_175:54,e_45:237,M_0:241}],50:[function(e,t,r){"use strict";function n(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=i(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){u=!0,o=e},f:function(){try{s||null==r.return||r.return()}finally{if(u)throw o}}}}function i(e,t){if(e){if("string"==typeof e)return a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(e,t):void 0}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function o(e,t,r){function i(t,r){var n=e.entities.add({position:t,point:{pixelSize:w,color:x,heightReference:m.CLAMP_TO_GROUND}});L.push(n),C.push(t),r&&E.push(t)}function a(r){T[g]?b.setInputAction(T[g],g):b.removeInputAction(g),T[y]?b.setInputAction(T[y],y):b.removeInputAction(y),T[_]?b.setInputAction(T[_],_):b.removeInputAction(_),e.entities.remove(A);for(var i=0;i<L.length;i++)e.entities.remove(L[i]);if(!r){var a,o=[{polyline:{positions:C,clampToGround:!0,width:1.5,material:M}}],s=n(C);try{
for(s.s();!(a=s.n()).done;){var u=a.value;o.push({position:u,point:{pixelSize:w,color:x,heightReference:m.CLAMP_TO_GROUND}})}}catch(e){s.e(e)}finally{s.f()}t(E.map(function(e){return v.fromCartesian(e)}),o)}L=A=null,T=C=null}function o(){a(!0)}var s;if(!t)throw new Error("缺少callback参数");r=r||{};var c=Cesium,f=c.ScreenSpaceEventType,d=c.CallbackProperty,h=c.Color,p=c.Cartesian3,m=c.HeightReference,v=c.Cartographic,g=f.LEFT_CLICK,y=f.MOUSE_MOVE,_=f.LEFT_DOUBLE_CLICK,b=e.screenSpaceEventHandler,M=r.lineColor||h.DARKORANGE,x=r.pointColor||h.DARKORANGE,w=r.pointSize||8,S=r.onMove,T=(s={},(0,u.default)(s,g,b.getInputAction(g)),(0,u.default)(s,y,b.getInputAction(y)),(0,u.default)(s,_,b.getInputAction(_)),s),C=[],E=[],A=e.entities.add({show:!1,polyline:{positions:new d(function(){return C},!1),show:new d(function(){return A.show&&C.length>1},!1),clampToGround:!0,width:1.5,material:M}}),L=[];return b.setInputAction(function(t){var r=(0,l.default)(e.scene,t.position);!r||1==C.length&&p.equals(r,C[C.length-1])||i(r,!0)},g),b.setInputAction(function(t){if(0!=C.length){var r=(0,l.default)(e.scene,t.endPosition);!r||1==C.length&&p.equals(r,C[C.length-1])||(E.length==C.length?i(r,!1):C[C.length-1]=r,S&&S(C.map(function(e){return v.fromCartesian(e)})),A.show=!0)}},y),b.setInputAction(function(){return a()},_),o}var s=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=o;var u=s(e("e_45")),l=s(e("m_175"))},{m_175:54,e_45:237,M_0:241}],51:[function(e,t,r){"use strict";function n(e,t,r){function n(t){return e.entities.add({position:new h(function(){return A[t]},!1),point:{show:new h(function(){return 0==t?A.length>0||E.length>0:A.length>1},!1),pixelSize:w,color:x,outlineColor:x,outlineWidth:1.5,outline:!0,heightReference:g.CLAMP_TO_GROUND}})}function i(){A=(0,o.default)(C),A.push(A[0]),m.fromCartographicArray(E,C)}function u(r){T[y]?b.setInputAction(T[y],y):b.removeInputAction(y),T[_]?b.setInputAction(T[_],_):b.removeInputAction(_),e.entities.remove(L);for(var n=0;n<P.length;n++)e.entities.remove(P[n]);r||t(C),P=C=L=null,T=E=A=null}function l(){u(!0)}var c;if(!t)throw new Error("缺少callback参数");r=r||{};var f=Cesium,d=f.ScreenSpaceEventType,h=f.CallbackProperty,p=f.Color,m=f.Rectangle,v=f.Cartographic,g=f.HeightReference,y=d.LEFT_CLICK,_=d.MOUSE_MOVE,b=(d.LEFT_DOUBLE_CLICK,e.screenSpaceEventHandler),M=r.areaColor||p.DARKORANGE,x=r.pointColor||p.DARKORANGE,w=r.pointSize||8,S=r.onMove,T=(c={},(0,a.default)(c,y,b.getInputAction(y)),(0,a.default)(c,_,b.getInputAction(_)),c),C=new m,E=[],A=[],L=e.entities.add({show:!1,rectangle:{coordinates:new h(function(){return C},!1),outline:!0,fill:!0,material:p.fromAlpha(M,.15),show:new h(function(){return L.show&&A.length>2},!1)},polyline:{positions:new h(function(){return A},!1),show:new h(function(){return L.show&&A.length>2},!1),clampToGround:!0,width:1.5,material:M}}),P=[n(0),n(1),n(2),n(3)];return b.setInputAction(function(t){if(2==E.length)return E.length=0,u();var r=(0,s.default)(e.scene,t.position);r&&(r=v.fromCartesian(r))&&!v.equals(r,E[1])&&(0==E.length?(A.length=0,E[0]=r,A[0]=Cesium.Cartesian3.fromRadians(r.longitude,r.latitude,r.height)):(E[1]=r,i()))},y),b.setInputAction(function(t){if(0!=E.length){var r=(0,s.default)(e.scene,t.endPosition);r&&(r=v.fromCartesian(r))&&!v.equals(r,E[1])&&(E[1]=r,L.show=!0,i(),S&&S(C))}},_),l}var i=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=n;var a=i(e("e_45")),o=i(e("C_184")),s=i(e("m_175"))},{C_184:52,m_175:54,e_45:237,M_0:241}],52:[function(e,t,r){"use strict";function n(e){return[Cesium.Rectangle.northwest(e),Cesium.Rectangle.southwest(e),Cesium.Rectangle.southeast(e),Cesium.Rectangle.northeast(e)].map(function(e){return Cesium.Cartesian3.fromRadians(e.longitude,e.latitude,e.height)})}Object.defineProperty(r,"__esModule",{value:!0}),r.default=n},{}],53:[function(e,t,r){"use strict";var n=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"getLine",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(r,"getPoint",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(r,"getPolyline",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(r,"getRactangle",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(r,"pickPosition",{enumerable:!0,get:function(){return u.default}}),r.default=void 0;var i=n(e("M_187")),a=n(e("e_188")),o=n(e("s_189")),s=n(e("h_190")),u=n(e("m_175")),l={getPoint:a.default,getLine:i.default,getPolyline:o.default,getRactangle:s.default,pickPosition:u.default};r.default=l},{M_187:48,e_188:49,s_189:50,h_190:51,m_175:54,M_0:241}],54:[function(e,t,r){"use strict";function n(e,t,r){var n=Cesium,a=n.Ray,o=n.Cartesian3,s=n.EllipsoidTerrainProvider;return i||(i=new a),r||(r=new o),(!e.pickPositionSupported||!e.globe.depthTestAgainstTerrain||e.terrainProvider instanceof s)&&e.camera.getPickRay(t,i)?e.globe.pick(i,e,r):e.pickPosition(t,r)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=n;var i},{}],55:[function(e,t,r){"use strict";var n=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("e_1")),a=n(e("s_2")),o=(n(e("C_195")),function(){function e(t){(0,i.default)(this,e),t=t||{};var r=Cesium,n=r.defaultValue;this.name=n(t.name,"未命名图层"+ ++e.NumUnName),this.parent=n(t.parent,null),this.zIndex=n(t.zIndex,1),this.provider=n(t.provider,null),this._show=n(t.show,!0)}return(0,a.default)(e,[{key:"show",get:function(){return this._show},set:function(e){this._show=e}},{key:"load",value:function(e){}},{key:"unload",value:function(e){}}]),e}());r.default=o,o.NumUnName=0},{C_195:40,e_1:235,s_2:236,M_0:241}],56:[function(e,t,r){"use strict";function n(e){var t=i();return function(){var r,n=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,l.default)(this,r)}}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var a=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=a(e("e_1")),s=a(e("s_2")),u=a(e("C_129")),l=a(e("o_130")),c=a(e("m_131")),f=a(e("-_202")),d=function(e){function t(e){var n;return(0,o.default)(this,t),n=r.call(this,e),n._imageryLayer=null,n}(0,u.default)(t,e);var r=n(t);return(0,s.default)(t,[{key:"show",get:function(){return this._show},set:function(e){this._show=e,this._imageryLayer&&(this._imageryLayer.show=e)}},{key:"load",value:function(e){if(!this.provider)throw new Error("ImageTileLayer#provider is required.");var t=e.imageryLayers;this.provider.zIndex=this.zIndex,this._imageryLayer=t.addImageryProvider(this.provider)}},{key:"unload",value:function(e){if(this._imageryLayer){e.imageryLayers.remove(this._imageryLayer)}}}]),t}(f.default);r.default=d},{"-_202":55,e_1:235,s_2:236,m_131:239,C_129:240,M_0:241,o_130:242}],57:[function(e,t,r){"use strict";function n(e){var t=i();return function(){var r,n=(0,f.default)(e);if(t){var i=(0,f.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,c.default)(this,r)}}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function a(e){var t=e.host||"http://t{s}.tianditu.com/",r=["0","1","2","3","4","5","6","7"];"/"==t[t.length-1]&&(t=t.substr(0,t.length-1));var n=t+"/"+e.layer+"_w/wmts?service=wmts&request=GetTile&version=1.0.0&LAYER="+e.layer+"&tileMatrixSet=w&TileMatrix={TileMatrix}&TileRow={TileRow}&TileCol={TileCol}&style=default&format=tiles";return n+="&tk="+e.appKey,new Cesium.WebMapTileServiceImageryProvider({url:n,layer:e.layer,style:"default",subdomains:r,tileMatrixSetID:"w",maximumLevel:e.maximumLevel,minimumLevel:e.minimumLevel})}var o=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.createTdtImageryProvider=a,r.default=r.TiandituTerLayer=r.TiandituVecLayer=r.TiandituImgLayer=void 0;var s=o(e("e_1")),u=o(e("s_2")),l=o(e("C_129")),c=o(e("o_130")),f=o(e("m_131")),d=o(e("M_209")),h=function(e){function t(e){var n;return(0,s.default)(this,t),e=e||{},e.name=e.name||"天地图图层",n=r.call(this,e),n._minimumLevel=e.minimumLevel,n._maximumLevel=e.maximumLevel,n._host=e.host,n._imageLayerName=e.imageLayer,n._labelLayerName=e.labelLayer,n._imageLayer=null,n._labelLayer=null,n}(0,l.default)(t,e);var r=n(t);return(0,u.default)(t,[{key:"show",get:function(){return this._show},set:function(e){this._show=e,this._imageLayer&&(this._imageLayer.show=this._show),this._labelLayer&&(this._labelLayer.show=this._show)}},{key:"load",value:function(e){var r=this._imageLayer,n=this._labelLayer;!r&&this._imageLayerName&&(r=new d.default({name:this.name,zIndex:this.zIndex,provider:a({host:this.host,appKey:t.AppKey,layer:this._imageLayerName,minimumLevel:this._minimumLevel,maximumLevel:this._maximumLevel})}),this._imageLayer=r),!n&&this._labelLayerName&&(n=new d.default({name:this.name+"-注记",zIndex:this.zIndex+1,provider:a({host:this.host,appKey:t.AppKey,layer:this._labelLayerName,minimumLevel:this._minimumLevel,maximumLevel:this._maximumLevel})}),this._labelLayer=n),r&&(r.show=this._show,r.load(e)),n&&(n.show=this._show,n.load(e))}},{key:"unload",value:function(e){this._imageLayer=this._imageLayer&&this._imageLayer.unload(e),this._labelLayer=this._labelLayer&&this._labelLayer.unload(e)}}]),t}(d.default);h.AppKey="3669131581c051178afabed885766ac2";var p=function(e){function t(e){return(0,s.default)(this,t),e=e||{},e.name=e.name||"天地图影像",e.imageLayer="img",e.labelLayer="cia",r.call(this,e)}(0,l.default)(t,e);var r=n(t);return t}(h);r.TiandituImgLayer=p;var m=function(e){function t(e){return(0,s.default)(this,t),e=e||{},e.name=e.name||"天地图矢量",e.imageLayer="vec",e.labelLayer="cva",r.call(this,e)}(0,l.default)(t,e);var r=n(t);return t}(h);r.TiandituVecLayer=m;var v=function(e){function t(e){return(0,s.default)(this,t),e=e||{},e.name=e.name||"天地图地形晕渲",e.imageLayer="ter",e.labelLayer="cta",r.call(this,e)}(0,l.default)(t,e);var r=n(t);return t}(h);r.TiandituTerLayer=v;var g=h;r.default=g},{M_209:56,e_1:235,s_2:236,m_131:239,C_129:240,M_0:241,o_130:242}],58:[function(e,t,r){"use strict";function n(e){for(var t=[],r=0;r<e.length;r++){var n=e.get(r);(n.imageryProvider.zIndex||n.zIndex)&&(t.push(n),n.zIndex?n.imageryProvider.zIndex||(n.imageryProvider.zIndex=n.zIndex):n.zIndex=n.imageryProvider.zIndex)}if(t&&t.length&&t.sort(function(e,t){return e.zIndex>t.zIndex?1:e.zIndex<t.zIndex?-1:0}),t.forEach(function(t){e.raiseToTop(t)}),"undefined"!=typeof CesiumVectorTile){for(var i=Cesium.defined,r=0;r<e.length;r++){var n=e.get(r);!i(n.imageryProvider.zIndex)&&!i(n.zIndex)&&n.imageryProvider instanceof CesiumVectorTile.VectorTileImageryProvider&&e.raiseToTop(n)}for(var r=0;r<e.length;r++){var n=e.get(r);!i(n.imageryProvider.zIndex)&&!i(n.zIndex)&&n.imageryProvider instanceof CesiumVectorTile.VectorTileImageryProvider&&(n.imageryProvider._lineOnly||n.imageryProvider._onlyPoint)&&e.raiseToTop(n)}}}Object.defineProperty(r,"__esModule",{value:!0}),r.default=n},{}],59:[function(e,t,r){"use strict";function n(e){var t=i();return function(){var r,n=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,l.default)(this,r)}}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var a=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=a(e("e_1")),s=a(e("s_2")),u=a(e("C_129")),l=a(e("o_130")),c=a(e("m_131")),f=a(e("._216")),d=(a(e("C_217")),a(e("-_202"))),h=function(e){function t(e){var n;return(0,o.default)(this,t),n=r.call(this,e),n.renderer=e.renderer||"Cesium",n.tileset=new Cesium.Cesium3DTileset(e),n}(0,u.default)(t,e);var r=n(t);return(0,s.default)(t,[{key:"load",value:function(e){if("Three"==this.renderer){f.default.init();(e.isMeshVisualizer?e:e.globalScene).add(this.tileset)}else{if(e.isMeshVisualizer)throw new Error("局部场景3d tiles不支持Cesium渲染器");e.primitives.add(this.tileset)}}},{key:"unload",value:function(e){if("Three"==this.renderer){f.default.init();(e.isMeshVisualizer?e:e.globalScene).remove(this.tileset,!0)}else e.isMeshVisualizer||e.primitives.remove(this.tileset,!0)}}]),t}(d.default);r.default=h},{"._216":73,C_217:40,"-_202":55,e_1:235,s_2:236,m_131:239,C_129:240,M_0:241,o_130:242}],60:[function(e,t,r){"use strict";function n(e){var t=i();return function(){var r,n=(0,f.default)(e);if(t){var i=(0,f.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,c.default)(this,r)}}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var a=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o,s=a(e("e_1")),u=a(e("s_2")),l=a(e("C_129")),c=a(e("o_130")),f=a(e("m_131")),d=a(e("3_225")),h=a(e("D_226")),p=function(e,t){var r=Cesium,n=r.Matrix4,i=r.defined,a=r.Cartesian3,s=new n;return o||(o=new n),function(){return i(t._rtcCenter)?(n.getTranslation(e.model,o),a.add(o,t._rtcCenter,o),n.multiplyByPoint(e.view,o,o),n.setTranslation(e.modelView,o,s)):e.modelView}},m=function(e){function t(e){var n;(0,s.default)(this,t);var i=Cesium,a=i.when,o=i.Resource,u=(i.Cartesian3,i.Rectangle),l=i.BoundingSphere,c=i.defaultValue;if(!e.url)throw new Error("GeoMesh#constructor:url is required");return n=r.call(this,e),n._rtcCenter=null,n.url=e.url,n.rectangle=new u,n.boundingSphere=new l,n.bbox=[-180,-90,180,90],n.source=null,n.ready=!1,n.show=c(e.show,!0),n._deferred=a.defer(),n.readyPromise=n._deferred.promise,n._pickIdMap=new Map,n._pickIds=[],n._lazyLoad=c(e.lazyLoad,!1),n._isLoading=!1,n._lazyLoad||("string"==typeof n.url?(n._isLoading=!0,o.fetchJson(n.url).then(function(e){n.onLoad(e)})):n.onLoad(n.url)),n}(0,l.default)(t,e);var r=n(t);return(0,u.default)(t,[{key:"pickIds",get:function(){return this._pickIds}},{key:"load",value:function(e){this.visualizer||(e=e.isMeshVisualizer?e:e.globalScene,e.add(this))}},{key:"unload",value:function(e){this.visualizer&&(e=e.isMeshVisualizer?e:e.globalScene,e.remove(this))}},{key:"onAdded",value:function(){var e=this;!this.lazyLoad||this.ready||this._isLoading||("string"==typeof this.url?(this._isLoading=!0,Resource.fetchJson(this.url).then(function(t){e.onLoad(t)})):this.onLoad(this.url))}},{key:"onRemoved",value:function(){var e=this.mesh,t=this.visualizer;e&&t&&(t.remove(e,!0),this._pickIds.length=0,this._pickIdMap.clear())}},{key:"onLoad",value:function(e){for(var t=Cesium,r=t.Rectangle,n=this._deferred,i=h.default.calcBBox(e),a=0;a<4;a++)this.bbox[a]=i[a];r.fromDegrees(i[0],i[1],i[2],i[3],this.rectangle);try{this.source=e,this.initMesh(),n.resolve(this),this.ready=!0}catch(e){n.reject(e)}}},{key:"setPickId",value:function(e,t){var r=Cesium,n=r.GeometryAttribute,i=r.ComponentDatatype,a=this._pickIdMap,o=a.get(e);if(!o){o=this.visualizer.frameState.context.createPickId({feature:e,primitive:this,boundingSphere:t.boundingSphere}),a.set(e,o),this._pickIds.push(o)}var s=t.attributes.position;s=s.values||s.array;for(var u=s.length/3,l=[],c=o.color,f=c.red,d=c.green,h=c.blue,p=c.alpha,m=0;m<u;m++)l.push(f,d,h,p);return l=new Float32Array(l),t.isBufferGeometry?t.setAttribute("pickColor",new THREE.BufferAttribute(l,4,!1)):t.attributes.pickColor=new n({componentDatatype:i.FLOAT,componentsPerAttribute:4,normalize:!1,values:l}),t}},{key:"initMesh",value:function(){var e=this,t=this.createMesh(this.source);this._rtcCenter&&(t.uniformMapLoadedCallback=function(t,r,n){var i=p(r.context.uniformState,e);t.modelView=i,t.u_modelView=i,t.modelViewMatrix=i,t.u_modelViewMatrix=i}),this.mesh=t}},{key:"rtcCenterTransform",value:function(e,t){for(var r=e.attributes.position,n=r.array||r.values,i=0;i<n.length;i+=3){var a=n[i],o=n[i+1],s=n[i+2];n[i]=a-t.x,n[i+1]=o-t.y,n[i+2]=s-t.z}return e}},{key:"transformGeometry",value:function(e,t){if(t)this.rtcCenterTransform(e,t);else{for(var r=this.visualizer,n=e.attributes.position.array,i={x:0,y:0,z:0},a=0;a<n.length;a+=3)i.x=n[a],i.y=n[a+1],i.z=n[a+2],r.worldCoordinatesToLocal(i,i,{y:1}),n[a]=i.x,n[a+1]=i.y,n[a+2]=i.z;e.computeVertexNormals(),e.computeBoundingSphere()}return e}},{key:"createMesh",value:function(e){throw new Error("GeoMesh#createMesh未实现")}},{key:"createHighlightGeometry",value:function(e){throw new Error("GeoMesh#createHighlightGeometry未实现")}},{key:"createHighlightMesh",value:function(e,t){var r=this,n=this.createHighlightGeometry(e);n.boundingSphere||n.computeBoundingSphere();var i=new THREE.Mesh(n,t);return this._rtcCenter&&(i.uniformMapLoadedCallback=function(e,t,n){var i=p(t.context.uniformState,r);e.modelView=i,e.u_modelView=i,e.modelViewMatrix=i,e.u_modelViewMatrix=i},i.up.set(0,0,1),i.modelMatrixNeedsUpdate=!1,i.matrixAutoUpdate=!1),i.receiveShadow=!1,i.castShadow=!1,this.transformGeometry(n,this._rtcCenter),i}},{key:"render",value:function(e,t){this.ready&&this.mesh&&this.show&&(this.pickId=this.mesh.pickId,t.push(this.mesh))}}]),t}(d.default);r.default=m,m.prototype.isGeoMesh=!0},{"3_225":4,D_226:199,e_1:235,s_2:236,m_131:239,C_129:240,M_0:241,o_130:242}],61:[function(e,t,r){"use strict";function n(e){var t=i();return function(){var r,n=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,f.default)(this,r)}}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function a(e){return{uvUnit:e?Object.assign({x:40,y:50},e):{x:40,y:50},generate:function(e){var t=this,r=Cesium,n=r.Cartesian3,i=r.Cartographic,a=Cesium.Math,o=[Math.PI,Math.PI/2,-Math.PI,-Math.PI/2];e=n.unpackArray(e),e=e.map(function(e){var t=i.fromCartesian(e);return o[0]=Math.min(o[0],t.longitude),o[1]=Math.min(o[1],t.latitude),t});var s=[];return e.forEach(function(e){s.push(11e4*a.toDegrees(e.longitude-o[0])/t.uvUnit.x,22e4*a.toDegrees(e.latitude-o[1])/t.uvUnit.y)}),s}}}var o=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=o(e("e_1")),u=o(e("s_2")),l=o(e("m_230")),c=o(e("C_129")),f=o(e("o_130")),d=o(e("m_131")),h=o(e("h_234")),p=o(e("-_235")),m=o(e("3_236")),v=function(e){function t(e){var n;(0,s.default)(this,t);var i=THREE,a=i.MeshBasicMaterial,o=Cesium,u=o.defaultValue;return n=r.call(this,e),n.useRtcCenter=u(e.useRtcCenter,!0),n.height=e.height||0,n._material=e.material||new a({color:"yellow",opacity:.5}),n.uvGenerator=e.uvGenerator,n.needsUpdate=!1,n}(0,c.default)(t,e);var r=n(t);return(0,u.default)(t,[{key:"material",get:function(){return this._material},set:function(e){this._material=e,this.mesh&&(this.mesh.material=e)}},{key:"createHighlightGeometry",value:function(e){var t=this.height,r=this.uvGenerator,n=p.default.fromFeature(e,t,null,r);return n=h.default.toBufferGeometry3js(n)}},{key:"createMesh",value:function(e){for(var t=Cesium,r=t.BoundingSphere,n=THREE,i=n.Mesh,a=this.material,o=this.visualizer,s=[],u=e.features,l=!!o._frameState&&!!o._frameState.context,c=0;c<u.length;c++){var f=u[c];if(f.geometry){var d=p.default.fromFeature(f,this.height,null,this.uvGenerator);l&&this.setPickId(f,d),s.push(d)}}var m=h.default.mergeGeometries(s);m=h.default.toBufferGeometry3js(m),m.boundingSphere||m.computeBoundingSphere(),r.clone(m.boundingSphere,this.boundingSphere),a.pickColorQualifier="varying",a.pickColorName="pickColor";var v=new i(m,this.material);return this._rtcCenter?(this._rtcCenter=this.boundingSphere.center,v.up.set(0,0,1),v.modelMatrixNeedsUpdate=!1,v.matrixAutoUpdate=!1):this._rtcCenter=null,v.receiveShadow=!0,this.transformGeometry(m,this._rtcCenter),v}},{key:"render",value:function(e,r){this.needsUpdate&&this.mesh&&(this.visualizer.remove(this.mesh,!0),this.initMesh(),this.needsUpdate=!1),(0,l.default)((0,d.default)(t.prototype),"render",this).call(this,e,r)}}]),t}(m.default);r.default=v,v.DefaultUvGenerator=a},{h_234:2,"-_235":43,"3_236":60,e_1:235,s_2:236,m_230:238,m_131:239,C_129:240,M_0:241,o_130:242}],62:[function(e,t,r){"use strict";function n(e){var t=i();return function(){var r,n=(0,f.default)(e);if(t){var i=(0,f.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,c.default)(this,r)}}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var a=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=a(e("e_1")),s=a(e("s_2")),u=a(e("m_230")),l=a(e("C_129")),c=a(e("o_130")),f=a(e("m_131")),d=a(e("h_234")),h=a(e("D_226")),p=a(e("-_246")),m=a(e("3_236")),v=function(e){function t(e){var n;(0,o.default)(this,t);var i=THREE,a=i.MeshBasicMaterial,s=Cesium,u=s.defaultValue;return n=r.call(this,e),n._lineWidth=e.lineWidth||9,n._material=e.material||new a({color:"yellow",opacity:.5}),n._union=u(e.union,!0),n._unionEpsilon=u(e.unionEpsilon,.01),n._uvUnit=e.uvUnit,n._needsUpdate=!1,n._clampToGround=u(e.clampToGround,!1),n.useRtcCenter=u(e.useRtcCenter,!0),n}(0,l.default)(t,e);var r=n(t);return(0,s.default)(t,[{key:"clampToGround",get:function(){return this._clampToGround},set:function(e){this._clampToGround!=e&&(this._clampToGround=e,this._needsUpdate=!0)}},{key:"material",get:function(){return this._material},set:function(e){this._material=e,this.mesh&&(this.mesh.material=e)}},{key:"lineWidth",get:function(){return this._lineWidth},set:function(e){this._lineWidth!=e&&(this._lineWidth=e,this._needsUpdate=!0)}},{key:"uvUnit",get:function(){return this._uvUnit},set:function(e){this._uvUnit!=e&&(this._uvUnit=e,this._needsUpdate=!0)}},{key:"union",get:function(){return this._union},set:function(e){this._union!=e&&(this._union=e,this._needsUpdate=!0)}},{key:"unionEpsilon",get:function(){return this._unionEpsilon},set:function(e){this._unionEpsilon!=e&&(this._unionEpsilon=e,this._needsUpdate=!0)}},{key:"createHighlightGeometry",value:function(e){var t=this.uvUnit,r=this.clampToGround,n=this.lineWidth;return p.default.fromFeature(e,n,t,r)}},{key:"createMesh",value:function(e){var t=Cesium,r=(t.Cartesian3,t.BoundingSphere),n=THREE,i=(n.ShapeUtils,n.Mesh),a=(n.BufferGeometry,n.BufferAttribute,[]);if(h.default.featureEach(e,function(e){var t=e.geometry,r=t.type;if("MultiLineString"==r)return void t.coordinates.forEach(function(e){var t={type:"Feature",geometry:{type:"LineString",coordinates:e}};h.default.calcBBox(t),a.push(t)});"LineString"==r&&a.push(e)}),0!=a.length){var o=this.visualizer,s=this.useRtcCenter,u=this.material,l=this.union,c=this.unionEpsilon,f=this.uvUnit,m=this.clampToGround,v=this.lineWidth;l&&(a=p.default.union(a,c));for(var g,y=!!o._frameState&&!!o._frameState.context,_=[],b=0;b<a.length;b++){var M=a[b];if(M.geometry){var x=p.default.fromFeature(M,v,f,m);x.computeBoundingSphere(),y&&this.setPickId(M,x),_.push(x)}}g=d.default.mergeGeometries3js(_),g.computeBoundingSphere(),r.clone(g.boundingSphere,this.boundingSphere),u.pickColorQualifier="varying",u.pickColorName="pickColor";var w=new i(g,u);return s?(this._rtcCenter=this.boundingSphere.center,w.up.set(0,0,1),w.modelMatrixNeedsUpdate=!1,w.matrixAutoUpdate=!1):this._rtcCenter=null,w.receiveShadow=!0,this.transformGeometry(g,this._rtcCenter),w}}},{key:"render",value:function(e,r){this._needsUpdate&&this.mesh&&(this.visualizer.remove(this.mesh,!0),this.initMesh(),this._needsUpdate=!1),(0,u.default)((0,f.default)(t.prototype),"render",this).call(this,e,r)}}]),t}(m.default);r.default=v},{h_234:2,D_226:199,"-_246":44,"3_236":60,e_1:235,s_2:236,m_230:238,m_131:239,C_129:240,M_0:241,o_130:242}],63:[function(e,t,r){"use strict";function n(e){var t=i();return function(){var r,n=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,l.default)(this,r)}}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var a=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=a(e("e_1")),s=a(e("s_2")),u=a(e("C_129")),l=a(e("o_130")),c=a(e("m_131")),f=a(e("h_234")),d=a(e("-_235")),h=a(e("3_236")),p=e("-_257"),m=function(e){function t(e){var n;(0,o.default)(this,t);var i=Cesium,a=i.defaultValue,s=THREE,u=s.TextureLoader,l=s.Vector3;return n=r.call(this,e),n.skyBox=e.skyBox,n.waterNormals=e.waterNormals,n.alpha=a(e.alpha,.8),n.clampToGround=a(e.clampToGround,!0),n._terrainProvider=null,n.waterParams={textureWidth:1024,textureHeight:1024,waterNormals:(new u).load(n.waterNormals,function(e){e.wrapS=e.wrapT=1e3}),alpha:n.alpha,sunDirection:new l,sunColor:16777215,waterColor:7695,distortionScale:3.7,fog:!1},n}(0,u.default)(t,e);var r=n(t);return(0,s.default)(t,[{key:"createGeomerty",value:function(e,t){var r,n=Cesium,i=n.Cartesian3,a=n.BoundingSphere,o=this.visualizer;this.clampToGround&&this._terrainProvider&&e.properties&&e.properties._terrainHeight&&(r=e.properties._terrainHeight);var s=d.default.fromFeature(e,r);t.push(a.clone(s.boundingSphere));for(var u=s.attributes.position.values,l=0;l<u.length;l+=3){var c=u[l],h=u[l+1],p=u[l+2],m=new i(c,h,p);o.worldCoordinatesToLocal(m,m,i.UNIT_Y),u[l]=m.x,u[l+1]=m.y,u[l+2]=m.z}return s=f.default.toBufferGeometry3js(s),s.computeBoundingSphere(),s.computeVertexNormals(),s}},{key:"createMesh",value:function(e){if(this.visualizer){for(var t=THREE,r=t.Object3D,n=[],i=new r,a=0;a<e.features.length;a++){var o=e.features[a],s=this.createGeomerty(o,n),u=new p.Water(s,this.waterParams);i.add(u)}return Cesium.BoundingSphere.fromBoundingSpheres(n,this.boundingSphere),i}}},{key:"render",value:function(e,t){var r=this;if(this.ready&&!this.mesh&&this.initMesh(),this.ready&&this.mesh&&this.show){this.pickId=this.mesh.pickId,t.push(this.mesh);var n,i=this.visualizer.scene,a=Cesium,o=a.EllipsoidTerrainProvider,s=a.Cartographic,u=a.sampleTerrainMostDetailed;if((n=!this.clampToGround||i.terrainProvider instanceof o?null:i.terrainProvider)!=this._terrainProvider)if(this._terrainProvider=n,n){if(!this._isUpdatingTerrainProperties){this._isUpdatingTerrainProperties=!0;var l=[];this.source.features.forEach(function(e){e.geometry&&l.push(e)});var c=l.map(function(e){var t=e.geometry.bbox,r=(t[0]+t[2])/2,n=(t[1]+t[3])/2;return s.fromDegrees(r,n)});u(n,c).then(function(){for(var e=0;e<l.length;e++){var t=l[e];t.properties=t.properties||{},t.properties._terrainHeight=c[e].height}c.length=0,r.initMesh(),r._isUpdatingTerrainProperties=!1}).otherwise(function(e){c.length=0,console.error(e)})}}else this.initMesh();var f=this.skyBox,d=f?f.sunPosition:this.visualizer._sunPositionLC;this.mesh.children.forEach(function(e){var t=e.material;t.uniforms.sunDirection.value.copy(d).normalize(),t.uniforms.time.value+=1/60})}}}]),t}(h.default);r.default=m},{h_234:2,"-_235":43,"3_236":60,"-_257":65,e_1:235,s_2:236,m_131:239,C_129:240,M_0:241,o_130:242}],64:[function(e,t,r){"use strict";function n(e){var t=i();return function(){var r,n=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,l.default)(this,r)}}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var a=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=a(e("e_1")),s=a(e("s_2")),u=a(e("C_129")),l=a(e("o_130")),c=a(e("m_131")),f=a(e("M_264")),d=(a(e("C_217")),a(e("-_202"))),h=function(e){function t(e){var n;return(0,o.default)(this,t),n=r.call(this,e),e.materialType=e.materialType||"basic",n.params=e,n._root=new f.default(e),n}(0,u.default)(t,e);var r=n(t);return(0,s.default)(t,[{key:"root",get:function(){return this._root}},{key:"ready",get:function(){return!!this._root&&this._root.ready}},{key:"readyPromise",get:function(){return this._root&&this._root.readyPromise}},{key:"boundingSphere",get:function(){return this._root&&this._root.boundingSphere}},{key:"materialType",get:function(){return this.params.materialType},set:function(e){var t=this.params,r=this._root;t.materialType!=e&&(t.materialType=e,r&&(r.materialType=e))}},{key:"show",get:function(){return this._show},set:function(e){this._show=e,this.root&&(this.root.show=e)}},{key:"reload",value:function(e){this.unload(e),this._root=new f.default(this.params),this.load(e)}},{key:"load",value:function(e){var t=e.isMeshVisualizer?e:e.globalScene;this.root.show=this.show,t.add(this.root)}},{key:"unload",value:function(e){var t=e.isMeshVisualizer?e:e.globalScene,r=this.root;t.remove(r,!0),this._root=r.destroy()}}]),t}(d.default);r.default=h},{M_264:80,C_217:40,"-_202":55,e_1:235,s_2:236,m_131:239,C_129:240,M_0:241,o_130:242}],65:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Water=void 0;var n=function(e,t){var r=THREE,n=r.Color,i=r.MathUtils,a=r.Matrix4,o=r.Mesh,s=r.PerspectiveCamera,u=r.Plane,l=r.ShaderMaterial,c=r.UniformsLib,f=r.UniformsUtils,d=r.Vector3,h=r.Vector4,p=r.WebGLRenderTarget,m=new o(e);t=t||{};var v=void 0!==t.textureWidth?t.textureWidth:512,g=void 0!==t.textureHeight?t.textureHeight:512,y=void 0!==t.clipBias?t.clipBias:0,_=void 0!==t.alpha?t.alpha:1,b=void 0!==t.time?t.time:0,M=void 0!==t.waterNormals?t.waterNormals:null,x=void 0!==t.sunDirection?t.sunDirection:new d(.70707,.70707,0),w=new n(void 0!==t.sunColor?t.sunColor:16777215),S=new n(void 0!==t.waterColor?t.waterColor:8355711),T=void 0!==t.eye?t.eye:new d(0,0,0),C=void 0!==t.eyeCesium?t.eyeCesium:new d(0,0,0),E=void 0!==t.distortionScale?t.distortionScale:20,A=void 0!==t.side?t.side:0,L=void 0!==t.fog&&t.fog,P=new u,O=new d,R=new d,I=new d,D=new a,B=new d(0,0,-1),U=new h,N=new d,k=new d,j=new h,G=new a,V=new a,F=new s,z={minFilter:1006,magFilter:1006,format:1022},H=new p(v,g,z);i.isPowerOfTwo(v)&&i.isPowerOfTwo(g)||(H.texture.generateMipmaps=!1);var W={uniforms:f.merge([c.fog,c.lights,{normalSampler:{value:null},mirrorSampler:{value:null},alpha:{value:1},time:{value:0},size:{value:1},distortionScale:{value:20},textureMatrix:{value:new a},textureMatrixCesium:{value:new a},sunColor:{value:new n(8355711)},sunDirection:{value:new d(.70707,.70707,0)},eye:{value:new d},eyeCesium:{value:new d},waterColor:{value:new n(5592405)}}]),
vertexShader:["uniform mat4 textureMatrix;","uniform mat4 textureMatrixCesium;","uniform float time;","varying vec4 mirrorCoord;","varying vec4 worldPosition;","#include <common>","#include <fog_pars_vertex>","#include <shadowmap_pars_vertex>","#include <logdepthbuf_pars_vertex>","void main() {","\tmirrorCoord = modelMatrix * vec4( position, 1.0 );","\tworldPosition = mirrorCoord.xyzw;","#ifdef CESIUM_MESH_VISUALIZER","\tmirrorCoord = textureMatrixCesium * vec4( position, 1.0 );","#else","\tmirrorCoord = textureMatrix * mirrorCoord;","#endif","\tvec4 mvPosition =  modelViewMatrix * vec4( position, 1.0 );","\tgl_Position = projectionMatrix * mvPosition;","vec3 transformed = vec3( position );","#include <beginnormal_vertex>","#include <defaultnormal_vertex>","#include <logdepthbuf_vertex>","#include <fog_vertex>","#include <shadowmap_vertex>","}"].join("\n"),fragmentShader:["uniform sampler2D mirrorSampler;","uniform float alpha;","uniform float time;","uniform float size;","uniform float distortionScale;","uniform sampler2D normalSampler;","uniform vec3 sunColor;","uniform vec3 sunDirection;","uniform vec3 eye;","#ifdef CESIUM_MESH_VISUALIZER","uniform vec3 eyeCesium;","#endif","uniform vec3 waterColor;","varying vec4 mirrorCoord;","varying vec4 worldPosition;","vec4 getNoise( vec2 uv ) {","\tvec2 uv0 = ( uv / 103.0 ) + vec2(time / 17.0, time / 29.0);","\tvec2 uv1 = uv / 107.0-vec2( time / -19.0, time / 31.0 );","\tvec2 uv2 = uv / vec2( 8907.0, 9803.0 ) + vec2( time / 101.0, time / 97.0 );","\tvec2 uv3 = uv / vec2( 1091.0, 1027.0 ) - vec2( time / 109.0, time / -113.0 );","\tvec4 noise = texture2D( normalSampler, uv0 ) +","\t\ttexture2D( normalSampler, uv1 ) +","\t\ttexture2D( normalSampler, uv2 ) +","\t\ttexture2D( normalSampler, uv3 );","\treturn noise * 0.5 - 1.0;","}","void sunLight( const vec3 surfaceNormal, const vec3 eyeDirection, float shiny, float spec, float diffuse, inout vec3 diffuseColor, inout vec3 specularColor ) {","\tvec3 reflection = normalize( reflect( -sunDirection, surfaceNormal ) );","\tfloat direction = max( 0.0, dot( eyeDirection, reflection ) );","\tspecularColor += pow( direction, shiny ) * sunColor * spec;","\tdiffuseColor += max( dot( sunDirection, surfaceNormal ), 0.0 ) * sunColor * diffuse;","}","#include <common>","#include <packing>","#include <bsdfs>","#include <fog_pars_fragment>","#include <logdepthbuf_pars_fragment>","#include <lights_pars_begin>","#include <shadowmap_pars_fragment>","#include <shadowmask_pars_fragment>","void main() {","#include <logdepthbuf_fragment>","#ifdef CESIUM_MESH_VISUALIZER","\tvec4 noise = getNoise((_CesiumModel2ThreeModel* worldPosition).xz * size );","#else","\tvec4 noise = getNoise( worldPosition.xz * size );","#endif ","\tvec3 surfaceNormal = normalize( noise.xzy * vec3( 1.5, 1.0, 1.5 ) );","\tvec3 diffuseLight = vec3(0.0);","\tvec3 specularLight = vec3(0.0);","#ifdef CESIUM_MESH_VISUALIZER","   vec3 worldToEye = eyeCesium-worldPosition.xyz;","#else","\tvec3 worldToEye = eye-worldPosition.xyz;","#endif ","\tvec3 eyeDirection = normalize( worldToEye );","#ifdef CESIUM_MESH_VISUALIZER","   eyeDirection=_CesiumNormal2ThreeNormal*eyeDirection;","#endif ","\tsunLight( surfaceNormal, eyeDirection, 100.0, 2.0, 0.5, diffuseLight, specularLight );","\tfloat distance = length(worldToEye);","\tvec2 distortion = surfaceNormal.xz * ( 0.001 + 1.0 / distance ) * distortionScale;","\tvec3 reflectionSample = vec3( texture2D( mirrorSampler, mirrorCoord.xy / mirrorCoord.w + distortion ) );","\tfloat theta = max( dot( eyeDirection, surfaceNormal ), 0.0 );","\tfloat rf0 = 0.3;","\tfloat reflectance = rf0 + ( 1.0 - rf0 ) * pow( ( 1.0 - theta ), 5.0 );","\tvec3 scatter = max( 0.0, dot( surfaceNormal, eyeDirection ) ) * waterColor;","\tvec3 albedo = mix( ( sunColor * diffuseLight * 0.3 + scatter ) * getShadowMask(), ( vec3( 0.1 ) + reflectionSample * 0.9 + reflectionSample * specularLight ), reflectance);","\tvec3 outgoingLight = albedo;","\tgl_FragColor = vec4( outgoingLight, alpha );","#include <tonemapping_fragment>","#include <fog_fragment>","}"].join("\n")},Y=new l({fragmentShader:W.fragmentShader,vertexShader:W.vertexShader,uniforms:f.clone(W.uniforms),lights:!0,side:A,fog:L});return Y.uniforms.mirrorSampler.value=H.texture,Y.uniforms.textureMatrix.value=G,Y.uniforms.textureMatrixCesium.value=V,Y.uniforms.alpha.value=_,Y.uniforms.time.value=b,Y.uniforms.normalSampler.value=M,Y.uniforms.sunColor.value=w,Y.uniforms.waterColor.value=S,Y.uniforms.sunDirection.value=x,Y.uniforms.distortionScale.value=E,Y.uniforms.eye.value=T,Y.uniforms.eyeCesium.value=C,m.material=Y,m.onBeforeRender=function(e,t,r){if(e.isCesiumRenderer?(R.setFromMatrixPosition(m.modelMatrix),I.setFromMatrixPosition(r.modelMatrix),D.extractRotation(m.modelMatrix)):(R.setFromMatrixPosition(m.matrixWorld),I.setFromMatrixPosition(r.matrixWorld),D.extractRotation(m.matrixWorld)),O.set(0,0,1),O.applyMatrix4(D),N.subVectors(R,I),!(N.dot(O)>0)){N.reflect(O).negate(),N.add(R),e.isCesiumRenderer?D.extractRotation(r.modelMatrix):D.extractRotation(r.matrixWorld),B.set(0,0,-1),B.applyMatrix4(D),B.add(I),k.subVectors(R,B),k.reflect(O).negate(),k.add(R),F.position.copy(N),F.up.set(0,1,0),F.up.applyMatrix4(D),F.up.reflect(O),F.lookAt(k),F.far=r.far,F.updateMatrixWorld(),F.projectionMatrix.copy(r.projectionMatrix),G.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),G.multiply(F.projectionMatrix),G.multiply(F.matrixWorldInverse),e.isCesiumRenderer&&(V.copy(G),V.multiply(m.modelMatrix)),P.setFromNormalAndCoplanarPoint(O,R),P.applyMatrix4(F.matrixWorldInverse),U.set(P.normal.x,P.normal.y,P.normal.z,P.constant);var n=F.projectionMatrix;if(j.x=(Math.sign(U.x)+n.elements[8])/n.elements[0],j.y=(Math.sign(U.y)+n.elements[9])/n.elements[5],j.z=-1,j.w=(1+n.elements[10])/n.elements[14],U.multiplyScalar(2/U.dot(j)),n.elements[2]=U.x,n.elements[6]=U.y,n.elements[10]=U.z+1-y,n.elements[14]=U.w,e.isCesiumRenderer?C.setFromMatrixPosition(r.modelMatrix):T.setFromMatrixPosition(r.matrixWorld),3e3!==e.outputEncoding)return console.warn("THREE.Water: WebGLRenderer must use LinearEncoding as outputEncoding."),void(m.onBeforeRender=function(){});if(0!==e.toneMapping)return console.warn("THREE.Water: WebGLRenderer must use NoToneMapping as toneMapping."),void(m.onBeforeRender=function(){});var i=e.getRenderTarget(),a=e.xr.enabled,o=e.shadowMap.autoUpdate;m.visible=!1,e.xr.enabled=!1,e.shadowMap.autoUpdate=!1,e.setRenderTarget(H),e.state.buffers.depth.setMask(!0),!1===e.autoClear&&e.clear(),e.render(t,F),m.visible=!0,e.xr.enabled=a,e.shadowMap.autoUpdate=o,e.setRenderTarget(i);var s=r.viewport;void 0!==s&&e.state.viewport(s)}},m};r.Water=n},{}],66:[function(e,t,r){"use strict";function n(e){var t=i();return function(){var r,n=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,l.default)(this,r)}}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var a=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.CountryVec2dLayer=r.LabelVec2dLayer=r.HighlightMarkerLayer=r.HighlightPolygonLayer=r.SealandVec2dLayer=void 0;var o=a(e("e_1")),s=a(e("s_2")),u=a(e("C_129")),l=a(e("o_130")),c=a(e("m_131")),f=a(e("o_273")),d=function(e){function t(e){var n;return(0,o.default)(this,t),n=r.call(this,e),n.provider=new CesiumVectorTile.VectorTileImageryProvider(e),e.focusAdminNames&&(n.provider.focusAdminNames=e.focusAdminNames,n.provider.focusPropertyName=e.focusPropertyName||"NAME"),n}(0,u.default)(t,e);var r=n(t);return(0,s.default)(t,[{key:"focusAdminNames",get:function(){return this.provider&&this.provider.focusAdminNames},set:function(e){this.provider&&(this.provider.focusAdminNames=e)}},{key:"focusPropertyName",get:function(){return this.provider&&this.provider.focusPropertyName},set:function(e){this.provider&&(this.provider.focusPropertyName=e)}}]),t}(f.default),h={Sealand:{zIndex:0,removeDuplicate:!1,minimumLevel:0,defaultStyle:{fill:!0,outlineColor:"rgba(138,138,138,1)",fillColor:"rgba(235,235,235,1)",backgroundColor:"rgba(89,129,188,1)"}},SealandDark:{zIndex:0,removeDuplicate:!1,minimumLevel:0,defaultStyle:{fill:!0,outlineColor:"rgba(138,138,138,1)",fillColor:"rgb(3,3,30)",backgroundColor:"rgb(10,13,44)"}},ChinaBorder:{zIndex:999,minimumLevel:0,defaultStyle:{lineWidth:1.25,outlineColor:"rgba(88,88,88,1)"}},Province:{zIndex:998,minimumLevel:0,removeDuplicate:!0,defaultStyle:{lineWidth:1,fill:!0,outline:!0,shadowColor:"white",outlineColor:"rgba(118,118,118,1)",fillColor:"rgba(225,225,225, .5)"},styleFilter:function(e,t){var r=!0;if(this.focusAdminNames&&this.focusAdminNames.length)for(var n=0;n<this.focusAdminNames.length&&!(r=e.properties[this.focusPropertyName]&&e.properties[this.focusPropertyName].toString().indexOf(this.focusAdminNames[n])>=0);n++);return r&&(t.fill=!1,t.outlineColor=Cesium.Color.BLACK,t.fillColor=Cesium.Color.WHITE,t.lineWidth=1.25,t.lineDash=null),t}},PlaceName:{minimumLevel:3,zIndex:999,defaultStyle:{showLabel:!0,labelPropertyName:"name",showMaker:!0,labelOffsetY:-12,fontFamily:"heiti",pointColor:"rgba(118,118,118,1)",labelStrokeWidth:4,fontSize:12,labelStroke:!0,fontColor:"white",labelStrokeColor:"rgba(118,118,118,1)"},styleFilter:function(e,t,r,n,i){var a=!0;if(this.focusAdminNames&&this.focusAdminNames.length&&e.properties.province)for(var o=0;o<this.focusAdminNames.length&&!(a=e.properties.province.indexOf(this.focusAdminNames[o])>=0)&&(!e.properties.city||!(a=e.properties.city.indexOf(this.focusAdminNames[o])>=0))&&(!t.labelPropertyName||"string"!=typeof e.properties[t.labelPropertyName]||!(a=e.properties[t.labelPropertyName].indexOf(this.focusAdminNames[o])>=0));o++);return a&&(t.pointColor=Cesium.Color.BLACK),"province"==e.properties.adminType?(i>14&&(t.show=!1),t.showMaker=!1,t.labelOffsetY=0,t.fontSize=16,t.labelStrokeColor=a?Cesium.Color.fromBytes(160,99,57):Cesium.Color.fromBytes(140,89,47)):("city"==e.properties.adminType&&(!e.properties.cityCode.endsWith("0100")&&i<6?t.show=!1:i<5&&(t.show=!1)),"county"==e.properties.adminType&&i<9&&(t.show=!1),"country"==e.properties.adminType&&(t.show=!1),i>14&&(t.fontSize=18),a&&(t.labelStrokeColor=Cesium.Color.BLACK)),i<6&&(t.fontSize=9),t.labelPropertyName=i>4?"name":"nameabbrevation",t}}};d.DefaultParams=h;var p=function(e){function t(e){(0,o.default)(this,t);var n=e.theme||"light",i="dark"==n?h.SealandDark:h.Sealand;return r.call(this,Object.assign({source:e.source},i))}(0,u.default)(t,e);var r=n(t);return t}(d);r.SealandVec2dLayer=p;var m=function(e){function t(e){return(0,o.default)(this,t),r.call(this,{source:e.source,focusAdminNames:e.focusAdminNames,focusPropertyName:e.focusPropertyName,minimumLevel:e.minimumLevel||1,removeDuplicate:!0,zIndex:void 0!==e.zIndex?e.zIndex:998,defaultStyle:{lineWidth:1,fill:"dark"!==e.theme,outline:!0,shadowColor:"white",outlineColor:"rgba(118,118,118,1)",fillColor:"rgba(225,225,225, .5)"},styleFilter:function(t,r){var n=!0;if(this.focusAdminNames&&this.focusAdminNames.length)for(var i=0;i<this.focusAdminNames.length&&!(n=t.properties[this.focusPropertyName]&&t.properties[this.focusPropertyName].toString().indexOf(this.focusAdminNames[i])>=0);i++);return n&&(r.fill=!1,"dark"==e.theme?r.outlineColor="rgb(245,245,245)":r.outlineColor=Cesium.Color.BLACK,r.fillColor=Cesium.Color.WHITE,r.lineWidth=1.25,r.lineDash=null),r}})}(0,u.default)(t,e);var r=n(t);return t}(d);r.HighlightPolygonLayer=m;var v=function(e){function t(e){return(0,o.default)(this,t),r.call(this,{source:e.source,focusAdminNames:e.focusAdminNames,focusPropertyName:e.focusPropertyName,minimumLevel:3,zIndex:void 0!==e.zIndex?e.zIndex:999,defaultStyle:{showLabel:!0,labelPropertyName:"name",showMaker:!0,labelOffsetY:-12,fontFamily:"heiti",pointColor:"rgba(118,118,118,1)",labelStrokeWidth:4,fontSize:12,labelStroke:!0,fontColor:"white",labelStrokeColor:"rgba(118,118,118,1)"},styleFilter:function(t,r,n,i,a){var o=!0;if(this.focusAdminNames&&this.focusAdminNames.length&&t.properties.province)for(var s=0;s<this.focusAdminNames.length&&!(o=t.properties.province.indexOf(this.focusAdminNames[s])>=0)&&(!t.properties.city||!(o=t.properties.city.indexOf(this.focusAdminNames[s])>=0))&&(!r.labelPropertyName||"string"!=typeof t.properties[r.labelPropertyName]||!(o=t.properties[r.labelPropertyName].indexOf(this.focusAdminNames[s])>=0));s++);return o&&("dark"==e.theme?r.pointColor=Cesium.Color.WHITE:r.pointColor=Cesium.Color.BLACK),"province"==t.properties.adminType?(a>14&&(r.show=!1),r.showMaker=!1,r.labelOffsetY=0,r.fontSize=16,r.labelStrokeColor=o?Cesium.Color.fromBytes(160,99,57):Cesium.Color.fromBytes(140,89,47)):("city"==t.properties.adminType&&(!t.properties.cityCode.endsWith("0100")&&a<6?r.show=!1:a<5&&(r.show=!1)),"county"==t.properties.adminType&&a<9&&(r.show=!1),"country"==t.properties.adminType&&(r.show=!1),a>14&&(r.fontSize=18),o&&("dark"==e.theme?r.labelStrokeColor="rgb(10,13,44)":r.labelStrokeColor=Cesium.Color.BLACK)),a<6&&(r.fontSize=9),r.labelPropertyName=a>4?"name":"nameabbrevation",r}})}(0,u.default)(t,e);var r=n(t);return t}(d);r.HighlightMarkerLayer=v;var g=function(e){function t(e){return(0,o.default)(this,t),r.call(this,{source:e.source,minimumLevel:e.minimumLevel||12,maximumLevel:e.maximumLevel||20,zIndex:void 0!==e.zIndex?e.zIndex:9999,defaultStyle:{showLabel:!0,labelPropertyName:"NAME",showMarker:!1,labelOffsetY:-12,fontFamily:"heiti",pointColor:"rgba(118,118,118,1)",labelStrokeWidth:4,fontSize:12,labelStroke:!0,fontColor:"white",labelStrokeColor:"rgba(118,118,118,1)"}})}(0,u.default)(t,e);var r=n(t);return t}(d);r.LabelVec2dLayer=g;var y=function(e){function t(e){return(0,o.default)(this,t),r.call(this,{source:e.source,zIndex:void 0!==e.zIndex?e.zIndex:999,minimumLevel:0,defaultStyle:{lineWidth:2,outlineColor:"dark"==e.theme?"white":"rgba(88,88,88,1)"}})}(0,u.default)(t,e);var r=n(t);return t}(d);r.CountryVec2dLayer=y;var _=d;r.default=_},{o_273:56,e_1:235,s_2:236,m_131:239,C_129:240,M_0:241,o_130:242}],67:[function(e,t,r){"use strict";function n(e,t){var r=t._pickIdMap,n=r.get(e);if(!n){n=t.localScene.frameState.context.createPickId({feature:e,primitive:t.root}),r.set(e,n),t.pickIds.push(n)}return n}var i=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var a=i(e("e_1")),o=i(e("s_2")),s=i(e("h_234")),u=i(e("h_278")),l=i(e("-_279")),c=i(e("-_235")),f=function(){function e(t,r,n,i,o,s){(0,a.default)(this,e);var u=Cesium.defaultValue;this.root=t,this.styleFilter=r,this.localScene=n,this.uvUnit=i,this.roundUv=u(o,!1),this.useUvUnit=u(s,!0),this.pickIds=[],this._pickIdMap=new Map,this.terrainProvider=null,this.clampToGround=!1,this.receiveShadow=!0,this.castShadow=!0}return(0,o.default)(e,[{key:"destroy",value:function(){this._pickIdMap.clear(),this.pickIds.splice(0)}},{key:"createMesh",value:function(e,t,r,n,i,a,o){var l=this.styleFilter,f=THREE,d=f.Mesh,h=Cesium,p=h.Cartesian3,m=h.Cartographic,v=h.defaultValue,g=this,y=g.localScene,_=v(t,g.uvUnit);r=v(r,!0),n=v(n,!0);var b=g.roundUv,M=g.useUvUnit,x=g.clampToGround,w=g.terrainProvider,S={useUvUnit:M,roundUv:b,receiveShadow:this.receiveShadow,castShadow:this.castShadow};l(e,S);var T=S.extrudedHeight,C=0;x&&e.properties._terrianHeight&&w&&(C=e.properties._terrianHeight);var E=c.default.fromFeature(e,x?C:null,C+T,a,i);if(T?(E=u.default.createExtrudedUvNormal(E,C,S.useUvUnit?S.uvUnit||_:null,S.roundUv,r,n),E=s.default.toBufferGeometry3js(E),E.attributes.uv=E.attributes.extrudedUv,E.deleteAttribute("extrudedUv"),E.deleteAttribute("extrudedNormal")):E=s.default.toBufferGeometry3js(E),o)for(var A=E.attributes.position.array,L=0;L<A.length;L+=3)A[L]-=o.x,A[L+1]-=o.y,A[L+2]-=o.z;else{for(var P=E.attributes.position.array,O=new p,R=new m,I=[],D=0,B=0;B<P.length;B+=3)O.x=P[B],O.y=P[B+1],O.z=P[B+2],m.fromCartesian(O,null,R),I.push(R.height-C),y.worldCoordinatesToLocal(O,O,{y:1}),P[B]=O.x,P[B+1]=O.y,P[B+2]=O.z,D=Math.max(O.y,D);if(T)for(var U=.1*T,N=0,k=0;k<I.length;k++){var j=I[k];j>=U&&(P[N+1]=D),N+=3}E.computeVertexNormals(),E.computeBoundingSphere()}return new d(E,S.material)}},{key:"requestContent",value:function(e,t){function r(e){var r,o={useUvUnit:T,roundUv:S},l=e.uri,d=l.properties.featureId;f(l,o);var h=o.extrudedHeight,p=0;M.clampToGround&&l.properties._terrianHeight&&M.terrainProvider&&(p=l.properties._terrianHeight);var v=c.default.fromFeature(l,M.clampToGround?p:null,p+h);h?(v=u.default.createExtrudedUvNormal(v,p,o.useUvUnit?o.uvUnit||w:null,o.roundUv),v=s.default.toBufferGeometry3js(v),v.attributes.uv=v.attributes.extrudedUv,v.deleteAttribute("extrudedUv"),v.deleteAttribute("extrudedNormal")):v=s.default.toBufferGeometry3js(v);var b=v.attributes.position.count,C=new Float32Array(b);C.fill(d),v.setAttribute("batchId",new m(C,1,!1));var E=o.material;E.pickColorQualifier="varying",E.pickColorName="pickColor",v.boundingSphere||v.computeBoundingSphere();var A=n(l,M);A.object.boundingSphere=_.clone(v.boundingSphere);for(var L=[],P=A.color,O=P.red,R=P.green,I=P.blue,D=P.alpha,B=0;B<b;B++)L.push(O,R,I,D);if(L=new Float32Array(L),v.setAttribute("pickColor",new m(L,4,!1)),t)for(var U=v.attributes.position.array,N=0;N<U.length;N+=3)U[N]-=t.x,U[N+1]-=t.y,U[N+2]-=t.z;else{for(var k=v.attributes.position.array,j=new g,G=new y,V=[],F=0,z=0;z<k.length;z+=3)j.x=k[z],j.y=k[z+1],j.z=k[z+2],y.fromCartesian(j,null,G),V.push(G.height-p),x.worldCoordinatesToLocal(j,j,{y:1}),k[z]=j.x,k[z+1]=j.y,k[z+2]=j.z,F=Math.max(j.y,F);if(h)for(var H=.1*h,W=0,Y=0;Y<V.length;Y++){var X=V[Y];X>=H&&(k[W+1]=F),W+=3}v.computeVertexNormals(),v.computeBoundingSphere()}a.has(E)?r=a.get(E):(r={material:E,geometries:[]},i.push(r),a.set(E,r)),r.geometries.push(v)}var i=[],a=new WeakMap,o=this.root,f=this.styleFilter,d=THREE,h=d.Object3D,p=d.Mesh,m=d.BufferAttribute,v=Cesium,g=v.Cartesian3,y=v.Cartographic,_=v.BoundingSphere,b=v.sampleTerrainMostDetailed,M=this,x=M.localScene,w=M.uvUnit,S=M.roundUv,T=M.useUvUnit,C=M.clampToGround,E=M.terrainProvider,A=M.receiveShadow,L=M.castShadow,P=[],O=[],R=[];P.push(O),e.contain.forEach(function(e){O.length>100&&(O=[],P.push(O));var t=e.uri;void 0==t.properties._terrianHeight&&R.push(t),O.push(e)}),e.intersect.forEach(function(e){O.length>100&&(O=[],P.push(O));var t=e.uri;void 0==t.properties._terrianHeight&&R.push(t),O.push(e)});var I=null;return C&&E&&R.length&&(I=new Promise(function(e,t){var r=R.map(function(e){var t=e.geometry.bbox,r=(t[0]+t[2])/2,n=(t[1]+t[3])/2;return y.fromDegrees(r,n)});b(E,r).then(function(t){for(var r=0;r<t.length;r++){R[r].properties._terrianHeight=t[r].height||0}R.length=0,e()}).otherwise(function(e){R.length=0,t(e)})})),Promise.all([I]).then(function(){return new l.default(P,function(e){for(var t=0;t<e.length;t++){var n=e[t];try{r(n)}catch(e){console.error(e)}}}).run().then(function(){var e=new h;return i.forEach(function(r){var n=s.default.mergeGeometries3js(r.geometries),i=r.material,u=new p(n,i);u.pickObject={id:u,mesh:u,primitive:o},u.receiveShadow=A,u.castShadow=L,e.add(u),t&&(u.matrixAutoUpdate=!1,u.modelMatrixNeedsUpdate=!1),u.frustumCulled=!1,a.delete(i)}),t&&(e.matrixAutoUpdate=!1,e.modelMatrixNeedsUpdate=!1),e.frustumCulled=!1,i.splice(0),e})})}}]),e}();r.default=f},{h_234:2,"-_279":189,h_278:42,"-_235":43,e_1:235,s_2:236,M_0:241}],68:[function(e,t,r){"use strict";var n=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("e_1")),a=n(e("s_2")),o=n(e("h_234")),s=n(e("m_285")),u=n(e("M_286")),l=n(e("-_279")),c=function(){function e(t,r){(0,i.default)(this,e),this.root=t,this.styleFilter=r}return(0,a.default)(e,[{key:"requestContent",value:function(e,t){function r(e){var r,a={},l=e.uri,f=l.properties.featureId;c(l,a);var d=u.default.parseFeature(l,f,a),h=a.material;if(t){d instanceof Cesium.Geometry||(d=d.constructor.createGeometry(d)),d=o.default.toBufferGeometry3js(d),d=new s.default(d,!0);for(var p=d.attributes.position.array,m=0;m<p.length;m+=3)p[m]-=t.x,p[m+1]-=t.y,p[m+2]-=t.z}else d=o.default.toBufferGeometry3js(d),d=new s.default(d,!0);i.has(h)?r=i.get(h):(r={material:h,geometries:[]},n.push(r),i.set(h,r)),r.geometries.push(d)}var n=[],i=new WeakMap,a=this.root,c=this.styleFilter,f=THREE,d=f.Object3D,h=f.Mesh,p=[],m=[];return p.push(m),e.contain.forEach(function(e){m.length>100&&(m=[],p.push(m)),m.push(e)}),e.intersect.forEach(function(e){m.length>100&&(m=[],p.push(m)),m.push(e)}),new l.default(p,function(e){e.forEach(r)}).run().then(function(){var t=new d;return n.forEach(function(e){var r=o.default.mergeGeometries3js(e.geometries),n=e.material,s=new h(r,n);s.pickObject={id:s,mesh:s,primitive:a},t.add(s),s.matrixAutoUpdate=!1,s.modelMatrixNeedsUpdate=!1,s.frustumCulled=!1,i.delete(n)}),t.matrixAutoUpdate=!1,t.modelMatrixNeedsUpdate=!1,t.frustumCulled=!1,n.splice(0),e.contain.splice(0),e.intersect.splice(0),t})}}]),e}();r.default=c},{h_234:2,M_286:75,"-_279":189,m_285:45,e_1:235,s_2:236,M_0:241}],69:[function(e,t,r){"use strict";function n(e){var t=i();return function(){var r,n=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,l.default)(this,r)}}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var a=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=a(e("e_1")),s=a(e("s_2")),u=a(e("C_129")),l=a(e("o_130")),c=a(e("m_131")),f=a(e("M_286")),d=a(e("o_295")),h=(a(e("C_217")),a(e("-_202"))),p=a(e("e_298")),m=a(e("s_299")),v=function(e){function t(e){var n;(0,o.default)(this,t);var i=Cesium,a=i.Color,s=i.defaultValue,u=i.Event;return e.style=e.style||"standard",n=r.call(this,e),n.url=e.url,n.useRtcCenter=s(e.useRtcCenter,"standard"!=e.style),n._property=e.property||"Floor",n._scale="number"==typeof e.scale?e.scale:4,n.lodMinRange=e.lodMinRange||8,n.bottomColor=e.bottomColor||a.DARKBLUE.clone(),n.topColor=e.topColor||a.CYAN.clone(),n.debugVolume=s(e.debugVolume,!1),n.style=e.style,n._styleFilter=e.styleFilter,n._uvUnit=e.uvUnit,n._roundUv=s(e.roundUv,!1),n._lodContentProvider=null,n._material=e.material,n._terrainProvider=null,n._clampToGround=s(e.clampToGround,!1),n._receiveShadow=s(e.receiveShadow,!0),n._castShadow=s(e.castShadow,!0),n.root=null,n.onBeforeLoad=new u,n.onLoading=new u,n.onLoaded=new u,n.onDataLoaded=new u,n}(0,u.default)(t,e);var r=n(t);return(0,s.default)(t,[{key:"property",get:function(){return this._property},set:function(e){this._property!=e&&(this._property=e,this.needsUpdate=!0)}},{key:"scale",get:function(){return this._scale},set:function(e){this._scale!=e&&(this._scale=e,this.needsUpdate=!0)}},{key:"receiveShadow",get:function(){return this._receiveShadow},set:function(e){this._receiveShadow!=e&&(this._receiveShadow=e,this._lodContentProvider&&(this._lodContentProvider.receiveShadow=e),this.needsUpdate=!0)}},{key:"castShadow",get:function(){return this._castShadow},set:function(e){this._castShadow!=e&&(this._castShadow=e,this._lodContentProvider&&(this._lodContentProvider.castShadow=e),this.needsUpdate=!0)}},{key:"material",get:function(){return this._material},set:function(e){this._material!=e&&(this._material=e,this.needsUpdate=!0)}},{key:"contentProvider",get:function(){return this._lodContentProvider}},{key:"clampToGround",get:function(){return this._clampToGround},set:function(e){this._clampToGround!=e&&(this._clampToGround=e,this._lodContentProvider&&(this._lodContentProvider.clampToGround=e),this.needsUpdate=!0)}},{key:"terrainProvider",get:function(){return this._terrainProvider},set:function(e){this._terrainProvider!=e&&(this._terrainProvider=e,this._lodContentProvider&&(this._lodContentProvider.terrainProvider=e),this.needsUpdate=!0)}},{key:"roundUv",get:function(){return this._roundUv},set:function(e){e!=this._roundUv&&(this._roundUv=e,this._lodContentProvider&&(this._lodContentProvider.roundUv=this._roundUv),this.needsUpdate=!0)}},{key:"uvUnit",get:function(){return this._uvUnit},set:function(e){this._uvUnit!=e&&(this._uvUnit=e,this._lodContentProvider&&(this._lodContentProvider.uvUnit=this.uvUnit),this.needsUpdate=!0)}},{key:"styleFilter",get:function(){return this._styleFilter},set:function(e){"standard"==this.style&&"function"==typeof e&&e!=this._styleFilter&&(this._styleFilter=e,this._lodContentProvider&&(this._lodContentProvider.styleFilter=e),this.needsUpdate=!0)}},{key:"needsUpdate",set:function(e){e&&this.root&&(this.root.needsUpdate=!0)}},{key:"show",get:function(){return this._show},set:function(e){this._show=e,this.root&&(this.root.show=e)}},{key:"boundingSphere",get:function(){if(this.root)return this.root.boundingSphereWC}},{key:"load",value:function(e){var t=this;this.onBeforeLoad.raiseEvent(this);var r=e.isMeshVisualizer?e:e.globalScene,n=this.material,i=m.default;switch(this.style){case"wireframe":n=new p.default({lineColor:new THREE.Color("white"),faceColor:new THREE.Color(34042),lineWidth:1,faceOpacity:.5,transparent:!0,depthTest:!1}),i=d.default}this.material=n;var a="standard"==this.style&&"function"==typeof this.styleFilter?this.styleFilter:function(e,r){r.extrudedHeight=e.properties[t.property]*t.scale,r.material=t.material},o=new i(null,a,r,this.uvUnit,this.roundUv);this._lodContentProvider=o,o.clampToGround=this.clampToGround,o.terrainProvider=this.terrainProvider,f.default.load(this.url,a,function(e){t.onLoading.raiseEvent(t,e)},function(e){t.onDataLoaded.raiseEvent(e)},{minRange:this.lodMinRange,debugVolume:!0,showDebugVolume:this.debugVolume,debugVolumeColor:Cesium.Color.BLACK,useRtcCenter:this.useRtcCenter,getLodContentProvider:function(e,t){return o.root=e,o}}).then(function(e){t.root=e,e.show=t.show,r.add(e),t.onLoaded.raiseEvent(t)});var s=r.scene;this._removeBeforeUpdateCb=r.beforeUpdate.addEventListener(function(){s.terrainProvider instanceof Cesium.EllipsoidTerrainProvider?t.terrainProvider=null:t._terrainProvider!=s.terrainProvider&&(t.terrainProvider=s.terrainProvider)})}},{key:"unload",value:function(e){var t=this._removeBeforeUpdateCb,r=this.root,n=this._lodContentProvider;t&&t(),r&&(n.destroy&&n.destroy(),this.root=r.destroy())}}]),t}(h.default),g=v;r.default=g},{M_286:75,C_217:40,e_298:70,"-_202":55,s_299:67,o_295:68,e_1:235,s_2:236,m_131:239,C_129:240,M_0:241,o_130:242}],70:[function(e,t,r){"use strict";function n(){function e(e){c(u,e,{get:function(){return l[e].value},set:function(t){l[e].value=t}})}function t(e){c(u,e,{get:function(){return l[e].value},set:function(t){null!=t&&void 0!=t&&l[e].value.set(t)}})}var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=THREE,a=i.ShaderMaterial,o=i.Color,s=n.Shader;r=Object.assign({uniforms:{lineWidth:{type:"f",value:"number"==typeof r.lineWidth?r.lineWidth:4},faceColor:{type:"c",value:r.faceColor||new o(2236962)},faceOpacity:{type:"f",value:"number"==typeof r.faceOpacity?r.faceOpacity:1},lineColor:{type:"c",value:r.lineColor||new o(16777215)},lineOpacity:{type:"f",value:"number"==typeof r.lineOpacity?r.lineOpacity:1}},vertexShader:s.vertexShader,fragmentShader:s.fragmentShader},r),delete r.lineWidth,delete r.faceColor,delete r.faceOpacity,delete r.lineColor,delete r.lineOpacity;var u=new a(r),l=u.uniforms,c=Object.defineProperty;return t("lineColor"),t("faceColor"),e("lineWidth"),e("faceOpacity"),e("lineOpacity"),u}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,n.Shader={vertexShader:["attribute vec4 center;","varying vec4 vCenter;","void main() {","   vCenter = center;","   gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#extension GL_OES_standard_derivatives : enable","varying vec4 vCenter;","uniform float lineWidth;","uniform float faceOpacity;","uniform float lineOpacity;","uniform vec3 faceColor;","uniform vec3 lineColor;","float _lineWidth;","float edgeFactorTri() {","   vec3 d = fwidth( vCenter.xyz );","   vec3 a3 = smoothstep( vec3( 0.0 ), d * _lineWidth , vCenter.xyz );","   return min( min( a3.x, a3.y ), a3.z );","}","float edgeFactorQuad1() {","   vec2 d = fwidth( vCenter.xy );","   vec2 a2 = smoothstep( vec2( 0.0 ), d * _lineWidth , vCenter.xy );","   return min( a2.x, a2.y );","}","float edgeFactorQuad2() {","   vec2 d = fwidth( 1.0 - vCenter.xy );","   vec2 a2 = smoothstep( vec2( 0.0 ), d * _lineWidth , 1.0 - vCenter.xy );","   return min( a2.x, a2.y );","}","void main() {","   _lineWidth=lineWidth * czm_pixelRatio;","   vec4 _lineColor=vec4( lineColor , lineOpacity );","   vec4 _faceColor=vec4( faceColor , faceOpacity );","   if ( vCenter.w == 0.0 ) {","       gl_FragColor = mix( _lineColor , _faceColor , edgeFactorTri() );","   } else {","       gl_FragColor = mix( _lineColor, _faceColor, min( edgeFactorQuad1(), edgeFactorQuad2() ) );","   }","}"].join("\n")};var i=n;r.default=i},{}],71:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("h_300");Object.keys(n).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===n[e]||Object.defineProperty(r,e,{enumerable:!0,get:function(){return n[e]}}))})},{h_300:47}],72:[function(e,t,r){"use strict";function n(){if(!S){S=!0;var e=Cesium;l=e.Cartesian3,c=e.Color,f=e.ComponentDatatype,d=e.defaultValue,h=e.defined,p=e.deprecationWarning,m=e.destroyObject,v=e.DeveloperError,g=e.getStringFromTypedArray,y=e.Matrix4,_=e.RuntimeError,b=e.Cesium3DTileBatchTable,M=e.Cesium3DTileFeature,x=e.Cesium3DTileFeatureTable,i._deprecationWarning=p}}function i(e,t,r,i,a,s){n(),this._tileset=e,this._tile=t,this._resource=r,this._model=void 0,this._batchTable=void 0,this._features=void 0,this._batchIdAttributeName=void 0,this._diffuseAttributeOrUniformName={},this._rtcCenterTransform=void 0,this._contentModelMatrix=void 0,this.featurePropertiesDirty=!1,this._visualizer=s,o(this,i,a,s)}function a(e){return function(t,r){e._model.updateCommands(t,r)}}function o(e,t,r,n){var o=e._tileset,s=e._tile,u=e._resource,c=d(r,0);r=c;var p=new Uint8Array(t),m=new DataView(t);r+=T;var v=m.getUint32(r,!0);if(1!==v)throw new _("Only Batched 3D Model version 1 is supported.  Version "+v+" is not.");r+=T;var M=m.getUint32(r,!0);r+=T;var S=m.getUint32(r,!0);r+=T;var C=m.getUint32(r,!0);r+=T;var E=m.getUint32(r,!0);r+=T;var A=m.getUint32(r,!0);r+=T;var L;E>=570425344?(r-=2*T,L=S,E=C,A=0,S=0,C=0,i._deprecationWarning("b3dm-legacy-header","This b3dm header is using the legacy format [batchLength] [batchTableByteLength]. The new format is [featureTableJsonByteLength] [featureTableBinaryByteLength] [batchTableJsonByteLength] [batchTableBinaryByteLength] from https://github.com/CesiumGS/3d-tiles/tree/master/specification/TileFormats/Batched3DModel.")):A>=570425344&&(r-=T,L=E,E=S,A=C,S=0,C=0,i._deprecationWarning("b3dm-legacy-header","This b3dm header is using the legacy format [batchTableJsonByteLength] [batchTableBinaryByteLength] [batchLength]. The new format is [featureTableJsonByteLength] [featureTableBinaryByteLength] [batchTableJsonByteLength] [batchTableBinaryByteLength] from https://github.com/CesiumGS/3d-tiles/tree/master/specification/TileFormats/Batched3DModel."));var P;if(0===S)P={BATCH_LENGTH:d(L,0)};else{var O=g(p,r,S);P=JSON.parse(O),r+=S}var R=new Uint8Array(t,r,C);r+=C;var I=new x(P,R);L=I.getGlobalProperty("BATCH_LENGTH"),I.featuresLength=L;var D,B;if(E>0){var U=g(p,r,E);D=JSON.parse(U),r+=E,A>0&&(B=new Uint8Array(t,r,A),B=new Uint8Array(B),r+=A)}var N;h(o.classificationType)&&(N=a(e));var k=new b(e,L,D,B,N);e._batchTable=k;var j=c+M-r;if(0===j)throw new _("glTF byte length must be greater than 0.");var G;r%4==0?G=new Uint8Array(t,r,j):(i._deprecationWarning("b3dm-glb-unaligned","The embedded glb is not aligned to a 4-byte boundary."),G=new Uint8Array(p.subarray(r,r+j)));var V={content:e,primitive:o};e._rtcCenterTransform=y.IDENTITY;var F=I.getGlobalProperty("RTC_CENTER",f.FLOAT,3)
;h(F)&&(e._rtcCenterTransform=y.fromTranslation(l.fromArray(F))),e._contentModelMatrix=y.multiply(s.computedTransform,e._rtcCenterTransform,new y);try{var z=Cesium;e._model=new w.default({dracoDecoderPath:w.default.DefaultDracoDecoderPath,gltf:G,visualizer:n,cull:!1,releaseGltfJson:!0,opaquePass:4,basePath:u,requestType:z.RequestType.TILES3D,modelMatrix:e._contentModelMatrix,upAxis:o._gltfUpAxis,forwardAxis:z.Axis.X,shadows:o.shadows,debugWireframe:o.debugWireframe,incrementallyLoadTextures:!1,pickObject:V,imageBasedLightingFactor:o.imageBasedLightingFactor,lightColor:o.lightColor,luminanceAtZenith:o.luminanceAtZenith,sphericalHarmonicCoefficients:o.sphericalHarmonicCoefficients,specularEnvironmentMaps:o.specularEnvironmentMaps})}catch(e){throw console.error(e),e}}function s(e){var t=e.featuresLength;if(!h(e._features)&&t>0){for(var r=new Array(t),n=0;n<t;++n)r[n]=new M(e,n);e._features=r}}var u=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.Batched3DModel3DTileContentEx=i;var l,c,f,d,h,p,m,v,g,y,_,b,M,x,w=u(e("3_302")),S=!1;i._deprecationWarning=p,Object.defineProperties(i.prototype,{featuresLength:{get:function(){return this._batchTable.featuresLength}},pointsLength:{get:function(){return 0}},trianglesLength:{get:function(){return this._model.trianglesLength}},geometryByteLength:{get:function(){return this._model.geometryByteLength}},texturesByteLength:{get:function(){return this._model.texturesByteLength}},batchTableByteLength:{get:function(){return this._batchTable.memorySizeInBytes}},innerContents:{get:function(){}},readyPromise:{get:function(){return this._model.readyPromise}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._resource.getUrlComponent(!0)}},batchTable:{get:function(){return this._batchTable}}});var T=Uint32Array.BYTES_PER_ELEMENT;i.prototype.hasProperty=function(e,t){return this._batchTable.hasProperty(e,t)},i.prototype.getFeature=function(e){var t=this.featuresLength;if(!h(e)||e<0||e>=t)throw new v("batchId is required and between zero and featuresLength - 1 ("+(t-1)+").");return s(this),this._features[e]},i.prototype.applyDebugSettings=function(e,t){t=e?t:c.WHITE,0===this.featuresLength?this._model.color=t:this._batchTable.setAllColor(t)},i.prototype.applyStyle=function(e){if(0===this.featuresLength){var t=h(e)&&h(e.color),r=h(e)&&h(e.show),n=this._model;n.color=t?e.color.evaluateColor(void 0,n.color):c.clone(c.WHITE,n.color),n.show=!r||e.show.evaluate(void 0)}else this._batchTable.applyStyle(e)},i.prototype.update=function(e,t){this._batchTable.update(e,t),this._contentModelMatrix=y.multiply(this._tile.computedTransform,this._rtcCenterTransform,this._contentModelMatrix);var r=this._model,e=this._tileset;r.modelMatrix=this._contentModelMatrix,r.shadows=e.shadows,r.imageBasedLightingFactor=e.imageBasedLightingFactor,r.lightColor=e.lightColor,r.luminanceAtZenith=e.luminanceAtZenith,r.sphericalHarmonicCoefficients=e.sphericalHarmonicCoefficients,r.specularEnvironmentMaps=e.specularEnvironmentMaps,r.debugWireframe=e.debugWireframe,this._model.update(t)},i.prototype.isDestroyed=function(){return!1},i.prototype.destroy=function(){return this._model=this._model&&this._model.destroy(),this._batchTable=this._batchTable&&this._batchTable.destroy(),this._visualizer=null,m(this)}},{"3_302":180,M_0:241}],73:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("D_303"),i=e("._304"),a={init:function(){if(!this.__init__){this.__init__=!0;var e=Cesium,t=e.Cesium3DTileContentFactory;e.Cesium3DTileset.prototype.render=function(e,t){this.__frameNumber!=e.frameNumber?(this.update(e),this.__frameNumber=e.frameNumber):this.__frameNumber=e.frameNumber;for(var r=0,n=0;n<this._selectedTiles.length;n++){var i=this._selectedTiles[n],a=i.content;if(a)if(a._contents&&Array.isArray(a._contents)){var o=a._contents;o.forEach(function(e){var n=e._model||e._modelInstanceCollection;n&&n.isMeshVisModel&&(t.push(n.root),r++)})}else{var s=a._model||a._modelInstanceCollection;s&&s.isMeshVisModel&&(t.push(s.root),r++)}}},t._b3dm=t.b3dm,t.b3dm=function(e,r,i,a,o){var s=e.visualizer;return s?new n.Batched3DModel3DTileContentEx(e,r,i,a,o,s):t._b3dm(e,r,i,a,o)},t._i3dm=t.i3dm,t.i3dm=function(e,r,n,a,o){var s=e.visualizer;return s?new i.Instanced3DModel3DTileContentEx(e,r,n,a,o,s):t._i3dm(e,r,n,a,o)}}}},o=a;r.default=o},{D_303:72,"._304":74}],74:[function(e,t,r){"use strict";function n(){if(!R){R=!0;var e=Cesium;u=e.AttributeCompression,l=e.Cartesian3,c=e.Color,f=e.ComponentDatatype,d=e.defaultValue,h=e.defined,p=e.deprecationWarning,m=e.destroyObject,v=e.DeveloperError,g=e.Ellipsoid,y=e.getStringFromTypedArray,_=e.Matrix3,b=e.Matrix4,M=e.Quaternion,x=e.RequestType,w=e.RuntimeError,S=e.Transforms,T=e.TranslationRotationScale,C=e.Pass,E=e.Axis,A=e.Cesium3DTileBatchTable,L=e.Cesium3DTileFeature,P=e.Cesium3DTileFeatureTable}}function i(e,t,r,i,o,s){n(),this._tileset=e,this._tile=t,this._resource=r,this._modelInstanceCollection=void 0,this._batchTable=void 0,this._features=void 0,this.featurePropertiesDirty=!1,this._visualizer=s,a(this,i,o,s)}function a(e,t,r,n){var a=d(r,0);r=a;var o=new Uint8Array(t),s=new DataView(t);r+=I;var c=s.getUint32(r,!0);if(1!==c)throw new w("Only Instanced 3D Model version 1 is supported. Version "+c+" is not.");r+=I;var p=s.getUint32(r,!0);r+=I;var m=s.getUint32(r,!0);if(0===m)throw new w("featureTableJsonByteLength is zero, the feature table must be defined.");r+=I;var v=s.getUint32(r,!0);r+=I;var C=s.getUint32(r,!0);r+=I;var L=s.getUint32(r,!0);r+=I;var R=s.getUint32(r,!0);if(1!==R&&0!==R)throw new w("Only glTF format 0 (uri) or 1 (embedded) are supported. Format "+R+" is not.");r+=I;var U=y(o,r,m),N=JSON.parse(U);r+=m;var k=new Uint8Array(t,r,v);r+=v;var j=new P(N,k),G=j.getGlobalProperty("INSTANCES_LENGTH");if(j.featuresLength=G,!h(G))throw new w("Feature table global property: INSTANCES_LENGTH must be defined");var V,F;if(C>0){var z=y(o,r,C);V=JSON.parse(z),r+=C,L>0&&(F=new Uint8Array(t,r,L),F=new Uint8Array(F),r+=L)}e._batchTable=new A(e,G,V,F);var H=a+p-r;if(0===H)throw new w("glTF byte length is zero, i3dm must have a glTF to instance.");var W;r%4==0?W=new Uint8Array(t,r,H):(i._deprecationWarning("i3dm-glb-unaligned","The embedded glb is not aligned to a 4-byte boundary."),W=new Uint8Array(o.subarray(r,r+H)));var Y=e._tileset,X={dracoDecoderPath:O.default.DefaultDracoDecoderPath,visualizer:n,instances:new Array(G),instancedAttributes:[{name:"batchId",default:0}],batchTable:e._batchTable,cull:!1,url:void 0,requestType:x.TILES3D,gltf:void 0,basePath:void 0,incrementallyLoadTextures:!1,upAxis:Y._gltfUpAxis,forwardAxis:E.X,opaquePass:4,imageBasedLightingFactor:Y.imageBasedLightingFactor,lightColor:Y.lightColor,luminanceAtZenith:Y.luminanceAtZenith,sphericalHarmonicCoefficients:Y.sphericalHarmonicCoefficients,specularEnvironmentMaps:Y.specularEnvironmentMaps};if(0===R){var q=y(W);q=q.replace(/[\s\0]+$/,""),X.url=e._resource.getDerivedResource({url:q})}else X.gltf=W,X.basePath=e._resource.clone();var K,Z=j.getGlobalProperty("EAST_NORTH_UP"),J=j.getGlobalProperty("RTC_CENTER",f.FLOAT,3);h(J)&&(K=l.unpack(J));for(var Q=X.instances,$=new l,ee=new Array(3),te=new l,re=new l,ne=new l,ie=new _,ae=new M,oe=new l,se=new T,ue=new b,le=0;le<G;le++){var ce=j.getProperty("POSITION",f.FLOAT,3,le,D);if(!h(ce)){ce=ee;var fe=j.getProperty("POSITION_QUANTIZED",f.UNSIGNED_SHORT,3,le,D);if(!h(fe))throw new w("Either POSITION or POSITION_QUANTIZED must be defined for each instance.");var de=j.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",f.FLOAT,3);if(!h(de))throw new w("Global property: QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");var he=j.getGlobalProperty("QUANTIZED_VOLUME_SCALE",f.FLOAT,3);if(!h(he))throw new w("Global property: QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");for(var pe=0;pe<3;pe++)ce[pe]=fe[pe]/65535*he[pe]+de[pe]}l.unpack(ce,0,$),h(K)&&l.add($,K,$),se.translation=$;var me=j.getProperty("NORMAL_UP",f.FLOAT,3,le,D),ve=j.getProperty("NORMAL_RIGHT",f.FLOAT,3,le,B),ge=!1;if(h(me)){if(!h(ve))throw new w("To define a custom orientation, both NORMAL_UP and NORMAL_RIGHT must be defined.");l.unpack(me,0,re),l.unpack(ve,0,te),ge=!0}else{var ye=j.getProperty("NORMAL_UP_OCT32P",f.UNSIGNED_SHORT,2,le,D),_e=j.getProperty("NORMAL_RIGHT_OCT32P",f.UNSIGNED_SHORT,2,le,B);if(h(ye)){if(!h(_e))throw new w("To define a custom orientation with oct-encoded vectors, both NORMAL_UP_OCT32P and NORMAL_RIGHT_OCT32P must be defined.");u.octDecodeInRange(ye[0],ye[1],65535,re),u.octDecodeInRange(_e[0],_e[1],65535,te),ge=!0}else Z?(S.eastNorthUpToFixedFrame($,g.WGS84,ue),b.getMatrix3(ue,ie)):_.clone(_.IDENTITY,ie)}ge&&(l.cross(te,re,ne),l.normalize(ne,ne),_.setColumn(ie,0,te,ie),_.setColumn(ie,1,re,ie),_.setColumn(ie,2,ne,ie)),M.fromRotationMatrix(ie,ae),se.rotation=ae,oe=l.fromElements(1,1,1,oe);var be=j.getProperty("SCALE",f.FLOAT,1,le);h(be)&&l.multiplyByScalar(oe,be,oe);var Me=j.getProperty("SCALE_NON_UNIFORM",f.FLOAT,3,le,D);h(Me)&&(oe.x*=Me[0],oe.y*=Me[1],oe.z*=Me[2]),se.scale=oe;var xe=j.getProperty("BATCH_ID",f.UNSIGNED_SHORT,1,le);h(xe)||(xe=le),b.fromTranslationRotationScale(se,ue);var we=ue.clone();Q[le]={modelMatrix:we,batchId:xe}}e._modelInstanceCollection=new O.default(X)}function o(e){var t=e.featuresLength;if(!h(e._features)&&t>0){for(var r=new Array(t),n=0;n<t;++n)r[n]=new L(e,n);e._features=r}}var s=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.Instanced3DModel3DTileContentEx=i;var u,l,c,f,d,h,p,m,v,g,y,_,b,M,x,w,S,T,C,E,A,L,P,O=s(e("3_302")),R=!1;i._deprecationWarning=p,Object.defineProperties(i.prototype,{featuresLength:{get:function(){return this._batchTable.featuresLength}},pointsLength:{get:function(){return 0}},trianglesLength:{get:function(){var e=this._modelInstanceCollection._model;return h(e)?e.trianglesLength:0}},geometryByteLength:{get:function(){var e=this._modelInstanceCollection._model;return h(e)?e.geometryByteLength:0}},texturesByteLength:{get:function(){var e=this._modelInstanceCollection._model;return h(e)?e.texturesByteLength:0}},batchTableByteLength:{get:function(){return this._batchTable.memorySizeInBytes}},innerContents:{get:function(){}},readyPromise:{get:function(){return this._modelInstanceCollection.readyPromise}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._resource.getUrlComponent(!0)}},batchTable:{get:function(){return this._batchTable}}});var I=Uint32Array.BYTES_PER_ELEMENT,D=new Array(4),B=new Array(4);i.prototype.hasProperty=function(e,t){return this._batchTable.hasProperty(e,t)},i.prototype.getFeature=function(e){var t=this.featuresLength;if(!h(e)||e<0||e>=t)throw new v("batchId is required and between zero and featuresLength - 1 ("+(t-1)+").");return o(this),this._features[e]},i.prototype.applyDebugSettings=function(e,t){t=e?t:c.WHITE,this._batchTable.setAllColor(t)},i.prototype.applyStyle=function(e){this._batchTable.applyStyle(e)},i.prototype.update=function(e,t){this._batchTable.update(e,t);var r=this._modelInstanceCollection,e=this._tileset;r.modelMatrix=this._tile.computedTransform,r.shadows=e.shadows,r.lightColor=e.lightColor,r.luminanceAtZenith=e.luminanceAtZenith,r.sphericalHarmonicCoefficients=e.sphericalHarmonicCoefficients,r.specularEnvironmentMaps=e.specularEnvironmentMaps,r.debugWireframe=e.debugWireframe},i.prototype.isDestroyed=function(){return!1},i.prototype.destroy=function(){return this._modelInstanceCollection=this._modelInstanceCollection&&this._modelInstanceCollection.destroy(),this._batchTable=this._batchTable&&this._batchTable.destroy(),this._visualizer=null,m(this)}},{"3_302":180,M_0:241}],75:[function(e,t,r){"use strict";function n(e,t){return{requestContent:function(r,n){function i(e){var r,i={},s=e.uri,u=s.properties.featureId;t(s,i);var l=d.parseFeature(s,u,i),c=i.material;if(n){l instanceof Cesium.Geometry||(l=l.constructor.createGeometry(l));for(var f=l.attributes.position.values,h=0;h<f.length;h+=3)f[h]-=n.x,f[h+1]-=n.y,f[h+2]-=n.z}o.has(c)?r=o.get(c):(r={material:c,geometries:[]},a.push(r),o.set(c,r)),r.geometries.push(l)}var a=[],o=new WeakMap,u=[],c=[];return u.push(c),r.contain.forEach(function(e){c.length>100&&(c=[],u.push(c)),c.push(e)}),r.intersect.forEach(function(e){c.length>100&&(c=[],u.push(c)),c.push(e)}),new l.default(u,function(e){e.forEach(i)}).run().then(function(){var t=new THREE.Object3D;return a.forEach(function(r){var n=s.default.mergeGeometries(r.geometries);n=s.default.toBufferGeometry3js(n);var i=r.material,a=new THREE.Mesh(n,i);a.pickObject={id:a,mesh:a,primitive:e},t.add(a),a.matrixAutoUpdate=!1,a.modelMatrixNeedsUpdate=!1,a.frustumCulled=!1,o.delete(i)}),t.matrixAutoUpdate=!1,t.modelMatrixNeedsUpdate=!1,t.frustumCulled=!1,a.splice(0),r.contain.splice(0),r.intersect.splice(0),t})}}}var i=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var a=i(e("e_1")),o=i(e("s_2")),s=i(e("s_310")),u=i(e("h_311")),l=i(e("-_312")),c=i(e("3_313")),f=i(e("D_314")),d=(i(e("._315")),function(){function e(){(0,a.default)(this,e)}return(0,o.default)(e,null,[{key:"loadGeojson",value:function(e){return Cesium.Resource.fetchJson(e)}},{key:"load",value:function(e,t,r,n,i){var a=this;return"function"!=typeof n&&(i=n,n=null),this.loadGeojson(e).then(function(e){return console.time("calcBBox"),u.default.calcBBox(e),console.timeEnd("calcBBox"),"function"==typeof n&&n(e),a.parse(e,t,r,i)})}},{key:"parse",value:function(e,t,r,i){r&&"function"!=typeof r&&(i=r,r=null),r||(r=function(e){}),i=i||{},i.useRtcCenter="boolean"!=typeof i.useRtcCenter||i.useRtcCenter,console.time("process contentSet");var a,o=i.getLodContentProvider||n,s=[],d=0,h=0,p=[],m=[],v=e.features&&e.features.length>100?e.features.length/100:100;p.push(m),u.default.featureEach(e,function(e,t){if(!e.geometry||!e.geometry.coordinates.length)return void h++;m.length>v&&(m=[],p.push(m)),m.push({feature:e,id:t})});var g=Cesium,y=g.Rectangle,_=g.TileBoundingRegion,b=g.Color,M=new l.default(p,function(e){for(var t=0;t<e.length;t++){var r=e[t],n=r.feature,i=r.id;try{var o=n.geometry.bbox,u=10*n.properties.Floor,l=y.fromDegrees(o[0],o[1],o[2],o[3]),c=new _({rectangle:l,minimumHeight:.1,maximumHeight:u});n.properties=n.properties||{},n.properties.featureId=i;var f={uri:n,boundingVolume:{region:c,sphere:c.boundingSphere},showDebugVolume:!1};s.push(f),d=Math.max(d,u),a?y.union(a,l,a):a=l.clone()}catch(e){throw console.error(e),e}}}),x=0;return M.run(function(e){x=.4*e,r(x)}).then(function(){x=40,r(x);try{var e=new _({rectangle:a,minimumHeight:.1,maximumHeight:d}),n=a.width/a.height,u=4,h=4;n>1?u=parseInt(Math.ceil(h*n)):h=parseInt(Math.ceil(u/n));var g=f.default.create({rootBoundingVolume:{region:e},maxLevel:i.maxLevel||5,zSliceLevel:i.zSliceLevel||6,xSize:u,ySize:h,zSize:2,minRange:i.minRange||2,debugVolume:i.debugVolume,showDebugVolume:i.showDebugVolume,debugVolumeColor:i.debugVolumeColor||b.CYAN.clone(),rtcCenter:i.useRtcCenter&&e.boundingSphere.center,recursive:!1}),y=g.children.slice();return new l.default(y,function(e){e._createLODTreeDelay(!0)}).run(function(e){r(.2*e+x)}).then(function(){return x=60,r(x),y=g.children.slice(),new l.default(y,function(e){f.default.filterContents(s,e,!1)}).run(function(e){r(.1*e+x)}).then(function(){x=70,r(x);var e=[];return g.children.forEach(function(t){(0,c.default)(t.children,function(t){t.refine="ADD",t.level>0&&e.push(t)})}),e.sort(function(e,t){return e.level-t.level}),p=[],m=[],p.push(m),v=100,e.forEach(function(e){m.length>v&&(m=[],p.push(m)),m.push(e)}),new l.default(p,function(e){for(var t=0;t<e.length;t++){var r=e[t],n=r.parent._getContentSetBeforeFilter();f.default.filterContents(n,r,!1)}}).run(function(e){r(.3*e+x)}).then(function(){x=100;var e=o(g,t);return g.children.forEach(function(t){(0,c.default)(t,function(t){t.contentProvider=e})}),r(x),g})})})}catch(e){throw console.error(e),e}})}},{key:"parseFeature",value:function(e,t,r){if(e.geometry){var n=this.parseGeometry(e.geometry,r),i=n.attributes.position.values.length,a=new Float32Array(i);a.fill(t);var o=Cesium,s=new o.GeometryAttribute({componentDatatype:o.ComponentDatatype.FLOAT,componentsPerAttribute:1,values:a});return n.attributes.batchId=s,n}}},{key:"parseGeometry",value:function(e,t){var r=this,n=e.type;if("Polygon"==n)e=this.parsePolygon(e.coordinates,t);else if("MultiPolygon"==n){var i=e.coordinates.map(function(e){return r.parsePolygon(e,t)});e=s.default.mergeGeometries(i)}else if("MultiGeometry"==n){var a=e.geometry.map(function(e){return r.parseGeometry(e,t)});e=s.default.mergeGeometries(a)}return e}},{key:"parsePolygon",value:function(e,t){for(var r=Cesium,n=r.PolygonHierarchy,i=r.PolygonGeometry,a=this.transformCoordinates(e[0]),o=[],s=1;s<e.length;s++){var u=e[s];u=new n(this.transformCoordinates(u)),o.push(u)}var l=i,c=new l(Object.assign({polygonHierarchy:new n(a,o),generateExtrudedUvNormal:!0},t));return c=l.createGeometry(c)}},{key:"transformCoordinates",value:function(e){var t=u.default.isClockWise(e);return e=e.map(function(e){return Cesium.Cartesian3.fromDegrees(e[0],e[1],e[2]||0)}),t||e.reverse(),e}}]),e}());r.default=d},{s_310:2,"-_312":189,h_311:199,"3_313":207,"._315":83,D_314:84,e_1:235,s_2:236,M_0:241}],76:[function(e,t,r){"use strict";var n=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i,a,o,s,u,l,c=n(e("e_1")),f=n(e("s_2")),d=e("3_170"),h=n(e("s_123")),p=(n(e("s_321")),{x:0,y:0,z:-1}),m={x:0,y:1,z:0},v=function(){function e(){(0,c.default)(this,e),this.visualizer=new h.default,this.cameraMeshes=new WeakMap,this.cameras=[],this.show=!0}return(0,f.default)(e,[{key:"update",value:function(e){this.show&&this.visualizer.update(e)}},{key:"removeCamera",value:function(e){if(this.cameraMeshes.has(e)){var t=this.cameraMeshes.get(e);-1!=this.visualizer.children.indexOf(t.frustum)&&this.visualizer.remove(t.frustum),-1!=this.visualizer.children.indexOf(t.direction)&&this.visualizer.remove(t.direction),this.cameraMeshes.delete(e)}}},{key:"addCamera",value:function(e,t,r,n){if(this.cameraMeshes.has(e)){var i=this.cameraMeshes.get(e);return-1==this.visualizer.children.indexOf(i.frustum)&&this.visualizer.add(i.frustum),void(-1==this.visualizer.children.indexOf(i.direction)&&this.visualizer.add(i.direction))}var a=this.createGeometry(e,n),o=new THREE.LineBasicMaterial({color:(t||Cesium.Color.YELLOW).toCssColorString(),side:2}),s=new THREE.LineBasicMaterial({color:(r||Cesium.Color.RED).toCssColorString(),side:2}),u=new THREE.LineSegments(a.frustumOutline,o),l=new THREE.LineSegments(a.direction,s);l.frustumCulled=!1,u.frustumCulled=!1,l.up.set(0,0,1),u.up.set(0,0,1),this.visualizer.add(u),this.visualizer.add(l),this.cameraMeshes.set(e,{frustum:u,direction:l}),this.cameras.push(e)}},{key:"createGeometry",value:function(e,t){var r=Cesium,n=r.Matrix4,s=r.Cartesian3,u=r.Quaternion,c=r.Matrix3,f=r.FrustumOutlineGeometry;t=t||e.inverseViewMatrix,t.elements&&(t=t.elements),o=n.getMatrix3(t,o||new c),i=u.fromRotationMatrix(o,i||new u),l=u.fromAxisAngle(m,Math.PI,l),u.multiply(i,l,i),a=n.getTranslation(e.inverseViewMatrix,a||new s);var h=new f({frustum:e.frustum,origin:a,orientation:i});return{direction:d.GeometryUtils.toBufferGeometry3js(this.createDirGeometry(a,o,e.frustum.far)),frustumOutline:d.GeometryUtils.toBufferGeometry3js(f.createGeometry(h))}}},{key:"createDirGeometry",value:function(e,t,r){var n=Cesium,i=n.Matrix4,a=n.Cartesian3,o=n.Geometry,l=n.ComponentDatatype;u=i.IDENTITY.clone(u),i.multiplyByMatrix3(u,t,u),s||(s=new a),i.multiplyByPoint(u,p,s),a.multiplyByScalar(s,r||5e10,s);var c=a.add(e,s,s),f=new Float32Array(6);a.pack(e,f,0),a.pack(c,f,3);var d=new Uint8Array([0,1]);return new o({attributes:{position:{componentDatatype:l.FLOAT,componentsPerAttribute:3,values:f}},indices:d})}},{key:"updateCamera",value:function(e,t){var r=this.cameraMeshes.get(e),n=this.createGeometry(e,t);r.frustum.geometry=n.frustum,r.frustum.geometry.needsUpdate=!0,r.direction.geometry=n.direction,r.direction.geometry.needsUpdate=!0}}]),e}(),g=v;r.default=g},{s_123:5,"3_170":39,s_321:77,e_1:235,s_2:236,M_0:241}],77:[function(e,t,r){"use strict";function n(e){function t(e){var t=e.geometry;if(t){var n=t.attributes.position;if(n)for(var i=n.array,a=0;a<i.length;a+=3)i[a]-=r.x,i[a+1]-=r.y,i[a+2]-=r.z}}var r=e._rtcCenter;if(!r){var n=function(e){var t=e.geometry;if(t){var r=t.boundingSphere;r||(t.computeBoundingSphere(),r=t.boundingSphere),i.push(Cesium.BoundingSphere.clone(r))}},i=[];if(e.traverse(n),i.length){var o=Cesium.BoundingSphere.fromBoundingSpheres(i);e._rtcCenter=r=o.center}}if(!r)return e;e.traverse(t);var s=function(t,r){var n=a(r.context.uniformState,e);t.modelView=n,t.u_modelView=n,t.modelViewMatrix=n,t.u_modelViewMatrix=n};return e.traverse(function(e){e.geometry&&(e.uniformMapLoadedCallback=s)}),e.geometry&&(e.uniformMapLoadedCallback=s),e}Object.defineProperty(r,"__esModule",{value:!0}),r.default=n;var i,a=function(e,t){var r=Cesium,n=r.Matrix4,a=r.defined,o=r.Cartesian3,s=new n;return i||(i=new n),function(){return a(t._rtcCenter)?(n.getTranslation(e.model,i),o.add(i,t._rtcCenter,i),n.multiplyByPoint(e.view,i,i),n.setTranslation(e.modelView,i,s)):e.modelView}}},{}],78:[function(e,t,r){"use strict";var n=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("e_1")),a=n(e("s_2")),o=(n(e("D_325")),function(){function e(){(0,i.default)(this,e)}return(0,a.default)(e,[{key:"requestContent",value:function(e,t){throw new Error("IContentProvider.requestContent not implemented")}}]),e}());r.default=o},{D_325:85,e_1:235,s_2:236,M_0:241}],79:[function(e,t,r){"use strict";function n(e){var t=0;if(e.isTexture){var r=e.image;t=r.width*r.height*4}else if(e.isGeometry){var i=y.default.get(e),a=i.attributes;for(var o in a)if(a[o]){var s=a[o].array;t+=s.buffer.byteLength}e.index&&(t+=e.index.array.buffer.byteLength)}else if(e.isMesh){var u=n(e.geometry),l=e.material;Array.isArray(l)||(l=[l]);var c=0;l.forEach(function(e){c+=n(e)}),t=c+u}else e.isMaterial?_.forEach(function(r){var i=e[r];i&&(t+=n(i))}):e.isObject3D&&e.children.forEach(function(e){t+=n(e)});return t}function i(e,t){for(var r=Cesium,n=r.Rectangle,i=r.Cartographic,a=r.Matrix4,o=r.Cartesian3,s=r.Ellipsoid,u=r.TileBoundingRegion,l=e.minimum,c=e.maximum,f=[l.x,c.x],d=[l.y,c.y],h=[l.z,c.z],p=new o(0,0,0),m=new o,v=new i,g=2*Math.PI,y=-g,_=Math.PI,b=-_,M=Number.MAX_VALUE,x=-M,w=0;w<f.length;w++){p.x=f[w];for(var S=0;S<d.length;S++){p.y=d[S];for(var T=0;T<h.length;T++)p.z=h[T],a.multiplyByPoint(t,p,m),i.fromCartesian(m,s.WGS84,v),g=Math.min(v.longitude,g),y=Math.max(v.longitude,y),_=Math.min(v.latitude,_),b=Math.max(v.latitude,b),M=Math.min(v.height,M),x=Math.max(v.height,x)}}return new u({rectangle:n.fromRadians(g,_,y,b),minimumHeight:M,maximumHeight:x,ellipsoid:s.WGS84})}function a(e){var t=Cesium,r=t.Cartographic.fromCartesian(e);return t.Cartesian3.fromRadians(r.longitude,r.latitude,0)}function o(e,t){var r=Cesium,n=r.Rectangle,i=r.Cartographic,a=r.Cartesian3,o=r.IntersectionTests,s=r.Ray;if(e.region){var u=i.fromCartesian(t),l=e.region.rectangle;return n.contains(l,u)}g||(g=new s),a.clone(t,g.position),a.normalize(t,g.direction);var c=e.boundingSphereWC||e.boundingSphere;return!!c&&o.raySphere(g,c)}function s(e,t,r){var n=r?t:a(t),i=e.children.length;if(o(e,n)){for(var u,l=0;l<i&&!(u=s(e.children[l],n,!0));l++);return!u&&e.isCommandsReady()&&(u=e),u}}function u(e,t,r,n){t.forEach(function(i){if(!i.positionClamped||n){var a=i.position,o=a.getValue(r.clock.currentTime);if(s(e,o)){var u=r.scene.clampToHeight(o,t);u&&(i.position=u,i.positionClamped=u)}}})}function l(e,t,r){return r=r||0,t=t||[],Cesium.Rectangle.pack(e.rectangle,r),t[r+4]=e.minimumHeight,t[r+5]=e.maximumHeight,t}function c(e,t){var r=Cesium,n=r.Rectangle,i=r.TileBoundingRegion;return t=t||0,new i({rectangle:n.unpack(e,t),minimumHeight:e[t+4],maximumHeight:e[t+5]})}function f(e,t,r){r=r||0,t=t||[];var n=Cesium.Cartesian3;return n.pack(e.center,t,r),n.pack(e.minimum,t,r+3),n.pack(e.maximum,t,r+6),t}function d(e,t,r){t=t||0;var n=Cesium,i=n.Cartesian3,a=n.AxisAlignedBoundingBox;return r||(r=new a),i.unpack(e,t,r.center),i.unpack(e,t+3,r.minimum),i.unpack(e,t+6,r.maximum),r}function h(e,t,r){return r=r||0,t||(t=[]),Cesium.Cartesian3.pack(e.center,t,r),t[r+3]=e.radius,t}function p(e,t,r){t=t||0;var n=Cesium,i=n.Cartesian3,a=n.BoundingSphere;return r||(r=new a),i.unpack(e,t,r.center),r.radius=e[t+3],r}function m(e){var t=Cesium,r=t.BoundingSphere,n=t.AxisAlignedBoundingBox,i=t.Cartesian3,a=t.Matrix4;e.updateMatrixWorld(!0);var o=[];e.updateMatrixWorld(),e.traverse(function(e){if(e.isMesh){var t=e.geometry,r=t.getAttribute("position");!r||r.count,r=r.array;try{r=i.unpackArray(r),r.forEach(function(t){a.multiplyByPoint(e.matrixWorld.elements,t,t),o.push(t)})}catch(e){console.error(e)}}});var s=n.fromPoints(o),u=r.fromPoints(o),l=s.center,c=[];return i.pack(l,c,0),i.pack(s.minimum,c,3),i.pack(s.maximum,c,6),{sphere:[u.center.x,u.center.y,u.center.z,u.radius],box:c}}var v=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.memeoryOf=n,r.boundingBoxToRegion=i,r.getSurfacePosition=a,r.tileContains=o,r.selectTileLoaded=s,r.updatePositionClamped=u,r.packBoundingRegion=l,r.unpackBoundingRegion=c,r.packBoundingBox=f,r.unpackBoundingBox=d,r.packBoundingSphere=h,r.unpackBoundingSphere=p,r.computeBoundingVolume=m;var g,y=v(e("C_327")),_=["map","lightMap","bumpMap","aoMap","specularMap","alphaMap","envMap","normalMap","emissiveMap","displacementMap","metalnessMap","roughnessMap","transmissionMap","clearcoatNormalMap","clearcoatMap"]},{C_327:22,M_0:241}],80:[function(e,t,r){"use strict";function n(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(n=function(e){return e?r:t})(e)}function i(e){var t=a();return function(){var r,n=(0,T.default)(e);if(t){var i=(0,T.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,S.default)(this,r)}}function a(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function o(e,t){var r=e.root&&!e.root._visible;return r||(r=e.parent&&!e.parent._visible),r||(r=!e._visible),r||(r=(0,N.pendingSort)(e,t)>0),r}function s(e,t){var r={uri:e.uri.replace(t,".")};return e.localBoundingSphere&&(r.sphere=(0,U.packBoundingSphere)(e.localBoundingSphere)),e.aabbLocal&&(r.box=(0,U.packBoundingBox)(e.aabbLocal)),r}function u(e){if(e.boundingSphere){var t=Cesium,r=t.Matrix3,n=t.Matrix4,i=t.BoundingSphere,a=e.tileset,o=a?a.modelMatrix:e.modelMatrix,s=n.getMaximumScale(o),u=e.boundingSphere,l=e.localBoundingSphere;u.radius*=s,n.multiplyByPoint(o,l.center,u.center),e.boundingSphere2d=i.projectTo2D(u,null,e.boundingSphere2d);var c=e.obb,f=e.aabbLocal;if(c){n.multiplyByPoint(o,c.center,c.center),_||(_=new r);var d=n.getMatrix3(o,_);r.multiply(d,c.halfAxes,c.halfAxes)}e.aabbLocal&&(n.multiplyByPoint(o,f.center,e.aabb.center),e.region=(0,U.boundingBoxToRegion)(f,o)),e.content&&(e.content.traverse(function(e){e.isMesh&&(e.frustumCulled=!1,n.multiply(o,e.matrixWorld.elements,e.modelMatrix)),e.matrixAutoUpdate=!1,e.modelMatrixNeedsUpdate=!1}),e.debugVolume&&e.debugVolume.isObject3D&&(e.debugVolume._modelMatrix=o))}}function l(e){var t,r=e.osgRoot;if(e._osgBuffer){if(!(r=P.readBuffer(e._osgBuffer))){var n=new Uint8Array(e._osgBuffer);n=THREE.LoaderUtils.decodeText(n),r=(0,O.readOsg)(n),e.content=(0,O.parseOsg)(r,!1),(0,L.default)(e.content,function(t){t.castShadow=e.castShadow,t.receiveShadow=e.receiveShadow})}e.osgRoot=r,e._osgBuffer=null}if(r){e.rangeDataList=r.RangeDataList,e.rangeList=r.RangeList;var i=e.tileset.minHeight;"number"==typeof e.tileset.minHeight&&P.traverse(r,function(e){if("Osg::Geometry"===e.Type)for(var t=e.VertexArray.Value,r=0;r<t.length;r+=3)t[r+2]<i&&(t[r+2]=i)}),e._isExpired||d(e),e._isEmptyLOD?(t=Cesium.when.defer(),t.resolve(e)):"Osg::PagedLOD"==r.Type||"Osg::Geometry"==r.Type?(e.children[0]||h(e),t=c(e)):(e.hasEmbedLOD=!0,e._contentMemorySize=0,t=p(e))}else t=Cesium.when.defer(),t.resolve(e);return t}function c(e){var t=e.tileset,r=Cesium.when.defer();if(e.content){var n=(0,U.memeoryOf)(e.content);t._memorySize+=n,e._contentMemorySize=n,r.resolve(e)}else{var i=e.loader,a=e.tileset;i.parse(e.osgRoot,e.path,function(t){t.traverse(function(t){t.isMesh&&(t.frustumCulled=!1,t.pickObject={id:e,mesh:t,primitive:a},t.material.autoRefresh=!1,t.modelMatrix=Cesium.Matrix4.multiply(a.modelMatrix,t.matrixWorld.elements,t.modelMatrix)),t.matrixAutoUpdate=!1,t.modelMatrixNeedsUpdate=!1});var n=(0,U.memeoryOf)(t);a._memorySize+=n,e._contentMemorySize=n,e.content=t,e.content.osgRoot=null,e.osgRoot=null,u(e),r.resolve(e)},function(e){console.error(e),r.reject(e)},{loadTexture:a.loadTexture,materialType:a.materialType})}return r}function f(e){var t=Cesium,r=t.BoundingSphere,n=t.Cartesian3,i=t.Matrix4;if(e._isEmptyLOD=!1,!e.tileset){var a=[];return e.children.forEach(function(e){e._isEmptyLOD||a.push(e.localBoundingSphere)}),e.localBoundingSphere=r.fromBoundingSpheres(a),void(e.boundingSphere=e.localBoundingSphere.clone())}var o=e.osgRoot;if(o){var s=o.Children,u=o.UserCenter;if("Osg::PagedLOD"==o.Type)e.localBoundingSphere=new r(n.fromArray(u.center),u.radius);else if(s&&"Osg::PagedLOD"==s[0].Type){var l=[];o.Children.forEach(function(e){(u=e.UserCenter)&&l.push(new r(n.fromArray(u.center),u.radius))}),l.length&&(e.localBoundingSphere=r.fromBoundingSpheres(l))}else{var c=[];P.traverse(o,function(e){if("Osg::Geometry"==e.Type){var t=e.VertexArray.Value;c.push(r.fromVertices(t))}}),0==c.length?e._isEmptyLOD=!0:e.localBoundingSphere=r.fromBoundingSpheres(c)}}if(!e._isEmptyLOD){e.boundingSphere=e.localBoundingSphere.clone();var f=i.getMaximumScale(e.tileset.modelMatrix);e.boundingSphere.radius*=f,i.multiplyByPoint(e.tileset.modelMatrix,e.localBoundingSphere.center,e.boundingSphere.center),e.boundingSphere2d=r.projectTo2D(e.boundingSphere)}}function d(e){var t=Cesium,r=(t.Color,t.AxisAlignedBoundingBox),n=t.OrientedBoundingBox,i=t.Matrix3,a=t.Cartesian3,o=t.BoxOutlineGeometry,s=(t.Transforms,t.Matrix4);try{if(f(e),e._isEmptyLOD)return;var u=e.osgRoot,l=e.tileset.modelMatrix;if(u){var c=[];if(P.traverse(u,function(e){if("Osg::Geometry"==e.Type){var t=a.unpackArray(e.VertexArray.Value);c=c.concat(t)}}),!c.length)return;e.obbLocal=n.fromPoints(c),e.aabbLocal=r.fromPoints(c)}else if(!e.aabbLocal&&!e.obbLocal)return;if(e.aabbLocal&&(e.aabb=e.aabbLocal.clone(),s.multiplyByPoint(l,e.aabbLocal.center,e.aabb.center),e.region=(0,U.boundingBoxToRegion)(e.aabbLocal,l),e.debugVolume)){var d=o.fromAxisAlignedBoundingBox(e.aabbLocal);d=o.createGeometry(d),d=j.default.toBufferGeometry3js(d);var h=new THREE.LineBasicMaterial({color:"cyan"});h.allowPick=!1,e.debugVolume=new THREE.LineSegments(d,h),e.debugVolume.modelMatrixNeedsUpdate=!1,e.debugVolume._modelMatrix=e.tileset.modelMatrix}if(e.obbLocal){e.obb=e.obbLocal.clone(),s.multiplyByPoint(l,e.obb.center,e.obb.center),_||(_=new i);var p=s.getMatrix3(l,_);i.multiply(p,e.obb.halfAxes,e.obb.halfAxes)}}catch(e){throw e}}function h(e){var t=e.rangeDataList;if(t&&t.length>0){var r=t[1],n=e,i=new G({tileset:n.tileset,tileId:r,manager:n.manager,loader:n.loader,parent:n,root:n.root||n,uri:n.path+"/"+r,debugVolume:n.debugVolume,showDebugVolume:n.showDebugVolume,minRange:n.minRange,receiveShadow:n.receiveShadow,castShadow:n.castShadow});e.children.push(i)}}function p(e){var t=[];return e.osgRoot.Children.forEach(function(r,n){var i,a=e.children[n];if(a)a.osgRoot=r,a.state=k.default.LOADING,i=c(a);else{var o=e.tileId+"."+n,s=e;a=new G({uri:s.uri+n,tileId:o,parent:s,manager:s.manager,loader:s.loader,tileset:s.tileset,root:s.root||s,debugVolume:s.debugVolume,showDebugVolume:s.showDebugVolume,minRange:s.minRange,isEmbedLOD:!0,receiveShadow:s.receiveShadow,castShadow:s.castShadow}),a.state=k.default.LOADING,a.osgRoot=r,i=l(a),
e.children.push(a)}i=i.then(function(){return a.state=k.default.LOADED,a.osgRoot=null,a.ready=!0,a._isExpired=!1,a.readyPromise.resolve(a),a}),t.push(i)}),Cesium.when.all(t,function(){return e.osgRoot=null,e})}function m(e,t,r,n,i){e.children.forEach(function(e){var a=e.content;if(!a)return void(e._isEmptyLOD=!0);a.traverse(function(e){var a=e.material;if(a){var o=a.map;o&&r._textures.get(o,t),r._webglRenderItems.getAndUpdate(e,t,!1,n,i)}}),e.state=k.default.READY}),e._initialized=!0}function v(e,t,r,n,i){var a=e.state,s=e.tileset,u=r._textures,l=r._webglRenderItems;if(!s._lodInitializing)if(a==k.default.UNLOADED||a==k.default.EXPIRED){var c=s._lodLoading;if(c){if(c==e)return;if("SpeedFirst"!=s.optimizeType){if(!o(c,e))return;c.cancelRequest()}}s._lodLoading=e,e.requestTile().then(function(){"SpeedFirst"==s.optimizeType&&(e.state=k.default.READY,s._shouldRaiseTileLoaded=!0),s._lodLoading=null}).otherwise(function(e){console.warn("Failed to load tile:"+tileToLoad.uri),console.error(e),s._lodLoading=null})}else{var c=s._lodInitializing;if(c)return;var f=e.content;if(!f)return;if("SpeedFirst"==s.optimizeType)return e.state=k.default.READY,s._shouldRaiseTileLoaded=!0,void(s._lodInitializing=null);s._lodInitializing=e,a==k.default.LOADED?(e.state=k.default.TEXTRURE_INITIALIZING,f.traverse(function(e){var r=e.material;if(r&&r.map){var n=r.map;u.get(n,t)}}),Cesium.requestAnimationFrame(function(){e.state=k.default.TEXTRURE_INITIALIZED,s._lodInitializing=null})):a==k.default.TEXTRURE_INITIALIZED&&(e.state=k.default.RENDER_ITEM_INITIALIZING,f.traverse(function(r){var a=r.geometry,o=r.material;if(a&&o&&(l.getAndUpdate(r,t,!1,i,n),e.tileset.releaseGeometry)){var s=a.attributes;for(var u in s)if(Object.hasOwnProperty.call(s,u)){var c=s[u];c.array=new c.array.constructor(0)}}}),Cesium.requestAnimationFrame(function(){e.state=k.default.READY,s._shouldRaiseTileLoaded=!0,s._lodInitializing=null}))}}var g=e("M_0"),y=e("M_110");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var _,b=g(e("e_1")),M=g(e("s_2")),x=g(e("s_332")),w=g(e("C_129")),S=g(e("o_130")),T=g(e("m_131")),C=g(e("D_336")),E=g(e("._337")),A=g(e("-_312")),L=g(e("3_313")),P=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==y(e)&&"function"!=typeof e)return{default:e};var r=n(t);if(r&&r.has(e))return r.get(e);var i={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=a?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(i,o,s):i[o]=e[o]}return i.default=e,r&&r.set(e,i),i}(e("m_340")),O=e("M_341"),R=g(e("e_342")),I=g(e("s_343")),D=g(e("h_344")),B=g(e("-_345")),U=e("3_346"),N=e("D_347"),k=g(e("._348")),j=g(e("s_310")),G=function(e){function t(e){var n;(0,b.default)(this,t),n=r.call(this,e),n.isPagedLOD=!0,n.isEmbedLOD=!!e.isEmbedLOD,n.hasEmbedLOD=!!e.hasEmbedLOD,n.uri=e.uri,n.path=C.default.GetDirectoryName(n.uri),n.debugVolume=e.debugVolume,n.showDebugVolume=e.showDebugVolume,n.rangeDataList=e.rangeDataList||[],n.rangeList=e.rangeList||[],n.minRange=e.minRange||8,n.boundingSphere=null,n.localBoundingSphere=null,n.aabb=null,n.aabbLocal=null,n.obb=null,n.obbLocal=null,n.region=null,n.state=k.default.UNLOADED,n.manager=e.manager;var i=Cesium,a=i.when,o=i.defaultValue,s=i.Matrix4,u=i.Event,l=n.uri.toLowerCase();if(l.endsWith(".xml")||l.endsWith(".json"))n.onInitProgress=e.onInitProgress,n.debugVolumeOnly=o(e.debugVolumeOnly,!1),n.ext=e.ext||"osgb",n.dataDir=e.dataDir||"/Data",n.tilePattern=e.tilePattern||"Tile_{x}_{y}",n.metadata={},n.minX=e.minX||0,n.maxX=e.maxX||8,n.minY=e.minY||0,n.maxY=e.maxY||8,n._transform=e.transform||s.IDENTITY.clone(),n._srsTransform=s.IDENTITY.clone(),n._srsMatrix=s.IDENTITY.clone(),n._computedTransform=s.IDENTITY.clone(),n.modelMatrix=s.IDENTITY.clone(),n.modelMatrixNeedsUpdate=!0,n._memorySize=0,n.geometryErrorScale=e.geometryErrorScale||.75,n.maximumMemorySize=e.maximumMemorySize||524288e3,n.tileLoaded=new u,n._shouldRaiseTileLoaded=!1,n.queue=new N.PagedLODQueue((0,x.default)(n)),n.show=o(e.show,!0),n.castShadow=o(e.castShadow,!1),n.receiveShadow=o(e.receiveShadow,!1),n.loadTexture=o(e.loadTexture,!0),n.materialType=o(e.materialType,"basic"),n.minHeight=e.minHeight,n.releaseGeometry=o(e.releaseGeometry,!0),n.sortType=o(e.sortType,"RangeFirst"),n.optimizeType=o(e.optimizeType,"PerformanceFirst"),n._level=-1,n.debugSuspendVisit=!1,n.loadMetaData();else{var c=e.parent,f=e.root,d=e.tileset,h=e.tileId;n._level=(c||f||d)._level+1,n.parent=c,n.root=f,n.tileId=h,n.tileset=d,n._timeStamp=Date.now(),n._contentMemorySize=0,n.castShadow=e.castShadow,n.receiveShadow=e.receiveShadow}return n.loader=e.loader||new R.default(n.manager),n.children=e.children||[],n.ready=!1,n.readyPromise=a.defer(),n}(0,w.default)(t,e);var r=i(t);return(0,M.default)(t,[{key:"transform",get:function(){return this._transform},set:function(e){this.center&&!Cesium.Matrix4.equals(e,this._transform)&&(this._transform=e,this.modelMatrixNeedsUpdate=!0)}},{key:"loadMetaData",value:function(){function e(){var e=c.metadata;if(c.center=a.fromDegrees(e.srs[0],e.srs[1],e.srs[2]||0),c.centerCartographic=o.fromDegrees(e.srs[0],e.srs[1],e.srs[2]||0),c._srsModelMatrix=s.eastNorthUpToFixedFrame(c.center,Cesium.Ellipsoid.WGS84,c._srsMatrix),e.srsOrigin){var t=a.fromArray(e.srsOrigin);c._srsTransform=l.fromTranslation(t)}l.multiply(c._transform,c._srsTransform,c._computedTransform),l.multiply(c._srsMatrix,c._computedTransform,c.modelMatrix)}var t=this,r=this.uri;this.manager&&(r=this.manager.resolveURL(this.uri));var n=Cesium,i=n.Resource,a=n.Cartesian3,o=n.Cartographic,s=n.Transforms,l=n.Matrix4,c=this;return this.uri.toLowerCase().endsWith(".xml")?i.fetchXML(r).then(function(r){var n=r.getElementsByTagName("ModelMetadata");if(n&&n.length>0){var i=n[0],a=i.getElementsByTagName("SRS");if(a&&a.length){var o=a[0],s=o.textContent,u=s.indexOf(":");if("ENU"!=s.split(":")[0])throw new Error("Unsupport SRS:"+s);var l=s.substr(u+1);t.metadata.srs=JSON.parse("["+l+"]"),t.metadata.srs.reverse()}var c=i.getElementsByTagName("SRSOrigin");if(c&&c.length){var f=c[0],d=f.textContent;d&&(t.metadata.srsOrigin=JSON.parse("["+d+"]"))}}else console.warn("metadata  "+t.url+" is empty.");return e(),t.loadRootTiles()}).otherwise(function(e){return console.trace(e),console.warn("metadata "+r+" load failed.",e),t.loadRootTiles()}):i.fetchJson(r).then(function(r){return t.metadata=r.metadata,t.localBoundingSphere=(0,U.unpackBoundingSphere)(r.sphere),t.boundingSphere=t.localBoundingSphere.clone(),r.box&&(t.aabbLocal=(0,U.unpackBoundingBox)(r.box),t.aabb=t.aabbLocal.clone()),r.transform&&(t.transform=l.fromArray(r.transform,0,t.transform)),e(),u(t),t.minX=r.minX,t.minY=r.minY,t.maxX=r.maxX,t.maxY=r.maxY,t.createRootTiles(r)}).otherwise(function(e){console.warn("metadata "+r+" load failed.",e),console.error(e)})}},{key:"createRootTiles",value:function(e){var r=this,n=this,i=n,a=[],o=[a];return e.children.forEach(function(e){var n=e.uri.split(/\//).pop();n=n.split("."),n.pop(),n=n.join(".");var s=e.uri;s.startsWith(".")&&(s=s.slice(1));var u=new t({uri:r.path+s,tileId:n,tileset:i,loader:i.loader,manager:i.manager,debugVolume:i.debugVolume,showDebugVolume:i.showDebugVolume,minRange:i.minRange,receiveShadow:i.receiveShadow,castShadow:i.castShadow});u.state=k.default.UNLOADED,u.localBoundingSphere=(0,U.unpackBoundingSphere)(e.sphere),u.aabbLocal=(0,U.unpackBoundingBox)(e.box),a.length>10&&(a=[],o.push(a)),a.push(u),i.children.push(u)}),new A.default(o,function(e){for(var t=0;t<e.length;t++){var r=e[t];d(r),u(r)}}).run(this.onInitProgress).then(function(){return console.time("first rendering"),r._initialized=!0,r.state=k.default.READY,r.ready=!0,r.readyPromise.resolve(r),r})}},{key:"loadRootTiles",value:function(){for(var e=this,r=this.children,n=[],i=this.minX;i<=this.maxX;i++)for(var a=E.default.paddingStart(i,3),o=this.minY;o<=this.maxY;o++){var s=E.default.paddingStart(o,3),l=this.tilePattern.replace("{x}",a).replace("{y}",s),c=this.dataDir+"/"+l+"/"+l+"."+this.ext,d=this.path+c,h=this,p=new t({uri:d,tileId:l,tileset:h,loader:h.loader,manager:h.manager,debugVolume:h.debugVolume,showDebugVolume:h.showDebugVolume,minRange:h.minRange,receiveShadow:h.receiveShadow,castShadow:h.castShadow});n.push(p)}return new A.default(n,function(e){return new Promise(function(t,n){e.requestTile().then(function(e){e&&!e._isEmptyLOD&&r.push(e),t()}).otherwise(function(r){console.warn("tile "+e.tileId+" load failed.",r),t()})})}).run(this.onInitProgress).then(function(){return f(e),u(e),e.state=k.default.READY,e.ready=!0,e.readyPromise.resolve(e),e})}},{key:"requestTile",value:function(){var e=Cesium,t=e.when,r=e.Resource,n=this;if(n.osgRoot){var i=t.defer();return i.resolve(n),i}var a=new Cesium.Request;n._request=a,n.cancelRequest=function(){n.state=k.default.CANCELLED};var o=n.uri;return n.manager&&(o=n.manager.resolveURL(n.uri)),n.state=k.default.LOADING,function(){return n._osgBuffer?Cesium.when(n._osgBuffer,function(){return l(n).then(function(){return n.state=k.default.LOADED,n})}):r.fetchArrayBuffer({url:o,request:a}).then(function(e){return n._osgBuffer=e,n._osgBufferSize=e.byteLength,n.state==k.default.CANCELLED?(n.state=k.default.UNLOADED,n):l(n)})}().then(function(){return n.state==k.default.CANCELLED?(n.unload(),n):n.state==k.default.UNLOADED?n:(n.hasEmbedLOD?n.state=k.default.READY:n.state=k.default.LOADED,n.ready=!0,n.readyPromise.resolve(n),n)}).otherwise(function(e){if(n.state==k.default.UNLOADED)return n;console.error(e),n.state=k.default.ERROR,n.ready=!1,n.readyPromise.reject(e)})}},{key:"computeDistanceToCamera",value:function(e){var t,r=this.region,n=this.boundingSphere,i=e.camera;if(r)t=r.distanceToCamera(e);else{if(!n)return;t=i.distanceToBoundingSphere(n)}0==t&&(t=Cesium.Cartesian3.distance(n.center,i.positionWC)),this._distanceToCamera=t}},{key:"computeOrderParams",value:function(e){var t=Cesium,r=t.Cartesian3,n=e.camera,i=n._scene,a=this.region,o=this.boundingSphere,s=this.tileset;s=s||this;var u;if(a)u=r.add(a.southwestCornerCartesian,a.northeastCornerCartesian,{}),r.divideByScalar(u,2,u);else{if(!o)return;u=o.center}if(s._cameraHeight<50||s._cameraPitch>-.1)return void(this._radiusPixel=void 0);var l=Cesium.SceneTransforms.wgs84ToWindowCoordinates(i,u,{});if(l){var c=l.x,f=l.y,d=i.canvas.width/e.pixelRatio,h=i.canvas.height/e.pixelRatio;c-=d/2,f-=h/2,f<0&&(f=-f),this._radiusPixel=c*c+f*f}}},{key:"computeVisibility",value:function(e){var t,r=Cesium,n=(r.Intersect,this.parent),i=e.cullingVolume;if(t=n?1==n._visibility?n._visibility:i.computeVisibility(this.region?this.region:this.boundingSphere):i.computeVisibility(this.boundingSphere),this._visibility=t,this._visible=t>-1,this._visible){var a=(this.tileset||this).geometryErrorScale;this.range=B.default.computeRange(this._distanceToCamera,this.boundingSphere.radius,e,a),this._visible=this.range>this.minRange}return this._visible}},{key:"visit",value:function(e,t){if(!this._isEmptyLOD){var r=this.tileset;if(r&&(this.minRange=r.minRange,this.showDebugVolume=r.showDebugVolume),this.frameNumber!=e.frameNumber&&(this.computeDistanceToCamera(e),this.computeVisibility(e)),this._visible){this.computeOrderParams(e);var n=this.tileset;this._timeStamp=n._currentTimeStamp;var i=this.rangeList&&this.rangeList.length>0;if(i){var a=this.rangeList[1];if(!(i=this.range>a[0]&&this.range<=a[1]))return this.state==k.default.READY?t.pushRendering(this):t.pushPending(this)}var o=this.children.length>0;this.children.forEach(function(r){if(r._timeStamp=n._currentTimeStamp,r.state!==k.default.READY)return o=!1,r.computeDistanceToCamera(e),r.computeOrderParams(e),t.pushPending(r);var i=!0;r.hasEmbedLOD&&r.children.forEach(function(r){r.state!==k.default.READY&&(i=!1,r.computeDistanceToCamera(e),r.computeOrderParams(e),t.pushPending(r))}),i?r.visit(e,t):o=!1}),o||(this.state==k.default.READY?t.pushRendering(this):t.pushPending(this))}this.frameNumber=e.frameNumber}}},{key:"render",value:function(e,t,r,n,i){var a=this;if(this.ready&&this.show){var o=this.queue;if(!this.debugSuspendVisit){if(this._currentTimeStamp=Date.now(),e.frameNumber!=this.frameNumber){if(this.modelMatrixNeedsUpdate&&(Cesium.Matrix4.multiply(this._transform,this._srsTransform,this._computedTransform),Cesium.Matrix4.multiply(this._srsMatrix,this._computedTransform,this.modelMatrix),(0,L.default)(this,function(e){u(e)}),this.modelMatrixNeedsUpdate=!1),this.computeDistanceToCamera(e),this.computeVisibility(e),this.computeOrderParams(e),!this._visible)return;this._shouldRaiseTileLoaded&&Cesium.requestAnimationFrame(function(){a.tileLoaded.raiseEvent(a),a._shouldRaiseTileLoaded=!1}),this._initialized||m(this,e,r,i,n),o.init(),this._cameraHeight=e.camera.positionCartographic.height,this._cameraPitch=e.camera.pitch,this.children.forEach(function(t){t.visit(e,o)}),o.sortPendings();var s=o.shiftPending();s&&v(s,e,r,n,i)}this._memorySize0=this._memorySize0||0;var l=this.maximumMemorySize,c=this._memorySize-this._memorySize0;this._memorySize>l&&c>.25*l&&(this.unload(),this._memorySize0=this._memorySize)}o.getRenderList(t),t.length&&!this._rendering&&(this._rendering=!0,console.timeEnd("first rendering")),this.frameNumber=e.frameNumber}}},{key:"unload",value:function(){var e=this,t=this.tileset;if(t){if(this._request&&this._request.cancelFunction&&this._request.cancelFunction(),this.hasEmbedLOD){var r=!0;this.children.forEach(function(t){t._timeStamp==e.tileset._currentTimeStamp&&(r=!1)}),r&&(this.children.forEach(function(e){e.unload()}),this._isExpired=!0,this._loading=!1,this.state=k.default.EXPIRED)}var n=this.content;n&&(t.visualizer.remove(n,!0),(0,D.default)(n),n.osgRoot&&(P.traverse(n.osgRoot,function(e){"Osg::Geometry"==e.Type&&destroyObject(e)}),delete n.osgRoot),this.content=null,this._osgBuffer=null,this._isExpired=!0,this._loading=!1,this.state=k.default.EXPIRED,t._memorySize>0&&(t._memorySize-=this._contentMemorySize),this._contentMemorySize=0)}else for(var i=this.queue.getExpiredList(),a=i.splice(0);a.length>0;){var o=a.pop();o.unload()}}},{key:"destroy",value:function(){var e=this.visualizer,t=Cesium.destroyObject;return(0,L.default)(this.children,function(r){r.unload(),r.debugVolume&&(r.debugVolume=e.remove(r.debugVolume,!0)),r.osgRoot&&P.traverse(r.osgRoot,function(e){"Osg::Geometry"==e.Type&&t(e)})}),this._renderList&&this._renderList.splice(0),this.boundingSphere=null,this.localBoundingSphere=null,this.aabb=null,this.aabbLocal=null,this.obb=null,this.obbLocal=null,this.region=null,e.remove(this,!0),this.visualizer=null,t(this)}},{key:"isCommandsReady",value:function(){if(!this.tileset)return!1;if(this.state!==k.default.READY)return!1;var e=this.content,t=void 0;return(0,L.default)(e,function(e){if(0!=t&&e.isMesh&&e.visible){void 0==t&&(t=!0);var r=e.renderItems;r?r.forEach(function(e){e.loaded||(t=!1)}):t=!1}}),t}},{key:"toIndexJSON",value:function(){var e=this;if(this.root)return void console.warn("Mesh3D.PagedLOD：只能从根节点导出索引");var t=s(this,this.path);return t.metadata=Object.assign({exporter:"Mesh3D.PagedLOD",datetime:(new Date).toLocaleDateString()},this.metadata),t.children=[],delete t.uri,t.ext=this.ext,t.dataDir=this.dataDir,t.tilePattern=this.tilePattern,t.minX=this.minX,t.minY=this.minY,t.maxX=this.maxX,t.maxY=this.maxY,t.transform=Cesium.Matrix4.toArray(this.transform),this.children.forEach(function(r){r._isEmptyLOD||(r=s(r,e.path),t.children.push(r))}),t}},{key:"selectTileLoaded",value:function(e){return(0,U.selectTileLoaded)(this,e)}}],[{key:"updatePositionClamped",value:function(e,t,r,n){return(0,U.updatePositionClamped)(e,t,r,n)}}]),t}(I.default);r.default=G},{s_310:2,s_343:4,"-_345":6,"-_312":189,D_336:193,"._337":194,"3_313":207,"3_346":79,D_347:81,"._348":82,m_340:179,e_342:182,M_341:185,h_344:186,s_332:233,e_1:235,s_2:236,m_131:239,C_129:240,M_0:241,o_130:242,M_110:245}],81:[function(e,t,r){"use strict";function n(e,t){if(e._level!=t._level){if(0==e._level)return-1;if(0==t._level)return 1;if("LevelFirst"==e.tileset.sortType)return e._level-t._level}return e.root&&t.root&&e.root!=t.root?e.root._radiusPixel!=t.root._radiusPixel?e.root._radiusPixel-t.root._radiusPixel:e.root._level!=t.root._level?e.parent._level-t.parent._level:e.root._distanceToCamera-t.root._distanceToCamera:e.parent&&t.parent&&e.parent!=t.parent?e.parent._radiusPixel!=t.parent._radiusPixel?e.parent._radiusPixel-t.parent._radiusPixel:e.parent._distanceToCamera-t.parent._distanceToCamera:e._radiusPixel!=t._radiusPixel?e._radiusPixel-t._radiusPixel:void 0!=e._distanceToCamera&&void 0!=t._distanceToCamera?e._distanceToCamera-t._distanceToCamera:(e.parent?e.parent._distanceToCamera:e._distanceToCamera)-(t.parent?t.parent._distanceToCamera:t._distanceToCamera)}function i(e){var t=[],r=[],i=[],a=[],u=0;this.init=function(){i.length=0,r.length=0,t.length=0,u=0,a.length=0},this.reset=this.init,this.getExpiredList=function(){return e.children.forEach(function(t){(0,o.default)(t.children,function(t){t._loading&&!t.content||!t.uri.endsWith(e.ext)||t._timeStamp==e._currentTimeStamp||i.push(t)})}),i},this.sortPendings=function(){r.sort(n)},this.shiftPending=function(){return r.shift()},this.pushDebugging=function(e){a.push(e)},this.pushPending=function(t){var n=t.state;t._timeStamp=e._currentTimeStamp,(!t.isEmbedLOD||n!=s.default.UNLOADED&&n!=s.default.EXPIRED)&&n!=s.default.LOADING&&n!=s.default.RENDER_ITEM_INITIALIZING&&n!=s.default.TEXTRURE_INITIALIZING&&r.push(t)},this.pushRendering=function(r){r._timeStamp=e._currentTimeStamp,t.push(r),u+=r._contentMemorySize},this.getRenderList=function(e){t.forEach(function(t){var r=t.content,n=t.tileset,i=t.debugVolume,a=t.showDebugVolume,s=n.debugVolumeOnly;if(r&&!s){var u=n.castShadow,l=n.receiveShadow;u==t.castShadow&&l==t.receiveShadow||(t.receiveShadow=l,t.castShadow=u,(0,o.default)(r,function(e){e.castShadow=u,e.receiveShadow=l})),e.push(r)}a&&i&&i.isObject3D&&(i.frustumCulled=!1,e.push(i))})},Object.defineProperties(this,{memeryRendering:{get:function(){return u}},debuggingList:{get:function(){return a}},renderList:{get:function(){return t}},pendingList:{get:function(){return r}},expiredList:{get:function(){return getExpiredList()}}})}var a=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.pendingSort=n,r.PagedLODQueue=i;var o=a(e("3_313")),s=a(e("._348"))},{"3_313":207,"._348":82,M_0:241}],82:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n={CANCELLED:-1,UNLOADED:0,LOADING:1,LOADED:2,TEXTRURE_INITIALIZING:3,TEXTRURE_INITIALIZED:4,RENDER_ITEM_INITIALIZING:5,READY:7,EXPIRED:8,ERROR:9},i=n;r.default=i},{}],83:[function(e,t,r){"use strict";function n(e){var t=i();return function(){var r,n=(0,f.default)(e);if(t){var i=(0,f.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,c.default)(this,r)}}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function a(e,t){var r=e.content;return!(!r||!e.loader||r._model)&&(e._loading||-1==t.indexOf(e)&&t.push(e),!0)}var o=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=o(e("e_1")),u=o(e("s_2")),l=o(e("C_129")),c=o(e("o_130")),f=o(e("m_131")),d=o(e("D_325")),h=o(e("h_344")),p=o(e("o_361")),m=o(e("m_362")),v=e("3_346"),g=o(e("3_313")),y=function(e){function t(e){var n;(0,s.default)(this,t),n=r.call(this,e);var i=Cesium,a=i.defaultValue,o=i.when,u=i.Event;return n.ready=!0,n.show=a(e.show,!0),n.readyPromise=o.defer(),n.maximumTextureSize=e.maximumTextureSize,n.maxMipmapSize=a(e.maxMipmapSize,1024),n.geometryErrorScale=a(e.geometryErrorScale,1),n.isQuadtreeLOD=!0,n.tileLoaded=new u,n.children=[],n.level=e.level||0,n.maxLevel=e.maxLevel,n._contentSet={contain:[],intersect:[],length:0},e.contentSet&&(n.contentSet=e.contentSet),n.refine=e.refine||"ADD",n.rangeMode=e.rangeMode||"PIXEL_SIZE_ON_SCREEN",n.parent=e.parent,n.root=e.root,n.translucent=a(e.translucent,!1),n.alphaTest=0,"number"==typeof e.alphaTest&&(n.alphaTest=e.alphaTest),n._memorySize=0,n.maximumMemorySize=e.maximumMemorySize||209715200,n}(0,l.default)(t,e);var r=n(t);return(0,u.default)(t,[{key:"contentSet",get:function(){return this._contentSet},set:function(e){this.setContentSet(e)}},{key:"selectTileLoaded",value:function(e){return(0,v.selectTileLoaded)(this,e)}},{key:"isCommandsReady",value:function(){var e,t=this.content;if(!t&&!this.contentSet.length)return!1;if(this.content)e=this.content.isObject3D?this.content:this.content._model;else if(this.contentSet.length)return!0;if(e){var r=void 0;return(0,g.default)(e,function(e){if(0!=r&&e.isMesh&&e.visible){void 0==r&&(r=!0);var t=e.renderItems;t?t.forEach(function(e){e.loaded||(r=!1)}):r=!1}}),r}return!1}},{key:"setContentSet",value:function(e){for(var t=this,r=function(e){return e instanceof d.default||(e.modelMatrix=e.modelMatrix||t.modelMatrix,e.rtcCenter=e.rtcCenter||t.rtcCenter,e.debugVolume=t.debugVolume,e.showDebugVolume=t.showDebugVolume,e=new d.default(e)),e},n=0;n<e.contain.length;n++){var i=e.contain[n];e.contain[n]=r(i)}for(var a=0;a<e.intersect.length;a++){var o=e.intersect[a];e.intersect[a]=r(o)}this._contentSet=e}},{key:"visit",value:function(e,t,r,n){var i=this;if(this.frameNumber!=e.frameNumber&&this.computeVisibility(e),this._visible){if(t.maxLevel=Math.max(this.level,t.maxLevel),t.visitTimes++,a(this,r))return void(this.frameNumber=e.frameNumber);var o=this.children.length>0,s=!1;if(o){var u=this.children[0].minRange;o=this.range>=u}o&&(s=!0,this.children.forEach(function(a){var o=e.cullingVolume.computeVisibility(a.boundingSphereWC);if(-1!=o){a.visibility=o,a._visible=!0,a.computeRange(e,i.geometryErrorScale),a.frameNumber=e.frameNumber,a.visit(e,t,r,n);var u=a.content,l=a.contentSet;u&&!u.isObject3D?u._model?u._model._ready?a.isCommandsReady()||(s=!1):(s=!1,n.push(a)):s=!1:l&&l.length&&(l.ready||(s=!1))}})),s&&"ADD"!=this.refine||(this.content&&this.content._model&&!this.content._model._ready?n.push(this):(this.content&&!this._commandsReady&&(this._commandsReady=!0,this.root&&(this.root._needsRaiseTileLoaded=!0)),t.push(this)))}this.frameNumber=e.frameNumber}},{key:"render",value:function(e,t){var r=this;if(this.ready&&this.show){var n=Cesium,i=n.when,o=n.requestAnimationFrame,s=n.Color;this._needsRaiseTileLoaded=!1;var u=this._cacheRenderList||[];if(e.frameNumber!=this.frameNumber){if(u.splice(0),this.computeVisibility(e),this.frameNumber=e.frameNumber,!this._visible)return;this._currentTimeStamp=Date.now();var l=[],c=[],f=[];l.maxLevel=this.level,l.visitTimes=0,this.children.forEach(function(t){t._timeStamp=r._currentTimeStamp,t.visit(e,l,c,f)}),l.sort(function(e,t){return e._distanceToCamera-t._distanceToCamera});var d=this.debugVolumeColor;if(l.forEach(function(t){if(0!=t.show){if(t.debugVolume&&r.showDebugVolume){if(t.debugVolume.frustumCulled=!1,d){var n=t.debugVolume.material;n._debugVolumeColor!=d&&(n._debugVolumeColor=d,n.color.set(d.toCssColorString()))}u.push(t.debugVolume)}if(t.content||0!=t.contentSet.length){if(t._timeStamp=r._currentTimeStamp,t.contentProvider)if(t._contentRequested&&r._version==t._version)t.content&&u.push(t.content);else{if(!r._contentRequesting){r._contentRequesting=!0;var o=t.contentProvider.requestContent(t.contentSet,r.rtcCenter);i(o,function(e){(0,g.default)(e,function(e){e.frustumCulled=!1,e.isMesh&&r.rtcCenter&&(e.uniformMapLoadedCallback=r.uniformMapLoadedCallback)}),t.content&&r.visualizer&&r.visualizer.remove(t.content),t.content=e,r._contentRequesting=!1,t._version=r._version}),t._contentRequested=!0}t.content&&u.push(t.content)}else if(t.content){var l=t.content;l.isObject3D?u.push(l):l._model?l._model._ready?u.push(l._model):-1==f.indexOf(t)&&f.push(t):a(t,c)}var h=t.contentSet;0==r.generateLOD&&h&&h.length>0&&(h.ready=!0,h.contain.forEach(function(t){t.content&&!t.content._ready&&(t._distanceToCamera=e.camera.distanceToBoundingSphere(r.boundingSphereWC),h.ready=!1,f.push(t))}),h.intersect.forEach(function(t){t.debugVolume&&(t.debugVolume.material.defaultColor=s.RED),t.content&&!t.content._ready&&(t._distanceToCamera=e.camera.distanceToBoundingSphere(t.boundingSphereWC),h.ready=!1,f.push(t))}),h.ready&&(h.contain.forEach(function(t){t.debugVolume&&(t.debugVolume.material.defaultColor=s.CYAN),t.content&&t.render(e,u)}),h.intersect.forEach(function(t){t.debugVolume&&(t.debugVolume.material.defaultColor=s.RED),t.content&&t.render(e,u)})))}}}),c&&c.length>0&&!this._loading){this._loading=!0,c.sort(function(e,t){return e._distanceToCamera-t._distanceToCamera});var h=c.shift();h._timeStamp=this._currentTimeStamp,this.imageCache=this.imageCache||{},this.texturesByUrl=this.texturesByUrl||{};var p=this.imageCache[h.level],v=this.texturesByUrl[h.level];p||(p={},this.imageCache[h.level]=p),h._loadContent(p,v).then(function(){r._memorySize+=h._contentMemorySize,h._timeStamp=r._currentTimeStamp,o(function(){r._loading=!1})})}if(f.length>0&&!this._texureCreating){0!=this.generateLOD&&f.sort(function(e,t){return e=e.parent?e.parent._distanceToCamera:e._distanceToCamera,t=t.parent?t.parent._distanceToCamera:t._distanceToCamera,e-t});var y=f.shift(),_=y.content._model||y.content,b=this.visualizer._textureCache;y._timeStamp=this._currentTimeStamp,this._cacheTextureIds=this._cacheTextureIds||[];var M=0==this.generateLOD?"":"L"+y.level+"_";_._ready=m.default.initTexture(e,_.mesh||_,b,this._cacheTextureIds,M,this.maximumTextureSize,this.maxMipmapSize),this._texureCreating=!0,o(function(){r._texureCreating=!1})}this._memorySize>this.maximumMemorySize&&this.unload()}u.forEach(function(e){t.push(e)}),this._cacheRenderList=u,this._needsRaiseTileLoaded&&o(function(){r.tileLoaded.raiseEvent(r)})}}},{key:"_loadContent",value:function(e,t){var r=this;return this._loading=!0,new Promise(function(n,i){var a=r.loader,o=r.content;r.uri=o.uri,a.load(o.uri,function(e){o._model=e,r._contentMemorySize=e._memorySize,e.traverse(function(e){if(e.isMesh){(Array.isArray(e.material)?e.material:[e.material]).forEach(function(e){e.autoRefresh=!1,e.transparent&&(r.alphaTest&&r.alphaTest>0?e.alphaTest=r.alphaTest:(r.translucent||r.root.translucent)&&(e.translucent=!0))}),e.pickObject={id:r,mesh:e,primitive:r}}e.frustumCulled=!1,e.matrixAutoUpdate=!1,e.modelMatrixNeedsUpdate=!1,e.modelMatrix=r.modelMatrix}),r._loading=!1,n(e)},void 0,function(e){r._loading=!1,console.error(e),i(e)},{loadTexture:!0,imageCache:e,textureCache:t})})}},{key:"unload",value:function(){var e=this;if(0!=this.level){if(this.content&&this.content._model){var t=this.root.visualizer,r=this.content._model;t.remove(r,!0),(0,h.default)(r),delete this.content._model}this._isExpired=!0,this._loading=!1}else{var n=[];this.children.forEach(function(t){(0,g.default)(t.children,function(t){!t._loading&&t.content&&t.content._model&&t._timeStamp!=e._currentTimeStamp&&n.push(t)})}),n.sort(function(e,t){return t._timeStamp/t._distanceToCamera-e._timeStamp/t._distanceToCamera});var i=n.splice(0);do{var a=i.pop();if(a.unload(),!(this._memorySize>0))break;this._memorySize-=a._contentMemorySize}while(i.length>0)}}},{key:"destroy",value:function(){var e=Cesium.destroyObject,t=this.visualizer;return this._cacheRenderList&&this._cacheRenderList.splice(0),(0,g.default)(this.children,function(r){if(r._contentSet&&r._contentSet.contain.splice(0)&&r._contentSet.intersect,r._contentSet=null,r.debugVolume&&(r.debugVolume=t.remove(r.debugVolume)),r.content){var n=r.content._model?r.content._model:r.content;t&&t.remove(n,!0),(0,h.default)(n),r.content=n.destroy&&n.destroy()}delete r.contentProvider,delete r.boundingVolume,delete r.visualizer,delete r.uniformMapLoadedCallback,e(r)}),t&&t.remove(this,!0),this._cacheTextureIds&&t&&(this._cacheTextureIds.forEach(function(e){var r=t._textureCache[e];r&&((!r.isDestroyed||!r.isDestroyed())&&r.destroy(),delete t._textureCache[e])}),this._cacheTextureIds=null),this.children.splice(0),this._contentSet&&this._contentSet.contain.splice(0)&&this._contentSet.intersect,this._contentSet=null,this.visualizer=null,this.imageCache=null,e(this)}},{key:"toJSON",value:function(){var e={boundingVolume:{box:(0,v.packBoundingBox)(this.boundingBox),sphere:(0,v.packBoundingSphere)(this.boundingSphere)},children:[],level:this.level,content:this.content,contentSet:this.contentSet,minRange:this.minRange,refine:this.refine};return this.children.forEach(function(t){t=t.toJSON(),t.parent=e,e.children.push(t)}),e}}],[{key:"updatePositionClamped",value:function(e,t,r,n){return(0,v.updatePositionClamped)(e,t,r,n)}},{key:"load",value:function(e){var r=this,n=e.url,i=e.manager;e.rangePower=e.rangePower||4;var a=THREE.LoaderUtils.extractUrlBase(n);a&&a.length>0&&!a.endsWith("/")&&(a+="/");var o=new t({modelMatrix:e.modelMatrix,maximumMemorySize:e.maximumMemorySize,alphaTest:e.alphaTest,level:0,maxMipmapSize:e.maxMipmapSize,maximumTextureSize:e.maximumTextureSize,translucent:e.translucent,geometryErrorScale:e.geometryErrorScale});return o.ready=!1,new THREE.FileLoader(i).load(n,function(t){var i=JSON.parse(t);r.fromJSON(i,e,o),o.uri=n,(0,g.default)(o,function(t){t.content&&t.content.uri&&(t.content.uri=a+t.content.uri),e.minRange&&(t.minRange=e.minRange*Math.pow(e.rangePower,t.level))}),o.ready=!0,o.readyPromise.resolve(o)},void 0,function(e){o.readyPromise.reject(e)}),o}},{key:"fromJSON",value:function(e,r,n){var i=r.loader;i||(i=new p.default(r.manager),r.dracoDecoderPath&&i.setDracoDecoderPath(r.dracoDecoderPath),r.loader=i);var a={modelMatrix:r.modelMatrix,boundingVolume:e.boundingVolume,content:e.content,level:e.level,minRange:e.minRange,refine:e.refine||r.refine,debugVolume:!!r.debugVolume,showDebugVolume:!!r.showDebugVolume,alphaTest:r.alphaTest,maximumMemorySize:r.maximumMemorySize};return n?n.init(a):n=new t(a),n.loader=r.loader,this.createChildren(n,e.children,n,r),n}},{key:"createChildren",value:function(e,r,n,i){var a=this;e.children=r.map(function(r){var o=new t({modelMatrix:i.modelMatrix,boundingVolume:r.boundingVolume,content:r.content,level:r.level,debugVolume:!!i.debugVolume,showDebugVolume:!!i.showDebugVolume,refine:r.refine||i.refine,minRange:r.minRange,alphaTest:i.alphaTest});return o.loader=i.loader,o.root=n,o.parent=e,r.children&&r.children.length&&a.createChildren(o,r.children,n,i),o})}}]),t}(d.default);r.default=y},{m_362:17,"3_313":207,"3_346":79,D_325:85,o_361:184,h_344:186,e_1:235,s_2:236,m_131:239,C_129:240,M_0:241,o_130:242}],84:[function(e,t,r){"use strict";function n(e,t){a||(a=new THREE.Box3),o||(o=new THREE.Box3),a.min.copy(e.minimum||e.min),a.max.copy(e.maximum||e.max),o.min.copy(t.minimum||t.min),o.max.copy(t.maximum||t.max)}var i=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var a,o,s=i(e("e_1")),u=i(e("s_2")),l=i(e("s_310")),c=i(e("D_369")),f=i(e("._315")),d=(i(e("D_325")),function(){function e(){(0,s.default)(this,e)}return(0,u.default)(e,null,[{key:"computeLODPower",value:function(e){var t=Cesium.Cartesian3,r=e.geometry,n=r.attributes.position;n=n.array||n.values,r.boundingBox||r.computeBoundingBox();var i=r.boundingBox,a=i.min.x,o=i.min.y,s=i.max.x,u=i.max.y,f=new t(a,u,0),d=new t(a,o,0),h=new t(s,o,0),p=new t(s,u,0),m=0;m+=(0,c.default)(f,d,h),m+=(0,c.default)(f,h,p);var v=l.default.computeSurfaceArea(r);return v*(v/m)}},{key:"splitBoundingVolume",value:function(e,t,r,n){var i,a,o=[];if(e.box&&(i=this.splitBoundingBox(e.box,t,r,n)),e.region&&(a=this.splitBoundingRegion(e.region,t,r,n)),i||a)for(var s=a?a.length:i.length,u=0;u<s;u++){var l={};a&&(l.region=a[u]),i&&(l.box=i[u]),o.push(l)}return o}},{key:"splitBoundingBox",value:function(e,t,r,n){var i=Cesium,a=i.Cartesian3,o=i.AxisAlignedBoundingBox,s=[],u=a.subtract(e.maximum,e.minimum,new a),l=new a(0,0,0),c=new a(0,0,0),f=[l,c];t=t||2,r=r||2,n=n||1;for(var d=1/t,h=1/r,p=1/n,m=0;m<t;m++)for(var v=m*d,g=(m+1)*d,y=0;y<r;y++)for(var _=y*h,b=(y+1)*h,M=0;M<n;M++){var x=M*p,w=(M+1)*p;l=a.fromElements(v,_,x,l),l=a.multiplyComponents(u,l,l),
l=a.add(e.minimum,l,l),c=a.fromElements(g,b,w,c),c=a.multiplyComponents(u,c,c),c=a.add(e.minimum,c,c);var S=o.fromPoints(f);s.push(S)}return s}},{key:"splitBoundingRegion",value:function(e,t,r,n){var i=Cesium,a=i.Rectangle,o=i.TileBoundingRegion,s=e.rectangle,u=s.west,l=s.south,c=s.width,f=s.height,d=e.maximumHeight,h=e.minimumHeight,p=d-h,m=[];t=t||2,r=r||2,n=n||1;for(var v=1/t,g=1/r,y=1/n,_=0;_<t;_++)for(var b=_*v*c,M=(_+1)*v*c,x=0;x<r;x++)for(var w=x*g*f,S=(x+1)*g*f,T=0;T<n;T++){var C=T*y*p,E=(T+1)*y*p,A=new a(u+b,l+w,u+M,l+S),L=new o({rectangle:A,minimumHeight:h+C,maximumHeight:h+E});m.push(L)}return m}},{key:"boxContains",value:function(e,t){return n(e,t),a.containsBox(o)}},{key:"boxIntersect",value:function(e,t){n(e,t);var r=a.intersect(o);return r=!r.isEmpty()}},{key:"regionContains",value:function(e,t){var r=e.rectangle,n=t.rectangle,i=e.minimumHeight-t.minimumHeight,a=e.maximumHeight-t.maximumHeight,o=r.west-n.west<=0&&r.east-n.east>=0&&r.south-n.south<=0&&r.north-n.north>=0;return o&&(o=i<=0&&a>=0),o}},{key:"regionIntersect",value:function(e,t){var r=e.rectangle,n=t.rectangle,i=e.maximumHeight-t.minimumHeight,a=t.maximumHeight-e.minimumHeight,o=i>0&&a>0;return o&&(o=!!Cesium.Rectangle.intersection(r,n)),o}},{key:"filterContents",value:function(e,t,r,n,i,a){function o(e,r){var n=r.boundingVolume.sphere.radius;return!(n<=t.minRadius)&&!(t.parent&&n>=t.parent.minRadius)}var s=this;if(n=n||2,r=void 0===r||r,0==t.level)return void t.children.forEach(function(t){s.filterContents(e,t,n,r,i,a)});var u={contain:new Array,intersect:new Array,length:0},l=t.minRadius;if(!l){i||(i=e.maxRaius||0,i||(e.forEach(function(e){i=Math.max(e.boundingVolume.sphere.radius,i)}),e.maxRaius=i),i=Math.min(i,t.boundingVolume.sphere.radius),e.maxRaius=i);l=i/Math.pow(n,t.maxLevel)*Math.pow(n,t.maxLevel-t.level),t.minRadius=t.level==t.maxLevel?0:l}e.forEach(function(e){if(t.region&&e.boundingVolume.region){var r=e.boundingVolume.region,n=t.region;s.regionContains(n,r)?(u.contain.push(e),u.length++):s.regionIntersect(n,r)&&(u.intersect.push(e),u.length++)}else{var i=e.boundingVolume.box,a=t.boundingBox;s.boxContains(a,i)?(u.contain.push(e),u.length++):s.boxIntersect(a,i)&&(u.intersect.push(e),u.length++)}}),t.contentSet=u;var c=u.contain.concat(u.intersect);if(r?t.children.forEach(function(t){s.filterContents(c,t,n,r,i||e.maxRaius,a)}):(c.maxRaius=i,t._getContentSetBeforeFilter=function(){return c}),t.parent&&"ADD"==t.parent.refine){a=a||o;var f={contain:[],intersect:[],length:0};u.contain.forEach(function(e){a(t,e)&&(f.contain.push(e),f.length++)}),u.intersect.forEach(function(e){a(t,e)&&(f.intersect.push(e),f.length++)}),t.contentSet=f}}},{key:"createLODTree",value:function(e,t,r,n,i,a,o,s,u,l,c){var d=this,h=e.level+1;if(!(h>t)){i=i||1/0;this.splitBoundingVolume(e.boundingVolume,1==h?a:2,1==h?o:2,s&&1==h?s:1).forEach(function(p){var m=new f.default({parent:e,boundingVolume:p,level:h,minRange:r*Math.pow(4,h-1),debugVolumeColor:l,debugVolume:u,showDebugVolume:c,modelMatrix:e.modelMatrix,rtcCenter:e.rtcCenter,maxLevel:t});n?d.createLODTree(m,t,r,n,i,a,o,s,u,l,c):m._createLODTreeDelay=function(e){e=void 0!==e&&e,d.createLODTree(m,t,r,e,i,a,o,s,u,l,c)},e.children.push(m)})}}},{key:"create",value:function(e){var t=e.rootBoundingVolume,r=e.maxLevel,n=e.zSliceLevel,i=e.minRange,a=e.debugVolume,o=e.showDebugVolume,s=e.debugVolumeColor||Cesium.Color.YELLOW,u=e.modelMatrix,l=e.rtcCenter,c=void 0===e.recursive||e.recursive,d=new f.default({boundingVolume:t,level:0,debugVolumeColor:s,debugVolume:a,showDebugVolume:o,minRange:i,modelMatrix:u,rtcCenter:l,maxLevel:r,maximumTextureSize:e.maximumTextureSize});return this.createLODTree(d,r,i,c,n,e.xSize,e.ySize,e.zSize||2,a,s,o),d}},{key:"fromJSON",value:function(e,t){function r(e,n){n.children.forEach(function(n){var i=new f.default(Object.assign(t,n));i.parent=e,r(i,n),e.children.push(i)})}t=t||{};var n=new f.default(Object.assign(t,e));return r(n,e),n}}]),e}());r.default=d},{s_310:2,D_369:195,"._315":83,D_325:85,e_1:235,s_2:236,M_0:241}],85:[function(e,t,r){"use strict";function n(e){var t=i();return function(){var r,n=(0,f.default)(e);if(t){var i=(0,f.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,c.default)(this,r)}}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var a=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o,s=a(e("e_1")),u=a(e("s_2")),l=a(e("C_129")),c=a(e("o_130")),f=a(e("m_131")),d=a(e("s_343")),h=(a(e("3_379")),e("3_346")),p=a(e("s_310")),m=function(e,t){var r=Cesium,n=r.Matrix4,i=r.defined,a=r.Cartesian3,s=new n;return o||(o=new n),function(){return i(t.rtcCenter)?(n.getTranslation(e.model,o),a.add(o,t.rtcCenter,o),n.multiplyByPoint(e.view,o,o),n.setTranslation(e.modelView,o,s)):e.modelView}},v=function(e){function t(e){var n;return(0,s.default)(this,t),n=r.call(this),n.minRange=null,n.boundingVolume=null,n.uri=null,n.contentProvider=null,n.frustumCulled=null,n.debugVolume=null,n.showDebugVolume=null,n.debugVolumeOnly=!1,n.debugVolumeColor=null,n.modelMatrixNeedsUpdate=!0,n._modelMatrix=null,n.rtcCenter=null,n.content=e.content||null,n._version=0,e.boundingVolume&&n.init(e),n}(0,l.default)(t,e);var r=n(t);return(0,u.default)(t,[{key:"needsUpdate",set:function(e){e&&this._version++}},{key:"boundingSphere",get:function(){return this.boundingVolume.sphere}},{key:"boundingBox",get:function(){return this.boundingVolume.box}},{key:"boundingSphereWC",get:function(){return this.boundingVolume.sphereWC}},{key:"boundingBoxWC",get:function(){return this.boundingVolume.boxWC}},{key:"region",get:function(){return this.boundingVolume.region}},{key:"modelMatrix",get:function(){return this._modelMatrix},set:function(e){if(e){var t=Cesium,r=t.Matrix4,n=t.BoundingSphere;e=e.elements||e,r.equals(e,this._modelMatrix)||(this._modelMatrix=r.clone(e,this._modelMatrix),this.boundingBoxWC&&r.multiplyByPoint(this.modelMatrix,this.boundingBox.center,this.boundingBoxWC.center),this.region&&n.equals(this.boundingSphereWC,this.region.boundingSphere)||r.multiplyByPoint(this.modelMatrix,this.boundingSphere.center,this.boundingSphereWC.center),this.modelMatrixNeedsUpdate=!0)}}},{key:"init",value:function(e){var t=Cesium,r=t.defaultValue,n=t.Matrix4,i=t.AxisAlignedBoundingBox,a=t.BoundingSphere;this.minRange=e.minRange||4,this.boundingVolume=e.boundingVolume,this.uri=e.uri,this.contentProvider=e.contentProvider,this.frustumCulled=r(e.frustumCulled,!0),this.debugVolume=r(e.debugVolume,!1),this.showDebugVolume=r(e.showDebugVolume,!1),this.debugVolumeOnly=r(e.debugVolumeOnly,!1),this.debugVolumeColor=e.debugVolumeColor,this.modelMatrixNeedsUpdate=!0,this._modelMatrix=null,this.rtcCenter=e.rtcCenter,this.content=e.content||null;var o=this.boundingVolume;if(o.box&&Array.isArray(this.boundingVolume.box)){var s=o.box;o.box=(0,h.unpackBoundingBox)(s)}if(o.region&&Array.isArray(o.region)){var u=o.region;o.region=(0,h.unpackBoundingRegion)(u)}if(o.sphere&&Array.isArray(o.sphere)){var l=o.sphere;o.sphere=(0,h.unpackBoundingSphere)(l),o.sphereWC=a.clone(o.sphere)}if(o.box&&!o.region&&e.modelMatrix&&(o.region=(0,h.boundingBoxToRegion)(o.box,e.modelMatrix)),o.sphere)o.sphereWC=a.clone(o.sphere);else if(o.box){var c=o.box,f=[c.minimum,c.maximum];o.sphere=a.fromPoints(f),o.sphereWC=a.clone(o.sphere)}else o.region&&(o.sphere=o.region.boundingSphere,o.sphereWC=o.region.boundingSphere);if(o.boxWC=i.clone(this.boundingVolume.box),this.modelMatrix=e.modelMatrix||n.IDENTITY.clone(),this.geometricError=o.sphere.radius,this.rtcCenter){var d,p=this;this.uniformMapLoadedCallback=function(e,t,r){d||(d=m(t.context.uniformState,p)),e.modelView=d,e.u_modelView=d,e.modelViewMatrix=d,e.u_modelViewMatrix=d}}this.debugVolume&&this.createDebugVolume(e.debugVolumeColor)}},{key:"createDebugVolume",value:function(e){var t,r=Cesium,n=r.RectangleOutlineGeometry,i=r.Ellipsoid,a=r.BoxOutlineGeometry,o=(r.Color,THREE),s=o.LineSegments,u=o.LineBasicMaterial;if(t=this.region?new n({rectangle:this.region.rectangle,height:this.region.minimumHeight,extrudedHeight:this.region.maximumHeight,ellipsoid:i.WGS84}):a.fromAxisAlignedBoundingBox(this.boundingBox),t=t.constructor.createGeometry(t),this.rtcCenter)for(var l=this.rtcCenter,c=t.attributes.position.values,f=0;f<c.length;f+=3)c[f]-=l.x,c[f+1]-=l.y,c[f+2]-=l.z;t=p.default.toBufferGeometry3js(t),e&&e instanceof Cesium.Color&&(e=e.toCssColorString());var d=new u({color:e||"cyan"});d._debugVolumeColor=e;var h=new s(t,d);h.pickObject={id:this,mesh:this,primitive:this.root||this},h.frustumCulled=!1,this.region&&this.rtcCenter&&(h.modelMatrixNeedsUpdate=!1),h.uniformMapLoadedCallback=this.uniformMapLoadedCallback,this.debugVolume=h}},{key:"computeRange",value:function(e,t){var r=Cesium,n=r.defaultValue(t,1),i=e.camera,a=e.context,o=a.drawingBufferHeight*n;this._distanceToCamera=i.distanceToBoundingSphere(this.boundingSphereWC);var s=Math.max(this._distanceToCamera,r.Math.EPSILON7),u=i.frustum.sseDenominator,l=this.geometricError,c=l*o/(s*u);return c/=e.pixelRatio,this.range=c,c}},{key:"computeVisibility",value:function(e){Cesium.Intersect;if(this._visible=!0,this.frustumCulled){var t=this.parent,r=t&&t.visibility;1!=r&&(r=e.cullingVolume.computeVisibility(this.boundingSphereWC)),this.visibility=r,this._visible=-1!=r}return this._visible&&(this.range=this.computeRange(e),this._visible=this.range>=this.minRange),this._visible}},{key:"render",value:function(e,t){var r=this;if(this.frameNumber!=e.frameNumber&&this.computeVisibility(e)){if(this.debugVolume&&(this.showDebugVolume||this.debugVolumeOnly)&&(this.debugVolume.frustumCulled=!1,t.push(this.debugVolume)),!this.debugVolumeOnly)if(this.uri&&this.contentProvider&&!this._contentRequested){var n=this.contentProvider,i=n.requestContent(this.uri,this.rtcCenter);Cesium.when(i,function(e){r.rtcCenter&&!e.uniformMapLoadedCallback&&(e.uniformMapLoadedCallback=r.uniformMapLoadedCallback),e.frustumCulled=!1,r.content=e}),this._contentRequested=!0}else this.content&&(this.content.isObject3D?(this.content.matrixAutoUpdate&&this.content.updateMatrixWorld(),t.push(this.content)):this.content.mesh&&t.push(this.content.mesh));this.modelMatrixNeedsUpdate=!1,this.frameNumber=e.frameNumber}}}]),t}(d.default);r.default=v},{s_310:2,s_343:4,"3_379":78,"3_346":79,e_1:235,s_2:236,m_131:239,C_129:240,M_0:241,o_130:242}],86:[function(e,t,r){"use strict";function n(e){var t=i();return function(){var r,n=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,f.default)(this,r)}}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function a(e,t,r,n){delete t.osgRoot,e.content=t,t.userData||(t.userData={uri:e.uri}),t.traverse(function(e){if(e.matrixAutoUpdate=!1,e.frustumCulled=!1,e.up.set(0,0,1),e.isMesh){e.pickObject={id:e,mesh:e,primitive:t};var i=e.material;(Array.isArray(i)?i:[i]).forEach(function(e){e.autoRefresh=!1,e.transparent&&n&&(e.translucent=n),r||(e.lightMap=null)})}})}function o(e,t){t=t||5;var r=[],n=0,i=Number.MAX_VALUE,a=[];e.forEach(function(e){if(e.content){var t=e.content;t.updateMatrixWorld(),t.traverse(function(e){if(e.isMesh){var o=e.matrixWorld,s=e.geometry.clone();if(s.applyMatrix4(o),s.computeBoundingBox(),s.computeBoundingSphere(),!e._power){var u=p.default.computeLODPower(e);e._power=u,isNaN(u)||u===1/0||(n=Math.max(n,u),i=Math.min(i,u)),a.push(u)}var l=s.boundingBox,c=s.boundingSphere,f=[l.min,l.max];s=null;var d=Cesium;r.push({boundingVolume:{box:new d.AxisAlignedBoundingBox.fromPoints(f),sphere:d.BoundingSphere.clone(c)},content:{uuid:e.uuid,mesh:e,root:t},power:e._power})}})}}),r.sort(function(e,t){return t.power-e.power}),a.sort(function(e,t){return t-e});var o,s=[],u=[],l=1,c=Math.sqrt(n/3);return u.push(s),r.forEach(function(e){var r=n/e.power,i=o/e.power,a=c/(2*l),f=c*Math.pow(2,l-1),d=r<f,h=i<a;!o||d&&h||s.length<3||l>=t?(e.level=l,s.push(e)):(l++,s=[],u.push(s),e.level=l,s.push(e)),o=e.power}),s=[],r.maxPower=n,r.minPower=i,r.levels=u,r}var s=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var u=s(e("e_1")),l=s(e("s_2")),c=s(e("C_129")),f=s(e("o_130")),d=s(e("m_131")),h=s(e("s_343")),p=s(e("D_314")),m=s(e("D_325")),v=(s(e("._315")),s(e("e_342"))),g=s(e("o_361")),y=s(e("h_344")),_=e("._172"),b=function(e){function t(e){var n;(0,u.default)(this,t),n=r.call(this,e);var i=Cesium,a=i.defaultValue,o=i.when,s=i.Event;return n.maximumTextureSize=e.maximumTextureSize,n.isQuatreeContentSet=!0,n.url=e.url,n.contentSet=e.contentSet,n.show=a(e.show,!0),n.modelMatrix=e.modelMatrix,n.debugVolume=e.debugVolume,n.showDebugVolume=e.showDebugVolume,n.minRange=e.minRange||32,n.radiusPower=e.radiusPower||4,n.lods=e.lods||[],n.maxLevel=e.maxLevel||5,n.refine=e.refine||"ADD",n.useLightMap=a(e.useLightMap,!0),n.preloadTexture=a(e.preloadTexture,!1),n.translucent=a(e.translucent,!1),n.format=e.format||"osg",n.dracoDecoderPath=e.dracoDecoderPath,n.contentCull=a(e.contentCull,!0),n.lodRoot=null,n.loader=e.loader,n.children=[],n.scene=new THREE.Scene,n.onLoadProgress=new s,n.ready=!1,n.readyPromise=o.defer(),n}(0,c.default)(t,e);var r=n(t);return(0,l.default)(t,[{key:"boundingSphere",get:function(){if(this.lodRoot)return this.lodRoot.boundingSphere}},{key:"boundingSphereWC",get:function(){if(this.lodRoot)return this.lodRoot.boundingSphereWC}},{key:"boundingBoxWC",get:function(){if(this.lodRoot)return this.lodRoot.boundingBoxWC}},{key:"region",get:function(){if(this.lodRoot)return this.lodRoot.region}},{key:"init",value:function(){var e=this,t=this.useLightMap,r=this.preloadTexture,n=this.translucent;if(this.contentSet)return this.contentSet.forEach(function(e){a(e,e.content,t,n)}),void this.onload(this.contentSet);if(!this.url)throw new Error("url is required");this.onLoadProgress.raiseEvent({currentPercent:0,totalPercent:0,currentFile:_.Path.GetFileName(this.url)});var i=Cesium,o=THREE.LoaderUtils.extractUrlBase(this.url);return i.Resource.fetchJson(this.url).then(function(s){var u=i.when.defer(),l=s.slice(),c=e.loader,f={},d=0;return function i(u){if(0==l.length)return void u();var h=l.pop(),m=p.default.unpackBoundingBox(h.boundingVolume.box),y=p.default.unpackBoundingSphere(h.boundingVolume.sphere);h.boundingVolume.box=m,h.boundingVolume.sphere=y;var b=_.Path.GetFileName(h.uri);if(h.uri=o+h.uri,!c){var M=_.Path.GetExtension(h.uri).toLowerCase();c=".vism"==M?new g.default:new v.default}c.setDracoDecoderPath&&!c.dracoLoader&&e.dracoDecoderPath&&c.setDracoDecoderPath(e.dracoDecoderPath),e.onLoadProgress.raiseEvent({currentPercent:0,totalPercent:d,currentFile:b}),c.load(h.uri,function(r){a(h,r,t,n),d=100*(s.length-l.length)/s.length,e.onLoadProgress.raiseEvent({currentPercent:100,totalPercent:d,currentFile:b}),i(u)},function(t){var r=100*t.loaded/t.total;e.onLoadProgress.raiseEvent({currentPercent:r,totalPercent:d,currentFile:b})},function(e){throw l=null,f={},e},{loadTexture:r,imageCache:f})}(function(){e.onLoadProgress.raiseEvent({currentPercent:100,totalPercent:100,currentFile:"全部加载完成"}),f={},e.onload(s),u.resolve(e)}),u})}},{key:"onload",value:function(e){var t=this,r=e;e=o(e,this.max);var n=[];e=e.map(function(e){var r=e.boundingVolume.box;n.push(r.minimum,r.maximum),e.modelMatrix=t.modelMatrix,e.debugVolume=t.debugVolume,e.showDebugVolume=t.showDebugVolume,e.minRange=t.minRange,e.frustumCulled=t.contentCull;var i=e.power,a=e.level;return e=new m.default(e),e.power=i,e.level=a,e}),this.boundingBox=Cesium.AxisAlignedBoundingBox.fromPoints(n),this.children.push.apply(this.children,e),r.forEach(function(e){var r=e.content;t.scene.add(r)}),this.createLOD(),this.ready=!0,this.readyPromise.resolve(this)}},{key:"createLOD",value:function(){var e,t=this;if(this.lods.length>0){e=this.lods.map(function(e){return e.minRadius}),e.sort(function(e,t){return t-e}),console.log(e);var r=[],n=new Map;this.children.forEach(function(e){var t=e.boundingVolume.sphere,i=parseInt(t.radius);if(n.has(i)){n.get(i).count++}else{var a={radius:i,count:1};n.set(i,a),r.push(a)}}),r.sort(function(e,t){return e.radius-t.radius}),console.log(r);var i=new Array(e.length).fill(0),a=e.slice().sort(function(e,t){return e-t});a.push(1/0),r.forEach(function(e){for(var t=1;t<a.length;t++)e.radius>=a[t-1]&&e.radius<=a[t]&&(i[t-1]+=e.count)}),i.reverse(),console.log(i)}var o=this.boundingBox;console.time("QuadtreeLODUtil.create");var s=Cesium,u=s.Cartesian3,l=s.Color,c=u.subtract(o.maximum,o.minimum,new u),f=c.x/c.y,d=4,h=4;f>1?d=parseInt(Math.ceil(h*f)):h=parseInt(Math.ceil(d/f));var m=p.default.create({rootBoundingVolume:{box:o},maxLevel:this.lods.length||this.maxLevel,xSize:d,ySize:h,zSize:this.zSize||1,minRange:this.minRange,debugVolume:this.debugVolume,showDebugVolume:this.showDebugVolume,debugVolumeColor:l.CYAN,modelMatrix:this.modelMatrix,maximumTextureSize:this.maximumTextureSize});console.timeEnd("QuadtreeLODUtil.create"),console.time("QuadtreeLODUtil.filterContents"),(0,_.traverse)(m,function(t){e&&(t.minRadius=e[t.level-1])});var v=function(e,t){return e.level==t.level};(0,_.traverse)(m,function(e){p.default.filterContents(t.children,e,t.radiusPower,null,v)}),console.timeEnd("QuadtreeLODUtil.filterContents"),m.generateLOD=!1,console.log(m),this.lodRoot=m}},{key:"render",value:function(e,t){this.ready&&this.show&&(this.lodRoot.visualizer=this.visualizer,this.lodRoot.render(e,t))}},{key:"destroy",value:function(){this.visualizer&&(this.visualizer.remove(this.scene,!0),this.visualizer.remove(this)),(0,y.default)(this.scene),this.children.splice(0),this.ready=!1,this.contentSet.forEach(function(e){e.content=null}),this.contentSet.splice(0),this.lodRoot.destroy(),this.lodRoot=null,this.loader=null,!this.scene.isScene&&scene.dispose&&this.scene.dispose(),this.scene=null,this.visualizer=null}}]),t}(h.default);r.default=b},{s_343:4,"._172":209,"._315":83,D_314:84,D_325:85,e_342:182,o_361:184,h_344:186,e_1:235,s_2:236,m_131:239,C_129:240,M_0:241,o_130:242}],87:[function(e,t,r){"use strict";var n=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.TaskList=void 0;var i=n(e("e_1")),a=n(e("s_2")),o=function(){function e(t,r){(0,i.default)(this,e),this._queue=[],this._loadingTiles=new Map,this._loadingCount=0,this.maxLoadingCount=t||1,this.workFuncName=r||"requestTile",this.deferredList=[],this.immediateList=[]}return(0,a.default)(e,[{key:"add",value:function(e){this.has(e)||this._queue.push(e)}},{key:"has",value:function(e){return this._loadingTiles.has(e.tileId)||-1!=this._queue.indexOf(e)}},{key:"remove",value:function(e){if(this._loadingTiles.has(e.tileId)&&this._loadingTiles.delete(e.tileId),-1!=this._queue.indexOf(e))for(var t=0;t<this.length;t++)if(this._queue[t]==e)return this._queue.splice(t,1)}},{key:"update",value:function(e){var t=this;if(this.length>0&&this._loadingCount<this.maxLoadingCount){var r=[],n=[];this._queue.forEach(function(e){0==e.visibility?r.push(e):n.push(e)});var i=n.length>0?n:r;if(0==n.length&&e)return;if(i.sort(function(e,t){return e._distanceToCamera&&t._distanceToCamera?e._distanceToCamera-t._distanceToCamera:1==e.visibility&&0==t.visibility?-1:0==e.visibility&&1==t.visibility?1:e.parent&&t.parent?e._distanceToCamera-t.parent._distanceToCamera:t.priority-e.priority}),this.deferredList=r,this.immediateList=n,0==i.length)return;var a=i.shift();return this._loadingTiles.set(a.tileId,a),Cesium.when(a[this.workFuncName](),function(){e?Cesium.requestAnimationFrame(function(){t._loadingCount--}):t._loadingCount--,t._loadingTiles.delete(a.tileId)},function(e){console.warn("tile "+a.tileId+"  load failed."),t._loadingCount--,t._loadingTiles.delete(a.tileId)}),this._loadingCount++,this._queue=n.concat(r),console.log(this.workFuncName,this._queue.length),!0}}},{key:"length",get:function(){return this._queue.length+this.immediateList.length+this.deferredList.length}}]),e}();r.TaskList=o},{e_1:235,s_2:236,M_0:241}],88:[function(e,t,r){(function(e){(function(){"use strict";function t(t,r){t instanceof Uint8Array?t=t.buffer:void 0!==e&&t instanceof e&&(t=new Uint8Array(t).buffer),this.pos=0,this.buffer=new DataView(t);var n=new Uint8Array(t);if(this.buffer.toString=function(e,t,r){var i=n.subarray(t,r);return String.fromCharCode.apply(null,i)},this.is_with_alpha=!!r,this.bottom_up=!0,this.flag=this.buffer.toString("utf-8",0,this.pos+=2),"BM"!=this.flag)throw new Error("Invalid BMP File");this.parseHeader(),this.parseRGBA()}Object.defineProperty(r,"__esModule",{value:!0}),r.BmpDecoder=t,t.prototype.parseHeader=function(){if(this.fileSize=this.buffer.getUint32(this.pos),this.pos+=4,this.reserved=this.buffer.getUint32(this.pos),this.pos+=4,this.offset=this.buffer.getUint32(this.pos),this.pos+=4,this.headerSize=this.buffer.getUint32(this.pos),this.pos+=4,this.width=this.buffer.getUint32(this.pos),this.pos+=4,this.height=this.buffer.getInt32(this.pos),this.pos+=4,this.planes=this.buffer.getUint16(this.pos),this.pos+=2,this.bitPP=this.buffer.getUint16(this.pos),this.pos+=2,this.compress=this.buffer.getUint32(this.pos),this.pos+=4,this.rawSize=this.buffer.getUint32(this.pos),this.pos+=4,this.hr=this.buffer.getUint32(this.pos),this.pos+=4,this.vr=this.buffer.getUint32(this.pos),this.pos+=4,this.colors=this.buffer.getUint32(this.pos),this.pos+=4,this.importantColors=this.buffer.getUint32(this.pos),this.pos+=4,16===this.bitPP&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=0===this.colors?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var r=this.buffer.getUint8(this.pos++),n=this.buffer.getUint8(this.pos++),i=this.buffer.getUint8(this.pos++),a=this.buffer.getUint8(this.pos++);this.palette[t]={red:i,green:n,blue:r,quad:a}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},t.prototype.parseRGBA=function(){var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()},t.prototype.bit1=function(){for(var e=Math.ceil(this.width/8),t=e%4,r=this.height>=0?this.height-1:-this.height,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<e;i++)for(var a=this.buffer.getUint8(this.pos++),o=n*this.width*4+8*i*4,s=0;s<8&&8*i+s<this.width;s++){var u=this.palette[a>>7-s&1];this.data[o+4*s]=0,this.data[o+4*s+1]=u.blue,this.data[o+4*s+2]=u.green,this.data[o+4*s+3]=u.red}0!=t&&(this.pos+=4-t)}},t.prototype.bit4=function(){if(2==this.compress){var e=function(e){var r=this.palette[e];this.data[t]=0,this.data[t+1]=r.blue,this.data[t+2]=r.green,this.data[t+3]=r.red,t+=4};this.data.fill(255);for(var t=0,r=this.bottom_up?this.height-1:0,n=!1;t<this.data.length;){var i=this.buffer.getUint8(this.pos++),a=this.buffer.getUint8(this.pos++);if(0==i){if(0==a){this.bottom_up?r--:r++,t=r*this.width*4,n=!1;continue}if(1==a)break;if(2==a){var o=this.buffer.getUint8(this.pos++),s=this.buffer.getUint8(this.pos++);this.bottom_up?r-=s:r+=s,t+=s*this.width*4+4*o}else{for(var u=this.buffer.getUint8(this.pos++),l=0;l<a;l++)n?e.call(this,15&u):e.call(this,(240&u)>>4),1&l&&l+1<a&&(u=this.buffer.getUint8(this.pos++)),n=!n;1==(a+1>>1&1)&&this.pos++}}else for(var l=0;l<i;l++)n?e.call(this,15&a):e.call(this,(240&a)>>4),n=!n}}else for(var c=Math.ceil(this.width/2),f=c%4,s=this.height-1;s>=0;s--){for(var d=this.bottom_up?s:this.height-1-s,o=0;o<c;o++){var a=this.buffer.getUint8(this.pos++),t=d*this.width*4+2*o*4,h=a>>4,p=15&a,m=this.palette[h];if(this.data[t]=0,this.data[t+1]=m.blue,this.data[t+2]=m.green,this.data[t+3]=m.red,2*o+1>=this.width)break;m=this.palette[p],this.data[t+4]=0,this.data[t+4+1]=m.blue,this.data[t+4+2]=m.green,this.data[t+4+3]=m.red}0!=f&&(this.pos+=4-f)}},t.prototype.bit8=function(){if(1==this.compress){var e=function(e){var r=this.palette[e];this.data[t]=0,this.data[t+1]=r.blue,this.data[t+2]=r.green,this.data[t+3]=r.red,t+=4};this.data.fill(255);for(var t=0,r=this.bottom_up?this.height-1:0;t<this.data.length;){var n=this.buffer.getUint8(this.pos++),i=this.buffer.getUint8(this.pos++);if(0==n){if(0==i){this.bottom_up?r--:r++,t=r*this.width*4;continue}if(1==i)break;if(2==i){var a=this.buffer.getUint8(this.pos++),o=this.buffer.getUint8(this.pos++);this.bottom_up?r-=o:r+=o,t+=o*this.width*4+4*a}else{for(var s=0;s<i;s++){e.call(this,this.buffer.getUint8(this.pos++))}!0&i&&this.pos++}}else for(var s=0;s<n;s++)e.call(this,i)}}else for(var u=this.width%4,o=this.height-1;o>=0;o--){for(var l=this.bottom_up?o:this.height-1-o,a=0;a<this.width;a++){var i=this.buffer.getUint8(this.pos++),t=l*this.width*4+4*a;if(i<this.palette.length){var c=this.palette[i];this.data[t]=0,this.data[t+1]=c.blue,this.data[t+2]=c.green,this.data[t+3]=c.red}else this.data[t]=0,this.data[t+1]=255,this.data[t+2]=255,this.data[t+3]=255}0!=u&&(this.pos+=4-u)}},t.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),r=t,n=this.height-1;n>=0;n--){for(var i=this.bottom_up?n:this.height-1-n,a=0;a<this.width;a++){var o=this.buffer.getUint16(this.pos);this.pos+=2;var s=(o&r)/r*255|0,u=(o>>5&r)/r*255|0,l=(o>>10&r)/r*255|0,c=o>>15?255:0,f=i*this.width*4+4*a;this.data[f]=c,this.data[f+1]=s,this.data[f+2]=u,this.data[f+3]=l}this.pos+=e}},t.prototype.bit16=function(){var e=this.width%2*2;this.maskRed=31744,this.maskGreen=992,this.maskBlue=31,this.mask0=0,3==this.compress&&(this.maskRed=this.buffer.getUint32(this.pos),this.pos+=4,this.maskGreen=this.buffer.getUint32(this.pos),this.pos+=4,this.maskBlue=this.buffer.getUint32(this.pos),this.pos+=4,this.mask0=this.buffer.getUint32(this.pos),this.pos+=4);for(var t=[0,0,0],r=0;r<16;r++)this.maskRed>>r&1&&t[0]++,this.maskGreen>>r&1&&t[1]++,this.maskBlue>>r&1&&t[2]++;t[1]+=t[0],t[2]+=t[1],t[0]=8-t[0],t[1]-=8,t[2]-=8;for(var n=this.height-1;n>=0;n--){for(var i=this.bottom_up?n:this.height-1-n,a=0;a<this.width;a++){var o=this.buffer.getUint16(this.pos);this.pos+=2;var s=(o&this.maskBlue)<<t[0],u=(o&this.maskGreen)>>t[1],l=(o&this.maskRed)>>t[2],c=i*this.width*4+4*a;this.data[c]=0,this.data[c+1]=s,this.data[c+2]=u,this.data[c+3]=l}this.pos+=e}},t.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.buffer.getUint8(this.pos++),i=this.buffer.getUint8(this.pos++),a=this.buffer.getUint8(this.pos++),o=t*this.width*4+4*r;this.data[o]=0,this.data[o+1]=n,this.data[o+2]=i,this.data[o+3]=a}this.pos+=this.width%4}},t.prototype.bit32=function(){if(3==this.compress){this.maskRed=this.buffer.getUint32(this.pos),this.pos+=4,this.maskGreen=this.buffer.getUint32(this.pos),this.pos+=4,this.maskBlue=this.buffer.getUint32(this.pos),this.pos+=4,this.mask0=this.buffer.getUint32(this.pos),this.pos+=4;for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.buffer.getUint8(this.pos++),i=this.buffer.getUint8(this.pos++),a=this.buffer.getUint8(this.pos++),o=this.buffer.getUint8(this.pos++),s=t*this.width*4+4*r;this.data[s]=n,this.data[s+1]=i,this.data[s+2]=a,this.data[s+3]=o}}else for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var i=this.buffer.getUint8(this.pos++),a=this.buffer.getUint8(this.pos++),o=this.buffer.getUint8(this.pos++),n=this.buffer.getUint8(this.pos++),s=t*this.width*4+4*r;this.data[s]=n,this.data[s+1]=i,this.data[s+2]=a,this.data[s+3]=o}},t.prototype.getData=function(){return this.data}}).call(this)}).call(this,e("buffer").Buffer)},{buffer:248}],89:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.DRACOExporter=void 0;var n=function(){};r.DRACOExporter=n,n.prototype={constructor:n,parse:function(e,t){if(void 0===DracoEncoderModule)throw new Error("THREE.DRACOExporter: required the draco_decoder to work.");void 0===t&&(t={decodeSpeed:5,encodeSpeed:5,encoderMethod:n.MESH_EDGEBREAKER_ENCODING,quantization:[16,8,8,8,8],exportUvs:!0,exportNormals:!0,exportColor:!1});var r=DracoEncoderModule(),i=new r.Encoder,a=new r.MeshBuilder,o=new r.Mesh;if(!0===e.isGeometry){var s=new THREE.BufferGeometry;s.fromGeometry(e),e=s}if(!0!==e.isBufferGeometry)throw new Error("THREE.DRACOExporter.parse(geometry, options): geometry is not a THREE.Geometry or BufferGeometry instance.");var u=e.getAttribute("position");a.AddFloatAttributeToMesh(o,r.POSITION,u.count,u.itemSize,u.array);var l=e.getIndex();if(null!==l)a.AddFacesToMesh(o,l.count/3,l.array);else{for(var l=new(u.count>65535?Uint32Array:Uint16Array)(u.count),c=0;c<l.length;c++)l[c]=c;a.AddFacesToMesh(o,u.count,l)}if(!0===t.exportNormals){var f=e.getAttribute("normal");void 0!==f&&a.AddFloatAttributeToMesh(o,r.NORMAL,f.count,f.itemSize,f.array)}if(!0===t.exportUvs){var d=e.getAttribute("uv");void 0!==d&&a.AddFloatAttributeToMesh(o,r.TEX_COORD,d.count,d.itemSize,d.array),d=e.getAttribute("uv2"),void 0!==d&&a.AddFloatAttributeToMesh(o,r.GENERIC,d.count,d.itemSize,d.array)}if(!0===t.exportColor){var h=e.getAttribute("color");void 0!==h&&a.AddFloatAttributeToMesh(o,r.COLOR,h.count,h.itemSize,h.array)}var p=new r.DracoInt8Array;if(i.SetSpeedOptions(t.encodeSpeed||5,t.decodeSpeed||5),void 0!==t.encoderMethod&&i.SetEncodingMethod(t.encoderMethod),void 0!==t.quantization)for(var c=0;c<5;c++)void 0!==t.quantization[c]&&i.SetAttributeQuantization(c,t.quantization[c]);var m=i.EncodeMeshToDracoBuffer(o,p);if(r.destroy(o),0===m)throw new Error("THREE.DRACOExporter: Draco encoding failed.");for(var v=new Int8Array(new ArrayBuffer(m)),c=0;c<m;c++)v[c]=p.GetValue(c);return r.destroy(p),r.destroy(i),r.destroy(a),v}},n.MESH_EDGEBREAKER_ENCODING=1,n.MESH_SEQUENTIAL_ENCODING=0,n.POINT_CLOUD=0,n.TRIANGULAR_MESH=1,n.INVALID=-1,n.POSITION=0,n.NORMAL=1,n.COLOR=2,n.TEX_COORD=3,n.GENERIC=4},{}],90:[function(e,t,r){"use strict";function n(){if(!E){E=!0;var e=THREE;i=e.BufferAttribute,a=e.BufferGeometry,o=1001,s=2,u=2300,l=2301,c=1006,f=1008,d=1007,h=e.MathUtils,p=1002,m=1003,v=1005,g=1004,y=e.PropertyBinding,_=1023,b=1e3,M=e.Scene,x=e.Vector3,T[m]=9728,T[g]=9984,T[v]=9986,T[c]=9729,T[d]=9985,T[f]=9987,T[o]=33071,T[b]=10497,T[p]=33648}}Object.defineProperty(r,"__esModule",{value:!0}),r.GLTFExporter=void 0;var i,a,o,s,u,l,c,f,d,h,p,m,v,g,y,_,b,M,x,w=e("h_399"),S="undefined"==typeof Blob||"undefined"==typeof Image||"undefined"==typeof Document||"undefined"==typeof window,T={},C={scale:"scale",position:"translation",quaternion:"rotation",morphTargetInfluences:"weights"},E=!1,A=function(){n()};r.GLTFExporter=A,A.prototype={constructor:A,parse:function(e,t,r){function n(e){return te.has(e)||te.set(e,re++),te.get(e)}function o(e,t){return e.length===t.length&&e.every(function(e,r){return e===t[r]})}function l(e){if("undefined"!=typeof TextEncoder)return(new TextEncoder).encode(e).buffer;for(var t=new Uint8Array(new ArrayBuffer(e.length)),r=0,n=e.length;r<n;r++){var i=e.charCodeAt(r);t[r]=i>255?32:i}return t.buffer}function c(e,t,r){for(var n={min:new Array(e.itemSize).fill(Number.POSITIVE_INFINITY),max:new Array(e.itemSize).fill(Number.NEGATIVE_INFINITY)},i=t;i<t+r;i++)for(var a=0;a<e.itemSize;a++){var o=e.array[i*e.itemSize+a];n.min[a]=Math.min(n.min[a],o),n.max[a]=Math.max(n.max[a],o)}return n}function f(e){return h.isPowerOfTwo(e.width)&&h.isPowerOfTwo(e.height)}function d(e){if(ee.attributesNormalized.has(e))return!1;for(var t=new x,r=0,n=e.count;r<n;r++)if(Math.abs(t.fromArray(e.array,3*r).length()-1)>5e-4)return!1;return!0}function p(e){if(ee.attributesNormalized.has(e))return ee.attributesNormalized.get(e);for(var t=e.clone(),r=new x,n=0,i=t.count;n<i;n++)r.fromArray(t.array,3*n),0===r.x&&0===r.y&&0===r.z?r.setX(1):r.normalize(),r.toArray(t.array,3*n);return ee.attributesNormalized.set(e,t),t}function m(e){return 4*Math.ceil(e/4)}function v(e,t){t=t||0;var r=m(e.byteLength);if(r!==e.byteLength){var n=new Uint8Array(r);if(n.set(new Uint8Array(e)),0!==t)for(var i=e.byteLength;i<r;i++)n[i]=t;return n.buffer}return e}
function g(e,t){if(0!==Object.keys(e.userData).length)try{var n=JSON.parse(JSON.stringify(e.userData));if(r.includeCustomExtensions&&n.gltfExtensions){void 0===t.extensions&&(t.extensions={});for(var i in n.gltfExtensions)t.extensions[i]=n.gltfExtensions[i],$[i]=!0;delete n.gltfExtensions}Object.keys(n).length>0&&(t.extras=n)}catch(t){console.warn("THREE.GLTFExporter: userData of '"+e.name+"' won't be serialized because of JSON.stringify error - "+t.message)}}function b(e,t){var r=!1,n={};0===t.offset.x&&0===t.offset.y||(n.offset=t.offset.toArray(),r=!0),0!==t.rotation&&(n.rotation=t.rotation,r=!0),1===t.repeat.x&&1===t.repeat.y||(n.scale=t.repeat.toArray(),r=!0),r&&(e.extensions=e.extensions||{},e.extensions.KHR_texture_transform=n,$.KHR_texture_transform=!0)}function E(e){return X.buffers||(X.buffers=[{byteLength:0}]),K.push(e),0}function L(e,t,r,n,i){X.bufferViews||(X.bufferViews=[]);var a;a=5121===t?1:5123===t?2:4;for(var o=m(n*e.itemSize*a),s=new DataView(new ArrayBuffer(o)),u=0,l=r;l<r+n;l++)for(var c=0;c<e.itemSize;c++){var f=e.array[l*e.itemSize+c];5126===t?s.setFloat32(u,f,!0):5125===t?s.setUint32(u,f,!0):5123===t?s.setUint16(u,f,!0):5121===t&&s.setUint8(u,f),u+=a}var d={buffer:E(s.buffer),byteOffset:q,byteLength:o};return void 0!==i&&(d.target=i),34962===i&&(d.byteStride=e.itemSize*a),q+=o,X.bufferViews.push(d),{id:X.bufferViews.length-1,byteLength:0}}function P(e){return X.bufferViews||(X.bufferViews=[]),new Promise(function(t){var r=new window.FileReader;r.readAsArrayBuffer(e),r.onloadend=function(){var e=v(r.result),n={buffer:E(e),byteOffset:q,byteLength:e.byteLength};q+=e.byteLength,X.bufferViews.push(n),t(X.bufferViews.length-1)}})}function O(e,t,n,i){var a,o={1:"SCALAR",2:"VEC2",3:"VEC3",4:"VEC4",16:"MAT4"};if(e.array.constructor===Float32Array)a=5126;else if(e.array.constructor===Uint32Array)a=5125;else if(e.array.constructor===Uint16Array)a=5123;else{if(e.array.constructor!==Uint8Array)throw new Error("THREE.GLTFExporter: Unsupported bufferAttribute component type.");a=5121}if(void 0===n&&(n=0),void 0===i&&(i=e.count),r.truncateDrawRange&&void 0!==t&&null===t.index){var s=n+i,u=t.drawRange.count===1/0?e.count:t.drawRange.start+t.drawRange.count;n=Math.max(n,t.drawRange.start),i=Math.min(s,u)-n,i<0&&(i=0)}if(0===i)return null;var l,f=c(e,n,i);void 0!==t&&(l=e===t.index?34963:34962);var d=L(e,a,n,i,l),h={bufferView:d.id,byteOffset:d.byteOffset,componentType:a,count:i,max:f.max,min:f.min,type:o[e.itemSize]};return X.accessors||(X.accessors=[]),X.accessors.push(h),X.accessors.length-1}function R(e,t,n){if(e){ee.images.has(e.src)||ee.images.set(e.src,{});var i=ee.images.get(e.src),a=t===_?"image/png":"image/jpeg",o=a+":flipY/"+n.toString();if(void 0!==i[o])return i[o];X.images||(X.images=[]);var s={mimeType:a},u=ee.assetSrcs[e.src]||e.src||e;if("undefined"!=typeof HTMLCanvasElement&&("string"!=typeof u||u.startsWith("blob:")||r.embedImages)){e||(e=document.createElement("canvas"),e.width=2,e.height=2);var l=Y=Y||document.createElement("canvas");l.width=Math.min(e.width,r.maxTextureSize),l.height=Math.min(e.height,r.maxTextureSize),r.forcePowerOfTwoTextures&&!f(l)&&(console.warn("GLTFExporter: Resized non-power-of-two image.",e),l.width=h.floorPowerOfTwo(l.width),l.height=h.floorPowerOfTwo(l.height));var c=l.getContext("2d");!0===n&&(c.translate(0,l.height),c.scale(1,-1)),c.drawImage(e,0,0,l.width,l.height),!0===r.binary?Z.push(new Promise(function(e){l.toBlob(function(t){P(t).then(function(t){s.bufferView=t,e()})},a)})):s.uri=l.toDataURL(a)}else s.uri=u;X.images.push(s);var d=X.images.length-1;return i[o]=d,d}}function I(e){X.samplers||(X.samplers=[]);var t={magFilter:T[e.magFilter],minFilter:T[e.minFilter],wrapS:T[e.wrapS],wrapT:T[e.wrapT]};return X.samplers.push(t),X.samplers.length-1}function D(e){if(ee.textures.has(e))return ee.textures.get(e);X.textures||(X.textures=[]);var t={sampler:I(e),source:R(e.image,e.format,e.flipY)};e.name&&(t.name=e.name),X.textures.push(t);var r=X.textures.length-1;return ee.textures.set(e,r),r}function B(e){if(ee.materials.has(e))return ee.materials.get(e);if(e.isShaderMaterial)return console.warn("GLTFExporter: THREE.ShaderMaterial not supported."),null;X.materials||(X.materials=[]);var t={pbrMetallicRoughness:{}};e.isMeshBasicMaterial?(t.extensions={KHR_materials_unlit:{}},$.KHR_materials_unlit=!0):e.isGLTFSpecularGlossinessMaterial?(t.extensions={KHR_materials_pbrSpecularGlossiness:{}},$.KHR_materials_pbrSpecularGlossiness=!0):e.isMeshStandardMaterial||console.warn("GLTFExporter: Use MeshStandardMaterial or MeshBasicMaterial for best results.");var r=e.color.toArray().concat([e.opacity]);if(o(r,[1,1,1,1])||(t.pbrMetallicRoughness.baseColorFactor=r),e.isMeshStandardMaterial?(t.pbrMetallicRoughness.metallicFactor=e.metalness,t.pbrMetallicRoughness.roughnessFactor=e.roughness):e.isMeshBasicMaterial?(t.pbrMetallicRoughness.metallicFactor=0,t.pbrMetallicRoughness.roughnessFactor=.9):(t.pbrMetallicRoughness.metallicFactor=.5,t.pbrMetallicRoughness.roughnessFactor=.5),e.isGLTFSpecularGlossinessMaterial){t.pbrMetallicRoughness.baseColorFactor&&(t.extensions.KHR_materials_pbrSpecularGlossiness.diffuseFactor=t.pbrMetallicRoughness.baseColorFactor);var n=[1,1,1];e.specular.toArray(n,0),t.extensions.KHR_materials_pbrSpecularGlossiness.specularFactor=n,t.extensions.KHR_materials_pbrSpecularGlossiness.glossinessFactor=e.glossiness}if(e.metalnessMap||e.roughnessMap)if(e.metalnessMap===e.roughnessMap){var i={index:D(e.metalnessMap)};b(i,e.metalnessMap),t.pbrMetallicRoughness.metallicRoughnessTexture=i}else console.warn("THREE.GLTFExporter: Ignoring metalnessMap and roughnessMap because they are not the same Texture.");if(e.map){var a={index:D(e.map)};b(a,e.map),e.isGLTFSpecularGlossinessMaterial&&(t.extensions.KHR_materials_pbrSpecularGlossiness.diffuseTexture=a),t.pbrMetallicRoughness.baseColorTexture=a}if(e.isGLTFSpecularGlossinessMaterial&&e.specularMap){var u={index:D(e.specularMap)};b(u,e.specularMap),t.extensions.KHR_materials_pbrSpecularGlossiness.specularGlossinessTexture=u}if(e.emissive){var l=e.emissive.clone().multiplyScalar(e.emissiveIntensity).toArray();if(o(l,[0,0,0])||(t.emissiveFactor=l),e.emissiveMap){var c={index:D(e.emissiveMap)};b(c,e.emissiveMap),t.emissiveTexture=c}}if(e.normalMap){var f={index:D(e.normalMap)};e.normalScale&&-1!==e.normalScale.x&&(e.normalScale.x!==e.normalScale.y&&console.warn("THREE.GLTFExporter: Normal scale components are different, ignoring Y and exporting X."),f.scale=e.normalScale.x),b(f,e.normalMap),t.normalTexture=f}if(e.aoMap){var d={index:D(e.aoMap),texCoord:1};1!==e.aoMapIntensity&&(d.strength=e.aoMapIntensity),b(d,e.aoMap),t.occlusionTexture=d}e.transparent?t.alphaMode="BLEND":e.alphaTest>0&&(t.alphaMode="MASK",t.alphaCutoff=e.alphaTest),e.side===s&&(t.doubleSided=!0),""!==e.name&&(t.name=e.name),g(e,t),X.materials.push(t);var h=X.materials.length-1;return ee.materials.set(e,h),h}function U(e){var t=[e.geometry.uuid];if(Array.isArray(e.material))for(var o=0,s=e.material.length;o<s;o++)t.push(e.material[o].uuid);else t.push(e.material.uuid);var u=t.join(":");if(ee.meshes.has(u))return ee.meshes.get(u);var l,c=e.geometry;l=e.isLineSegments?1:e.isLineLoop?2:e.isLine?3:e.isPoints?0:e.material.wireframe?1:4,c.isBufferGeometry||(console.warn("GLTFExporter: Exporting THREE.Geometry will increase file size. Use BufferGeometry instead."),c=(new a).setFromObject(e));var f={},h={},m=[],v=[],y={uv:"TEXCOORD_0",uv2:"TEXCOORD_1",color:"COLOR_0",skinWeight:"WEIGHTS_0",skinIndex:"JOINTS_0"},_=c.getAttribute("normal");void 0===_||d(_)||(console.warn("THREE.GLTFExporter: Creating normalized normal attribute from the non-normalized one."),c.setAttribute("normal",p(_)));var b=null;for(var M in c.attributes)if("morph"!==M.substr(0,5)){var x=c.attributes[M];M=y[M]||M.toUpperCase();var w=/^(POSITION|NORMAL|TANGENT|TEXCOORD_\d+|COLOR_\d+|JOINTS_\d+|WEIGHTS_\d+)$/;if(w.test(M)||(M="_"+M),ee.attributes.has(n(x)))h[M]=ee.attributes.get(n(x));else{b=null;var S=x.array;"JOINTS_0"!==M||S instanceof Uint16Array||S instanceof Uint8Array||(console.warn('GLTFExporter: Attribute "skinIndex" converted to type UNSIGNED_SHORT.'),b=new i(new Uint16Array(S),x.itemSize,x.normalized));var T=O(b||x,c);null!==T&&(h[M]=T,ee.attributes.set(n(x),T))}}if(void 0!==_&&c.setAttribute("normal",_),0===Object.keys(h).length)return null;if(void 0!==e.morphTargetInfluences&&e.morphTargetInfluences.length>0){var C=[],E=[],A={};if(void 0!==e.morphTargetDictionary)for(var L in e.morphTargetDictionary)A[e.morphTargetDictionary[L]]=L;for(var o=0;o<e.morphTargetInfluences.length;++o){var P={},R=!1;for(var M in c.morphAttributes)if("position"===M||"normal"===M){var x=c.morphAttributes[M][o],I=M.toUpperCase(),D=c.attributes[M];if(ee.attributes.has(n(x)))P[I]=ee.attributes.get(n(x));else{var U=x.clone();if(!c.morphTargetsRelative)for(var N=0,k=x.count;N<k;N++)U.setXYZ(N,x.getX(N)-D.getX(N),x.getY(N)-D.getY(N),x.getZ(N)-D.getZ(N));P[I]=O(U,c),ee.attributes.set(n(D),P[I])}}else R||(console.warn("GLTFExporter: Only POSITION and NORMAL morph are supported."),R=!0);v.push(P),C.push(e.morphTargetInfluences[o]),void 0!==e.morphTargetDictionary&&E.push(A[o])}f.weights=C,E.length>0&&(f.extras={},f.extras.targetNames=E)}var j=r.forceIndices,G=Array.isArray(e.material);if(G&&0===c.groups.length)return null;!j&&null===c.index&&G&&(console.warn("THREE.GLTFExporter: Creating index for non-indexed multi-material mesh."),j=!0);var V=!1;if(null===c.index&&j){for(var F=[],o=0,z=c.attributes.position.count;o<z;o++)F[o]=o;c.setIndex(F),V=!0}for(var H=G?e.material:[e.material],W=G?c.groups:[{materialIndex:0,start:void 0,count:void 0}],o=0,z=W.length;o<z;o++){var Y={mode:l,attributes:h};if(g(c,Y),v.length>0&&(Y.targets=v),null!==c.index){var q=n(c.index);void 0===W[o].start&&void 0===W[o].count||(q+=":"+W[o].start+":"+W[o].count),ee.attributes.has(q)?Y.indices=ee.attributes.get(q):(Y.indices=O(c.index,c,W[o].start,W[o].count),ee.attributes.set(q,Y.indices)),null===Y.indices&&delete Y.indices}var K=B(H[W[o].materialIndex]);null!==K&&(Y.material=K),m.push(Y)}V&&c.setIndex(null),f.primitives=m,X.meshes||(X.meshes=[]),X.meshes.push(f);var Z=X.meshes.length-1;return ee.meshes.set(u,Z),Z}function N(e){X.cameras||(X.cameras=[]);var t=e.isOrthographicCamera,r={type:t?"orthographic":"perspective"};return t?r.orthographic={xmag:2*e.right,ymag:2*e.top,zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near}:r.perspective={aspectRatio:e.aspect,yfov:h.degToRad(e.fov),zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near},""!==e.name&&(r.name=e.type),X.cameras.push(r),X.cameras.length-1}function k(e,t){X.animations||(X.animations=[]),e=A.Utils.mergeMorphTargetTracks(e.clone(),t);for(var r=e.tracks,n=[],a=[],o=0;o<r.length;++o){var s=r[o],l=y.parseTrackName(s.name),c=y.findNode(t,l.nodeName),f=C[l.propertyName];if("bones"===l.objectName&&(c=!0===c.isSkinnedMesh?c.skeleton.getBoneByName(l.objectIndex):void 0),!c||!f)return console.warn('THREE.GLTFExporter: Could not export animation track "%s".',s.name),null;var d=s.values.length/s.times.length;f===C.morphTargetInfluences&&(d/=c.morphTargetInfluences.length);var h;!0===s.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline?(h="CUBICSPLINE",d/=3):h=s.getInterpolation()===u?"STEP":"LINEAR",a.push({input:O(new i(s.times,1)),output:O(new i(s.values,d)),interpolation:h}),n.push({sampler:a.length-1,target:{node:J.get(c),path:f}})}return X.animations.push({name:e.name||"clip_"+X.animations.length,samplers:a,channels:n}),X.animations.length-1}function j(e){var t=X.nodes[J.get(e)],r=e.skeleton;if(void 0===r)return null;var n=e.skeleton.bones[0];if(void 0===n)return null;for(var a=[],o=new Float32Array(16*r.bones.length),s=0;s<r.bones.length;++s)a.push(J.get(r.bones[s])),r.boneInverses[s].toArray(o,16*s);return void 0===X.skins&&(X.skins=[]),X.skins.push({inverseBindMatrices:O(new i(o,16)),joints:a,skeleton:J.get(n)}),t.skin=X.skins.length-1}function G(e){var t={};e.name&&(t.name=e.name),t.color=e.color.toArray(),t.intensity=e.intensity,e.isDirectionalLight?t.type="directional":e.isPointLight?(t.type="point",e.distance>0&&(t.range=e.distance)):e.isSpotLight&&(t.type="spot",e.distance>0&&(t.range=e.distance),t.spot={},t.spot.innerConeAngle=(e.penumbra-1)*e.angle*-1,t.spot.outerConeAngle=e.angle),void 0!==e.decay&&2!==e.decay&&console.warn("THREE.GLTFExporter: Light decay may be lost. glTF is physically-based, and expects light.decay=2."),!e.target||e.target.parent===e&&0===e.target.position.x&&0===e.target.position.y&&-1===e.target.position.z||console.warn("THREE.GLTFExporter: Light direction may be lost. For best results, make light.target a child of the light with position 0,0,-1.");var r=X.extensions.KHR_lights_punctual.lights;return r.push(t),r.length-1}function V(e){X.nodes||(X.nodes=[]);var t={};if(r.trs){var n=e.quaternion.toArray(),i=e.position.toArray(),a=e.scale.toArray();o(n,[0,0,0,1])||(t.rotation=n),o(i,[0,0,0])||(t.translation=i),o(a,[1,1,1])||(t.scale=a)}else e.matrixAutoUpdate&&e.updateMatrix(),o(e.matrix.elements,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])||(t.matrix=e.matrix.elements);if(""!==e.name&&(t.name=String(e.name)),g(e,t),e.isMesh||e.isLine||e.isPoints){var s=U(e);null!==s&&(t.mesh=s)}else if(e.isCamera)t.camera=N(e);else if(e.isDirectionalLight||e.isPointLight||e.isSpotLight)$.KHR_lights_punctual||(X.extensions=X.extensions||{},X.extensions.KHR_lights_punctual={lights:[]},$.KHR_lights_punctual=!0),t.extensions=t.extensions||{},t.extensions.KHR_lights_punctual={light:G(e)};else if(e.isLight)return console.warn("THREE.GLTFExporter: Only directional, point, and spot lights are supported.",e),null;if(e.isSkinnedMesh&&Q.push(e),e.children.length>0){for(var u=[],l=0,c=e.children.length;l<c;l++){var f=e.children[l];if(f.visible||!1===r.onlyVisible){var d=V(f);null!==d&&u.push(d)}}u.length>0&&(t.children=u)}X.nodes.push(t);var h=X.nodes.length-1;return J.set(e,h),h}function F(e){X.scenes||(X.scenes=[],X.scene=0);var t={};""!==e.name&&(t.name=e.name),X.scenes.push(t);for(var n=[],i=0,a=e.children.length;i<a;i++){var o=e.children[i];if(o.visible||!1===r.onlyVisible){var s=V(o);null!==s&&n.push(s)}}n.length>0&&(t.nodes=n),g(e,t)}function z(e){var t=new M;t.name="AuxScene";for(var r=0;r<e.length;r++)t.children.push(e[r]);F(t)}function H(e){e=e.map(function(e){return e instanceof DataView||e instanceof Uint8Array?e.buffer:e});var t=0;e.forEach(function(e){return t+=e.byteLength});var r=new Uint8Array(t),n=0;return e.forEach(function(e){r.set(new Uint8Array(e),n),n+=e.byteLength}),r.buffer}var W={binary:!1,trs:!1,onlyVisible:!0,truncateDrawRange:!0,embedImages:!0,maxTextureSize:1/0,animations:[],forceIndices:!1,forcePowerOfTwoTextures:!1,includeCustomExtensions:!1};r=Object.assign({},W,r),r.animations.length>0&&(r.trs=!0);var Y,X={asset:{version:"2.0",generator:"GLTFExporter"}},q=0,K=[],Z=[],J=new Map,Q=[],$={},ee={meshes:new Map,attributes:new Map,attributesNormalized:new Map,materials:new Map,textures:new Map,images:new Map,assetSrcs:r.assetSrcs||{}},te=new Map,re=0;try{!function(e){e=e instanceof Array?e:[e];for(var t=[],n=0;n<e.length;n++)e[n]instanceof M?F(e[n]):t.push(e[n]);t.length>0&&z(t);for(var n=0;n<Q.length;++n)j(Q[n]);for(var n=0;n<r.animations.length;++n)k(r.animations[n],e[0])}(e)}catch(e){throw console.error(e),e}Promise.all(Z).then(function(){if(S){var e=H(K),n=Object.keys($);if(n.length>0&&(X.extensionsUsed=n),X.buffers&&X.buffers.length>0&&(X.buffers[0].byteLength=e.byteLength),!0===r.binary){var i=12,a=1179937895,o=2,s=8,u=1313821514,c=5130562,f=v(e),d=new DataView(new ArrayBuffer(s));d.setUint32(0,f.byteLength,!0),d.setUint32(4,c,!0);var h=v(l(JSON.stringify(X)),32),p=new DataView(new ArrayBuffer(s));p.setUint32(0,h.byteLength,!0),p.setUint32(4,u,!0);var m=new ArrayBuffer(i),g=new DataView(m);g.setUint32(0,a,!0),g.setUint32(4,o,!0);var y=i+p.byteLength+h.byteLength+d.byteLength+f.byteLength;g.setUint32(8,y,!0);var _=H([m,p,h,d,f]);t(_)}else if(X.buffers&&X.buffers.length>0){var b="data:application/octet-stream;base64,"+(0,w.fromByteArray)(new Uint8Array(e));X.buffers[0].uri=b,t(X)}else t(X)}else{var M=new Blob(K,{type:"application/octet-stream"}),n=Object.keys($);if(n.length>0&&(X.extensionsUsed=n),X.buffers&&X.buffers.length>0&&(X.buffers[0].byteLength=M.size),!0===r.binary){var i=12,a=1179937895,o=2,s=8,u=1313821514,c=5130562,x=new window.FileReader;x.readAsArrayBuffer(M),x.onloadend=function(){var e=v(x.result),r=new DataView(new ArrayBuffer(s));r.setUint32(0,e.byteLength,!0),r.setUint32(4,c,!0);var n=v(l(JSON.stringify(X)),32),f=new DataView(new ArrayBuffer(s));f.setUint32(0,n.byteLength,!0),f.setUint32(4,u,!0);var d=new ArrayBuffer(i),h=new DataView(d);h.setUint32(0,a,!0),h.setUint32(4,o,!0);var p=i+f.byteLength+n.byteLength+r.byteLength+e.byteLength;h.setUint32(8,p,!0);var m=new Blob([d,f,n,r,e],{type:"application/octet-stream"}),g=new window.FileReader;g.readAsArrayBuffer(m),g.onloadend=function(){t(g.result)}}}else if(X.buffers&&X.buffers.length>0){var x=new window.FileReader;x.readAsDataURL(M),x.onloadend=function(){var e=x.result;X.buffers[0].uri=e,t(X)}}else t(X)}})}},A.Utils={insertKeyframe:function(e,t){var r,n=e.getValueSize(),i=new e.TimeBufferType(e.times.length+1),a=new e.ValueBufferType(e.values.length+n),o=e.createInterpolant(new e.ValueBufferType(n));if(0===e.times.length){i[0]=t;for(var s=0;s<n;s++)a[s]=0;r=0}else if(t<e.times[0]){if(Math.abs(e.times[0]-t)<.001)return 0;i[0]=t,i.set(e.times,1),a.set(o.evaluate(t),0),a.set(e.values,n),r=0}else if(t>e.times[e.times.length-1]){if(Math.abs(e.times[e.times.length-1]-t)<.001)return e.times.length-1;i[i.length-1]=t,i.set(e.times,0),a.set(e.values,0),a.set(o.evaluate(t),e.values.length),r=i.length-1}else for(var s=0;s<e.times.length;s++){if(Math.abs(e.times[s]-t)<.001)return s;if(e.times[s]<t&&e.times[s+1]>t){i.set(e.times.slice(0,s+1),0),i[s+1]=t,i.set(e.times.slice(s+1),s+2),a.set(e.values.slice(0,(s+1)*n),0),a.set(o.evaluate(t),(s+1)*n),a.set(e.values.slice((s+1)*n),(s+2)*n),r=s+1;break}}return e.times=i,e.values=a,r},mergeMorphTargetTracks:function(e,t){for(var r=[],n={},i=e.tracks,a=0;a<i.length;++a){var o=i[a],s=y.parseTrackName(o.name),u=y.findNode(t,s.nodeName);if("morphTargetInfluences"===s.propertyName&&void 0!==s.propertyIndex){if(o.createInterpolant!==o.InterpolantFactoryMethodDiscrete&&o.createInterpolant!==o.InterpolantFactoryMethodLinear){if(o.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline)throw new Error("THREE.GLTFExporter: Cannot merge tracks with glTF CUBICSPLINE interpolation.");console.warn("THREE.GLTFExporter: Morph target interpolation mode not yet supported. Using LINEAR instead."),o=o.clone(),o.setInterpolation(l)}var c=u.morphTargetInfluences.length,f=u.morphTargetDictionary[s.propertyIndex];if(void 0===f)throw new Error("THREE.GLTFExporter: Morph target name not found: "+s.propertyIndex);var d;if(void 0!==n[u.uuid]){var h=o.createInterpolant(new o.ValueBufferType(1));d=n[u.uuid];for(var p=0;p<d.times.length;p++)d.values[p*c+f]=h.evaluate(d.times[p]);for(var p=0;p<o.times.length;p++){var m=this.insertKeyframe(d,o.times[p]);d.values[m*c+f]=o.values[p]}}else{d=o.clone();for(var v=new d.ValueBufferType(c*d.times.length),p=0;p<d.times.length;p++)v[p*c+f]=d.values[p];d.name=".morphTargetInfluences",d.values=v,n[u.uuid]=d,r.push(d)}}else r.push(o)}return e.tracks=r,e}}},{h_399:218}],91:[function(e,t,r){"use strict";function n(e){var t=i();return function(){var r,n=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,f.default)(this,r)}}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function a(e){if(!s){var t=THREE,r=(t.FileLoader,t.Loader),i=t.Texture,a={load:function(e,t,r,n){var a=this,o=new i;if("string"==typeof e){var s=new THREE.FileLoader(this.manager);s.setResponseType("arraybuffer"),s.setPath(this.path),s.load(e,function(e){o.image=a.parse(e),o.needsUpdate=!0,void 0!==t&&t(o)},r,n)}else o.image=a.parse(e),o.needsUpdate=!0,void 0!==t&&t(o);return o},parse:function(e){var t=new h.BmpDecoder(e),r=document.createElement("canvas");return r.width=t.width,r.height=t.height,r.getContext("2d").getImageData(0,0,r.width,r.height).data.set(t.data),r}};s=(0,p.default)(r,{prototype:a,esConstructor:function(){return function(e){function t(e){var n;return(0,u.default)(this,t),n=r.call(this,e),constructor.call((0,l.default)(n),e),n}(0,c.default)(t,e);var r=n(t);return t}(r)},constructor:function(e){}}),s.prototype.constructor.name="BMPLoader"}return new s(e)}var o=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.BMPLoader=a;var s,u=o(e("e_1")),l=o(e("s_332")),c=o(e("C_129")),f=o(e("o_130")),d=o(e("m_131")),h=e("m_406"),p=o(e("M_407"))},{M_407:198,m_406:88,s_332:233,e_1:235,m_131:239,C_129:240,M_0:241,o_130:242}],92:[function(e,t,r){"use strict";function n(e){var t=i();return function(){var r,n=(0,y.default)(e);if(t){var i=(0,y.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,g.default)(this,r)}}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function a(){if(!b){b=!0;var e=THREE;s=e.CompressedTextureLoader,u=1023,l=33778,c=33779,f=36196,d=33776}}var o=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.DDSLoader=void 0;var s,u,l,c,f,d,h,p=o(e("e_1")),m=o(e("s_332")),v=o(e("C_129")),g=o(e("o_130")),y=o(e("m_131")),_=o(e("M_407")),b=!1,M=function(e){if(a(),!h){var t={parse:function(e,t){function r(e){return e.charCodeAt(0)+(e.charCodeAt(1)<<8)+(e.charCodeAt(2)<<16)+(e.charCodeAt(3)<<24)}var n={mipmaps:[],width:0,height:0,format:null,mipmapCount:1},i=r("DXT1"),a=r("DXT3"),o=r("DXT5"),s=r("ETC1"),h=new Int32Array(e,0,31);if(542327876!==h[0])return console.error("THREE.DDSLoader.parse: Invalid magic number in DDS header."),n;if(4&!h[20])return console.error("THREE.DDSLoader.parse: Unsupported format, must contain a FourCC code."),n;var p,m=h[21],v=!1;switch(m){case i:p=8,n.format=d;break;case a:p=16,n.format=l;break;case o:p=16,n.format=c;break;case s:p=8,n.format=f;break;default:if(!(32===h[22]&&16711680&h[23]&&65280&h[24]&&255&h[25]&&4278190080&h[26]))return console.error("THREE.DDSLoader.parse: Unsupported FourCC code ",function(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)}(m)),n;v=!0,p=64,n.format=u}n.mipmapCount=1,131072&h[2]&&!1!==t&&(n.mipmapCount=Math.max(1,h[7]));var g=h[28];if(n.isCubemap=!!(512&g),n.isCubemap&&(!(1024&g)||!(2048&g)||!(4096&g)||!(8192&g)||!(16384&g)||!(32768&g)))return console.error("THREE.DDSLoader.parse: Incomplete cubemap faces"),n;n.width=h[4],n.height=h[3];for(var y=h[1]+4,_=n.isCubemap?6:1,b=0;b<_;b++)for(var M=n.width,x=n.height,w=0;w<n.mipmapCount;w++){if(v)var S=function(e,t,r,n){for(var i=r*n*4,a=new Uint8Array(e,t,i),o=new Uint8Array(i),s=0,u=0,l=0;l<n;l++)for(var c=0;c<r;c++){var f=a[u];u++;var d=a[u];u++;var h=a[u];u++;var p=a[u];u++,o[s]=h,s++,o[s]=d,s++,o[s]=f,s++,o[s]=p,s++}return o}(e,y,M,x),T=S.length;else var T=Math.max(4,M)/4*Math.max(4,x)/4*p,S=new Uint8Array(e,y,T);var C={data:S,width:M,height:x};n.mipmaps.push(C),y+=T,M=Math.max(M>>1,1),x=Math.max(x>>1,1)}return n}};h=(0,_.default)(s,{esConstructor:function(e){return function(t){function r(t){var n;return(0,p.default)(this,r),n=i.call(this,t),e.call((0,m.default)(n),t),n}(0,v.default)(r,t);var i=n(r);return r}(s)},constructor:function(e){},prototype:t})}return new h(e)};r.DDSLoader=M},{M_407:198,s_332:233,e_1:235,m_131:239,C_129:240,M_0:241,o_130:242}],93:[function(e,t,r){"use strict";function n(e){var t=i();return function(){var r,n=(0,v.default)(e);if(t){var i=(0,v.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,m.default)(this,r)}}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function a(){if(!_){_=!0;var e=THREE;s=e.BufferAttribute,u=e.BufferGeometry,l=e.FileLoader,c=e.Loader}}var o=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.DRACOLoader=void 0;var s,u,l,c,f,d=o(e("e_1")),h=o(e("s_332")),p=o(e("C_129")),m=o(e("o_130")),v=o(e("m_131")),g=o(e("M_110")),y=o(e("M_407")),_=!1,b=function(e){if(a(),!f){var t={setDecoderPath:function(e){return this.decoderPath=e,this},setDecoderConfig:function(e){return this.decoderConfig=e,this},setWorkerLimit:function(e){return this.workerLimit=e,this},setVerbosity:function(){console.warn("THREE.DRACOLoader: The .setVerbosity() method has been removed.")},setDrawMode:function(){console.warn("THREE.DRACOLoader: The .setDrawMode() method has been removed.")},setSkipDequantization:function(){console.warn("THREE.DRACOLoader: The .setSkipDequantization() method has been removed.")},load:function(e,t,r,n){var i=this,a=new l(this.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),"use-credentials"===this.crossOrigin&&a.setWithCredentials(!0),a.load(e,function(e){var r={attributeIDs:i.defaultAttributeIDs,attributeTypes:i.defaultAttributeTypes,useUniqueIDs:!1};i.decodeGeometry(e,r).then(t).catch(n)},r,n)},decodeDracoFile:function(e,t,r,n){var i={attributeIDs:r||this.defaultAttributeIDs,attributeTypes:n||this.defaultAttributeTypes,useUniqueIDs:!!r};this.decodeGeometry(e,i).then(t)},decodeGeometry:function(e,t){var r=this;for(var n in t.attributeTypes){var i=t.attributeTypes[n];void 0!==i.BYTES_PER_ELEMENT&&(t.attributeTypes[n]=i.name)}var a=JSON.stringify(t);if(f.taskCache.has(e)){var o=f.taskCache.get(e);if(o.key===a)return o.promise;if(0===e.byteLength)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}var s,u=this.workerNextTaskID++,l=e.byteLength,c=this._getWorker(u,l).then(function(r){return s=r,new Promise(function(r,n){s._callbacks[u]={resolve:r,reject:n},s.postMessage({type:"decode",id:u,taskConfig:t,buffer:e},[e])})}).then(function(e){return r._createGeometry(e.geometry)});return c.finally(function(){s&&u&&r._releaseTask(s,u)}),f.taskCache.set(e,{key:a,promise:c}),c},_createGeometry:function(e){var t=new u;e.index&&t.setIndex(new s(e.index.array,1));for(var r=0;r<e.attributes.length;r++){var n=e.attributes[r],i=n.name,a=n.array,o=n.itemSize;t.setAttribute(i,new s(a,o))}return t},_loadLibrary:function(e,t){var r=new l(this.manager);return r.setPath(this.decoderPath),r.setResponseType(t),new Promise(function(t,n){r.load(e,t,void 0,n)})},preload:function(){return this._initDecoder(),this},_initDecoder:function(){var e=this;if(this.decoderPending)return this.decoderPending;var t="object"!==("undefined"==typeof WebAssembly?"undefined":(0,g.default)(WebAssembly))||"js"===this.decoderConfig.type,r=[];return t?r.push(this._loadLibrary("draco_decoder.js","text")):(r.push(this._loadLibrary("draco_wasm_wrapper.js","text")),r.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(r).then(function(r){var n=r[0];t||(e.decoderConfig.wasmBinary=r[1]);var i=f.DRACOWorker.toString(),a=["/* draco decoder */",n,"","/* worker */",i.substring(i.indexOf("{")+1,i.lastIndexOf("}"))].join("\n");e.workerSourceURL=URL.createObjectURL(new Blob([a]))}),this.decoderPending},_getWorker:function(e,t){var r=this;return this._initDecoder().then(function(){if(r.workerPool.length<r.workerLimit){var n=new Worker(r.workerSourceURL);n._callbacks={},n._taskCosts={},n._taskLoad=0,n.postMessage({type:"init",decoderConfig:r.decoderConfig}),n.onmessage=function(e){var t=e.data;switch(t.type){case"decode":n._callbacks[t.id].resolve(t);break;case"error":n._callbacks[t.id].reject(t);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+t.type+'"')}},r.workerPool.push(n)}else r.workerPool.sort(function(e,t){return e._taskLoad>t._taskLoad?-1:1});var n=r.workerPool[r.workerPool.length-1];return n._taskCosts[e]=t,n._taskLoad+=t,n})},_releaseTask:function(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]},debug:function(){console.log("Task load: ",this.workerPool.map(function(e){return e._taskLoad}))},dispose:function(){for(var e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}};f=(0,y.default)(c,{esConstructor:function(e){return function(t){function r(t){var n;return(0,d.default)(this,r),n=i.call(this,t),e.call((0,h.default)(n),t),n}(0,p.default)(r,t);var i=n(r);return r}(c)},constructor:function(){if(this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,navigator&&navigator.hardwareConcurrency){var e=navigator.hardwareConcurrency/2;this.workerLimit=Math.max(4,e),this.workerLimit=Math.min(e,8)}this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD",uv2:"GENERIC"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array",uv2:"Float32Array"}},prototype:t}),f.DRACOWorker=function(){function e(e,r,n,i){var a,o,s=i.attributeIDs,u=i.attributeTypes,l=r.GetEncodedGeometryType(n);if(l===e.TRIANGULAR_MESH)a=new e.Mesh,o=r.DecodeBufferToMesh(n,a);else{if(l!==e.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");a=new e.PointCloud,o=r.DecodeBufferToPointCloud(n,a)}if(!o.ok()||0===a.ptr)throw new Error("THREE.DRACOLoader: Decoding failed: "+o.error_msg());var c={index:null,attributes:[]};for(var f in s){var d,h,p=self[u[f]];if(i.useUniqueIDs)h=s[f],d=r.GetAttributeByUniqueId(a,h);else{if(-1===(h=r.GetAttributeId(a,e[s[f]])))continue;d=r.GetAttribute(a,h)}c.attributes.push(t(e,r,a,f,p,d))}if(l===e.TRIANGULAR_MESH){for(var m=a.num_faces(),v=3*m,g=new Uint32Array(v),y=new e.DracoInt32Array,_=0;_<m;++_){r.GetFaceFromMesh(a,_,y);for(var b=0;b<3;++b)g[3*_+b]=y.GetValue(b)}c.index={array:g,itemSize:1},e.destroy(y)}return e.destroy(a),c}function t(e,t,r,n,i,a){var o,s,u=a.num_components(),l=r.num_points(),c=l*u;switch(i){case Float32Array:o=new e.DracoFloat32Array,t.GetAttributeFloatForAllPoints(r,a,o),s=new Float32Array(c);break;case Int8Array:o=new e.DracoInt8Array,t.GetAttributeInt8ForAllPoints(r,a,o),s=new Int8Array(c);break;case Int16Array:o=new e.DracoInt16Array,t.GetAttributeInt16ForAllPoints(r,a,o),s=new Int16Array(c);break;case Int32Array:o=new e.DracoInt32Array,t.GetAttributeInt32ForAllPoints(r,a,o),s=new Int32Array(c);break;case Uint8Array:o=new e.DracoUInt8Array,t.GetAttributeUInt8ForAllPoints(r,a,o),s=new Uint8Array(c);break;case Uint16Array:o=new e.DracoUInt16Array,t.GetAttributeUInt16ForAllPoints(r,a,o),s=new Uint16Array(c);break;case Uint32Array:o=new e.DracoUInt32Array,t.GetAttributeUInt32ForAllPoints(r,a,o),s=new Uint32Array(c);break;default:throw new Error("THREE.DRACOLoader: Unexpected attribute type.")}for(var f=0;f<c;f++)s[f]=o.GetValue(f);return e.destroy(o),{name:n,array:s,itemSize:u}}var r,n;onmessage=function(t){var i=t.data;switch(i.type){case"init":r=i.decoderConfig,n=new Promise(function(e){r.onModuleLoaded=function(t){e({draco:t})},DracoDecoderModule(r)});break;case"decode":var a=i.buffer,o=i.taskConfig;n.then(function(t){var r=t.draco,n=new r.Decoder,s=new r.DecoderBuffer;s.Init(new Int8Array(a),a.byteLength);try{var u=e(r,n,s,o),l=u.attributes.map(function(e){return e.array.buffer});u.index&&l.push(u.index.array.buffer),self.postMessage({type:"decode",id:i.id,geometry:u},l)}catch(e){console.error(e),self.postMessage({type:"error",id:i.id,error:e.message})}finally{r.destroy(s),r.destroy(n)}})}}},f.taskCache=new WeakMap,f.setDecoderPath=function(){
console.warn("THREE.DRACOLoader: The .setDecoderPath() method has been removed. Use instance methods.")},f.setDecoderConfig=function(){console.warn("THREE.DRACOLoader: The .setDecoderConfig() method has been removed. Use instance methods.")},f.releaseDecoderModule=function(){console.warn("THREE.DRACOLoader: The .releaseDecoderModule() method has been removed. Use instance methods.")},f.getDecoderModule=function(){console.warn("THREE.DRACOLoader: The .getDecoderModule() method has been removed. Use instance methods.")}}return new f(e)};r.DRACOLoader=b},{M_407:198,s_332:233,e_1:235,m_131:239,C_129:240,M_0:241,o_130:242,M_110:245}],94:[function(e,t,r){"use strict";function n(e){var t=i();return function(){var r,n=(0,we.default)(e);if(t){var i=(0,we.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,xe.default)(this,r)}}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function a(){if(!Te){Te=!0;var e=THREE;s=e.AnimationClip,u=e.Bone,l=e.Box3,c=e.BufferAttribute,f=e.BufferGeometry,d=1001,h=e.Color,p=e.DirectionalLight,m=2,v=e.FileLoader,g=0,y=e.Group,_=e.InterleavedBuffer,b=e.InterleavedBufferAttribute,M=e.Interpolant,x=2300,w=2301,S=e.Line,T=e.LineBasicMaterial,C=e.LineLoop,E=e.LineSegments,A=1006,L=1008,P=1007,O=e.Loader,R=e.LoaderUtils,I=e.Material,D=e.Math,B=e.Matrix4,U=e.Matrix3,N=e.Mesh,k=e.MeshBasicMaterial,j=e.MeshPhysicalMaterial,G=e.MeshStandardMaterial,V=1002,F=1003,z=1005,H=1004,W=e.NumberKeyframeTrack,Y=e.Object3D,X=e.OrthographicCamera,q=e.PerspectiveCamera,K=e.PointLight,Z=e.Points,J=e.PointsMaterial,Q=e.PropertyBinding,$=e.QuaternionKeyframeTrack,ee=1023,te=1022,re=1e3,ne=e.Skeleton,ie=e.SkinnedMesh,ae=e.Sphere,oe=e.SpotLight,se=0,ue=e.TextureLoader,le=2,ce=1,fe=e.Vector2,de=e.Vector3,he=e.VectorKeyframeTrack,pe=3001,me=e.Texture,ve=e.ShaderMaterial}}var o=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.GLTFLoader=void 0;var s,u,l,c,f,d,h,p,m,v,g,y,_,b,M,x,w,S,T,C,E,A,L,P,O,R,I,D,B,U,N,k,j,G,V,F,z,H,W,Y,X,q,K,Z,J,Q,$,ee,te,re,ne,ie,ae,oe,se,ue,le,ce,fe,de,he,pe,me,ve,ge,ye=o(e("M_110")),_e=o(e("e_1")),be=o(e("s_332")),Me=o(e("C_129")),xe=o(e("o_130")),we=o(e("m_131")),Se=o(e("M_407")),Te=!1,Ce=function(e){if(a(),!ge){var t=function(){var e={};return{get:function(t){return e[t]},add:function(t,r){e[t]=r},remove:function(t){delete e[t]},removeAll:function(){e={}}}},r=function(e){if(!e)throw new Error("THREE._GLTFLoader: Attempting to load .dds texture without importing DDSLoader");this.name=Ye.MSFT_TEXTURE_DDS,this.ddsLoader=e},i=function(e){this.name=Ye.KHR_LIGHTS_PUNCTUAL;var t=e.extensions&&e.extensions[Ye.KHR_LIGHTS_PUNCTUAL]||{};this.lightDefs=t.lights||[]},o=function(){this.name=Ye.KHR_MATERIALS_UNLIT},xe=function(){this.name=Ye.KHR_MATERIALS_CLEARCOAT},we=function(e){this.name=Ye.KHR_BINARY_GLTF,this.content=null,this.body=null;var t=new DataView(e,0,qe);if(this.header={magic:R.decodeText(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==Xe)throw new Error("THREE._GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE._GLTFLoader: Legacy binary file detected.");for(var r=new DataView(e,qe),n=0;n<r.byteLength;){var i=r.getUint32(n,!0);if((n+=4)>=r.byteLength)break;var a=r.getUint32(n,!0);if((n+=4)>=r.byteLength)break;if(a===Ke.JSON){var o=new Uint8Array(e,qe+n,i);this.content=R.decodeText(o)}else if(a===Ke.BIN){var s=qe+n;this.body=e.slice(s,s+i)}n+=i}if(null===this.content)throw new Error("THREE._GLTFLoader: JSON content not found.")},Te=function(e,t){if(!t)throw new Error("THREE._GLTFLoader: No DRACOLoader instance provided.");this.name=Ye.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()},Ce=function(){this.name=Ye.KHR_TEXTURE_TRANSFORM},Ee=function(e){G.call(this),this.isGLTFSpecularGlossinessMaterial=!0;var t=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),r=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),n=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),i=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),a=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb;","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.specularRoughness = max( 1.0 - glossinessFactor, 0.0525 );// 0.0525 corresponds to the base mip of a 256 cubemap.","material.specularRoughness += geometryRoughness;","material.specularRoughness = min( material.specularRoughness, 1.0 );","material.specularColor = specularFactor.rgb;"].join("\n"),o={specular:{value:(new h).setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=o,this.onBeforeCompile=function(e){for(var s in o)e.uniforms[s]=o[s];e.fragmentShader=e.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;"),e.fragmentShader=e.fragmentShader.replace("uniform float metalness;","uniform float glossiness;"),e.fragmentShader=e.fragmentShader.replace("#include <roughnessmap_pars_fragment>",t),e.fragmentShader=e.fragmentShader.replace("#include <metalnessmap_pars_fragment>",r),e.fragmentShader=e.fragmentShader.replace("#include <roughnessmap_fragment>",n),e.fragmentShader=e.fragmentShader.replace("#include <metalnessmap_fragment>",i),e.fragmentShader=e.fragmentShader.replace("#include <lights_physical_fragment>",a)},Object.defineProperties(this,{specular:{get:function(){return o.specular.value},set:function(e){o.specular.value=e}},specularMap:{get:function(){return o.specularMap.value},set:function(e){o.specularMap.value=e}},glossiness:{get:function(){return o.glossiness.value},set:function(e){o.glossiness.value=e}},glossinessMap:{get:function(){return o.glossinessMap.value},set:function(e){o.glossinessMap.value=e,e?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_ROUGHNESSMAP=""):(delete this.defines.USE_ROUGHNESSMAP,delete this.defines.USE_GLOSSINESSMAP)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(e)},Ae=function(){return{name:Ye.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return Ee},extendParams:function(e,t,r){var n=t.extensions[this.name];e.color=new h(1,1,1),e.opacity=1;var i=[];if(Array.isArray(n.diffuseFactor)){var a=n.diffuseFactor;e.color.fromArray(a),e.opacity=a[3]}if(void 0!==n.diffuseTexture&&i.push(r.assignTexture(e,"map",n.diffuseTexture)),e.emissive=new h(0,0,0),e.glossiness=void 0!==n.glossinessFactor?n.glossinessFactor:1,e.specular=new h(1,1,1),Array.isArray(n.specularFactor)&&e.specular.fromArray(n.specularFactor),void 0!==n.specularGlossinessTexture){var o=n.specularGlossinessTexture;i.push(r.assignTexture(e,"glossinessMap",o)),i.push(r.assignTexture(e,"specularMap",o))}return Promise.all(i)},createMaterial:function(e){var t=new Ee(e);return t.fog=!0,t.color=e.color,t.map=void 0===e.map?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=void 0===e.aoMap?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=1,t.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,t.bumpMap=void 0===e.bumpMap?null:e.bumpMap,t.bumpScale=1,t.normalMap=void 0===e.normalMap?null:e.normalMap,t.normalMapType=se,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=void 0===e.specularMap?null:e.specularMap,t.specular=e.specular,t.glossinessMap=void 0===e.glossinessMap?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=void 0===e.envMap?null:e.envMap,t.envMapIntensity=1,t.refractionRatio=.98,t}}},Le=function(){this.name=Ye.KHR_MESH_QUANTIZATION},Pe=function(e){this.name=Ye.KHR_TECHNIQUES_WEBGL,this.getMaterialType=function(){return ve},this.getUniformTexture=function(e,t,r){return r.loadTexture(t).then(function(t){e.value=t})},this.extendParams=function(t,r,n){var i=e.extensions[this.name],a=r.extensions[this.name],o=i.techniques[a.technique];t.name=o.name;var s=i.programs[o.program],u=o.uniforms,l={},c=[];for(var f in a.values)if(a.values.hasOwnProperty(f)&&u[f]){var d=a.values[f],p=u[f].type;l[f]={value:null};var m=l[f];switch(p){case Ze.FLOAT:m.value={value:d};break;case Ze.FLOAT_VEC2:m.value=(new fe).fromArray(d);break;case Ze.FLOAT_VEC3:m.value=(new de).fromArray(d);break;case Ze.FLOAT_VEC4:m.value=(new h).fromArray(d);break;case Ze.FLOAT_MAT3:m.value=(new U).fromArray(d);break;case Ze.FLOAT_MAT4:m.value=(new B).fromArray(d);break;case Ze.SAMPLER_2D:var v=d.index;c.push(this.getUniformTexture(m,v,n))}}t.uniforms=l;i.shaders[s.fragmentShader],i.shaders[s.vertexShader];return Promise.all(c)},this.createMaterial=function(e){return new ve(e)}},Oe=function(e){this.name=Ye.CESIUM_RTC;var t=(new de).fromArray(e.extensions[this.name].center);this.rtcCenterTransform=(new B).setPosition(t)},Re=function(e,t,r,n){M.call(this,e,t,r,n)},Ie=function(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)?e:/^data:.*,.*$/i.test(e)?e:/^blob:.*$/i.test(e)?e:t+e)},De=function(e){return void 0===e.DefaultMaterial&&(e.DefaultMaterial=new G({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:g})),e.DefaultMaterial},Be=function(e,t,r){for(var n in r.extensions)void 0===e[n]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[n]=r.extensions[n])},Ue=function(e,t){void 0!==t.extras&&("object"===(0,ye.default)(t.extras)?Object.assign(e.userData,t.extras):console.warn("THREE._GLTFLoader: Ignoring primitive type .extras, "+t.extras))},Ne=function(e,t,r){for(var n=!1,i=!1,a=0,o=t.length;a<o;a++){var s=t[a];if(void 0!==s.POSITION&&(n=!0),void 0!==s.NORMAL&&(i=!0),n&&i)break}if(!n&&!i)return Promise.resolve(e);for(var u=[],l=[],a=0,o=t.length;a<o;a++){var s=t[a];if(n){var c=void 0!==s.POSITION?r.getDependency("accessor",s.POSITION):e.attributes.position;u.push(c)}if(i){var c=void 0!==s.NORMAL?r.getDependency("accessor",s.NORMAL):e.attributes.normal;l.push(c)}}return Promise.all([Promise.all(u),Promise.all(l)]).then(function(t){var r=t[0],a=t[1];return n&&(e.morphAttributes.position=r),i&&(e.morphAttributes.normal=a),e.morphTargetsRelative=!0,e})},ke=function(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(var r=0,n=t.weights.length;r<n;r++)e.morphTargetInfluences[r]=t.weights[r];if(t.extras&&Array.isArray(t.extras.targetNames)){var i=t.extras.targetNames;if(e.morphTargetInfluences.length===i.length){e.morphTargetDictionary={};for(var r=0,n=i.length;r<n;r++)e.morphTargetDictionary[i[r]]=r}else console.warn("THREE._GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}},je=function(e){var t=e.extensions&&e.extensions[Ye.KHR_DRACO_MESH_COMPRESSION];return t?"draco:"+t.bufferView+":"+t.indices+":"+Ge(t.attributes):e.indices+":"+Ge(e.attributes)+":"+e.mode},Ge=function(e){for(var t="",r=Object.keys(e).sort(),n=0,i=r.length;n<i;n++)t+=r[n]+":"+e[r[n]]+";";return t},Ve=function(e,r,n){this.json=e||{},this.extensions=r||{},this.options=n||{},this.cache=new t,this.primitiveCache={},this.textureLoader=new ue(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.fileLoader=new v(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)},Fe=function(e,t,r){var n=t.attributes,i=new l;if(void 0!==n.POSITION){var a=r.json.accessors[n.POSITION],o=a.min,s=a.max;if(void 0===o||void 0===s)return void console.warn("THREE._GLTFLoader: Missing min/max properties for accessor POSITION.");i.set(new de(o[0],o[1],o[2]),new de(s[0],s[1],s[2]));var u=t.targets;if(void 0!==u){for(var c=new de,f=new de,d=0,h=u.length;d<h;d++){var p=u[d];if(void 0!==p.POSITION){var a=r.json.accessors[p.POSITION],o=a.min,s=a.max;void 0!==o&&void 0!==s?(f.setX(Math.max(Math.abs(o[0]),Math.abs(s[0]))),f.setY(Math.max(Math.abs(o[1]),Math.abs(s[1]))),f.setZ(Math.max(Math.abs(o[2]),Math.abs(s[2]))),c.max(f)):console.warn("THREE._GLTFLoader: Missing min/max properties for accessor POSITION.")}}i.expandByVector(c)}e.boundingBox=i;var m=new ae;i.getCenter(m.center),m.radius=i.min.distanceTo(i.max)/2,e.boundingSphere=m}},ze=function(e,t,r){var n=t.attributes,i=[];for(var a in n){var o=tt[a]||a.toLowerCase();o in e.attributes||i.push(function(t,n){return r.getDependency("accessor",t).then(function(t){e.setAttribute(n,t)})}(n[a],o))}if(void 0!==t.indices&&!e.index){var s=r.getDependency("accessor",t.indices).then(function(t){e.setIndex(t)});i.push(s)}return Ue(e,t),Fe(e,t,r),Promise.all(i).then(function(){return void 0!==t.targets?Ne(e,t.targets,r):e})},He=function(e,t){var r=e.getIndex();if(null===r){var n=[],i=e.getAttribute("position");if(void 0===i)return console.error("THREE._GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(var a=0;a<i.count;a++)n.push(a);e.setIndex(n),r=e.getIndex()}var o=r.count-2,s=[];if(t===le)for(var a=1;a<=o;a++)s.push(r.getX(0)),s.push(r.getX(a)),s.push(r.getX(a+1));else for(var a=0;a<o;a++)a%2==0?(s.push(r.getX(a)),s.push(r.getX(a+1)),s.push(r.getX(a+2))):(s.push(r.getX(a+2)),s.push(r.getX(a+1)),s.push(r.getX(a)));s.length/3!==o&&console.error("THREE._GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");var u=e.clone();return u.setIndex(s),u},We={load:function(e,t,r,n,i,a){var o,s=this;o=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:R.extractUrlBase(e),s.manager.itemStart(e);var u=function(t){n?n(t):console.error(t),s.manager.itemError(e),s.manager.itemEnd(e)},l=new v(s.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),"use-credentials"===s.crossOrigin&&l.setWithCredentials(!0),l.load(e,function(r){try{if(i){var n=i(r);n&&(r=n)}s.parse(r,o,function(r){t(r),s.manager.itemEnd(e)},u,a)}catch(e){u(e)}},r,u)},setDRACOLoader:function(e){return this.dracoLoader=e,this},setDDSLoader:function(e){return this.ddsLoader=e,this},parse:function(e,t,n,a,s){var u,l,c=Cesium,f={};if("string"==typeof e)u=e,l=JSON.parse(u);else if(e instanceof ArrayBuffer||e instanceof Uint8Array){e instanceof Uint8Array&&(e=e.slice().buffer);var d=R.decodeText(new Uint8Array(e,0,4));if(d===Xe)try{f[Ye.KHR_BINARY_GLTF]=new we(e),u=f[Ye.KHR_BINARY_GLTF].content,l=JSON.parse(u)}catch(t){try{l=c.parseGlb(new Uint8Array(e))}catch(e){return void(a&&a(e))}}else u=R.decodeText(new Uint8Array(e)),l=JSON.parse(u)}else l=e;try{if(void 0===l.asset||l.asset.version[0]<2||l.asset.version<2){l=c.updateVersion(l);var h=l.buffers;if(1==h.length&&h[0].extras&&h[0].extras._pipeline&&h[0].extras._pipeline.source){var p=new Uint32Array(e.buffer||e,0,5),m=p[3],v=20+m;l.binaryStart=v}}}catch(e){return void(a&&a(e))}if(l.extensionsUsed)for(var g=0;g<l.extensionsUsed.length;++g){var y=l.extensionsUsed[g],_=l.extensionsRequired||[];switch(y){case Ye.KHR_LIGHTS_PUNCTUAL:f[y]=new i(l);break;case Ye.KHR_MATERIALS_CLEARCOAT:f[y]=new xe;break;case Ye.KHR_MATERIALS_UNLIT:f[y]=new o;break;case Ye.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:f[y]=new Ae;break;case Ye.KHR_DRACO_MESH_COMPRESSION:f[y]=new Te(l,this.dracoLoader);break;case Ye.MSFT_TEXTURE_DDS:f[y]=new r(this.ddsLoader);break;case Ye.KHR_TEXTURE_TRANSFORM:f[y]=new Ce;break;case Ye.KHR_MESH_QUANTIZATION:f[y]=new Le;break;case Ye.KHR_TECHNIQUES_WEBGL:f[y]=new Pe(l);break;case Ye.CESIUM_RTC:f[y]=new Oe(l);break;default:_.indexOf(y)>=0&&console.warn('THREE._GLTFLoader: Unknown extension "'+y+'".')}}new Ve(l,f,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,manager:this.manager,loadTexture:s?s.loadTexture:void 0}).parse(n,a)}};ge=(0,Se.default)(O,{esConstructor:function(e){return function(t){function r(t){var n;return(0,_e.default)(this,r),n=i.call(this,t),e.call((0,be.default)(n),t),n}(0,Me.default)(r,t);var i=n(r);return r}(O)},constructor:function(){this.dracoLoader=null,this.ddsLoader=null},prototype:We});var Ye={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",MSFT_TEXTURE_DDS:"MSFT_texture_dds",KHR_TECHNIQUES_WEBGL:"KHR_techniques_webgl",CESIUM_RTC:"CESIUM_RTC"};i.prototype.loadLight=function(e){var t,r=this.lightDefs[e],n=new h(16777215);void 0!==r.color&&n.fromArray(r.color);var i=void 0!==r.range?r.range:0;switch(r.type){case"directional":t=new p(n),t.target.position.set(0,0,-1),t.add(t.target);break;case"point":t=new K(n),t.distance=i;break;case"spot":t=new oe(n),t.distance=i,r.spot=r.spot||{},r.spot.innerConeAngle=void 0!==r.spot.innerConeAngle?r.spot.innerConeAngle:0,r.spot.outerConeAngle=void 0!==r.spot.outerConeAngle?r.spot.outerConeAngle:Math.PI/4,t.angle=r.spot.outerConeAngle,t.penumbra=1-r.spot.innerConeAngle/r.spot.outerConeAngle,t.target.position.set(0,0,-1),t.add(t.target);break;default:throw new Error('THREE._GLTFLoader: Unexpected light type, "'+r.type+'".')}return t.position.set(0,0,0),t.decay=2,void 0!==r.intensity&&(t.intensity=r.intensity),t.name=r.name||"light_"+e,Promise.resolve(t)},o.prototype.getMaterialType=function(){return k},o.prototype.extendParams=function(e,t,r){var n=[];e.color=new h(1,1,1),e.opacity=1;var i=t.pbrMetallicRoughness;if(i){if(Array.isArray(i.baseColorFactor)){var a=i.baseColorFactor;e.color.fromArray(a),e.opacity=a[3]}void 0!==i.baseColorTexture&&n.push(r.assignTexture(e,"map",i.baseColorTexture))}return Promise.all(n)},xe.prototype.getMaterialType=function(){return j},xe.prototype.extendParams=function(e,t,r){var n=[],i=t.extensions[this.name];if(void 0!==i.clearcoatFactor&&(e.clearcoat=i.clearcoatFactor),void 0!==i.clearcoatTexture&&n.push(r.assignTexture(e,"clearcoatMap",i.clearcoatTexture)),void 0!==i.clearcoatRoughnessFactor&&(e.clearcoatRoughness=i.clearcoatRoughnessFactor),void 0!==i.clearcoatRoughnessTexture&&n.push(r.assignTexture(e,"clearcoatRoughnessMap",i.clearcoatRoughnessTexture)),void 0!==i.clearcoatNormalTexture&&(n.push(r.assignTexture(e,"clearcoatNormalMap",i.clearcoatNormalTexture)),void 0!==i.clearcoatNormalTexture.scale)){var a=i.clearcoatNormalTexture.scale;e.clearcoatNormalScale=new fe(a,a)}return Promise.all(n)};var Xe="glTF",qe=12,Ke={JSON:1313821514,BIN:5130562};Te.prototype.decodePrimitive=function(e,t){var r=this.json,n=this.dracoLoader,i=e.extensions[this.name].bufferView,a=e.extensions[this.name].attributes,o={},s={},u={};for(var l in a){var c=tt[l]||l.toLowerCase();o[c]=a[l]}for(l in e.attributes){var c=tt[l]||l.toLowerCase();if(void 0!==a[l]){var f=r.accessors[e.attributes[l]],d=Je[f.componentType];u[c]=d,s[c]=!0===f.normalized}}return t.getDependency("bufferView",i).then(function(e){return new Promise(function(t){n.decodeDracoFile(e,function(e){for(var r in e.attributes){var n=e.attributes[r],i=s[r];void 0!==i&&(n.normalized=i)}t(e)},o,u)})})},Ce.prototype.extendTexture=function(e,t){return e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),void 0!==t.texCoord&&console.warn('THREE._GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),e.needsUpdate=!0,e},Ee.prototype=Object.create(G.prototype),Ee.prototype.constructor=Ee,Ee.prototype.copy=function(e){return G.prototype.copy.call(this,e),this.specularMap=e.specularMap,this.specular.copy(e.specular),this.glossinessMap=e.glossinessMap,this.glossiness=e.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this},Re.prototype=Object.create(M.prototype),Re.prototype.constructor=Re,Re.prototype.copySampleValue_=function(e){for(var t=this.resultBuffer,r=this.sampleValues,n=this.valueSize,i=e*n*3+n,a=0;a!==n;a++)t[a]=r[i+a];return t},Re.prototype.beforeStart_=Re.prototype.copySampleValue_,Re.prototype.afterEnd_=Re.prototype.copySampleValue_,Re.prototype.interpolate_=function(e,t,r,n){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=2*o,u=3*o,l=n-t,c=(r-t)/l,f=c*c,d=f*c,h=e*u,p=h-u,m=-2*d+3*f,v=d-f,g=1-m,y=v-f+c,_=0;_!==o;_++){var b=a[p+_+o],M=a[p+_+s]*l,x=a[h+_+o],w=a[h+_]*l;i[_]=g*b+y*M+m*x+v*w}return i};var Ze={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},Je={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},Qe={9728:F,9729:A,9984:H,9985:P,9986:z,9987:L},$e={33071:d,33648:V,10497:re},et={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},tt={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},rt={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},nt={CUBICSPLINE:void 0,LINEAR:w,STEP:x},it={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"},at={"image/png":ee,"image/jpeg":te};Ve.prototype.parse=function(e,t){var r=this,n=this,i=this.json,a=this.extensions;this.cache.removeAll(),this.markDefs(),Promise.all([this.getDependencies("scene"),this.getDependencies("animation"),this.getDependencies("camera")]).then(function(t){var r={scene:t[0][i.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:i.asset,parser:n,userData:{}};Be(a,r,i),Ue(r,i),a[Ye.CESIUM_RTC]&&(r.CESIUM_RTC=i.extensions[Ye.CESIUM_RTC].center),e(r)}).catch(function(e){r.cache.removeAll(),t(e)})},Ve.prototype.markDefs=function(){for(var e=this.json.nodes||[],t=this.json.skins||[],r=this.json.meshes||[],n={},i={},a=0,o=t.length;a<o;a++)for(var s=t[a].joints,u=0,l=s.length;u<l;u++)e[s[u]].isBone=!0;for(var c=0,f=e.length;c<f;c++){var d=e[c];void 0!==d.mesh&&(void 0===n[d.mesh]&&(n[d.mesh]=i[d.mesh]=0),n[d.mesh]++,void 0!==d.skin&&(r[d.mesh].isSkinnedMesh=!0))}this.json.meshReferences=n,this.json.meshUses=i},Ve.prototype.getDependency=function(e,t){var r=e+":"+t,n=this.cache.get(r);if(!n){switch(e){case"scene":n=this.loadScene(t);break;case"node":n=this.loadNode(t);break;case"mesh":n=this.loadMesh(t);break;case"accessor":n=this.loadAccessor(t);break;case"bufferView":n=this.loadBufferView(t);break;case"buffer":n=this.loadBuffer(t);break;case"material":n=this.loadMaterial(t);break;case"texture":n=this.loadTexture(t);break;case"skin":n=this.loadSkin(t);break;case"animation":n=this.loadAnimation(t);break;case"camera":n=this.loadCamera(t);break;case"light":n=this.extensions[Ye.KHR_LIGHTS_PUNCTUAL].loadLight(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(r,n)}return n},Ve.prototype.getDependencies=function(e){var t=this.cache.get(e);if(!t){var r=this,n=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(n.map(function(t,n){return r.getDependency(e,n)})),this.cache.add(e,t)}return t},Ve.prototype.loadBuffer=function(e){var t=this.json.buffers[e],r=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE._GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return t.extras&&t.extras._pipeline?Promise.resolve(t.extras._pipeline.source.buffer):Promise.resolve(this.extensions[Ye.KHR_BINARY_GLTF].body);var n=this.options;return new Promise(function(e,i){t.extras&&t.extras._pipeline?e(t.extras._pipeline.source.buffer):r.load(Ie(t.uri,n.path),e,void 0,function(){i(new Error('THREE._GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})},Ve.prototype.loadBufferView=function(e){var t=this.json.bufferViews[e],r=this.json.binaryStart||0;return this.getDependency("buffer",t.buffer).then(function(e){var n=t.byteLength||0,i=t.byteOffset||0;return e.slice(r+i,r+i+n)})},Ve.prototype.loadAccessor=function(e){var t=this,r=this.json,n=this.json.accessors[e];if(void 0===n.bufferView&&void 0===n.sparse)return Promise.resolve(null);var i=[];return void 0!==n.bufferView?i.push(this.getDependency("bufferView",n.bufferView)):i.push(null),void 0!==n.sparse&&(i.push(this.getDependency("bufferView",n.sparse.indices.bufferView)),i.push(this.getDependency("bufferView",n.sparse.values.bufferView))),Promise.all(i).then(function(e){var i,a,o=e[0],s=et[n.type],u=Je[n.componentType],l=u.BYTES_PER_ELEMENT,f=l*s,d=n.byteOffset||0,h=void 0!==n.bufferView?r.bufferViews[n.bufferView].byteStride:void 0,p=!0===n.normalized;if(h&&h!==f){var m=Math.floor(d/h),v="InterleavedBuffer:"+n.bufferView+":"+n.componentType+":"+m+":"+n.count,g=t.cache.get(v);g||(i=new u(o,m*h,n.count*h/l),g=new _(i,h/l),t.cache.add(v,g)),a=new b(g,s,d%h/l,p)}else i=null===o?new u(n.count*s):new u(o,d,n.count*s),a=new c(i,s,p);if(void 0!==n.sparse){var y=et.SCALAR,M=Je[n.sparse.indices.componentType],x=n.sparse.indices.byteOffset||0,w=n.sparse.values.byteOffset||0,S=new M(e[1],x,n.sparse.count*y),T=new u(e[2],w,n.sparse.count*s);null!==o&&(a=new c(a.array.slice(),a.itemSize,a.normalized));for(var C=0,E=S.length;C<E;C++){var A=S[C];if(a.setX(A,T[C*s]),s>=2&&a.setY(A,T[C*s+1]),s>=3&&a.setZ(A,T[C*s+2]),s>=4&&a.setW(A,T[C*s+3]),s>=5)throw new Error("THREE._GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return a})},Ve.prototype.loadTexture=function(e){var t,r=this,n=this.json,i=this.options,a=this.textureLoader,o=self.URL||self.webkitURL,s=n.textures[e],u=s.extensions||{};t=u[Ye.MSFT_TEXTURE_DDS]?n.images[u[Ye.MSFT_TEXTURE_DDS].source]:n.images[s.source];var l="texture-"+JSON.stringify(s),c=this.cache.get(l);if(s.name&&c)return c;var f=t.uri,d=!1;return void 0!==t.bufferView&&(f=r.getDependency("bufferView",t.bufferView).then(function(e){d=!0;var r=new Blob([e],{type:t.mimeType});return f=o.createObjectURL(r)})),c=Promise.resolve(f).then(function(e){var t=i.manager.getHandler(e);return t||(t=u[Ye.MSFT_TEXTURE_DDS]?r.extensions[Ye.MSFT_TEXTURE_DDS].ddsLoader:a),new Promise(function(r,n){if(0==i.loadTexture){var a=new me,o=Ie(e,i.path),s=o.search(/\.jpe?g($|\?)/i)>0||0===o.search(/^data\:image\/jpeg/);return a.format=s?te:ee,a.image=o,void r(a)}t.load(Ie(e,i.path),r,void 0,function(t){n("Failed to load image "+e)})})}).then(function(e){!0===d&&o.revokeObjectURL(f),e.flipY=!1,s.name&&(e.name=s.name),t.mimeType in at&&(e.format=at[t.mimeType]);var r=n.samplers||{},i=r[s.sampler]||{};return e.magFilter=Qe[i.magFilter]||A,e.minFilter=Qe[i.minFilter]||L,e.wrapS=$e[i.wrapS]||re,e.wrapT=$e[i.wrapT]||re,e}),this.cache.add("texture-"+s.name,c),c},Ve.prototype.assignTexture=function(e,t,r){var n=this;return this.getDependency("texture",r.index).then(function(i){if(!i.isCompressedTexture)switch(t){case"aoMap":case"emissiveMap":case"metalnessMap":case"normalMap":case"roughnessMap":i.format=te}if(void 0===r.texCoord||0==r.texCoord||"aoMap"===t&&1==r.texCoord||console.warn("THREE._GLTFLoader: Custom UV set "+r.texCoord+" for texture "+t+" not yet supported."),n.extensions[Ye.KHR_TEXTURE_TRANSFORM]){var a=void 0!==r.extensions?r.extensions[Ye.KHR_TEXTURE_TRANSFORM]:void 0;a&&(i=n.extensions[Ye.KHR_TEXTURE_TRANSFORM].extendTexture(i,a))}e[t]=i})},Ve.prototype.assignFinalMaterial=function(e){var t=e.geometry,r=e.material,n=void 0!==t.attributes.tangent,i=void 0!==t.attributes.color,a=void 0===t.attributes.normal,o=!0===e.isSkinnedMesh,s=Object.keys(t.morphAttributes).length>0,u=s&&void 0!==t.morphAttributes.normal;if(e.isPoints){var l="PointsMaterial:"+r.uuid,f=this.cache.get(l);f||(f=new J,I.prototype.copy.call(f,r),f.color.copy(r.color),f.map=r.map,f.sizeAttenuation=!1,this.cache.add(l,f)),r=f}else if(e.isLine){var l="LineBasicMaterial:"+r.uuid,d=this.cache.get(l);d||(d=new T,I.prototype.copy.call(d,r),d.color.copy(r.color),this.cache.add(l,d)),r=d}if(n||i||a||o||s){var l="ClonedMaterial:"+r.uuid+":";r.isGLTFSpecularGlossinessMaterial&&(l+="specular-glossiness:"),o&&(l+="skinning:"),n&&(l+="vertex-tangents:"),i&&(l+="vertex-colors:"),a&&(l+="flat-shading:"),s&&(l+="morph-targets:"),u&&(l+="morph-normals:");var h=this.cache.get(l);h||(h=r.clone(),o&&(h.skinning=!0),n&&(h.vertexTangents=!0),i&&(h.vertexColors=!0),a&&(h.flatShading=!0),s&&(h.morphTargets=!0),u&&(h.morphNormals=!0),this.cache.add(l,h)),r=h}r.aoMap&&void 0===t.attributes.uv2&&void 0!==t.attributes.uv&&t.setAttribute("uv2",new c(t.attributes.uv.array,2)),r.normalScale&&!n&&(r.normalScale.y=-r.normalScale.y),r.clearcoatNormalScale&&!n&&(r.clearcoatNormalScale.y=-r.clearcoatNormalScale.y),e.material=r},Ve.prototype.loadMaterial=function(e){var t,r=this,n=this.json,i=this.extensions,a=n.materials[e],o={},s=a.extensions||{},u=[];if(s[Ye.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var l=i[Ye.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];l||(l=new Ae,i[Ye.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]=l),t=l.getMaterialType(),u.push(l.extendParams(o,a,r))}else if(s[Ye.KHR_MATERIALS_UNLIT]){var c=i[Ye.KHR_MATERIALS_UNLIT];t=c.getMaterialType(),u.push(c.extendParams(o,a,r))}else{var f;if(s[Ye.KHR_TECHNIQUES_WEBGL]){f={};var d=i[Ye.KHR_TECHNIQUES_WEBGL];u.push(d.extendParams(f,a,r))}t=G;var p=a.pbrMetallicRoughness||{};if(o.color=new h(1,1,1),o.opacity=1,Array.isArray(p.baseColorFactor)){var v=p.baseColorFactor;o.color.fromArray(v),o.opacity=v[3]}void 0!==p.baseColorTexture&&u.push(r.assignTexture(o,"map",p.baseColorTexture)),o.metalness=void 0!==p.metallicFactor?p.metallicFactor:1,o.roughness=void 0!==p.roughnessFactor?p.roughnessFactor:1,void 0!==p.metallicRoughnessTexture&&(u.push(r.assignTexture(o,"metalnessMap",p.metallicRoughnessTexture)),u.push(r.assignTexture(o,"roughnessMap",p.metallicRoughnessTexture)))}!0===a.doubleSided&&(o.side=m);var g=a.alphaMode||it.OPAQUE;if(g===it.BLEND?(o.transparent=!0,o.depthWrite=!1):(o.transparent=!1,g===it.MASK&&(o.alphaTest=void 0!==a.alphaCutoff?a.alphaCutoff:.5)),void 0!==a.normalTexture&&t!==k&&(u.push(r.assignTexture(o,"normalMap",a.normalTexture)),o.normalScale=new fe(1,1),void 0!==a.normalTexture.scale&&o.normalScale.set(a.normalTexture.scale,a.normalTexture.scale)),void 0!==a.occlusionTexture&&t!==k&&(u.push(r.assignTexture(o,"aoMap",a.occlusionTexture)),void 0!==a.occlusionTexture.strength&&(o.aoMapIntensity=a.occlusionTexture.strength)),void 0!==a.emissiveFactor&&t!==k&&(o.emissive=(new h).fromArray(a.emissiveFactor)),void 0!==a.emissiveTexture&&t!==k&&u.push(r.assignTexture(o,"emissiveMap",a.emissiveTexture)),s[Ye.KHR_MATERIALS_CLEARCOAT]){var y=i[Ye.KHR_MATERIALS_CLEARCOAT];t=y.getMaterialType(),u.push(y.extendParams(o,{extensions:s},r))}return Promise.all(u).then(function(){var e;if(t===Ee)e=i[Ye.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(o);else{if(f){var r=f.uniforms.u_diffuse;r&&(r.value.isTexture?o.map=r.value:o.color=r.value);var n=f.uniforms.u_emission;n&&(n.value.isTexture?o.emissiveMap=n.value:o.emissive=n.value)
;var s=f.uniforms.u_shininess;s&&(o.shininess=s.value)}e=new t(o)}return a.name&&(e.name=a.name),e.map&&(e.map.encoding=pe),e.emissiveMap&&(e.emissiveMap.encoding=pe),Ue(e,a),a.extensions&&Be(i,e,a),e})},Ve.prototype.loadGeometries=function(e){for(var t=this,r=this.extensions,n=this.primitiveCache,i=[],a=0,o=e.length;a<o;a++){var s=e[a],u=je(s),l=n[u];if(l)i.push(l.promise);else{var c;c=s.extensions&&s.extensions[Ye.KHR_DRACO_MESH_COMPRESSION]?function(e){return r[Ye.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then(function(r){return ze(r,e,t)})}(s):ze(new f,s,t),n[u]={primitive:s,promise:c},i.push(c)}}return Promise.all(i)},Ve.prototype.loadMesh=function(e){for(var t=this,r=this.json,n=r.meshes[e],i=n.primitives,a=[],o=0,s=i.length;o<s;o++){var u=void 0===i[o].material?De(this.cache):this.getDependency("material",i[o].material);a.push(u)}return a.push(t.loadGeometries(i)),Promise.all(a).then(function(r){for(var a=r.slice(0,r.length-1),o=r[r.length-1],s=[],u=0,l=o.length;u<l;u++){var c,f=o[u],d=i[u],h=a[u];if(d.mode===Ze.TRIANGLES||d.mode===Ze.TRIANGLE_STRIP||d.mode===Ze.TRIANGLE_FAN||void 0===d.mode)c=!0===n.isSkinnedMesh?new ie(f,h):new N(f,h),!0!==c.isSkinnedMesh||c.geometry.attributes.skinWeight.normalized||c.normalizeSkinWeights(),d.mode===Ze.TRIANGLE_STRIP?c.geometry=He(c.geometry,ce):d.mode===Ze.TRIANGLE_FAN&&(c.geometry=He(c.geometry,le));else if(d.mode===Ze.LINES)c=new E(f,h);else if(d.mode===Ze.LINE_STRIP)c=new S(f,h);else if(d.mode===Ze.LINE_LOOP)c=new C(f,h);else{if(d.mode!==Ze.POINTS)throw new Error("THREE._GLTFLoader: Primitive mode unsupported: "+d.mode);c=new Z(f,h)}Object.keys(c.geometry.morphAttributes).length>0&&ke(c,n),c.name=n.name||"mesh_"+e,o.length>1&&(c.name+="_"+u),Ue(c,n),t.assignFinalMaterial(c),s.push(c)}if(1===s.length)return s[0];for(var p=new y,u=0,l=s.length;u<l;u++)p.add(s[u]);return p})},Ve.prototype.loadCamera=function(e){var t,r=this.json.cameras[e],n=r[r.type];return n?("perspective"===r.type?t=new q(D.radToDeg(n.yfov),n.aspectRatio||1,n.znear||1,n.zfar||2e6):"orthographic"===r.type&&(t=new X(n.xmag/-2,n.xmag/2,n.ymag/2,n.ymag/-2,n.znear,n.zfar)),r.name&&(t.name=r.name),Ue(t,r),Promise.resolve(t)):void console.warn("THREE._GLTFLoader: Missing camera parameters.")},Ve.prototype.loadSkin=function(e){var t=this.json.skins[e],r={joints:t.joints};return void 0===t.inverseBindMatrices?Promise.resolve(r):this.getDependency("accessor",t.inverseBindMatrices).then(function(e){return r.inverseBindMatrices=e,r})},Ve.prototype.loadAnimation=function(e){for(var t=this.json,r=t.animations[e],n=[],i=[],a=[],o=[],u=[],l=0,c=r.channels.length;l<c;l++){var f=r.channels[l],d=r.samplers[f.sampler],h=f.target,p=void 0!==h.node?h.node:h.id,m=void 0!==r.parameters?r.parameters[d.input]:d.input,v=void 0!==r.parameters?r.parameters[d.output]:d.output;n.push(this.getDependency("node",p)),i.push(this.getDependency("accessor",m)),a.push(this.getDependency("accessor",v)),o.push(d),u.push(h)}return Promise.all([Promise.all(n),Promise.all(i),Promise.all(a),Promise.all(o),Promise.all(u)]).then(function(t){for(var n=t[0],i=t[1],a=t[2],o=t[3],u=t[4],l=[],c=0,f=n.length;c<f;c++){var d=n[c],h=i[c],p=a[c],m=o[c],v=u[c];if(void 0!==d){d.updateMatrix(),d.matrixAutoUpdate=!0;var g;switch(rt[v.path]){case rt.weights:g=W;break;case rt.rotation:g=$;break;case rt.position:case rt.scale:default:g=he}var y=d.name?d.name:d.uuid,_=void 0!==m.interpolation?nt[m.interpolation]:w,b=[];rt[v.path]===rt.weights?d.traverse(function(e){!0===e.isMesh&&e.morphTargetInfluences&&b.push(e.name?e.name:e.uuid)}):b.push(y);var M=p.array;if(p.normalized){var x;if(M.constructor===Int8Array)x=1/127;else if(M.constructor===Uint8Array)x=1/255;else if(M.constructor==Int16Array)x=1/32767;else{if(M.constructor!==Uint16Array)throw new Error("THREE._GLTFLoader: Unsupported output accessor component type.");x=1/65535}for(var S=new Float32Array(M.length),T=0,C=M.length;T<C;T++)S[T]=M[T]*x;M=S}for(var T=0,C=b.length;T<C;T++){var E=new g(b[T]+"."+rt[v.path],h.array,M,_);"CUBICSPLINE"===m.interpolation&&(E.createInterpolant=function(e){return new Re(this.times,this.values,this.getValueSize()/3,e)},E.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),l.push(E)}}}var A=r.name?r.name:"animation_"+e;return new s(A,void 0,l)})},Ve.prototype.loadNode=function(e){var t=this.json,r=this.extensions,n=this,i=t.meshReferences,a=t.meshUses,o=t.nodes[e];return function(){var e=[];return void 0!==o.mesh&&e.push(n.getDependency("mesh",o.mesh).then(function(e){var t;if(i[o.mesh]>1){var r=a[o.mesh]++;t=e.clone(),t.name+="_instance_"+r}else t=e;return void 0!==o.weights&&t.traverse(function(e){if(e.isMesh)for(var t=0,r=o.weights.length;t<r;t++)e.morphTargetInfluences[t]=o.weights[t]}),t})),void 0!==o.camera&&e.push(n.getDependency("camera",o.camera)),o.extensions&&o.extensions[Ye.KHR_LIGHTS_PUNCTUAL]&&void 0!==o.extensions[Ye.KHR_LIGHTS_PUNCTUAL].light&&e.push(n.getDependency("light",o.extensions[Ye.KHR_LIGHTS_PUNCTUAL].light)),Promise.all(e)}().then(function(e){var t;if((t=!0===o.isBone?new u:e.length>1?new y:1===e.length?e[0]:new Y)!==e[0])for(var n=0,i=e.length;n<i;n++)t.add(e[n]);if(o.name&&(t.userData.name=o.name,t.name=Q.sanitizeNodeName(o.name)),Ue(t,o),o.extensions&&Be(r,t,o),void 0!==o.matrix){var a=new B;a.fromArray(o.matrix),t.applyMatrix4(a)}else void 0!==o.translation&&t.position.fromArray(o.translation),void 0!==o.rotation&&t.quaternion.fromArray(o.rotation),void 0!==o.scale&&t.scale.fromArray(o.scale);return t})},Ve.prototype.loadScene=function(){function e(t,r,n,i){var a=n.nodes[t];return i.getDependency("node",t).then(function(e){if(void 0===a.skin)return e;var t;return i.getDependency("skin",a.skin).then(function(e){t=e;for(var r=[],n=0,a=t.joints.length;n<a;n++)r.push(i.getDependency("node",t.joints[n]));return Promise.all(r)}).then(function(r){return e.traverse(function(e){if(e.isMesh){for(var n=[],i=[],a=0,o=r.length;a<o;a++){var s=r[a];if(s){n.push(s);var u=new B;void 0!==t.inverseBindMatrices&&u.fromArray(t.inverseBindMatrices.array,16*a),i.push(u)}else console.warn('THREE._GLTFLoader: Joint "%s" could not be found.',t.joints[a])}e.bind(new ne(n,i),e.matrixWorld)}}),e})}).then(function(t){r.add(t);var o=[];if(a.children)for(var s=a.children,u=0,l=s.length;u<l;u++){var c=s[u];o.push(e(c,t,n,i))}return Promise.all(o)})}return function(t){var r=this.json,n=this.extensions,i=this.json.scenes[t],a=this,o=new y;i.name&&(o.name=i.name),Ue(o,i),i.extensions&&Be(n,o,i);for(var s=i.nodes||[],u=[],l=0,c=s.length;l<c;l++)u.push(e(s[l],o,r,a));return Promise.all(u).then(function(){return o})}}()}return new ge(e)};r.GLTFLoader=Ce},{M_407:198,s_332:233,e_1:235,m_131:239,C_129:240,M_0:241,o_130:242,M_110:245}],95:[function(e,t,r){"use strict";function n(e){var t=i();return function(){var r,n=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,f.default)(this,r)}}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function a(e){if(!s){var t=THREE,r=t.DataTextureLoader,i=1015,a=1016,o=3e3,f=1006,d=1003,p=3002,m=1009,v={parse:function(e){var t=function(e,t){switch(e){case 1:console.error("RGBELoader Read Error: "+(t||""));break;case 2:console.error("RGBELoader Write Error: "+(t||""));break;case 3:console.error("RGBELoader Bad File Format: "+(t||""));break;default:case 4:console.error("RGBELoader: Error: "+(t||""))}return-1},r=function(e,t,r){t=t||1024;for(var n=e.pos,i=-1,a=0,o="",s=String.fromCharCode.apply(null,new Uint16Array(e.subarray(n,n+128)));0>(i=s.indexOf("\n"))&&a<t&&n<e.byteLength;)o+=s,a+=s.length,n+=128,s+=String.fromCharCode.apply(null,new Uint16Array(e.subarray(n,n+128)));return-1<i&&(!1!==r&&(e.pos+=a+i+1),o+s.slice(0,i))},n=function(){function e(e){t[0]=e;var n=r[0],i=n>>16&32768,a=n>>12&2047,o=n>>23&255;return o<103?i:o>142?(i|=31744,i|=(255==o?0:1)&&8388607&n):o<113?(a|=2048,i|=(a>>114-o)+(a>>113-o&1)):(i|=o-112<<10|a>>1,i+=1&a)}var t=new Float32Array(1),r=new Int32Array(t.buffer);return function(t,r,n,i){var a=t[r+3],o=Math.pow(2,a-128)/255;n[i+0]=e(t[r+0]*o),n[i+1]=e(t[r+1]*o),n[i+2]=e(t[r+2]*o)}}(),o=new Uint8Array(e);o.pos=0;var s=function(e){var n,i,a=/^#\?(\S+)$/,o=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,s=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,u=/^\s*FORMAT=(\S+)\s*$/,l=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,c={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};if(e.pos>=e.byteLength||!(n=r(e)))return t(1,"no header found");if(!(i=n.match(a)))return t(3,"bad initial token");for(c.valid|=1,c.programtype=i[1],c.string+=n+"\n";;){if(!1===(n=r(e)))break;if(c.string+=n+"\n","#"!==n.charAt(0)){if((i=n.match(o))&&(c.gamma=parseFloat(i[1],10)),(i=n.match(s))&&(c.exposure=parseFloat(i[1],10)),(i=n.match(u))&&(c.valid|=2,c.format=i[1]),(i=n.match(l))&&(c.valid|=4,c.height=parseInt(i[1],10),c.width=parseInt(i[2],10)),2&c.valid&&4&c.valid)break}else c.comments+=n+"\n"}return 2&c.valid?4&c.valid?c:t(3,"missing image size specifier"):t(3,"missing format specifier")}(o);if(-1!==s){var u=s.width,l=s.height,c=function(e,r,n){var i,a,o,s,u,l,c,f,d,h,p,m,v,g=r,y=n;if(g<8||g>32767||2!==e[0]||2!==e[1]||128&e[2])return new Uint8Array(e);if(g!==(e[2]<<8|e[3]))return t(3,"wrong scanline width");if(!(i=new Uint8Array(4*r*n))||!i.length)return t(4,"unable to allocate buffer space");for(a=0,o=0,f=4*g,v=new Uint8Array(4),l=new Uint8Array(f);y>0&&o<e.byteLength;){if(o+4>e.byteLength)return t(1);if(v[0]=e[o++],v[1]=e[o++],v[2]=e[o++],v[3]=e[o++],2!=v[0]||2!=v[1]||(v[2]<<8|v[3])!=g)return t(3,"bad rgbe scanline format");for(c=0;c<f&&o<e.byteLength;){if(s=e[o++],m=s>128,m&&(s-=128),0===s||c+s>f)return t(3,"bad scanline data");if(m)for(u=e[o++],d=0;d<s;d++)l[c++]=u;else l.set(e.subarray(o,o+s),c),c+=s,o+=s}for(h=g,d=0;d<h;d++)p=0,i[a]=l[d+p],p+=g,i[a+1]=l[d+p],p+=g,i[a+2]=l[d+p],p+=g,i[a+3]=l[d+p],a+=4;y--}return i}(o.subarray(o.pos),u,l);if(-1!==c){switch(this.type){case m:var f=c,d=1023,h=m;break;case i:for(var p=c.length/4*3,v=new Float32Array(p),g=0;g<p;g++)!function(e,t,r,n){var i=e[t+3],a=Math.pow(2,i-128)/255;r[n+0]=e[t+0]*a,r[n+1]=e[t+1]*a,r[n+2]=e[t+2]*a}(c,4*g,v,3*g);var f=v,d=1022,h=i;break;case a:for(var p=c.length/4*3,y=new Uint16Array(p),g=0;g<p;g++)n(c,4*g,y,3*g);var f=y,d=1022,h=a;break;default:console.error("THREE.RGBELoader: unsupported type: ",this.type)}return{width:u,height:l,data:f,header:s.string,gamma:s.gamma,exposure:s.exposure,format:d,type:h}}}return null},setDataType:function(e){return this.type=e,this},load:function(e,t,n,s){function u(e,r){switch(e.type){case m:e.encoding=p,e.minFilter=d,e.magFilter=d,e.generateMipmaps=!1,e.flipY=!0;break;case i:case a:e.encoding=o,e.minFilter=f,e.magFilter=f,e.generateMipmaps=!1,e.flipY=!0}t&&t(e,r)}return r.prototype.load.call(this,e,u,n,s)}};s=(0,h.default)(r,{esConstructor:function(){return function(e){function t(e){var n;return(0,u.default)(this,t),n=r.call(this,e),constructor.call((0,l.default)(n),e),n}(0,c.default)(t,e);var r=n(t);return t}(r)},constructor:function(e){this.type=m},prototype:v})}return new s(e)}var o=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.RGBELoader=a;var s,u=o(e("e_1")),l=o(e("s_332")),c=o(e("C_129")),f=o(e("o_130")),d=o(e("m_131")),h=o(e("M_407"))},{M_407:198,s_332:233,e_1:235,m_131:239,C_129:240,M_0:241,o_130:242}],96:[function(e,t,r){"use strict";function n(e){var t=i();return function(){var r,n=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,f.default)(this,r)}}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function a(e){if(!s){var t=THREE,r=t.FileLoader,i=t.Loader,a=t.Texture,o={load:function(e,t,n,i){var o=this,s=new a,u=new r(this.manager);return u.setResponseType("arraybuffer"),u.setPath(this.path),u.load(e,function(e){s.image=o.parse(e),s.needsUpdate=!0,void 0!==t&&t(s)},n,i),s},parse:function(e){function t(e,t,r,n,i,a,o,s,u){var l,c,f,d=u,h=0,p=x.width;for(f=t;f!==n;f+=r)for(c=i;c!==o;c+=a,h++)l=s[h],e[4*(c+p*f)+3]=255,e[4*(c+p*f)+2]=d[3*l+0],e[4*(c+p*f)+1]=d[3*l+1],e[4*(c+p*f)+0]=d[3*l+2];return e}function r(e,t,r,n,i,a,o,s){var u,l,c,f=0,d=x.width;for(c=t;c!==n;c+=r)for(l=i;l!==o;l+=a,f+=2)u=s[f+0]+(s[f+1]<<8),e[4*(l+d*c)+0]=(31744&u)>>7,e[4*(l+d*c)+1]=(992&u)>>2,e[4*(l+d*c)+2]=(31&u)>>3,e[4*(l+d*c)+3]=32768&u?0:255;return e}function n(e,t,r,n,i,a,o,s){var u,l,c=0,f=x.width;for(l=t;l!==n;l+=r)for(u=i;u!==o;u+=a,c+=3)e[4*(u+f*l)+3]=255,e[4*(u+f*l)+2]=s[c+0],e[4*(u+f*l)+1]=s[c+1],e[4*(u+f*l)+0]=s[c+2];return e}function i(e,t,r,n,i,a,o,s){var u,l,c=0,f=x.width;for(l=t;l!==n;l+=r)for(u=i;u!==o;u+=a,c+=4)e[4*(u+f*l)+2]=s[c+0],e[4*(u+f*l)+1]=s[c+1],e[4*(u+f*l)+0]=s[c+2],e[4*(u+f*l)+3]=s[c+3];return e}function a(e,t,r,n,i,a,o,s){var u,l,c,f=0,d=x.width;for(c=t;c!==n;c+=r)for(l=i;l!==o;l+=a,f++)u=s[f],e[4*(l+d*c)+0]=u,e[4*(l+d*c)+1]=u,e[4*(l+d*c)+2]=u,e[4*(l+d*c)+3]=255;return e}function o(e,t,r,n,i,a,o,s){var u,l,c=0,f=x.width;for(l=t;l!==n;l+=r)for(u=i;u!==o;u+=a,c+=2)e[4*(u+f*l)+0]=s[c+0],e[4*(u+f*l)+1]=s[c+0],e[4*(u+f*l)+2]=s[c+0],e[4*(u+f*l)+3]=s[c+1];return e}var s=0,u=1,l=2,c=3,f=9,d=10,h=11,p=48,m=4,v=0,g=1,y=2,_=3;e.length<19&&console.error("THREE.TGALoader: Not enough data to contain header.");var b=new Uint8Array(e),M=0,x={id_length:b[M++],colormap_type:b[M++],image_type:b[M++],colormap_index:b[M++]|b[M++]<<8,colormap_length:b[M++]|b[M++]<<8,colormap_size:b[M++],origin:[b[M++]|b[M++]<<8,b[M++]|b[M++]<<8],width:b[M++]|b[M++]<<8,height:b[M++]|b[M++]<<8,pixel_size:b[M++],flags:b[M++]};!function(e){switch(e.image_type){case u:case f:(e.colormap_length>256||24!==e.colormap_size||1!==e.colormap_type)&&console.error("THREE.TGALoader: Invalid type colormap data for indexed type.");break;case l:case c:case d:case h:e.colormap_type&&console.error("THREE.TGALoader: Invalid type colormap data for colormap type.");break;case s:console.error("THREE.TGALoader: No data.");default:console.error('THREE.TGALoader: Invalid type "%s".',e.image_type)}(e.width<=0||e.height<=0)&&console.error("THREE.TGALoader: Invalid image size."),8!==e.pixel_size&&16!==e.pixel_size&&24!==e.pixel_size&&32!==e.pixel_size&&console.error('THREE.TGALoader: Invalid pixel size "%s".',e.pixel_size)}(x),x.id_length+M>e.length&&console.error("THREE.TGALoader: No data."),M+=x.id_length;var w=!1,S=!1,T=!1;switch(x.image_type){case f:w=!0,S=!0;break;case u:S=!0;break;case d:w=!0;break;case l:break;case h:w=!0,T=!0;break;case c:T=!0}var C="undefined"!=typeof OffscreenCanvas,E=C?new OffscreenCanvas(x.width,x.height):document.createElement("canvas");E.width=x.width,E.height=x.height;var A=E.getContext("2d"),L=A.createImageData(x.width,x.height),P=function(e,t,r,n,i){var a,o,s,u;if(o=r.pixel_size>>3,s=r.width*r.height*o,t&&(u=i.subarray(n,n+=r.colormap_length*(r.colormap_size>>3))),e){a=new Uint8Array(s);for(var l,c,f,d=0,h=new Uint8Array(o);d<s;)if(l=i[n++],c=1+(127&l),128&l){for(f=0;f<o;++f)h[f]=i[n++];for(f=0;f<c;++f)a.set(h,d+f*o);d+=o*c}else{for(c*=o,f=0;f<c;++f)a[d+f]=i[n++];d+=c}}else a=i.subarray(n,n+=t?r.width*r.height:s);return{pixel_data:a,palettes:u}}(w,S,x,M,b);!function(e,s,u,l,c){var f,d,h,b,M,w;switch((x.flags&p)>>m){default:case y:f=0,h=1,M=s,d=0,b=1,w=u;break;case v:f=0,h=1,M=s,d=u-1,b=-1,w=-1;break;case _:f=s-1,h=-1,M=-1,d=0,b=1,w=u;break;case g:f=s-1,h=-1,M=-1,d=u-1,b=-1,w=-1}if(T)switch(x.pixel_size){case 8:a(e,d,b,w,f,h,M,l);break;case 16:o(e,d,b,w,f,h,M,l);break;default:console.error("THREE.TGALoader: Format not supported.")}else switch(x.pixel_size){case 8:t(e,d,b,w,f,h,M,l,c);break;case 16:r(e,d,b,w,f,h,M,l);break;case 24:n(e,d,b,w,f,h,M,l);break;case 32:i(e,d,b,w,f,h,M,l);break;default:console.error("THREE.TGALoader: Format not supported.")}}(L.data,x.width,x.height,P.pixel_data,P.palettes);return A.putImageData(L,0,0),C?E.transferToImageBitmap():E}};s=(0,h.default)(i,{esConstructor:function(e){return function(t){function r(t){var n;return(0,u.default)(this,r),n=i.call(this,t),e.call((0,l.default)(n),t),n}(0,c.default)(r,t);var i=n(r);return r}(i)},constructor:function(e){},prototype:o})}return new s(e)}var o=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.TGALoader=a;var s,u=o(e("e_1")),l=o(e("s_332")),c=o(e("C_129")),f=o(e("o_130")),d=o(e("m_131")),h=o(e("M_407"))},{M_407:198,s_332:233,e_1:235,m_131:239,C_129:240,M_0:241,o_130:242}],97:[function(e,t,r){(function(t){(function(){"use strict";var n=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.Base64Encoder=void 0;var i=n(e("e_1")),a=n(e("s_2")),o=function(){function e(){(0,i.default)(this,e)}return(0,a.default)(e,null,[{key:"decodeArray",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(0===e.length)return new t(0);for(var n,i=[],a=0,o=0;o<e.length;o++)n="function"==typeof t.from?t.from(e[o],"base64"):new t(e[o],"base64"),a+=n.length,r.push(a),i.push(n);if(1===e.length)return i[0];for(var s=new t(a),u=0,l=0;l<e.length;l++)i[l].copy(s,u),u+=i[l].length;return s}}]),e}();r.Base64Encoder=o}).call(this)}).call(this,e("buffer").Buffer)},{e_1:235,s_2:236,M_0:241,buffer:248}],98:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Constants=void 0;var n={INDENT_VALUE:2,Sizes:{BOOL_SIZE:1,CHAR_SIZE:1,SHORT_SIZE:2,INT_SIZE:4,LONG_SIZE:4,INT64_SIZE:8,FLOAT_SIZE:4,DOUBLE_SIZE:8,GLENUM_SIZE:4},TypeIds:{ID_BYTE_ARRAY:0,ID_UBYTE_ARRAY:1,ID_SHORT_ARRAY:2,ID_USHORT_ARRAY:3,ID_INT_ARRAY:4,ID_UINT_ARRAY:5,ID_FLOAT_ARRAY:6,ID_DOUBLE_ARRAY:7,ID_VEC2B_ARRAY:8,ID_VEC3B_ARRAY:9,ID_VEC4B_ARRAY:10,ID_VEC4UB_ARRAY:11,ID_VEC2S_ARRAY:12,ID_VEC3S_ARRAY:13,ID_VEC4S_ARRAY:14,ID_VEC2_ARRAY:15,ID_VEC3_ARRAY:16,ID_VEC4_ARRAY:17,ID_VEC2D_ARRAY:18,ID_VEC3D_ARRAY:19,ID_VEC4D_ARRAY:20,ID_VEC2UB_ARRAY:21,ID_VEC3UB_ARRAY:22,ID_VEC2US_ARRAY:23,ID_VEC3US_ARRAY:24,ID_VEC4US_ARRAY:25,ID_VEC2I_ARRAY:26,ID_VEC3I_ARRAY:27,ID_VEC4I_ARRAY:28,ID_VEC2UI_ARRAY:29,ID_VEC3UI_ARRAY:30,ID_VEC4UI_ARRAY:31,ID_UINT64_ARRAY:32,ID_INT64_ARRAY:33,ID_DRAWARRAYS:50,ID_DRAWARRAY_LENGTH:51,ID_DRAWELEMENTS_UBYTE:52,ID_DRAWELEMENTS_USHORT:53,ID_DRAWELEMENTS_UINT:54}};r.Constants=n},{}],99:[function(e,t,r){"use strict";var n=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.DataTypes=r.ObjectProperty=r.ObjectMark=r.ObjectGLEnum=void 0;var i=n(e("s_2")),a=n(e("e_1")),o=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;(0,a.default)(this,e),this.value=t};r.ObjectGLEnum=o;var s=function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,a.default)(this,e),this.name=t,this.indent=r};r.ObjectMark=s;var u=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];(0,a.default)(this,e),this.name=t,this.value=r,this.mapProperty=n}return(0,i.default)(e,[{key:"set",value:function(e){return"string"==typeof e?this.name=e:"number"==typeof e&&(this.value=e),this}}]),e}();r.ObjectProperty=u;var l={ObjectProperty:u,ObjectMark:s,ObjectGLEnum:o};r.DataTypes=l},{e_1:235,s_2:236,M_0:241}],100:[function(e,t,r){"use strict";function n(e,t){var r="";if(t>i.LOG&&(r=Object.keys(i).filter(function(e){return i[e]===t})+" : "),t>o.level&&console.log(r+e),a)try{a(e,t)}catch(e){}}Object.defineProperty(r,"__esModule",{value:!0}),r.Log=void 0;var i={LOG:1,WARN:2,ERROR:3,FATAL:4},a=null,o=function(e){return n(e,i.LOG)};r.Log=o,o.log=function(e){return n(e,i.LOG)},o.warn=function(e){return n(e,i.WARN)},o.error=function(e){return n(e,i.ERROR)},o.fatal=function(e){return n(e,i.FATAL)},o.setLogLog=function(){o.level=i.LOG},o.setLogWarn=function(){o.level=i.WARN},o.setLogError=function(){o.level=i.ERROR},o.setLogFatal=function(){o.level=i.FATAL},o.setLogOff=function(){o.level=Number.MAX_VALUE},o.level=i.WARN},{}],101:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ArrayTableEnum=void 0;var n={ByteArray:0,UByteArray:1,ShortArray:2,UShortArray:3,IntArray:4,UIntArray:5,FloatArray:6,DoubleArray:7,Vec2bArray:8,Vec3bArray:9,Vec4bArray:10,Vec2ubArray:21,Vec3ubArray:22,Vec4ubArray:11,Vec2sArray:12,Vec3sArray:13,Vec4sArray:14,Vec2usArray:23,Vec3usArray:24,Vec4usArray:25,Vec2fArray:15,Vec3fArray:16,Vec4fArray:17,Vec2dArray:18,Vec3dArray:19,Vec4dArray:20,Vec2iArray:26,Vec3iArray:27,Vec4iArray:28,Vec2uiArray:29,Vec3uiArray:30,Vec4uiArray:31};r.ArrayTableEnum=n},{}],102:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.AttributeBinding=void 0;var n={BIND_OFF:0,BIND_OVERALL:1,BIND_PER_PRIMITIVE_SET:2,BIND_PER_PRIMITIVE:3,BIND_PER_VERTEX:4};r.AttributeBinding=n},{}],103:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.CenterMode=void 0;var n={USE_BOUNDING_SPHERE_CENTER:0,USER_DEFINED_CENTER:1,UNION_OF_BOUNDING_SPHERE_AND_USER_DEFINED:2};r.CenterMode=n},{}],104:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.FaceMode=void 0;var n=e("M_451"),i={FRONT:n.GLEnum.FRONT,BACK:n.GLEnum.BACK,FRONT_AND_BACK:n.GLEnum.FRONT_AND_BACK};r.FaceMode=i},{M_451:106}],105:[function(e,t,r){"use strict";function n(e,t){for(var r in e)if(e[r]==t)return r}Object.defineProperty(r,"__esModule",{value:!0}),r.EnumToString=n},{}],106:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.GLEnum=void 0;var n={GL_ALPHA_TEST:3008,GL_BLEND:3042,GL_COLOR_LOGIC_OP:3058,GL_COLOR_MATERIAL:2903,GL_CULL_FACE:2884,GL_DEPTH_TEST:2929,GL_FOG:2912,GL_FRAGMENT_PROGRAM_ARB:34820,GL_LINE_STIPPLE:2852,GL_POINT_SMOOTH:2832,GL_POINT_SPRITE_ARB:34913,GL_POLYGON_OFFSET_FILL:32823,GL_POLYGON_OFFSET_LINE:10754,GL_POLYGON_OFFSET_POINT:10753,GL_POLYGON_STIPPLE:2882,GL_SCISSOR_TEST:3089,GL_STENCIL_TEST:2960,GL_STENCIL_TEST_TWO_SIDE:35088,GL_VERTEX_PROGRAM_ARB:34336,GL_COLOR_SUM:33880,GL_LIGHTING:2896,GL_NORMALIZE:2977,GL_RESCALE_NORMAL:32826,GL_TEXTURE_1D:3552,GL_TEXTURE_2D:3553,GL_TEXTURE_3D:32879,GL_TEXTURE_CUBE_MAP:34067,GL_TEXTURE_RECTANGLE:34037,GL_TEXTURE_GEN_Q:3171,GL_TEXTURE_GEN_R:3170,GL_TEXTURE_GEN_S:3168,GL_TEXTURE_GEN_T:3169,GL_CLIP_PLANE0:12288,GL_CLIP_PLANE1:12289,GL_CLIP_PLANE2:12290,GL_CLIP_PLANE3:12291,GL_CLIP_PLANE4:12292,GL_CLIP_PLANE5:12293,GL_LIGHT0:16384,GL_LIGHT1:16385,GL_LIGHT2:16386,GL_LIGHT3:16387,GL_LIGHT4:16388,GL_LIGHT5:16389,GL_LIGHT6:16390,GL_LIGHT7:16391,GL_VERTEX_PROGRAM_POINT_SIZE:34370,GL_VERTEX_PROGRAM_TWO_SIDE:34371,NEVER:512,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,NOTEQUAL:517,GEQUAL:518,ALWAYS:519,REPLACE:7681,MODULATE:8448,ADD:260,ADD_SIGNED:34164,INTERPOLATE:34165,SUBTRACT:34023,DOT3_RGB:34478,DOT3_RGBA:34479,CONSTANT:34166,PRIMARY_COLOR:34167,PREVIOUS:34168,TEXTURE:5890,TEXTURE0:33984,TEXTURE1:33985,TEXTURE2:33986,TEXTURE3:33987,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,CLAMP:10496,CLAMP_TO_EDGE:33071,CLAMP_TO_BORDER:33069,REPEAT:10497,MIRROR:33648,LINEAR:9729,LINEAR_MIPMAP_LINEAR:9987,LINEAR_MIPMAP_NEAREST:9985,NEAREST:9728,NEAREST_MIPMAP_LINEAR:9986,NEAREST_MIPMAP_NEAREST:9984,GL_INTENSITY:32841,GL_LUMINANCE:6409,GL_ALPHA:6406,GL_LUMINANCE_ALPHA:6410,GL_RGB:6407,GL_RGBA:6408,GL_COMPRESSED_ALPHA_ARB:34025,GL_COMPRESSED_LUMINANCE_ARB:34026,GL_COMPRESSED_INTENSITY_ARB:34028,GL_COMPRESSED_LUMINANCE_ALPHA_ARB:34027,GL_COMPRESSED_RGB_ARB:34029,GL_COMPRESSED_RGBA_ARB:34030,GL_COMPRESSED_RGB_S3TC_DXT1_EXT:33776,GL_COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,GL_COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,GL_COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,GL_COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,GL_COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,GL_COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,GL_COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,GL_ETC1_RGB8_OES:36196,GL_COMPRESSED_RGB8_ETC2:37492,GL_COMPRESSED_SRGB8_ETC2:37493,GL_COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37494,GL_COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37495,GL_COMPRESSED_RGBA8_ETC2_EAC:37496,GL_COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37497,GL_COMPRESSED_R11_EAC:37488,GL_COMPRESSED_SIGNED_R11_EAC:37489,GL_COMPRESSED_RG11_EAC:37490,GL_COMPRESSED_SIGNED_RG11_EAC:37491,GL_BYTE:5120,GL_SHORT:5122,GL_INT:5124,GL_FLOAT:5126,GL_DOUBLE:5130,GL_UNSIGNED_BYTE:5121,GL_UNSIGNED_SHORT:5123,GL_UNSIGNED_INT:5125,DST_ALPHA:772,DST_COLOR:774,ONE:1,ONE_MINUS_DST_ALPHA:773,ONE_MINUS_DST_COLOR:775,ONE_MINUS_SRC_ALPHA:771,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,SRC_ALPHA_SATURATE:776,SRC_COLOR:768,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,ZERO:0,COORDINATE:33873,DEPTH:33874,FOG_HINT:3156,GENERATE_MIPMAP_HINT:33170,LINE_SMOOTH_HINT:3154,PERSPECTIVE_CORRECTION_HINT:3152,POINT_SMOOTH_HINT:3153,POLYGON_SMOOTH_HINT:3155,TEXTURE_COMPRESSION_HINT:34031,FRAGMENT_SHADER_DERIVATIVE_HINT:35723,POINT:6912,LINE:6913,FILL:6912,BACK:1029,FRONT:1028,FRONT_AND_BACK:1032,FIXED_ONLY:35101,FASTEST:4353,NICEST:4353,DONT_CARE:4352};r.GLEnum=n},{}],107:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ImageType=void 0;var n={IMAGE_INLINE_DATA:0,IMAGE_INLINE_FILE:1,IMAGE_EXTERNAL:2};r.ImageType=n},{}],108:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ColorMode=void 0;var n={AMBIENT:4608,DIFFUSE:4609,SPECULAR:4610,EMISSION:5632,AMBIENT_AND_DIFFUSE:5634,OFF:5635};r.ColorMode=n},{}],109:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ObjectDataVariance=void 0;var n={DYNAMIC:0,STATIC:1,UNSPECIFIED:2};r.ObjectDataVariance=n},{}],110:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.PrimitiveMode=void 0;var n={POINTS:0,LINES:1,LINE_STRIP:3,LINE_LOOP:2,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,GL_QUADS:7};r.PrimitiveMode=n},{}],111:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.PrimitiveTableEnum=void 0;var n={DrawArrays:50,DrawArraysLength:51,DrawElementsUByte:52,DrawElementsUShort:53,DrawElementsUInt:54,GL_POINTS:0,GL_LINES:1,GL_LINE_STRIP:3,GL_LINE_LOOP:2,GL_TRIANGLES:4,GL_TRIANGLE_STRIP:5,GL_TRIANGLE_FAN:6,GL_QUADS:7,GL_QUAD_STRIP:8,GL_POLYGON:9,GL_LINES_ADJACENCY:10,GL_LINES_ADJACENCY_EXT:10,GL_LINE_STRIP_ADJACENCY_EXT:11,GL_LINE_STRIP_ADJACENCY:11,GL_TRIANGLES_ADJACENCY:12,GL_TRIANGLES_ADJACENCY_EXT:12,GL_TRIANGLE_STRIP_ADJACENCY:13,GL_TRIANGLE_STRIP_ADJACENCY_EXT:13,GL_PATCHES:14};r.PrimitiveTableEnum=n},{}],112:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.RangeMode=void 0;var n={DISTANCE_FROM_EYE_POINT:0,PIXEL_SIZE_ON_SCREEN:1};r.RangeMode=n},{}],113:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ShadeModelMode=void 0;var n={ConstantsFLAT:7424,SMOOTH:7425};r.ShadeModelMode=n},{}],114:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.StateAttributeValue=void 0;var n={OFF:0,ON:1,OVERRIDE:2,PROTECTED:4,INHERIT:8};r.StateAttributeValue=n},{}],115:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.RenderBinMode=void 0;var n={INHERIT_RENDERBIN_DETAILS:0,USE_RENDERBIN_DETAILS:1,OVERRIDE_RENDERBIN_DETAILS:2,PROTECTED_RENDERBIN_DETAILS:4,OVERRIDE_PROTECTED_RENDERBIN_DETAILS:6};r.RenderBinMode=n},{}],116:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.RenderingHint=void 0;var n={DEFAULT_BIN:0,OPAQUE_BIN:1,TRANSPARENT_BIN:2};r.RenderingHint=n},{}],117:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.InternalFormatMode=void 0;var n={USE_IMAGE_DATA_FORMAT:0,USE_USER_DEFINED_FORMAT:1,USE_ARB_COMPRESSION:2,USE_S3TC_DXT1_COMPRESSION:3,USE_S3TC_DXT3_COMPRESSION:4,USE_S3TC_DXT5_COMPRESSION:5,USE_PVRTC_2BPP_COMPRESSION:6,USE_PVRTC_4BPP_COMPRESSION:7,USE_ETC_COMPRESSION:8,USE_ETC2_COMPRESSION:9,USE_RGTC1_COMPRESSION:10,USE_RGTC2_COMPRESSION:11,USE_S3TC_DXT1c_COMPRESSION:12,USE_S3TC_DXT1a_COMPRESSION:13};r.InternalFormatMode=n},{}],118:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ShadowCompareFunc=void 0;var n={NEVER:512,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,NOTEQUAL:517,GEQUAL:518,ALWAYS:519};r.ShadowCompareFunc=n},{}],119:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ShadowTextureMode=void 0;var n={LUMINANCE:6409,INTENSITY:32841,ALPHA:6406,NONE:0};r.ShadowTextureMode=n},{}],120:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ReferenceFrame=void 0;var n={RELATIVE_RF:0,ABSOLUTE_RF:1,ABSOLUTE_RF_INHERIT_VIEWPOINT:2};r.ReferenceFrame=n},{}],121:[function(e,t,r){(function(t){(function(){"use strict";function n(e){var t=i();return function(){var r,n=(0,v.default)(e);if(t){var i=(0,v.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,m.default)(this,r)}}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function a(e,t){return e.bufferToString("ASCII",t,t+1)}function o(e,t){return t=t||0,"string"==typeof e?!!x[e.charCodeAt(t)]:!!x[e[t]]}function s(e){for(;e._position<=e._buffer.byteLength&&o(e._buffer,e._position);)e._position++}function u(e){var t=e.readString();return parseInt(t)}function l(e){var t=e.readString();return parseFloat(t)}function c(e,t){t=t||0;var r;return 10===(r="string"==typeof e?e.charCodeAt(t):e[t])||13===r}var f=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.AsciiStreamOperator=void 0;for(var d=f(e("e_1")),h=f(e("s_2")),p=f(e("C_129")),m=f(e("o_130")),v=f(e("m_131")),g=e("._458"),y=e("C_459"),_=e("o_460"),b=e("m_461"),M="\0\t\r\n\f ",x={},w=0;w<M.length;w++)x[M.charCodeAt(w)]=!0;var S=function(e){function r(e,n){var a;return(0,d.default)(this,r),a=i.call(this,"AsciiStreamOperator"),void 0!==t&&e instanceof t?e=new Uint8Array(e):e instanceof ArrayBuffer&&(e=new Uint8Array(e)),a._buffer=e,a._position=n,a.version=-1,a}(0,p.default)(r,e);var i=n(r);return(0,h.default)(r,[{key:"isBinary",value:function(){return!1}},{key:"bufferToString",value:function(e,t,r){var n=this._buffer.subarray(t,r);return String.fromCharCode.apply(null,n)}},{key:"advanceToCurrentEndBracket",value:function(){for(var e,t=0;this._position<this._buffer.byteLength;)if("}"===(e=this.readString())){if(t<=0)return;t--}else"{"===e&&t++}},{key:"readBool",value:function(){return"TRUE"===this.readString()}},{key:"readUInt",value:function(){return u(this)}},{key:"readInt",value:function(){return u(this)}},{key:"readUShort",value:function(){return u(this)}},{key:"readShort",value:function(){return u(this)}},{key:"readUByte",value:function(){return u(this)}},{key:"readByte",value:function(){return u(this)}},{key:"readFloat",value:function(){return l(this)}},{key:"readDouble",value:function(){return l(this)}},{key:"readHex",value:function(){var e=this.readString();return e=e.reaplace("0x",""),parseInt(e,16)}},{key:"matchString",value:function(e){var t=this._position;return e===this.readString()||(this._position=t,!1)}},{key:"lookForward",value:function(){var e=this._position,t=this.readString();return this._position=e,t}},{key:"goToNextRow",value:function(){for(;this._position<=this._buffer.byteLength&&!c(this._buffer,this._position);)this._position++}},{key:"readChar",value:function(){return s(this),this._position+=1,this.bufferToString("ASCII",this._position-1,this._position)}},{key:"readString",value:function(){s(this);for(var e=this._position;e<=this._buffer.byteLength&&!o(this._buffer,e);)e++;var t=this.bufferToString("ASCII",this._position,e);return this._position=e,t}},{key:"readWrappedString",value:function(){if(s(this),'"'===a(this,this._position)){this._position++
;for(var e=this._position;e<=this._buffer.byteLength&&'"'!==a(this,e);)e++;var t=this.bufferToString("ASCII",this._position,e);return this._position=e+1,t}return this.readString()}},{key:"readGLEnum",value:function(e){var t=this.readString();e.hasOwnProperty(t)||b.Log.warn("readGLEnum: "+t+" enum not found"),e.value=_.GLEnum[t]}},{key:"readObjectMark",value:function(e){var t=this.readString();e.name!==t&&b.Log.warn("AsciiStreamOperator.readObjectMark mismatch: expecting "+e.name+", actual: "+t)}},{key:"readObjectProperty",value:function(e){var t=0,r=this.readString();if(e.mapProperty)t=y.ObjectWrapperManager.getValue(e.name,r);else if(e.name!==r)throw"Unmatched property "+e.name+" != "+r;e.set(t)}}]),r}(g.StreamOperator);r.AsciiStreamOperator=S}).call(this)}).call(this,e("buffer").Buffer)},{m_461:100,o_460:106,C_459:156,"._458":125,e_1:235,s_2:236,m_131:239,C_129:240,M_0:241,o_130:242,buffer:248}],122:[function(e,t,r){(function(t){(function(){"use strict";function n(e){var t=i();return function(){var r,n=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,l.default)(this,r)}}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var a=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.BinaryStreamOperator=void 0;var o=a(e("e_1")),s=a(e("s_2")),u=a(e("C_129")),l=a(e("o_130")),c=a(e("m_131")),f=e("._458"),d=e("m_461"),h=function(e){function r(e,n){var a;return(0,o.default)(this,r),a=i.call(this,"BinaryStreamOperator"),void 0!==t&&e instanceof t&&(e=new Uint8Array(e).buffer),a.supportBinaryBrackets=!1,a.version=-1,a._buffer=e,a._dv=new DataView(e),a._position=n,a._beginPositions=[],a._blockSizes=[],a}(0,u.default)(r,e);var i=n(r);return(0,s.default)(r,[{key:"isBinary",value:function(){return!0}},{key:"advanceToCurrentEndBracket",value:function(){if(this.supportBinaryBrackets&&this._beginPositions.length>0){var e=this._beginPositions.pop();e+=this._blockSizes.pop(),this._position=e}}},{key:"readObjectProperty",value:function(e){var t=0;e.mapProperty&&(t=this.readInt()),e.set(t)}},{key:"readObjectMark",value:function(e){if(this.supportBinaryBrackets)if("{"===e.name)if(this._beginPositions.push(this._position),-1!==this.version&&this.version>148){var t=this.readInt(),r=this.readInt();if(r>Math.pow(2,21))throw"Too high value - size of file. nodeJS can manage 2^53 numbers only";var n=Math.pow(2,32)*r+t;this._blockSizes.push(n)}else{var i=this.readInt();this._blockSizes.push(i)}else"}"===e.name&&this._beginPositions.length>0&&(this._beginPositions.pop(),this._blockSizes.pop())}},{key:"readBool",value:function(){var e=this.readChar().charCodeAt(0);return e>1&&d.Log.warn("found boolean who is not 0 or 1 - "+e+". may indicate failure in reading binary"),0!==e}},{key:"readByte",value:function(){return this._position+=1,this._dv.getInt8(this._position-1)}},{key:"readUByte",value:function(){return this._position+=1,this._dv.getUint8(this._position-1)}},{key:"readShort",value:function(){return this._position+=2,this._dv.getInt16(this._position-2,!0)}},{key:"readUShort",value:function(){return this._position+=2,this._dv.getUint16(this._position-2,!0)}},{key:"readInt",value:function(){return this._position+=4,this._dv.getInt32(this._position-4,!0)}},{key:"readUInt",value:function(){return this._position+=4,this._dv.getUint32(this._position-4,!0)}},{key:"readFloat",value:function(){return this._position+=4,this._dv.getFloat32(this._position-4,!0)}},{key:"readDouble",value:function(){return this._position+=8,this._dv.getFloat64(this._position-8,!0)}},{key:"readChar",value:function(){var e=this.readUByte();return String.fromCharCode(e)}},{key:"readString",value:function(){var e=this.readUInt();this._position+=e;var t=new Uint8Array(this._buffer,this._position-e,e);return String.fromCharCode.apply(null,t)}},{key:"readWrappedString",value:function(){return this.readString()}},{key:"readGLEnum",value:function(e){e.value=this.readUInt()}},{key:"readBuffer",value:function(e){var t=new Uint8Array(this._buffer,this._position,e);return this._position+=e,t}}]),r}(f.StreamOperator);r.BinaryStreamOperator=h}).call(this)}).call(this,e("buffer").Buffer)},{m_461:100,"._458":125,e_1:235,s_2:236,m_131:239,C_129:240,M_0:241,o_130:242,buffer:248}],123:[function(e,t,r){"use strict";function n(e,t){e.inputOperator.readObjectProperty(e.PROPERTY.set(t))}function i(e,t){if(e.typeReaderMap[t])return e.typeReaderMap[t];var r,n="read"+t,i=e.inputOperator[n];if(i&&(r=i.bind(e.inputOperator)),i=e[n],i&&(r=i.bind(e)),r)return e.typeReaderMap[t]=r,r;throw"reader type: "+t+" not found"}function a(e,t){for(var r=[],n=0;n<e;n++)r.push(t());return r}function o(e,t,r,n){var i=e.inputOperator.readInt();e.readBeginBracket();var a={Value:[],Type:r.name,Count:i,ItemSize:n};if(i>0)if(e.isBinary()){var o=r.BYTES_PER_ELEMENT,s=e.inputOperator.readBuffer(i*n*o);s=s.slice().buffer,a.Value=new r(s)}else{a.Value=new r(i*n);for(var u=0,l=0;l<i;l++)for(var c=t(),f=0;f<n;f++)a.Value[u++]=c[f]}return e.readEndBracket(),a}var s=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.InputStream=void 0;var u=s(e("e_1")),l=s(e("s_2"));e("M_473");var c=e("C_459"),f=e("s_475"),d=e("h_476"),h=e("-_477"),p=e("m_461"),m=e("D_479"),v=e("._480"),g=d.Constants.TypeIds,y=function(){function e(t){(0,u.default)(this,e),this.inputOperator=t,this._identifierMap={},this._arrayMap={},this._fields=[],this.typeReaderMap={},this.PROPERTY=new f.DataTypes.ObjectProperty,this.BEGIN_BRACKET=new f.DataTypes.ObjectMark("{",+d.Constants.INDENT_VALUE),this.END_BRACKET=new f.DataTypes.ObjectMark("}",-d.Constants.INDENT_VALUE)}return(0,l.default)(e,[{key:"readObject",value:function(e){var t=this.inputOperator.readString();if("NULL"===t)return null;if(this.readBeginBracket(),n(this,"UniqueID"),!c.ObjectWrapperManager.findWrapper(t))return console.warn(t+": wrapper for class not found"),this.advanceToCurrentEndBracket(),e;var r,i=this.inputOperator.readUInt();return this._identifierMap[i]?(this.advanceToCurrentEndBracket(),r=this._identifierMap[i]):(r=this.readObjectFields(t,i,e),this.advanceToCurrentEndBracket()),r}},{key:"readObjectOfType",value:function(){return this.readObject()}},{key:"readBeginBracket",value:function(){this.inputOperator.readObjectMark(this.BEGIN_BRACKET)}},{key:"readEndBracket",value:function(){this.inputOperator.readObjectMark(this.END_BRACKET)}},{key:"readMatrix",value:function(e){for(var t=i(this,e),r=[],n=0;n<16;n++)r.push(t());return r}},{key:"readPrimitiveSet",value:function(){if(this.getVersion()>=112)return this.readObjectOfType("osg::PrimitiveSet");var e=0,t=null,r=new f.ObjectProperty("PrimitiveType",0,!0),n=new f.ObjectProperty("PrimitiveType",0,!0),i=this.inputOperator;if(i.readObjectProperty(r),i.readObjectProperty(n),this.getVersion()>96&&(e=i.readUInt()),r.value===g.ID_DRAWARRAYS){t={First:i.readInt(),Count:i.readInt(),Mode:n.value,NumInstances:e}}else if(r.value===g.ID_DRAWARRAY_LENGTH){var a=i.readInt(),o=i.readUInt();this.readBeginBracket();var s=Int32Array;if(t={First:a,Mode:n.value,Indices:{ItemSize:1,Type:s.name,Value:[],Count:o},NumInstances:e},this.isBinary())t.Indices.Value=new s(i._buffer,i._position,o),i._position+=o;else{t.Indices.Value=new s(o);for(var u=0;u<o;u++)t.Indices.Value[u]=i.readInt()}this.readEndBracket()}else if(r.value===g.ID_DRAWELEMENTS_UBYTE){var l=Uint8Array,c=i.readUInt();if(t={Mode:n.value,Indices:{ItemSize:1,Type:l.name,Value:[],Count:c},NumInstances:e},this.readBeginBracket(),this.isBinary())t.Indices.Value=new l(i._buffer,i._position,c),i._position+=c;else{t.Indices.Value=new l(c);for(var d=0;d<c;d++)t.Indices.Value[d]=i.readUByte()}this.readEndBracket()}else if(r.value===g.ID_DRAWELEMENTS_USHORT){var h=Uint16Array,p=i.readUInt();if(t={Mode:n.value,Indices:{ItemSize:1,Type:h.name,Value:[],Count:p},NumInstances:e},this.readBeginBracket(),this.isBinary()){var m=h.BYTES_PER_ELEMENT,v=i.readBuffer(p*m);v=v.slice().buffer,t.Indices.Value=new h(v)}else{t.Indices.Value=new h(p);for(var y=0;y<p;y++)t.Indices.Value[y]=i.readUShort()}this.readEndBracket()}else{if(r.value!==g.ID_DRAWELEMENTS_UINT)throw"InputStream.readPrimitiveSet: "+r.value+" ID not found";var _=Uint32Array,b=i.readUInt();if(t={Mode:n.value,Indices:{ItemSize:1,Type:_.name,Value:[],Count:b},NumInstances:e},this.readBeginBracket(),this.isBinary()){var m=_.BYTES_PER_ELEMENT,M=i.readBuffer(b*m);M=M.slice().buffer,t.Indices.Value=new _(M)}else{t.Indices.Value=new _(b);for(var x=0;x<b;x++)t.Indices.Value[x]=i.readUInt()}this.readEndBracket()}return t}},{key:"readProperty",value:function(e){return n(this,e)}},{key:"readVectorOfType",value:function(e,t){return a(e,i(this,t))}},{key:"readArray",value:function(){var e=this,t=null;n(this,"ArrayID");var r=this.inputOperator,s=r.readUInt("ArrayID");if(this._arrayMap[s])return this._arrayMap[s];var u=new f.ObjectProperty("ArrayType",0,!0);r.readObjectProperty(u);var l=r,c=1;if(u.value===g.ID_BYTE_ARRAY)t=o(e,function(){return l.readByte()},Int8Array,c);else if(u.value===g.ID_UBYTE_ARRAY)t=o(e,function(){return l.readUByte()},Uint8Array,c);else if(u.value===g.ID_SHORT_ARRAY)t=o(e,function(){return l.readShort()},Int16Array,c);else if(u.value===g.ID_USHORT_ARRAY)t=o(e,function(){return l.readUShort()},Uint16Array,c);else if(u.value===g.ID_INT_ARRAY)t=o(e,function(){return l.readInt()},Int32Array,c);else if(u.value===g.ID_UINT_ARRAY)t=o(e,function(){return l.readUInt()},Uint32Array,c);else if(u.value===g.ID_FLOAT_ARRAY)t=o(e,function(){return l.readFloat()},Float32Array,c);else if(u.value===g.ID_DOUBLE_ARRAY)t=o(e,function(){return l.readDouble()},Float64Array,c);else if(u.value===g.ID_VEC2B_ARRAY){c=2;var d=i(e,"Byte");t=o(e,function(){return a(2,d)},Int8Array,c)}else if(u.value===g.ID_VEC3B_ARRAY){c=3;var h=i(e,"Byte");t=o(e,function(){return a(3,h)},Int8Array,c)}else if(u.value===g.ID_VEC4B_ARRAY){c=4;var p=i(e,"Byte");t=o(e,function(){return a(4,p)},Int8Array,c)}else if(u.value===g.ID_VEC2UB_ARRAY){c=2;var m=i(e,"UByte");t=o(e,function(){return a(2,m)},Uint8Array,c)}else if(u.value===g.ID_VEC3UB_ARRAY){c=3;var v=i(e,"UByte");t=o(e,function(){return a(3,v)},Uint8Array,c)}else if(u.value===g.ID_VEC4UB_ARRAY){c=4;var y=i(e,"UByte");t=o(e,function(){return a(4,y)},Uint8Array,c)}else if(u.value===g.ID_VEC2S_ARRAY){c=2;var _=i(e,"Short");t=o(e,function(){return a(2,_)},Int16Array,c)}else if(u.value===g.ID_VEC3S_ARRAY){c=3;var b=i(e,"Short");t=o(e,function(){return a(3,b)},Int16Array,c)}else if(u.value===g.ID_VEC4S_ARRAY){c=4;var M=i(e,"Short");t=o(e,function(){return a(4,M)},Int16Array,c)}else if(u.value===g.ID_VEC2US_ARRAY){c=2;var x=i(e,"UShort");t=o(e,function(){return a(2,x)},Uint16Array,c)}else if(u.value===g.ID_VEC3US_ARRAY){c=3;var w=i(e,"UShort");t=o(e,function(){return a(3,w)},Uint16Array,c)}else if(u.value===g.ID_VEC4US_ARRAY){c=4;var S=i(e,"UShort");t=o(e,function(){return a(4,S)},Uint16Array,c)}else if(u.value===g.ID_VEC2_ARRAY){c=2;var T=i(e,"Float");t=o(e,function(){return a(2,T)},Float32Array,c)}else if(u.value===g.ID_VEC3_ARRAY){c=3;var C=i(e,"Float");t=o(e,function(){return a(3,C)},Float32Array,c)}else if(u.value===g.ID_VEC4_ARRAY){c=4;var E=i(e,"Float");t=o(e,function(){return a(4,E)},Float32Array,c)}else if(u.value===g.ID_VEC2D_ARRAY){c=2;var A=i(e,"Double");t=o(e,function(){return a(2,A)},Float64Array,c)}else if(u.value===g.ID_VEC3D_ARRAY){c=3;var L=i(e,"Double");t=o(e,function(){return a(3,L)},Float64Array,c)}else if(u.value===g.ID_VEC4D_ARRAY){c=4;var P=i(e,"Double");t=o(e,function(){return a(4,P)},Float64Array,c)}else if(u.value===g.ID_VEC2I_ARRAY){c=2;var O=i(e,"Int");t=o(e,function(){return a(2,O)},Int32Array,c)}else if(u.value===g.ID_VEC3I_ARRAY){c=3;var R=i(e,"Int");t=o(e,function(){return a(3,R)},Int32Array,c)}else if(u.value===g.ID_VEC4I_ARRAY){c=4;var I=i(e,"Int");t=o(e,function(){return a(4,I)},Int32Array,c)}else if(u.value===g.ID_VEC2UI_ARRAY){c=2;var D=i(e,"UInt");t=o(e,function(){return a(2,D)},Uint32Array,c)}else if(u.value===g.ID_VEC3UI_ARRAY){c=3;var B=i(e,"UInt");t=o(e,function(){return a(3,B)},Uint32Array,c)}else{if(u.value!==g.ID_VEC4UI_ARRAY)throw"InputStream.readArray(): Unsupported array type.";c=4;var U=i(e,"UInt");t=o(e,function(){return a(4,U)},Uint32Array,c)}return this._arrayMap[s]=t,t}},{key:"getVersion",value:function(){return this.inputOperator.version}},{key:"advanceToCurrentEndBracket",value:function(){this.inputOperator.advanceToCurrentEndBracket()}},{key:"isBinary",value:function(){return this.inputOperator.isBinary()}},{key:"readObjectFields",value:function(e,t,r){var n=this,i=c.ObjectWrapperManager.findWrapper(e);if(!i)return console.warn(e+": wrapper for class not found"),void this.advanceToCurrentEndBracket();var a=this.inputOperator.version,o=r||i.createInstance();return this._identifierMap[t]=o,i.associates.forEach(function(e){if(e.minVersion<=a&&e.maxVersion>=a){var t=c.ObjectWrapperManager.findWrapper(e.name);t?(n._fields.push(t.getName()),t.read(n,o),n._fields.pop()):p.Log.warn(e.name+": wrapper for associate not found. continuing to next associate")}}),o}},{key:"readImage",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this,r=t.inputOperator;t.getVersion()>94&&(n(t,"ClassName"),r.readString()),n(t,"UniqueID");var i=r.readUInt();if(t._identifierMap[i])return t._identifierMap[i];n(t,"FileName");var a=r.readWrappedString();n(t,"WriteHint");var o=(r.readInt(),r.readInt()),s=null;if(0===o)if(this.isBinary()){var u=r.readInt(),l=r.readInt(),c=r.readInt(),f=r.readInt(),d=r.readInt(),g=r.readInt(),y=r.readInt(),_=(r.readInt(),r.readInt(),r.readUInt());if(_>0){var b=r.readBuffer(_);s=new h.Image,s.setProperty("ImageType",v.ImageType.IMAGE_INLINE_DATA),s.setProperty("Origin",u),s.setImage(l,c,f,d,g,y,b,1)}for(var M=r.readUInt(),x=[],w=0;w<M;w++)x.push(r.readUInt());s&&M>0&&s.setProperty("Levels",x),e=!1}else{n(t,"Origin");var S=r.readInt();n(t,"Size");var T=r.readInt(),C=r.readInt(),E=r.readInt();n(t,"InternalTextureFormat");var A=r.readInt();n(t,"PixelFormat");var L=r.readInt();n(t,"DataType");var P=r.readInt();n(t,"Packing");var O=r.readInt();n(t,"AllocationMode"),n(t,"Data");var R=r.readUInt()-1;t.readBeginBracket();for(var I=[],D=0;D<=R;D++)I.push(r.readWrappedString());var B=[];m.Base64Encoder.decodeArray(I,B),B.pop(),t.readEndBracket(),s=new h.Image,s.setProperty("ImageType",v.ImageType.IMAGE_INLINE_DATA),s.setProperty("Origin",S),s.setImage(T,C,E,A,L,P,data,mode,O),R>0&&s.setProperty("Levels",B),e=!1}else if(1===o&&t.isBinary()){var U=r.readUInt(),N=r.readBuffer(U);s=new h.Image,s.setProperty("ImageType",v.ImageType.IMAGE_INLINE_FILE),s.setProperty("Data",N),e=!1}return e&&""!==a&&(s=new h.Image,s.setProperty("ImageType",v.ImageType.IMAGE_EXTERNAL),s.FileName=a,p.Log.warn("InputStream,readImage - reading from external file - not implemented")),s=t.readObjectFields("osg::Object",i,s),s.setProperty("Name",a),s.setProperty("WriteHint",a),t._identifierMap[i]=s,s}}]),e}();r.InputStream=y},{D_479:97,h_476:98,s_475:99,m_461:100,"._480":107,"-_477":133,C_459:156,M_473:178,e_1:235,s_2:236,M_0:241}],124:[function(require,module,exports){(function(Buffer){(function(){"use strict";function readBuffer(e){void 0!==Buffer&&e instanceof Buffer&&(e=new Uint8Array(e).buffer);var t=new _BinaryStreamOperator.BinaryStreamOperator(e,0),r=t.readUInt(),n=t.readUInt();t._position=0;var i=e.byteLength>=OSGT_HEADER.length;if(i){var a=t.readBuffer(OSGT_HEADER.length);i=String.fromCharCode.apply(null,a)===OSGT_HEADER}var o,s,u;if(r===OSG_HEADER_LOW&&n===OSG_HEADER_HIGH){t._position=8;var l;o=t.readUInt(),s=t.readUInt();var c=t.readUInt();u=0!=(1&c),0!=(2&c),l=0!=(4&c),t.supportBinaryBrackets=l;if("0"!==t.readString())throw"compresses data not supported"}else{if(!i)return console.warn("osg-serializer-js: osg format not supported. use  `parseOsg` instead"),!1;(0,_Log.Log)("OSGT File"),t=new _AsciiStreamOperator.AsciiStreamOperator(e,OSGT_HEADER.length),o=t.readString(),t.goToNextRow(),o=WriteType["WRITE_"+o.toUpperCase()]||0,t.readObjectProperty(PROPERTY.set("#Version")),s=t.readUInt(),t.goToNextRow(),t.readObjectProperty(PROPERTY.set("#Generator")),t.readString(),t.goToNextRow(),u="#CustomDomain"===t.lookForward()}if(u)throw new Error("osg DomainVersion not supported.");t.version=s;var f=new _InputStream.InputStream(t),d=(new Date).getTime(),h=f.readObject();return(0,_Log.Log)("timeElapsed:",(new Date).getTime()-d),h}function readFile(path,cb){if(!cb)throw"Call back required";var req="require",fs=eval(req+"('fs');");fs.readFile(path,function(e,t){e&&cb(e);var r;try{console.log(e,t),r=readBuffer(t)}catch(e){return console.trace(e),cb(e)}if(!r)return cb("Failed to convert file");cb(null,r)})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.readBuffer=readBuffer,exports.readFile=readFile;var _InputStream=require("C_481"),_DataTypes=require("s_475"),_BinaryStreamOperator=require("m_483"),_AsciiStreamOperator=require("M_484"),_Log=require("m_461"),PROPERTY=new _DataTypes.DataTypes.ObjectProperty,OSG_HEADER_LOW=1821445793,OSG_HEADER_HIGH=452674885,OSGT_HEADER="#Ascii",WriteType={WRITE_UNKNOWN:0,WRITE_SCENE:1,WRITE_IMAGE:2,WRITE_OBJECT:3}}).call(this)}).call(this,require("buffer").Buffer)},{s_475:99,m_461:100,M_484:121,m_483:122,C_481:123,buffer:248}],125:[function(e,t,r){"use strict";function n(e,t){throw"function "+t+" Not Implemented in "+e}var i=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.StreamOperator=void 0;var a=i(e("e_1")),o=i(e("s_2")),s=function(){function e(t){(0,a.default)(this,e),this.name=t}return(0,o.default)(e,[{key:"readChar",value:function(){n(this.name,"readChar")}},{key:"readUByte",value:function(){n(this.name,"readUByte")}},{key:"readByte",value:function(){n(this.name,"readByte")}},{key:"readShort",value:function(){n(this.name,"readShort")}},{key:"readUShort",value:function(){n(this.name,"readUShort")}},{key:"readInt",value:function(){n(this.name,"readInt")}},{key:"readUInt",value:function(){n(this.name,"readUInt")}},{key:"readBool",value:function(){n(this.name,"readBool")}},{key:"readString",value:function(){n(this.name,"readString")}},{key:"readObjectProperty",value:function(e){n(this.name,"readObjectProperty")}},{key:"readObjectMark",value:function(e){n(this.name,"readObjectMark")}},{key:"advanceToCurrentEndBracket",value:function(){n(this.name,"advanceToCurrentEndBracket")}},{key:"isBinary",value:function(){n(this.name,"isBinary")}},{key:"readWrappedString",value:function(){n(this.name,"readWrappedString")}},{key:"readGLEnum",value:function(e){n(this.name,"readGLenum")}},{key:"readFloat",value:function(){n(this.name,"readFloat")}},{key:"readDouble",value:function(){n(this.name,"readDouble")}},{key:"readBuffer",value:function(e){n(this.name,"readBuffer")}}]),e}();r.StreamOperator=s},{e_1:235,s_2:236,M_0:241}],126:[function(e,t,r){"use strict";function n(e){var t=i();return function(){var r,n=(0,l.default)(e);if(t){var i=(0,l.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,u.default)(this,r)}}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var a=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.BufferData=void 0;var o=a(e("e_1")),s=a(e("C_129")),u=a(e("o_130")),l=a(e("m_131")),c=e("m_494"),f=function(e){function t(){return(0,o.default)(this,t),r.call(this)}(0,s.default)(t,e);var r=n(t);return t}(c.ObjectClass);r.BufferData=f},{m_494:138,e_1:235,m_131:239,C_129:240,M_0:241,o_130:242}],127:[function(e,t,r){"use strict";function n(e){var t=i();return function(){var r,n=(0,l.default)(e);if(t){var i=(0,l.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,u.default)(this,r)}}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var a=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.CullFace=void 0;var o=a(e("e_1")),s=a(e("C_129")),u=a(e("o_130")),l=a(e("m_131")),c=e("3_500"),f=e("D_501"),d=function(e){function t(){var e;return(0,o.default)(this,t),e=r.call(this),e.Type="osg::CullFace",e.Mode=f.FaceMode.BACK,e}(0,s.default)(t,e);var r=n(t);return t}(c.StateAttribute);r.CullFace=d},{D_501:104,"3_500":142,e_1:235,m_131:239,C_129:240,M_0:241,o_130:242}],128:[function(e,t,r){"use strict";function n(e){var t=i();return function(){var r,n=(0,l.default)(e);if(t){var i=(0,l.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,u.default)(this,r)}}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var a=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.DefaultUserDataContainer=void 0;var o=a(e("e_1")),s=a(e("C_129")),u=a(e("o_130")),l=a(e("m_131")),c=e("e_507"),f=function(e){function t(){var e;return(0,o.default)(this,t),e=r.call(this),e.Type="Osg::DefaultUserDataContainer",e}(0,s.default)(t,e);var r=n(t);return t}(c.UserDataContainer);r.DefaultUserDataContainer=f},{e_507:147,e_1:235,m_131:239,C_129:240,M_0:241,o_130:242}],129:[function(e,t,r){"use strict";function n(e){var t=i();return function(){var r,n=(0,l.default)(e);if(t){var i=(0,l.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,u.default)(this,r)}}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var a=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.Drawable=void 0;var o=a(e("e_1")),s=a(e("C_129")),u=a(e("o_130")),l=a(e("m_131")),c=e("._513"),f=function(e){function t(){var e;return(0,o.default)(this,t),e=r.call(this),e.InitialBound=null,e.BoundingBox=null,e.Shape=null,e.SupportsDisplayList=!0,e.UseDisplayList=!0,e.UseVertexBufferObjects=!1,e.Type="osg::Drawable",e}(0,s.default)(t,e);var r=n(t);return t}(c.Node);r.Drawable=f},{"._513":137,e_1:235,m_131:239,C_129:240,M_0:241,o_130:242}],130:[function(e,t,r){"use strict";function n(e){var t=i();return function(){var r,n=(0,l.default)(e);if(t){var i=(0,l.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,u.default)(this,r)}}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var a=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.Geode=void 0;var o=a(e("e_1")),s=a(e("C_129")),u=a(e("o_130")),l=a(e("m_131")),c=e("s_519"),f=function(e){function t(){var e;return(0,o.default)(this,t),e=r.call(this),e.Type="Osg::Geode",e}(0,s.default)(t,e);var r=n(t);return t}(c.Group);r.Geode=f},{s_519:132,e_1:235,m_131:239,C_129:240,M_0:241,o_130:242}],131:[function(e,t,r){"use strict";function n(e){var t=i();return function(){var r,n=(0,l.default)(e);if(t){var i=(0,l.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,u.default)(this,r)}}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var a=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.Geometry=void 0;var o=a(e("e_1")),s=a(e("C_129")),u=a(e("o_130")),l=a(e("m_131")),c=e("C_525"),f=function(e){function t(){var e;return(0,o.default)(this,t),e=r.call(this),e.Type="Osg::Geometry",e.InitialBound=null,e.BoundingBox=null,e.PrimitiveSetList=[],e.TexCoordArray=[],e.VertexAttribArray=[],e}(0,s.default)(t,e);var r=n(t);return t}(c.Drawable);r.Geometry=f},{C_525:129,e_1:235,m_131:239,C_129:240,M_0:241,o_130:242}],132:[function(e,t,r){"use strict";function n(e){var t=i();return function(){var r,n=(0,l.default)(e);if(t){var i=(0,l.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,u.default)(this,r)}}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var a=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.Group=void 0;var o=a(e("e_1")),s=a(e("C_129")),u=a(e("o_130")),l=a(e("m_131")),c=e("._513"),f=function(e){function t(){var e;return(0,o.default)(this,t),e=r.call(this),e.Children=[],e.Type="Osg::Group",e}(0,s.default)(t,e);var r=n(t);return t}(c.Node);r.Group=f},{"._513":137,e_1:235,m_131:239,C_129:240,M_0:241,o_130:242}],133:[function(e,t,r){"use strict";function n(e){var t=i();return function(){var r,n=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,l.default)(this,r)}}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var a=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.Image=void 0;var o=a(e("e_1")),s=a(e("s_2")),u=a(e("C_129")),l=a(e("o_130")),c=a(e("m_131")),f=e("m_538"),d=function(e){function t(){var e;return(0,o.default)(this,t),e=r.call(this),e.S=0,e.T=0,e.R=0,e.InternalTextureFormat=0,e.PixelFormat=0,e.DataType=0,e.Data=null,e.Mode=0,e.Packing=1,e.RowLength=0,e.Origin=0,e.FileName="",e.Levels=null,e.WriteHint=null,e.Type="Osg::Image",e.FromExternal=!1,e}(0,u.default)(t,e);var r=n(t);return(0,s.default)(t,[{key:"setImage",value:function(e,t,r,n,i,a,o,s){var u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,l=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0;this.S=e,this.T=t,this.R=r,this.InternalTextureFormat=n,this.PixelFormat=i,this.DataType=a,this.Data=o,this.Packing=u,this.Mode=s,this.RowLength=l}}]),t}(f.BufferData);r.Image=d},{m_538:126,e_1:235,s_2:236,m_131:239,C_129:240,M_0:241,o_130:242}],134:[function(e,t,r){"use strict";function n(e){var t=i();return function(){var r,n=(0,l.default)(e);if(t){var i=(0,l.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,u.default)(this,r)}}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var a=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.LOD=void 0;var o=a(e("e_1")),s=a(e("C_129")),u=a(e("o_130")),l=a(e("m_131")),c=e("._513"),f=e("D_545"),d=e("._546"),h=function(e){function t(){var e;return(0,o.default)(this,t),e=r.call(this),e.CenterMode=f.CenterMode.USE_BOUNDING_SPHERE_CENTER,e.RangeMode=d.RangeMode.DISTANCE_FROM_EYE_POINT,e.UserCenter={center:[],radius:0},e.RangeList=[],e.Type="Osg::LOD",e}(0,s.default)(t,e);var r=n(t);return t}(c.Node);r.LOD=h},{D_545:103,"._546":112,"._513":137,e_1:235,m_131:239,C_129:240,M_0:241,o_130:242}],135:[function(e,t,r){"use strict";function n(e){var t=i();return function(){var r,n=(0,l.default)(e);if(t){var i=(0,l.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,u.default)(this,r)}}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var a=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.Material=void 0;var o=a(e("e_1")),s=a(e("C_129")),u=a(e("o_130")),l=a(e("m_131")),c=e("3_500"),f=function(e){function t(){var e;return(0,o.default)(this,t),e=r.call(this),e.AmbientFrontAndBack=!0,e.AmbientFront=null,e.AmbientBack=null,e.DiffuseFrontAndBack=!0,e.DiffuseFront=null,e.DiffuseBack=null,e.SpecularFrontAndBack=!0,e.SpecularFront=null,e.SpecularBack=null,e.EmissionFrontAndBack=!0,e.EmissionFront=null,e.EmissionBack=null,e.ShininessFrontAndBack=!0,e.ShininessFront=0,e.ShininessBack=0,e.Type="Osg::Material",e}(0,s.default)(t,e);var r=n(t);return t}(c.StateAttribute);r.Material=f},{"3_500":142,e_1:235,m_131:239,C_129:240,M_0:241,o_130:242}],136:[function(e,t,r){"use strict";function n(e){var t=i();return function(){var r,n=(0,l.default)(e);if(t){var i=(0,l.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,u.default)(this,r)}}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var a=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.MatrixTransform=void 0;var o=a(e("e_1")),s=a(e("C_129")),u=a(e("o_130")),l=a(e("m_131")),c=e("C_558"),f=function(e){function t(){var e;return(0,o.default)(this,t),e=r.call(this),e.Type="Osg::MatrixTransform",e.Matrix=null,e}(0,s.default)(t,e);var r=n(t);return t}(c.Transform);r.MatrixTransform=f},{C_558:146,e_1:235,m_131:239,C_129:240,M_0:241,o_130:242}],137:[function(e,t,r){"use strict";function n(e){var t=i();return function(){var r,n=(0,l.default)(e);if(t){var i=(0,l.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,u.default)(this,r)}}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var a=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.Node=void 0;var o=a(e("e_1")),s=a(e("C_129")),u=a(e("o_130")),l=a(e("m_131")),c=e("m_494"),f=function(e){function t(){var e;return(0,o.default)(this,t),e=r.call(this),e.CullingActive=!0,e.NodeMask=4294967295,e.Descriptions=[],e.InitialBound=null,e.StateSet=null,e.Type="Osg::Node",e}(0,s.default)(t,e);var r=n(t);return t}(c.ObjectClass);r.Node=f},{m_494:138,e_1:235,m_131:239,C_129:240,M_0:241,o_130:242}],138:[function(e,t,r){"use strict";var n=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.ObjectClass=void 0;var i=n(e("e_1")),a=n(e("s_2")),o=e("m_461"),s=function(){function e(){(0,i.default)(this,e),this.Name="",this.DataVariance=null,this.UserDataContainer=null,this.Type="Osg::Object"}return(0,a.default)(e,[{key:"setProperty",value:function(e,t){void 0===this[e]&&o.Log.warn("setProperty: "+this.Type+"."+e+" have not been defined"),this[e]=t}},{key:"getProperty",value:function(e){return void 0===this[e]&&o.Log.warn("getProperty: "+this.Type+"."+e+" have not been defined"),this[e]}}]),e}();r.ObjectClass=s},{m_461:100,e_1:235,s_2:236,M_0:241}],139:[function(e,t,r){"use strict";function n(e){var t=i();return function(){var r,n=(0,l.default)(e);if(t){var i=(0,l.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,u.default)(this,r)}}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1
;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var a=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.OsgArray=void 0;var o=a(e("e_1")),s=a(e("C_129")),u=a(e("o_130")),l=a(e("m_131")),c=e("m_538"),f=function(e){function t(){var e;return(0,o.default)(this,t),e=r.call(this),e.Binding=null,e.Normalize=!1,e}(0,s.default)(t,e);var r=n(t);return t}(c.BufferData);r.OsgArray=f},{m_538:126,e_1:235,m_131:239,C_129:240,M_0:241,o_130:242}],140:[function(e,t,r){"use strict";function n(e){var t=i();return function(){var r,n=(0,l.default)(e);if(t){var i=(0,l.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,u.default)(this,r)}}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var a=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.PagedLOD=void 0;var o=a(e("e_1")),s=a(e("C_129")),u=a(e("o_130")),l=a(e("m_131")),c=e("C_580"),f=function(e){function t(){var e;return(0,o.default)(this,t),e=r.call(this),e.DatabasePath="",e.FileNames=[],e.PriorityOffset=[],e.PriorityScale=[],e.FrameNumberOfLastTraversal=0,e.NumChildrenThatCannotBeExpired=0,e.DisableExternalChildrenPaging=!1,e.Children=[],e.Type="Osg::PagedLOD",e}(0,s.default)(t,e);var r=n(t);return t}(c.LOD);r.PagedLOD=f},{C_580:134,e_1:235,m_131:239,C_129:240,M_0:241,o_130:242}],141:[function(e,t,r){"use strict";function n(e){var t=i();return function(){var r,n=(0,l.default)(e);if(t){var i=(0,l.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,u.default)(this,r)}}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var a=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.ShadeModel=void 0;var o=a(e("e_1")),s=a(e("C_129")),u=a(e("o_130")),l=a(e("m_131")),c=e("3_500"),f=function(e){function t(){var e;return(0,o.default)(this,t),e=r.call(this),e.Mode=null,e.Type="Osg::ShadeModel",e}(0,s.default)(t,e);var r=n(t);return t}(c.StateAttribute);r.ShadeModel=f},{"3_500":142,e_1:235,m_131:239,C_129:240,M_0:241,o_130:242}],142:[function(e,t,r){"use strict";function n(e){var t=i();return function(){var r,n=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,l.default)(this,r)}}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var a=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.StateAttribute=void 0;var o=a(e("e_1")),s=a(e("s_2")),u=a(e("C_129")),l=a(e("o_130")),c=a(e("m_131")),f=e("m_494"),d=function(e){function t(){var e;return(0,o.default)(this,t),e=r.call(this),e.Type="Osg::StateAttribute",e}(0,u.default)(t,e);var r=n(t);return(0,s.default)(t,[{key:"getMember",value:function(){return 0}},{key:"getTypeMemberPair",value:function(){return{type:this.Type,member:this.getMember()}}}]),t}(f.ObjectClass);r.StateAttribute=d},{m_494:138,e_1:235,s_2:236,m_131:239,C_129:240,M_0:241,o_130:242}],143:[function(e,t,r){"use strict";function n(e){var t=i();return function(){var r,n=(0,l.default)(e);if(t){var i=(0,l.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,u.default)(this,r)}}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var a=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.StateSet=void 0;var o=a(e("e_1")),s=a(e("C_129")),u=a(e("o_130")),l=a(e("m_131")),c=e("m_494"),f=e("D_600"),d=e("._601"),h=function(e){function t(){var e;return(0,o.default)(this,t),e=r.call(this),e.ModeList=[],e.AttributeList=[],e.TextureModeList=[],e.TextureAttributeList=[],e.UniformList=[],e.RenderingHint=f.RenderingHint.DEFAULT_BIN,e.RenderBinMode=d.RenderBinMode.INHERIT_RENDERBIN_DETAILS,e.BinNumber=0,e.BinName="",e.NestRenderBins=!0,e.DefineList={},e.Type="Osg::StateSet",e}(0,s.default)(t,e);var r=n(t);return t}(c.ObjectClass);r.StateSet=h},{"._601":115,D_600:116,m_494:138,e_1:235,m_131:239,C_129:240,M_0:241,o_130:242}],144:[function(e,t,r){"use strict";function n(e){var t=i();return function(){var r,n=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,l.default)(this,r)}}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var a=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.Texture=void 0;var o=a(e("e_1")),s=a(e("s_2")),u=a(e("C_129")),l=a(e("o_130")),c=a(e("m_131")),f=e("3_500"),d=e("-_609"),h=function(e){function t(){var e;return(0,o.default)(this,t),e=r.call(this),e.InternalFormatMode=0,e.InternalFormat=0,e.Type="Osg::Texture",e}(0,u.default)(t,e);var r=n(t);return(0,s.default)(t,[{key:"computeInternalFormatType",value:function(){}},{key:"setInternalFormat",value:function(e){this.InternalFormatMode=d.InternalFormatMode.USE_USER_DEFINED_FORMAT,this.InternalFormat=e,computeInternalFormatType()}}]),t}(f.StateAttribute);r.Texture=h},{"-_609":117,"3_500":142,e_1:235,s_2:236,m_131:239,C_129:240,M_0:241,o_130:242}],145:[function(e,t,r){"use strict";function n(e){var t=i();return function(){var r,n=(0,l.default)(e);if(t){var i=(0,l.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,u.default)(this,r)}}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var a=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.Texture2D=void 0;var o=a(e("e_1")),s=a(e("C_129")),u=a(e("o_130")),l=a(e("m_131")),c=e("m_615"),f=function(e){function t(){var e;return(0,o.default)(this,t),e=r.call(this),e.Image=null,e.TextureWidth=0,e.TextureHeight=0,e.Type="Osg::Texture2D",e}(0,s.default)(t,e);var r=n(t);return t}(c.Texture);r.Texture2D=f},{m_615:144,e_1:235,m_131:239,C_129:240,M_0:241,o_130:242}],146:[function(e,t,r){"use strict";function n(e){var t=i();return function(){var r,n=(0,l.default)(e);if(t){var i=(0,l.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,u.default)(this,r)}}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var a=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.Transform=void 0;var o=a(e("e_1")),s=a(e("C_129")),u=a(e("o_130")),l=a(e("m_131")),c=e("s_519"),f=function(e){function t(){var e;return(0,o.default)(this,t),e=r.call(this),e.Type="Osg::Transform",e.ReferenceFrame=0,e}(0,s.default)(t,e);var r=n(t);return t}(c.Group);r.Transform=f},{s_519:132,e_1:235,m_131:239,C_129:240,M_0:241,o_130:242}],147:[function(e,t,r){"use strict";function n(e){var t=i();return function(){var r,n=(0,l.default)(e);if(t){var i=(0,l.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,u.default)(this,r)}}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var a=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.UserDataContainer=void 0;var o=a(e("e_1")),s=a(e("C_129")),u=a(e("o_130")),l=a(e("m_131")),c=e("m_494"),f=function(e){function t(){var e;return(0,o.default)(this,t),e=r.call(this),e.DescriptionList=[],e.ObjectList=[],e.UserData=null,e.Type="Osg::UserDataContainer",e}(0,s.default)(t,e);var r=n(t);return t}(c.ObjectClass);r.UserDataContainer=f},{m_494:138,e_1:235,m_131:239,C_129:240,M_0:241,o_130:242}],148:[function(e,t,r){"use strict";var n=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.Associate=void 0;var i=n(e("e_1")),a=function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,i.default)(this,e),this.name=t,this.minVersion=r.minVersion||0,this.maxVersion=r.maxVersion||1e8};r.Associate=a},{e_1:235,M_0:241}],149:[function(e,t,r){"use strict";var n=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.BaseSerializer=void 0;var i=n(e("e_1")),a=n(e("s_2")),o=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,i.default)(this,e),this._options=r,this._name=t}return(0,a.default)(e,[{key:"getName",value:function(){return this._name}},{key:"getMinVersion",value:function(){return this._options.minVersion||0}},{key:"getMaxVersion",value:function(){return this._options.maxVersion||1e9}},{key:"read",value:function(e,t){throw"BaseSerializer.read not implemented"}}]),e}();r.BaseSerializer=o},{e_1:235,s_2:236,M_0:241}],150:[function(e,t,r){"use strict";function n(e){var t=i();return function(){var r,n=(0,f.default)(e);if(t){var i=(0,f.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,c.default)(this,r)}}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function a(e){var t={};return Object.keys(e).forEach(function(r){var n=e[r];t[n]&&d.Log.warn("EnumSerializer: Duplicate value: "+t[n]+", "+r),t[n]=r}),t}var o=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.EnumSerializer=void 0;var s=o(e("e_1")),u=o(e("s_2")),l=o(e("C_129")),c=o(e("o_130")),f=o(e("m_131")),d=e("m_461"),h=e("s_640"),p=function(e){function t(e,n,i,o){var u;return(0,s.default)(this,t),u=r.call(this,e,o),u._defaultValue=i,u._enumMap=n,u._reverseMap=a(n),u}(0,l.default)(t,e);var r=n(t);return(0,u.default)(t,[{key:"read",value:function(e,t){if(e.isBinary()){var r=e.inputOperator.readInt();this._reverseMap.hasOwnProperty(r)||(d.Log.warn("EnumSerializer: failed to find ENUM value "+r+" for serializer "+this.getName()+". Setting to default value."),r=this._defaultValue),t.setProperty(this.getName(),r)}else if(e.inputOperator.matchString(this.getName())){var n=e.inputOperator.readString(),i=this._enumMap[n];this._enumMap.hasOwnProperty(n)||(d.Log.warn("EnumSerializer: failed to find ENUM key "+n+" for serializer "+this.getName()+". Setting to default value."),i=this._defaultValue),t.setProperty(this.getName(),i)}}}]),t}(h.BaseSerializer);r.EnumSerializer=p},{m_461:100,s_640:149,e_1:235,s_2:236,m_131:239,C_129:240,M_0:241,o_130:242}],151:[function(e,t,r){"use strict";function n(e){var t=i();return function(){var r,n=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,l.default)(this,r)}}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var a=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.ImageSerializer=void 0;var o=a(e("e_1")),s=a(e("s_2")),u=a(e("C_129")),l=a(e("o_130")),c=a(e("m_131")),f=e("s_640"),d=function(e){function t(e,n,i){var a;return(0,o.default)(this,t),a=r.call(this,e,i),a._defaultValue=n,a}(0,u.default)(t,e);var r=n(t);return(0,s.default)(t,[{key:"read",value:function(e,t){if(e.isBinary()){if(e.inputOperator.readBool()){var r=this.getName(),n=e.readImage();t.setProperty(r,n)}}else if(e.inputOperator.matchString(this.getName())){var i=e.inputOperator.readBool();i&&(e.readBeginBracket(),t.setProperty(this.getName(),e.readImage()),e.readEndBracket())}}}]),t}(f.BaseSerializer);r.ImageSerializer=d},{s_640:149,e_1:235,s_2:236,m_131:239,C_129:240,M_0:241,o_130:242}],152:[function(e,t,r){"use strict";function n(e){var t=i();return function(){var r,n=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,l.default)(this,r)}}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var a=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.MatrixSerializer=void 0;var o=a(e("e_1")),s=a(e("s_2")),u=a(e("C_129")),l=a(e("o_130")),c=a(e("m_131")),f=e("s_640"),d=function(e){function t(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,o.default)(this,t),n=r.call(this,e,i),n._type=i.type||"Double",n}(0,u.default)(t,e);var r=n(t);return(0,s.default)(t,[{key:"read",value:function(e,t){var r=[];e.isBinary()?e.readMatrix(this._type):e.inputOperator.matchString(this.getName())&&e.readMatrix(this._type),r&&t.setProperty(this.getName(),r)}}]),t}(f.BaseSerializer);r.MatrixSerializer=d},{s_640:149,e_1:235,s_2:236,m_131:239,C_129:240,M_0:241,o_130:242}],153:[function(e,t,r){"use strict";function n(e){var t=i();return function(){var r,n=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,l.default)(this,r)}}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var a=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.ObjectCallbackSerializer=void 0;var o=a(e("e_1")),s=a(e("s_2")),u=a(e("C_129")),l=a(e("o_130")),c=a(e("m_131")),f=e("s_640"),d=function(e){function t(e,n){return(0,o.default)(this,t),r.call(this,e,n)}(0,u.default)(t,e);var r=n(t);return(0,s.default)(t,[{key:"read",value:function(e,t){var r=!1;if(e.isBinary()?r=e.inputOperator.readBool():e.inputOperator.matchString(this.getName())&&(r=e.inputOperator.readBool()),r)throw"callback object serializing is NOT SUPPORTED - property: "+this.getName()}}]),t}(f.BaseSerializer);r.ObjectCallbackSerializer=d},{s_640:149,e_1:235,s_2:236,m_131:239,C_129:240,M_0:241,o_130:242}],154:[function(e,t,r){"use strict";function n(e){var t=i();return function(){var r,n=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,l.default)(this,r)}}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var a=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.ObjectSerializer=void 0;var o=a(e("e_1")),s=a(e("s_2")),u=a(e("C_129")),l=a(e("o_130")),c=a(e("m_131")),f=e("s_640"),d=function(e){function t(e,n,i){var a;return(0,o.default)(this,t),a=r.call(this,e,i),a._defaultValue=n,a}(0,u.default)(t,e);var r=n(t);return(0,s.default)(t,[{key:"read",value:function(e,t){if(e.isBinary()){e.inputOperator.readBool()&&(t[this._name]=e.readObjectOfType())}else if(e.inputOperator.matchString(this._name)){var r=e.inputOperator.readBool();r&&(e.readBeginBracket(),t[this._name]=e.readObjectOfType(),e.readEndBracket())}}}]),t}(f.BaseSerializer);r.ObjectSerializer=d},{s_640:149,e_1:235,s_2:236,m_131:239,C_129:240,M_0:241,o_130:242}],155:[function(e,t,r){"use strict";var n=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.ObjectWrapper=void 0;var i=n(e("e_1")),a=n(e("s_2")),o=e("e_672"),s=e("m_461"),u=function(){function e(t,r,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};(0,i.default)(this,e),this._name=t,this._typeCtor=n,this.associates=r.map(function(e){return"string"==typeof e?new o.Associate(e):e}),this._serializers=a.serializers||[]}return(0,a.default)(e,[{key:"read",value:function(e,t){var r=this,n=e.getVersion();this._serializers.forEach(function(i){if(i.getMinVersion()<=n&&n<=i.getMaxVersion())try{i.read(e,t)}catch(e){throw e.stack&&(e=e.toString()+"\n"+e.stack),s.Log.fatal(e),"ObjectWrapper.read: Error reading property "+r._name+"."+i.getName()}})}},{key:"addSerializer",value:function(e){this._serializers.push(e)}},{key:"createInstance",value:function(){var e=this._typeCtor;return e?new e:null}},{key:"getName",value:function(){return this._name}}]),e}();r.ObjectWrapper=u},{m_461:100,e_672:148,e_1:235,s_2:236,M_0:241}],156:[function(e,t,r){"use strict";function n(e){return function(t,r){if(wrapperObject=u[e],!wrapperObject)throw"ObjectWrapperManager.readWrapperObject : "+e}}Object.defineProperty(r,"__esModule",{value:!0}),r.ObjectWrapperManager=void 0;var i=e("o_460"),a=e("-_675"),o=e("3_676"),s={ArrayType:a.ArrayTableEnum,PrimitiveType:o.PrimitiveTableEnum,GL:i.GLEnum},u={},l={getValue:function(e,t){return(s[e]||i.GLEnum)[t]},findWrapper:function(e){return u[e]},addWrapper:function(e){var t=e.getName();u[t]=e},readWrapperObject:n};r.ObjectWrapperManager=l},{"-_675":101,o_460:106,"3_676":111}],157:[function(e,t,r){"use strict";function n(e){var t=i();return function(){var r,n=(0,f.default)(e);if(t){var i=(0,f.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,c.default)(this,r)}}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function a(e,t){var r="read"+t,n=e[r];if(!n)throw new Error("reader type: "+t+" not found");return n.bind(e)}var o=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.PropByValSerializer=void 0;var s=o(e("e_1")),u=o(e("s_2")),l=o(e("C_129")),c=o(e("o_130")),f=o(e("m_131")),d=e("s_640"),h={HEXINT:"UInt",GLInt:"Int"},p={Vec4d:{size:4,type:"Double"}},m=function(e){function t(e,n,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return(0,s.default)(this,t),a=r.call(this,n,o),a._defaultValue=i,a._useHex=!1,a._vectorSize=0,p[e]?(a._vectorSize=p[e].size,a._type=p[e].type):h[e]?(a._type=h[e],a._useHex=!0):a._type=e,a}(0,l.default)(t,e);var r=n(t);return(0,u.default)(t,[{key:"read",value:function(e,t){var r;if(this._vectorSize>0)r=e.readVectorOfType(this._vectorSize,this._type);else if(e.isBinary()){var n=a(e.inputOperator,this._type);r=n()}else if(e.inputOperator.matchString(this._name))if(this._useHex)r=e.inputOperator.readHex();else{var i=a(e.inputOperator,this._type);r=i()}t.setProperty(this._name,r)}}]),t}(d.BaseSerializer);r.PropByValSerializer=m},{s_640:149,e_1:235,s_2:236,m_131:239,C_129:240,M_0:241,o_130:242}],158:[function(e,t,r){"use strict";function n(e){var t=i();return function(){var r,n=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,l.default)(this,r)}}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var a=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.UserSerializer=void 0;var o=a(e("e_1")),s=a(e("s_2")),u=a(e("C_129")),l=a(e("o_130")),c=a(e("m_131")),f=e("s_640"),d=function(e){function t(e,n,i){var a;return(0,o.default)(this,t),a=r.call(this,e,i),a._reader=n,a}(0,u.default)(t,e);var r=n(t);return(0,s.default)(t,[{key:"read",value:function(e,t){if(e.isBinary()){if(!e.inputOperator.readBool())return}else if(!e.inputOperator.matchString(this.getName()))return;this._reader(e,t)}}]),t}(f.BaseSerializer);r.UserSerializer=d},{s_640:149,e_1:235,s_2:236,m_131:239,C_129:240,M_0:241,o_130:242}],159:[function(e,t,r){"use strict";function n(e){var t=i();return function(){var r,n=(0,f.default)(e);if(t){var i=(0,f.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,c.default)(this,r)}}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function a(e,t){var r="read"+t,n=e.inputOperator[r];if(n)return n.bind(e.inputOperator);if(n=e[r])return n.bind(e);throw"reader type: "+t+" not found"}var o=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.VectorSerializer=void 0;var s=o(e("e_1")),u=o(e("s_2")),l=o(e("C_129")),c=o(e("o_130")),f=o(e("m_131")),d=e("s_640"),h=function(e){function t(e,n,i){var a;return(0,s.default)(this,t),a=r.call(this,e,i),a._type=n,a}(0,l.default)(t,e);var r=n(t);return(0,u.default)(t,[{key:"read",value:function(e,t){var r=a(e,this._type),n=[];if(e.isBinary())for(var i=e.inputOperator.readUInt(),o=0;o<i;o++)n.push(r());else if(e.inputOperator.matchString(this.getName())){var s=e.inputOperator.readUInt();if(s>0){e.readBeginBracket();for(var u=0;u<s;u++)n.push(r());e.readEndBracket()}}n.length>0&&t.setProperty(this._name,n)}}]),t}(d.BaseSerializer);r.VectorSerializer=h},{s_640:149,e_1:235,s_2:236,m_131:239,C_129:240,M_0:241,o_130:242}],160:[function(e,t,r){"use strict";var n=e("C_459"),i=e("D_699"),a=e("._700"),o=e("C_701"),s=e("D_501"),u=new a.ObjectWrapper("osg::CullFace",["osg::Object","osg::StateAttribute","osg::CullFace"],o.CullFace);u.addSerializer(new i.EnumSerializer("Mode",s.FaceMode,s.FaceMode.BACK)),n.ObjectWrapperManager.addWrapper(u)},{D_501:104,C_701:127,D_699:150,"._700":155,C_459:156}],161:[function(e,t,r){"use strict";function n(){throw"InitialBound not yet implemented"}var i=e("C_459"),a=e("M_704"),o=e("e_705"),s=e("s_706"),u=e("h_707"),l=e("._700"),c=e("3_709"),f=e("D_710"),d=new l.ObjectWrapper("osg::Drawable",["osg::Object",new c.Associate("osg::Node",{minVersion:154}),"osg::Drawable"],f.Drawable);d.addSerializer(new a.ObjectSerializer("StateSet",null)),d.addSerializer(new o.UserSerializer("InitialBound",n)),d.addSerializer(new s.ObjectCallbackSerializer("ComputeBoundingBoxCallback")),d.addSerializer(new a.ObjectSerializer("Shape",null)),d.addSerializer(new u.PropByValSerializer("Bool","SupportsDisplayList",!0)),d.addSerializer(new u.PropByValSerializer("Bool","UseDisplayList",!0)),d.addSerializer(new u.PropByValSerializer("Bool","UseVertexBufferObjects",!1)),d.addSerializer(new s.ObjectCallbackSerializer("UpdateCallback")),d.addSerializer(new s.ObjectCallbackSerializer("EventCallback")),d.addSerializer(new s.ObjectCallbackSerializer("CullCallback")),d.addSerializer(new s.ObjectCallbackSerializer("DrawCallback")),d.addSerializer(new u.PropByValSerializer("HEXINT","NodeMask",4294967295,{minVersion:142})),d.addSerializer(new u.PropByValSerializer("Bool","CullingActive",!0,{minVersion:145})),i.ObjectWrapperManager.addWrapper(d)},{D_710:129,"3_709":148,s_706:153,M_704:154,"._700":155,C_459:156,h_707:157,e_705:158}],162:[function(e,t,r){"use strict";function n(e,t){var r=e.inputOperator.readUInt();e.readBeginBracket();for(var n=0;n<r;n++){var i=e.readObjectOfType("osg::Drawable");i&&t.Children.push(i)}e.readEndBracket()}var i=e("C_459"),a=e("e_705"),o=e("._700"),s=e("m_714"),u=new o.ObjectWrapper("osg::Geode",["osg::Object","osg::Node","osg::Geode"],s.Geode);u.addSerializer(new a.UserSerializer("Drawables",n)),i.ObjectWrapperManager.addWrapper(u)},{m_714:130,"._700":155,C_459:156,e_705:158}],163:[function(e,t,r){"use strict";function n(e){var t=0;if(e.isBinary())t=e.inputOperator.readInt();else{var r=e.inputOperator.readString();t=g.AttributeBinding[r]}return t}function i(e){var t=new p.OsgArray;if(e.readProperty("Array"),e.inputOperator.readBool()&&(t=e.readArray()),e.readProperty("Indices"),e.inputOperator.readBool()){var r=e.readArray();r&&(t.UserDataContainer||(t.UserDataContainer=new v.DefaultUserDataContainer),t.UserDataContainer.UserData=r)}return e.readProperty("Binding"),t.Binding=n(e),e.readProperty("Normalize"),t.Normalize=0!==e.inputOperator.readInt(),t}function a(e){return function(t,r){t.readBeginBracket();var n=i(t);r.setProperty(e,n),t.readEndBracket()}}function o(e){return function(t,r){var n=t.inputOperator.readUInt();t.readBeginBracket();for(var a=[],o=0;o<n;o++){t.readProperty("Data"),t.readBeginBracket();var s=i(t);a.push(s),t.readEndBracket()}t.readEndBracket(),r.setProperty(e,a),t.readEndBracket()}}function s(e,t){if(!e.isBinary())return e.inputOperator.readBool()}var u=e("C_459"),l=e("e_716"),c=e("M_704"),f=e("e_705"),d=e("._700"),h=e("3_720"),p=e("D_721"),m=e("3_709"),v=e("C_723"),g=e("o_724"),y=new d.ObjectWrapper("osg::Geometry",["osg::Object",new m.Associate("osg::Node",{minVersion:154}),"osg::Drawable","osg::Geometry"],h.Geometry);y.addSerializer(new l.VectorSerializer("PrimitiveSetList","PrimitiveSet")),y.addSerializer(new f.UserSerializer("VertexData",a("VertexArray"),{maxVersion:111})),y.addSerializer(new f.UserSerializer("NormalData",a("NormalArray"),{maxVersion:111})),y.addSerializer(new f.UserSerializer("ColorData",a("ColorArray"),{maxVersion:111})),y.addSerializer(new f.UserSerializer("SecondaryColorData",a("SecondaryColorArray"),{maxVersion:111})),y.addSerializer(new f.UserSerializer("FogCoordData",a("FogCoordArray"),{maxVersion:111})),y.addSerializer(new f.UserSerializer("TexCoordData",o("TexCoordArray"),{maxVersion:111})),y.addSerializer(new f.UserSerializer("VertexAttribData",o("VertexAttribArray"),{maxVersion:111})),y.addSerializer(new f.UserSerializer("FastPathHint ",s,{maxVersion:111})),y.addSerializer(new c.ObjectSerializer("VertexArray",null,{minVersion:112})),y.addSerializer(new c.ObjectSerializer("NormalArray",null,{minVersion:112})),y.addSerializer(new c.ObjectSerializer("ColorArray",null,{minVersion:112})),y.addSerializer(new c.ObjectSerializer("SecondaryColorArray",null,{minVersion:112})),y.addSerializer(new c.ObjectSerializer("FogCoordArray",null,{minVersion:112})),y.addSerializer(new l.VectorSerializer("TexCoordArrayList","Array",{minVersion:112})),y.addSerializer(new l.VectorSerializer("VertexAttribArrayList","Array",{minVersion:112})),u.ObjectWrapperManager.addWrapper(y)},{o_724:102,C_723:128,"3_720":131,D_721:139,"3_709":148,M_704:154,"._700":155,C_459:156,e_705:158,e_716:159}],164:[function(e,t,r){"use strict";function n(e,t){var r=e.inputOperator.readUInt();e.readBeginBracket();for(var n=0;n<r;n++){var i=e.readObject();i&&t.Children.push(i)}e.readEndBracket()}var i=e("C_459"),a=e("e_705"),o=e("._700"),s=e("s_728"),u=new o.ObjectWrapper("osg::Group",["osg::Object","osg::Node","osg::Group"],s.Group);u.addSerializer(new a.UserSerializer("Children",n)),i.ObjectWrapperManager.addWrapper(u)},{s_728:132,"._700":155,C_459:156,e_705:158}],165:[function(e,t,r){"use strict";function n(e,t){var r=e.inputOperator.readUInt();e.readBeginBracket();for(var n=[],i=0;i<r;i++){var a=e.inputOperator.readFloat(),o=e.inputOperator.readFloat();n.push([a,o])}e.readEndBracket(),t.setProperty("RangeList",n)}function i(e,t){var r=e.readVectorOfType(3,"Double"),n=e.inputOperator.readDouble();t.setProperty("UserCenter",{center:r,radius:n})}var a=e("C_459"),o=e("e_705"),s=e("D_699"),u=e("._700"),l=e("._733"),c=e("D_545"),f=e("._546"),d=new u.ObjectWrapper("osg::LOD",["osg::Object","osg::Node","osg::LOD"],l.LOD);d.addSerializer(new s.EnumSerializer("CenterMode",c.CenterMode,c.CenterMode.USE_BOUNDING_SPHERE_CENTER)),d.addSerializer(new o.UserSerializer("UserCenter",i)),d.addSerializer(new s.EnumSerializer("RangeMode",f.RangeMode,f.RangeMode.DISTANCE_FROM_EYE_POINT)),d.addSerializer(new o.UserSerializer("RangeList",n)),a.ObjectWrapperManager.addWrapper(d)},{D_545:103,"._546":112,"._733":134,D_699:150,"._700":155,C_459:156,e_705:158}],166:[function(e,t,r){"use strict";function n(e,t){function r(r,n){var i;if("Float"===t)i=r.inputOperator.readFloat.bind(r.inputOperator);else{if("Vec4f"!==t)throw"serializeMaterial - type not supported";i=function(){return r.readVectorOfType(4,"Float")}}var a=r.inputOperator.readBool();r.readProperty("Front");var o=i();r.readProperty("Back");var s=i();a?(n[e+"FrontAndBack"]=!0,n[e+"Front"]=o,n[e+"Back"]=o):(n[e+"FrontAndBack"]=!1,n[e+"Front"]=o,n[e+"Back"]=s)}return r}var i=e("C_459"),a=e("D_699"),o=e("e_705"),s=e("._700"),u=e("h_740"),l=e("-_741"),c=new s.ObjectWrapper("osg::Material",["osg::Object","osg::StateAttribute","osg::Material"],u.Material);c.addSerializer(new a.EnumSerializer("ColorMode",l.ColorMode,l.ColorMode.OFF)),c.addSerializer(new o.UserSerializer("Ambient",n("Ambient","Vec4f"))),c.addSerializer(new o.UserSerializer("Diffuse",n("Diffuse","Vec4f"))),c.addSerializer(new o.UserSerializer("Specular",n("Specular","Vec4f"))),c.addSerializer(new o.UserSerializer("Emission",n("Emission","Vec4f"))),c.addSerializer(new o.UserSerializer("Shininess",n("Shininess","Float"))),i.ObjectWrapperManager.addWrapper(c)},{"-_741":108,h_740:135,D_699:150,"._700":155,C_459:156,e_705:158}],167:[function(e,t,r){"use strict";var n=e("C_459"),i=e("D_743"),a=e("._700"),o=e("C_745"),s=new a.ObjectWrapper("osg::MatrixTransform",["osg::Object","osg::Node","osg::Group","osg::Transform","osg::MatrixTransform"],o.MatrixTransform);s.addSerializer(new i.MatrixSerializer("Mode")),n.ObjectWrapperManager.addWrapper(s)},{C_745:136,D_743:152,"._700":155,C_459:156}],168:[function(e,t,r){"use strict";function n(e,t){var r,n;e.readBeginBracket(),e.readProperty("Center"),r=e.readVectorOfType(3,"Double"),e.readProperty("Radius"),n=e.inputOperator.readDouble(),e.readEndBracket(),t.InitialBound={center:r,radius:n}}function i(e,t){for(var r=e.inputOperator.readUInt(),n=0;n<r;++n){var i=e.inputOperator.readWrappedString();t.descriptions.push(i)}e.readEndBracket()}var a=e("C_459"),o=e("s_706"),s=e("M_704"),u=e("e_705"),l=e("h_707"),c=e("._700"),f=e("-_752"),d=new c.ObjectWrapper("osg::Node",["osg::Object","osg::Node"],f.Node);d.addSerializer(new u.UserSerializer("InitialBound",n)),d.addSerializer(new o.ObjectCallbackSerializer("ComputeBoundingSphereCallback")),d.addSerializer(new o.ObjectCallbackSerializer("UpdateCallback")),d.addSerializer(new o.ObjectCallbackSerializer("EventCallback")),d.addSerializer(new o.ObjectCallbackSerializer("CullCallback")),d.addSerializer(new l.PropByValSerializer("Bool","CullingActive",!0)),d.addSerializer(new l.PropByValSerializer("HEXINT","NodeMask",4294967295)),d.addSerializer(new u.UserSerializer("Descriptions",i,{maxVersion:76})),d.addSerializer(new s.ObjectSerializer("StateSet",null)),a.ObjectWrapperManager.addWrapper(d)},{"-_752":137,s_706:153,M_704:154,"._700":155,C_459:156,h_707:157,e_705:158}],169:[function(e,t,r){"use strict";function n(){throw"UserDataReader not yet supported"}var i=e("C_459"),a=e("D_699"),o=e("M_704"),s=e("e_705"),u=e("h_707"),l=e("._700"),c=e("M_759"),f=e("e_760"),d=new l.ObjectWrapper("osg::Object",["osg::Object"],c.ObjectClass);d.addSerializer(new u.PropByValSerializer("String","Name","")),d.addSerializer(new a.EnumSerializer("DataVariance",f.ObjectDataVariance,f.ObjectDataVariance.UNSPECIFIED)),
d.addSerializer(new s.UserSerializer("UserData",n,{maxVersion:76})),d.addSerializer(new o.ObjectSerializer("UserDataContainer",null,{minVersion:77})),i.ObjectWrapperManager.addWrapper(d)},{e_760:109,M_759:138,D_699:150,M_704:154,"._700":155,C_459:156,h_707:157,e_705:158}],170:[function(e,t,r){"use strict";function n(e,t){var r=[],n=[],i=[],a=e.inputOperator.readUInt();e.readBeginBracket();for(var o=0;o<a;o++){var s=e.inputOperator.readWrappedString();r.push(s)}e.readEndBracket(),e.readProperty("PriorityList"),a=e.inputOperator.readUInt(),e.readBeginBracket();for(var u=0;u<a;u++)n.push(e.inputOperator.readFloat()),i.push(e.inputOperator.readFloat());e.readEndBracket(),t.setProperty("RangeDataList",r),t.setProperty("PriorityOffsets",n),t.setProperty("PriorityScales",i)}function i(e,t){var r=e.inputOperator.readUInt();if(r>0){var n=[];e.readBeginBracket();for(var i=0;i<r;i++){var a=e.readObjectOfType("osg::Node");a&&n.push(a)}e.readEndBracket(),t.setProperty("Children",n)}}function a(e,t){var r,n=e.inputOperator.readBool();n&&(r=e.inputOperator.readWrappedString(),t.setProperty("DatabasePath",r))}var o=e("C_459"),s=e("e_705"),u=e("h_707"),l=e("._700"),c=e("D_765"),f=new l.ObjectWrapper("osg::PagedLOD",["osg::Object","osg::Node","osg::LOD","osg::PagedLOD"],c.PagedLOD);f.addSerializer(new s.UserSerializer("DatabasePath",a)),f.addSerializer(new u.PropByValSerializer("UInt","FrameNumberOfLastTraversal",0,{maxVersion:69})),f.addSerializer(new u.PropByValSerializer("UInt","NumChildrenThatCannotBeExpired",0)),f.addSerializer(new u.PropByValSerializer("Bool","DisableExternalChildrenPaging",!1)),f.addSerializer(new s.UserSerializer("RangeDataList",n)),f.addSerializer(new s.UserSerializer("Children",i)),o.ObjectWrapperManager.addWrapper(f)},{D_765:140,"._700":155,C_459:156,h_707:157,e_705:158}],171:[function(e,t,r){"use strict";var n=e("C_459"),i=e("D_699"),a=e("._700"),o=e("m_769"),s=e("M_770"),u=new a.ObjectWrapper("osg::ShadeModel",["osg::Object","osg::StateAttribute","osg::ShadeModel"],o.ShadeModel);u.addSerializer(new i.EnumSerializer("Mode",s.ShadeModelMode,s.ShadeModelMode.SMOOTH)),n.ObjectWrapperManager.addWrapper(u)},{M_770:113,m_769:141,D_699:150,"._700":155,C_459:156}],172:[function(e,t,r){"use strict";var n=e("C_459"),i=e("s_706"),a=e("._700"),o=e("-_774"),s=new a.ObjectWrapper("osg::StateAttribute",["osg::Object","osg::StateAttribute"],o.StateAttribute);s.addSerializer(new i.ObjectCallbackSerializer("UpdateCallback")),s.addSerializer(new i.ObjectCallbackSerializer("EventCallback")),n.ObjectWrapperManager.addWrapper(s)},{"-_774":142,s_706:153,"._700":155,C_459:156}],173:[function(e,t,r){"use strict";function n(e,t){Array.prototype.push.apply(e,t)}function i(e){var t=e.inputOperator.readUInt(),r=[];if(t>0){e.readBeginBracket();for(var n=0;n<t;n++){var i=new w.DataTypes.ObjectGLEnum;e.inputOperator.readGLEnum(i),r.push({key:i.value,value:o(e)})}e.readEndBracket()}return r}function a(e){var t=[],r=e.inputOperator.readUInt();if(r>0){e.readBeginBracket();for(var n=0;n<r;n++){var i=e.readObjectOfType("osg::StateAttribute");e.readProperty("Value");var a=o(e);i&&t.push({key:i.getTypeMemberPair(),value:{StateAttribute:i,Value:a}})}e.readEndBracket()}return t}function o(e){if(e.isBinary())return e.inputOperator.readInt();var t=e.inputOperator.readString(),r=0;return t.indexOf("OFF")>=0&&(r=x.StateAttributeValue.OFF),t.indexOf("ON")>=0&&(r=x.StateAttributeValue.ON),t.indexOf("OVERRIDE")>=0&&(r|=x.StateAttributeValue.OVERRIDE),t.indexOf("PROTECTED")>=0&&(r|=x.StateAttributeValue.PROTECTED),t.indexOf("INHERIT")>=0&&(r|=x.StateAttributeValue.INHERIT),r}function s(e,t){var r=i(e);return n(t.ModeList,r),!0}function u(e,t){var r=a(e);n(t.AttributeList,r)}function l(e,t){var r=e.inputOperator.readUInt();e.readBeginBracket();for(var a=0;a<r;a++)e.readProperty("Data"),n(t.TextureModeList,i(e));e.readEndBracket()}function c(e,t){var r=e.inputOperator.readUInt();e.readBeginBracket();for(var i=0;i<r;i++)e.readProperty("Data"),n(t.TextureAttributeList,a(e));e.readEndBracket()}function f(e,t){var r=e.inputOperator.readUInt();e.readBeginBracket();for(var n=0;n<r;n++){var i=e.inputOperator.readWrappedString(),a=e.inputOperator.readWrappedString();e.inputOperator.readObjectProperty(e.PROPERTY.set("Value"));var s=o(e);t.DefineList[i]={DefineValue:a,OverrideValue:s}}e.readEndBracket()}function d(e,t){var r=e.inputOperator.readUInt();e.readBeginBracket();for(var n=0;n<r;n++){var i=e.readObjectOfType("osg::Uniform");e.inputOperator.readObjectProperty(e.PROPERTY.set("Value"));var a=o(e);i&&t.UniformList.push({Uniform:i,Value:a})}e.readEndBracket()}var h=e("C_459"),p=e("e_705"),m=e("D_699"),v=e("h_707"),g=e("s_706"),y=e("._700"),_=e("M_781"),b=e("D_600"),M=e("._601"),x=e("h_784"),w=e("s_475"),S=new y.ObjectWrapper("osg::StateSet",["osg::Object","osg::StateSet"],_.StateSet);S.addSerializer(new p.UserSerializer("ModeList",s)),S.addSerializer(new p.UserSerializer("AttributeList",u)),S.addSerializer(new p.UserSerializer("TextureModeList",l)),S.addSerializer(new p.UserSerializer("TextureAttributeList",c)),S.addSerializer(new p.UserSerializer("UniformList",d)),S.addSerializer(new v.PropByValSerializer("Int","RenderingHint",b.RenderingHint.DEFAULT_BIN)),S.addSerializer(new m.EnumSerializer("RenderBinMode",M.RenderBinMode,M.RenderBinMode.DEFAULT_BIN)),S.addSerializer(new v.PropByValSerializer("Int","BinNumber",0)),S.addSerializer(new v.PropByValSerializer("String","BinName","")),S.addSerializer(new v.PropByValSerializer("Bool","NestRenderBins",!0)),S.addSerializer(new g.ObjectCallbackSerializer("UpdateCallback")),S.addSerializer(new g.ObjectCallbackSerializer("EventCallback")),S.addSerializer(new p.UserSerializer("DefineList",f,{minVersion:151})),h.ObjectWrapperManager.addWrapper(S)},{s_475:99,h_784:114,"._601":115,D_600:116,M_781:143,D_699:150,s_706:153,"._700":155,C_459:156,h_707:157,e_705:158}],174:[function(e,t,r){"use strict";function n(e,t){var r=new p.ObjectGLEnum;e.inputOperator.readGLEnum(r),t.getProperty("InternalFormatMode")===f.InternalFormatMode.USE_USER_DEFINED_FORMAT&&t.setInternalFormat(r.value)}function i(e){return function(t,r){var n=new p.ObjectGLEnum;t.inputOperator.readGLEnum(n),r.setProperty(e,n)}}function a(e,t){for(var r=e.inputOperator.readString(),n=[],i=0;i<4;i++)n.push(y[r.charAt(i)]);t.setProperty("Swizzle",n)}function o(e){e.inputOperator.readUInt(),e.inputOperator.readInt(),e.inputOperator.readBool(),e.inputOperator.readInt(),e.inputOperator.readInt(),e.inputOperator.readInt()}var s=e("e_705"),u=e("h_707"),l=e("D_699"),c=e("C_789"),f=e("-_609"),d=e("m_791"),h=e("M_792"),p=e("s_475"),m=e("._700"),v=e("C_459"),g=new m.ObjectWrapper("osg::Texture",["osg::Object","osg::StateAttribute","osg::Texture"],c.Texture),y={R:6403,G:6404,B:6405,A:6406,0:0,1:1};g.addSerializer(new s.UserSerializer("WRAP_S",i("WrapS"))),g.addSerializer(new s.UserSerializer("WRAP_T",i("WrapT"))),g.addSerializer(new s.UserSerializer("WRAP_R",i("WrapR"))),g.addSerializer(new s.UserSerializer("MIN_FILTER",i("MinFilter"))),g.addSerializer(new s.UserSerializer("MAG_FILTER",i("MagFilter"))),g.addSerializer(new u.PropByValSerializer("Float","MaxAnisotropy",1)),g.addSerializer(new u.PropByValSerializer("Bool","UseHardwareMipMapGeneration",!0)),g.addSerializer(new u.PropByValSerializer("Bool","UnRefImageDataAfterApply",!1)),g.addSerializer(new u.PropByValSerializer("Bool","ClientStorageHint",!1)),g.addSerializer(new u.PropByValSerializer("Bool","ResizeNonPowerOfTwoHint",!0)),g.addSerializer(new u.PropByValSerializer("Vec4d","BorderColor",[0,0,0,0],{minVersion:79})),g.addSerializer(new u.PropByValSerializer("GLInt","BorderWidth",0,{minVersion:79})),g.addSerializer(new l.EnumSerializer("InternalFormatMode",f.InternalFormatMode,f.InternalFormatMode.USE_IMAGE_DATA_FORMAT,{minVersion:79})),g.addSerializer(new s.UserSerializer("InternalFormat",n,{minVersion:79})),g.addSerializer(new s.UserSerializer("SourceFormat",i("SourceFormat"),{minVersion:79})),g.addSerializer(new s.UserSerializer("SourceType",i("SourceType"),{minVersion:79})),g.addSerializer(new u.PropByValSerializer("Bool","ShadowComparison",!1,{minVersion:79})),g.addSerializer(new l.EnumSerializer("ShadowCompareFunc",d.ShadowCompareFunc,d.ShadowCompareFunc.LEQUAL,{minVersion:79})),g.addSerializer(new l.EnumSerializer("ShadowTextureMode",h.ShadowTextureMode,h.ShadowTextureMode.LUMINANCE,{minVersion:79})),g.addSerializer(new u.PropByValSerializer("Float","ShadowAmbient",0,{minVersion:79})),g.addSerializer(new s.UserSerializer("ImageAttachment",o,{minVersion:95,maxVersion:152})),g.addSerializer(new s.UserSerializer("Swizzle",a,{minVersion:98})),g.addSerializer(new u.PropByValSerializer("Float","MinLOD",0,{minVersion:155})),g.addSerializer(new u.PropByValSerializer("Float","MaxLOD",-1,{minVersion:155})),g.addSerializer(new u.PropByValSerializer("Float","LODBias",0,{minVersion:155})),v.ObjectWrapperManager.addWrapper(g)},{s_475:99,"-_609":117,m_791:118,M_792:119,C_789:144,D_699:150,"._700":155,C_459:156,h_707:157,e_705:158}],175:[function(e,t,r){"use strict";var n=e("C_459"),i=e("h_707"),a=e("D_798"),o=e("._700"),s=e("C_800"),u=new o.ObjectWrapper("osg::Texture2D",["osg::Object","osg::StateAttribute","osg::Texture","osg::Texture2D"],s.Texture2D);u.addSerializer(new a.ImageSerializer("Image",null)),u.addSerializer(new i.PropByValSerializer("Int","TextureWidth",0)),u.addSerializer(new i.PropByValSerializer("Int","TextureHeight",0)),n.ObjectWrapperManager.addWrapper(u)},{C_800:145,D_798:151,"._700":155,C_459:156,h_707:157}],176:[function(e,t,r){"use strict";var n=e("C_459"),i=e("D_699"),a=e("._700"),o=e("e_804"),s=e("s_805"),u=new a.ObjectWrapper("osg::Transform",["osg::Object","osg::Node","osg::Group","osg::Transform"],o.Transform);u.addSerializer(new i.EnumSerializer("Mode",s.ReferenceFrame,s.ReferenceFrame.RELATIVE_RF)),n.ObjectWrapperManager.addWrapper(u)},{s_805:120,e_804:146,D_699:150,"._700":155,C_459:156}],177:[function(e,t,r){"use strict";function n(e,t){e.readBeginBracket(),t.UserData=e.readObject(),e.readEndBracket()}function i(e,t){var r=e.inputOperator.readUInt();e.readBeginBracket();for(var n=0;n<r;n++){var i=e.inputOperator.readWrappedString();t.DescriptionList.push(i)}e.readEndBracket()}function a(e,t){var r=e.inputOperator.readUInt();e.readBeginBracket();for(var n=0;n<r;n++){var i=e.inputOperator.readWrappedString();t.ObjectList.push(i)}e.readEndBracket()}var o=e("C_459"),s=e("e_705"),u=e("._700"),l=e("C_723"),c=new u.ObjectWrapper("osg::UserDataContainer",["osg::Object","osg::UserDataContainer"],null),f=new u.ObjectWrapper("osg::DefaultUserDataContainer",["osg::Object","osg::UserDataContainer","osg::DefaultUserDataContainer"],l.DefaultUserDataContainer);f.addSerializer(new s.UserSerializer("UDC_UserData",n)),f.addSerializer(new s.UserSerializer("UDC_Descriptions",i)),f.addSerializer(new s.UserSerializer("UDC_UserObjects",a)),o.ObjectWrapperManager.addWrapper(f),o.ObjectWrapperManager.addWrapper(c)},{C_723:128,"._700":155,C_459:156,e_705:158}],178:[function(e,t,r){"use strict";e("._810"),e("C_525"),e("o_812"),e("m_813"),e("s_519"),e("e_815"),e("s_816"),e("._513"),e("m_494"),e("3_819"),e("3_500"),e("._821"),e("m_615"),e("o_823"),e("C_558"),e("e_507"),e("C_580"),e("s_827")},{"._810":160,C_525:161,o_812:162,m_813:163,s_519:164,C_580:165,e_815:166,s_816:167,"._513":168,m_494:169,s_827:170,"3_819":171,"3_500":172,"._821":173,m_615:174,o_823:175,C_558:176,e_507:177}],179:[function(e,t,r){"use strict";function n(e,t){t&&t(e);var r=e.Children;if(r&&r.length)for(var i=0;i<r.length;i++){var a=r[i];n(a,t)}}Object.defineProperty(r,"__esModule",{value:!0}),r.traverse=n,Object.defineProperty(r,"RenderBinMode",{enumerable:!0,get:function(){return i.RenderBinMode}}),Object.defineProperty(r,"ShadowTextureMode",{enumerable:!0,get:function(){return a.ShadowTextureMode}}),Object.defineProperty(r,"FaceMode",{enumerable:!0,get:function(){return o.FaceMode}}),Object.defineProperty(r,"ColorMode",{enumerable:!0,get:function(){return s.ColorMode}}),Object.defineProperty(r,"StateAttributeValue",{enumerable:!0,get:function(){return u.StateAttributeValue}}),Object.defineProperty(r,"RenderingHint",{enumerable:!0,get:function(){return l.RenderingHint}}),Object.defineProperty(r,"ReferenceFrame",{enumerable:!0,get:function(){return c.ReferenceFrame}}),Object.defineProperty(r,"InternalFormatMode",{enumerable:!0,get:function(){return f.InternalFormatMode}}),Object.defineProperty(r,"PrimitiveMode",{enumerable:!0,get:function(){return d.PrimitiveMode}}),Object.defineProperty(r,"GLEnum",{enumerable:!0,get:function(){return h.GLEnum}}),Object.defineProperty(r,"AttributeBinding",{enumerable:!0,get:function(){return p.AttributeBinding}}),Object.defineProperty(r,"ShadeModelMode",{enumerable:!0,get:function(){return m.ShadeModelMode}}),Object.defineProperty(r,"CenterMode",{enumerable:!0,get:function(){return v.CenterMode}}),Object.defineProperty(r,"RangeMode",{enumerable:!0,get:function(){return g.RangeMode}}),Object.defineProperty(r,"ImageType",{enumerable:!0,get:function(){return _.ImageType}}),Object.defineProperty(r,"Log",{enumerable:!0,get:function(){return b.Log}}),Object.defineProperty(r,"readBuffer",{enumerable:!0,get:function(){return M.readBuffer}}),Object.defineProperty(r,"readFile",{enumerable:!0,get:function(){return M.readFile}}),Object.defineProperty(r,"EnumToString",{enumerable:!0,get:function(){return x.EnumToString}}),Object.defineProperty(r,"Node",{enumerable:!0,get:function(){return w.Node}}),Object.defineProperty(r,"Group",{enumerable:!0,get:function(){return S.Group}}),Object.defineProperty(r,"Drawable",{enumerable:!0,get:function(){return T.Drawable}}),Object.defineProperty(r,"Image",{enumerable:!0,get:function(){return C.Image}}),Object.defineProperty(r,"Geode",{enumerable:!0,get:function(){return E.Geode}}),Object.defineProperty(r,"OsgArray",{enumerable:!0,get:function(){return A.OsgArray}}),Object.defineProperty(r,"MatrixTransform",{enumerable:!0,get:function(){return L.MatrixTransform}}),Object.defineProperty(r,"Material",{enumerable:!0,get:function(){return P.Material}}),Object.defineProperty(r,"StateAttribute",{enumerable:!0,get:function(){return O.StateAttribute}}),Object.defineProperty(r,"Texture2D",{enumerable:!0,get:function(){return R.Texture2D}}),Object.defineProperty(r,"Texture",{enumerable:!0,get:function(){return I.Texture}}),Object.defineProperty(r,"StateSet",{enumerable:!0,get:function(){return D.StateSet}}),Object.defineProperty(r,"ObjectClass",{enumerable:!0,get:function(){return B.ObjectClass}}),Object.defineProperty(r,"Geometry",{enumerable:!0,get:function(){return U.Geometry}}),r.PrimitiveTable=void 0;var i=e("h_828"),a=e("-_829"),o=e("3_830"),s=e("D_831"),u=e("._832"),l=e("C_833"),c=e("o_834"),f=e("m_835"),d=e("M_836"),h=e("e_837"),p=e("s_838"),m=e("h_839"),v=e("-_840"),g=e("3_841"),y=e("D_842"),_=e("._843"),b=e("C_844"),M=e("o_845"),x=e("m_846"),w=e("M_847"),S=e("e_848"),T=e("s_849"),C=e("h_850"),E=e("-_851"),A=e("3_852"),L=e("D_853"),P=e("._854"),O=e("C_855"),R=e("o_856"),I=e("m_857"),D=e("M_858"),B=e("e_859"),U=e("s_860"),N=y.PrimitiveTableEnum;r.PrimitiveTable=N},{C_844:100,s_838:102,"-_840":103,"3_830":104,m_846:105,e_837:106,"._843":107,D_831:108,M_836:110,D_842:111,"3_841":112,h_839:113,"._832":114,h_828:115,C_833:116,m_835:117,"-_829":119,o_834:120,o_845:124,s_849:129,"-_851":130,s_860:131,e_848:132,h_850:133,"._854":135,D_853:136,M_847:137,e_859:138,"3_852":139,C_855:142,M_858:143,m_857:144,o_856:145}],180:[function(e,t,r){"use strict";function n(e){var t=i();return function(){var r,n=(0,h.default)(e);if(t){var i=(0,h.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,d.default)(this,r)}}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function a(e,t,r){var n=Cesium,i=n.BoxOutlineGeometry,a=n.Color,o=i.fromAxisAlignedBoundingBox(e);o=i.createGeometry(o),r&&r instanceof a&&(r=r.toCssColorString());var s=new THREE.LineBasicMaterial({color:r||"cyan",transparent:!0});s._debugVolumeColor=r,s.allowPick=!0,o=A.default.toBufferGeometry3js(o);var u=new THREE.LineSegments(o,s);return u.pickObject={id:u,mesh:u,primitive:t},u.up.copy(t.root.up),u.frustumCulled=!1,u.isDebugVolume=!0,u}function o(e){var t=P[e];return t||(t=new m.DRACOLoader,P[e]=t,t.setDecoderPath(e),t.preload()),t}var s=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var u,l=s(e("e_1")),c=s(e("s_2")),f=s(e("C_129")),d=s(e("o_130")),h=s(e("m_131")),p=e("o_867"),m=e("m_868"),v=e("M_869"),g=s(e("e_870")),y=s(e("s_871")),_=s(e("h_872")),b=s(e("-_873")),M=e("3_874"),x=s(e("D_875")),w=s(e("._876")),S=s(e("C_877")),T=s(e("o_878")),C=s(e("m_879")),E=s(e("M_880")),A=s(e("M_132")),L=function(e,t){var r=Cesium,n=r.Matrix4,i=r.defined,a=r.Cartesian3,o=new n;return u||(u=new n),function(){return i(t._rtcCenter)?(n.getTranslation(e.model,u),a.add(u,t._rtcCenter,u),n.multiplyByPoint(e.view,u,u),n.setTranslation(e.modelView,u,o)):e.modelView}},P={},O=function(e){function t(e){var n;(0,l.default)(this,t),n=r.call(this);var i=Cesium,a=i.when,o=i.Matrix4,s=i.Axis,u=i.defaultValue,c=i.Event;if(n.ready=!1,n.readyPromise=a.defer(),n.translucent=u(e.translucent,!1),n._modelMatrix=e.modelMatrix||o.IDENTITY.clone(),n._upAxis=void 0===e.upAxis?null:e.upAxis,n.forwardAxis=e.forwardAxis||s.X,n.cull=u(e.cull,!0),n._show=u(e.show,!0),n._requestType=e.requestType,n.pickObject=e.pickObject,n.manager=e.manager,n.loader=e.loader,n.dracoDecoderPath=e.dracoDecoderPath,n.url=e.url,n.basePath=e.basePath,n._instances=e.instances,n._instancedAttributes=e.instancedAttributes,n._boundingSphere=null,n._boundingSphereWC=null,n.boundingSphere=e.boundingSphere,n._boundingBox=null,n._boundingBoxWC=null,n.boundingBox=e.boundingBox,n.debugVolume=e.debugVolume,n.showDebugVolume=e.showDebugVolume,n.debugVolumeOnly=e.debugVolumeOnly,n.debugVolumeColor=e.debugVolumeColor,n._lazyLoad=e.lazyLoad,n._options=e,n.editable=u(e.editable,!1),n.castShadow=u(e.castShadow,!0),n.receiveShadow=u(e.receiveShadow,!0),n.preInitialize=u(e.preInitialize,!1),n.overrideTextureEncoding=e.overrideTextureEncoding,n.minRange=e.minRange||4,n.rangeMode="PIXEL_ON_SCREEN",n._lods=[],n._lodNeedsUpdate=!1,n.onModelLoaded=new c,n.onLoadProgress=new c,n.onInitInitialized=new c,n.onInitProgress=new c,e.lods&&e.lods.length>0&&e.lods.forEach(function(e){n.addLod(e.maxRange,e.simplifyFactor,e.simplifyOptions)}),t._loadTaskList||(t._loadTaskList=new M.TaskList(10,"load")),n._lazyLoad){if(!n.boundingSphere)throw new Error("When lazyLoad is true, boundingSphere is required.")}else n.load(e);return n.createDebugVolume(),n}(0,f.default)(t,e);var r=n(t);return(0,c.default)(t,[{key:"upAxis",get:function(){return this._upAxis},set:function(e){if(this._upAxis!=e){var t=Cesium,r=t.Cartesian3,n=t.Axis;if(this._upAxis=e,null==this._upAxis)return;var i=new r(0,1,0);e==n.Z?i=new r(0,0,1):e==n.X&&(i=new r(1,0,0)),this.traverse(function(e){e.up.set(i.x,i.y,i.z)}),this.modelMatrixNeedsUpdate=!0}}},{key:"getMagic",value:function(e){for(var t=[],r=0;r<4;r++)t.push(e[r]);return t=String.fromCharCode.apply(null,t)}},{key:"traverse",value:function(e){this.root&&e&&this.root.traverse(e)}},{key:"traverseGeometry",value:function(e){if(e){var t={};this.traverse(function(r){var n=r.geometry;n&&!t[n.uuid]&&(t[n.uuid]=!0,e(n))})}}},{key:"traverseMaterial",value:function(e){if(e){var t={};this.traverse(function(r){var n=r.material;n&&(Array.isArray(n)?n.forEach(function(r){t[r.uuid]&&(t[r.uuid]=!0,e(r))}):t[n.uuid]||(t[n.uuid]=!0,e(n)))})}}},{key:"traverseTexture",value:function(e){if("function"==typeof e){var t={};this.traverseMaterial(function(r){for(var n in r)if(Object.hasOwnProperty.call(r,n)){var i=r[n];i&&i.isTexture&&!t[i.uuid]&&(i.uuid,e(i))}})}}},{key:"load",value:function(e){var t=this,r=Cesium,n=r.defaultValue,i=r.Resource;e=e||this._options;var a,s=e.manager||this.manager,u=e.dracoDecoderPath||this.dracoDecoderPath,l=e.gltf||e.buffer;if("string"==typeof e.url){var c=y.default.GetExtension(e.url).toLowerCase();c&&(a=c.slice(1))}l&&(l instanceof ArrayBuffer?l=new Uint8Array(l):l instanceof Uint8Array&&(l=l.slice()),a||(a=this.getMagic(l)));var f=e.loader||this.loader;if(!f)switch(a){case"osgb":case"osgt":case"osg":case"osgjson":f=new g.default(s);break;case"vism":f=new T.default(s);break;default:if(f=new p.GLTFLoader(s),u&&"string"==typeof u){var d=o(u);f.setDRACOLoader(d)}var h=new v.DDSLoader(s);f.setDDSLoader(h)}if("vism"==a&&!f.dracoLoader&&u&&"string"==typeof u){var d=o(u);f.setDRACOLoader(d)}var m=this.basePath||this.url;if(m&&(m instanceof i&&(m=m.url),m=THREE.LoaderUtils.extractUrlBase(m)),l){if("b3dm"==a){var _=b.default.parseB3DM(l.buffer);l=_.gltfView,delete _.gltfView,this.b3dmHeader=_}f.parse(l,m,function(e){t.onload(e)},function(e){console.error(e),t.readyPromise.reject(e)},{loadTexture:n(e.preloadTexture,!0)})}else if("string"==typeof e.url){var M="x"==a?[e.url,e]:e.url;f.load(M,function(e){t.onload(e)},function(e){t.onLoadProgress.raiseEvent(e)},function(e){console.error(e),t.readyPromise.reject("Failed to load model "+t.url+":"+e)},"b3dm"==a?function(e){var r=b.default.parseB3DM(e),n=r.gltfView;return delete r.gltfView,t.b3dmHeader=r,n}:null,{loadTexture:n(e.preloadTexture,!0)})}return this.readyPromise}},{key:"onload",value:function(e){var t=this,r=Cesium,n=r.Axis,i=r.Cartesian3,a=r.RequestType,o=r.defined;this._model3js=e;var s=e.scene||e.mesh||e;if(e.models&&(s=new THREE.Object3D,e.models.forEach(function(e){s.add(e)}),e.scene=s),this.modelScene=s,this.modelScene.visible=this._show,this.b3dmHeader&&!e.CESIUM_RTC&&(e.CESIUM_RTC=this.b3dmHeader.CESIUM_RTC),this._requestType==a.TILES3D||e.CESIUM_RTC){var u,l;e.CESIUM_RTC&&(e._rtcCenter=i.fromArray(e.CESIUM_RTC),l=function(t,r,n){u||(u=L(r.context.uniformState,e)),t.modelView=u,t.u_modelView=u,t.modelViewMatrix=u,t.u_modelViewMatrix=u});var c=new i(0,0,1);this.upAxis==n.Y&&(c=new i(0,1,0)),Object3D.traverse(s,function(r){r.up.set(c.x,c.y,c.z),r.frustumCulled=!1,r.isMesh&&(e.CESIUM_RTC&&(r.uniformMapLoadedCallback=l),t.pickObject&&(r.pickObject=t.pickObject))}),s.updateMatrixWorld(),this.computeModelMatrix()}if(this._requestType!=a.TILES3D){var f;this.upAxis==n.Z?f=new i(0,0,1):this.upAxis==n.X?f=new i(1,0,0):this.upAxis==n.Y&&(f=new i(0,1,0));var d=o(this.overrideTextureEncoding);s.traverse(function(e){if(e.frustumCulled=t.cull,f&&e.up.set(f.x,f.y,f.z),e.isMesh){var r=e.pickObjects=[];(Array.isArray(e.material)?e.material:[e.material]).forEach(function(n,i){n.transparent&&t.translucent&&(n.translucent=!0),d&&n.map&&(n.map.encoding=t.overrideTextureEncoding),r.push({id:e,mesh:e,primitive:t,material:n,materialIndex:i})})}}),this.onModelLoaded.raiseEvent(this),this.createBoudingVolume(),this.updateBoudingVolume()}s.instances=this.instances,s.instancedAttributes=this.instancedAttributes,this.modelMatrixNeedsUpdate=!0,this.ready=!0,this.readyPromise.resolve(this)}},{key:"createBoudingVolume",value:function(e){if(this.root&&(!this.boundingSphere||e)){var t=this.root,r=[];t.updateMatrixWorld(),t.traverse(function(e){var t=e.geometry;if(t){t.boundingBox||t.computeBoundingBox();var n=t.boundingBox.clone();n.applyMatrix4(e.matrixWorld),r.push(n.min,n.max)}});var n=Cesium,i=n.BoundingSphere,a=n.AxisAlignedBoundingBox,o=THREE,s=o.Box3,u=o.Vector3,l=a.fromPoints(r),c=i.fromPoints(r);r.splice(0),this.boundingSphere=c,this.boundingBox=l,this.boundingBox3js=new s((new u).copy(l.minimum),(new u).copy(l.maximum)),this.boundingBoxWC3js=(new s).copy(this.boundingBox3js),this.modelMatrixNeedsUpdate=!0,this.createDebugVolume()}}},{key:"updateBoudingVolume",value:function(){var e=this.upAxis,t=this.root,r=this.visualizer,n=this.boundingSphere,i=this.boundingSphereWC,a=this.boundingBox,o=this.boundingBoxWC;if(n&&r){var s=Cesium,u=s.Axis,l=s.Matrix4,c=r._actualModelMatrixYup,f=r._actualModelMatrixXup,d=r._actualModelMatrix;if(0!=this.modelMatrixNeedsUpdate||r.modelMatrixNeedsUpdate){var h;if(null!=e)e==u.Y?h=c:e==u.X?h=f:e==u.Z&&(h=d);else{var p=t.up;p.y?h=c:p.x?h=f:p.z&&(h=d)}this.modelMatrix=h,t.modelMatrix||(t.modelMatrix=new l);var m=t.modelMatrix;l.multiply(h,t.matrixWorld.elements,m);var v=i.center;l.multiplyByPoint(m,n.center,v),i.radius=n.radius*l.getMaximumScale(m),v=o.center,l.multiplyByPoint(m,a.center,v)}}}},{key:"createDebugVolume",value:function(){var e=this;if(this.debugVolume&&this.boundingBox){var t=this.visualizer;this.debugVolume.isMesh&&(t&&t.remove(debugVolume,!0),(0,S.default)(debugVolume),this.debugVolume=!0),this.debugVolume=a(this.boundingBox,this,this.debugVolumeColor),this.root.traverse(function(r){if(!r.isDebugVolume&&r.isMesh&&r.geometry){var n=function e(){t&&t.remove(s,!0),(0,S.default)(s),delete r.__debugVolume,r.removeEventListener("dispose",e)},i=r.geometry;i.boundingBox||i.computeBoundingBox();var o=o=i.boundingBox.clone().applyMatrix4(r.matrixWorld);o=Cesium.AxisAlignedBoundingBox.fromPoints([o.min,o.max]);var s=a(o,e,e.debugVolumeColor);r.addEventListener("dispose",n),r.__debugVolume=s}})}}},{key:"computeRange",value:function(e,t){this._distanceToCamera=e.camera.distanceToBoundingSphere(this._boundingSphereWC);var r=Math.max(this._distanceToCamera,Cesium.Math.EPSILON7);if("PIXEL_ON_SCREEN"==this.rangeMode){var n=this._boundingSphereWC.radius;return E.default.computeRange(r,n,e,t)}return r}},{key:"computeVisibility",value:function(e){if(this.boundingSphere)if(this.range=this.computeRange(e),this.visibility=this.visible=!0,this.range<this.minRange)this.visibility=this.visible=!1;else{var t;t=e.cullingVolume.computeVisibility(this._boundingSphereWC),this.visibility=this.visible=-1!=t}}},{key:"createOrUpdateLod",value:function(){var e=this;this._lodNeedsUpdate&&this.root&&(this._lods.sort(function(e,t){return e.maxRange-t.maxRange}),this._lods.forEach(function(t){if(!t.root){var r=t.simplifyOptions;if(r.simplifyFactor>=1)return void(t.root=e.root);var n=e.root.clone(!0);n.traverse(function(n){if(n.instances=e.instances,n.instancedAttributes=e.instancedAttributes,n.frustumCulled=!1,n.isMesh){var i=n,a=i.geometry,o=a.attributes.position.count,s=t.simplifyFactor*o;if(i.geometry=simplify_three(a,s,r),r.resampleTexture){var u=i.material.clone();for(var l in u){var c=u[l];"lightMap"!=l&&c&&c.isTexture&&(u[l]=w.default.resampleTexture(c.clone(),t.simplifyFactor,r.forcePowerOfTwo))}i.material=u}}}),t.root=n}}),this._lodNeedsUpdate=!1)}},{key:"initializeCommands",value:function(e,t){var r=this;this.commandInitializing=!0;var n=t.renderer,i=n._webglRenderStates.get(t,e.camera),a=e.context,o=n._webglRenderItems,s=[],u=[s],l=0;return this.root.updateMatrixWorld(),this.root.traverse(function(e){if(e.isMesh||e.isLine||e.isPoints||e.isSprite){s.push(e);var t=C.default.get(e.geometry),r=t.materialIndicesUsed;l+=r?r.length:1,l>10&&(s=[],u.push(s),l=0)}}),new _.default(u,function(r){for(var n=0;n<r.length;n++){var s=r[n];t.computeModelMatrix(s,e),t.computeObjectVisibility(s,e,!0);var u=o.getAndUpdate(s,e,!1,i);if(u)for(var l=0;l<u.length;l++){var c=u[l],f=c.drawCommand;f.framebuffer=t.defaultFramebuffer,f.execute(a),f.framebuffer=void 0,c.loaded=!0}}}).run(function(e,t,n,i){r.onInitProgress.raiseEvent({progress:e,message:"Initializing drawCommands",loaded:n,total:i})}).then(function(){r.commandInitializing=!1,r.commandInitialized=!0,r.onInitInitialized.raiseEvent(r)})}},{key:"render",value:function(e,r,n){var i=this;if(this.root&&this.visualizer){if(this.preInitialize){if(this.commandInitializing)return;if(!this.commandInitialized)return void this.initializeCommands(e,this.visualizer)}var a=this._cacheRenderList||[];if(this._cacheRenderList=a,e.frameNumber!=this.frameNumber){a.splice(0);var o=this.editable,s=this.castShadow,u=this.receiveShadow,l=this.root;if(o==l._editable&&s==l._castShadow&&u==l._receiveShadow||(l._editable=o,l._castShadow=s,l._receiveShadow=u,l.traverse(function(e){var t=e.material;if(void 0!=t){e.castShadow=s,e.receiveShadow=u;(Array.isArray(t)?t:[t]).forEach(function(e){e.autoRefresh=o})}})),this.editable&&l.updateMatrixWorld(),this.updateBoudingVolume(),this.computeVisibility(e,n),!this.visible)return;var c=t._loadTaskList;if(!this._lazyLoad||this.root||this._isLazyLoading||(this._isLazyLoading=!0,this.tileId=Cesium.createGuid(),c.add(this)),c.frameNumber&&c.frameNumber==e.frameNumber||(c.frameNumber=e.frameNumber,c.update()),this.root&&this.show&&!this.debugVolumeOnly){var f=null;if(this._lods.length>0){this.createOrUpdateLod();for(var d=0;d<this._lods.length;d++){var h=this._lods[d];if(this.range<=h.maxRange){f=h.root;break}}}f=f||this.root,a.push(f)}this.debugVolume&&this.showDebugVolume&&(a.push(this.debugVolume),this.root.traverse(function(e){var t=e.__debugVolume;if(t){var r=t.material,n=i.debugVolumeColor;r._debugVolumeColor!=n&&(r._debugVolumeColor=n,n instanceof Cesium.Color&&(n=n.toCssColorString()),r.color.set(n)),a.push(t)}})),this.root&&(this.modelMatrixNeedsUpdate=!1)}a.forEach(function(e){r.push(e)})}}},{key:"update",value:function(e){(this._requestType==Cesium.RequestType.TILES3D||this.model3js&&this.model3js.CESIUM_RTC)&&this.computeModelMatrix()}},{key:"computeModelMatrix",value:function(){var e=this;if(this._model3js){var t=Cesium,r=t.Axis,n=t.Matrix4,i=this._computedModelMatrix;i||(i=new n,this._computedModelMatrix=i),this.modelMatrixNeedsUpdate&&(this.upAxis===r.Y?n.multiplyTransformation(this.modelMatrix,r.Y_UP_TO_Z_UP,i):this.upAxis===r.X&&n.multiplyTransformation(this.modelMatrix,r.X_UP_TO_Z_UP,i),this.forwardAxis==r.Z&&n.multiplyTransformation(this.modelMatrix,r.Z_UP_TO_X_UP,i),this.modelMatrixNeedsUpdate=!1);var a=this.modelScene;Object3D.traverse(a,function(t){t.isMesh&&(t.frustumCulled=e.cull,t.modelMatrix=n.multiply(i,t.matrixWorld.elements,t.modelMatrix||new Cesium.Matrix4)),t.matrixAutoUpdate=!1,t.modelMatrixNeedsUpdate=!1}),a.modelMatrixNeedsUpdate=!1,a.matrixAutoUpdate=!1}}},{key:"updateCommands",value:function(e,t){}},{key:"addLod",value:function(e,t,r){r=r||{},r=Object.assign({agressiveness:4,update:5,resampleTexture:!1,forcePowerOfTwo:!1},r);var n={maxRange:e,simplifyFactor:t,simplifyOptions:r};return this._lods.push(n),this._lodNeedsUpdate=!0,n}},{key:"clearLods",value:function(){return this._lods.forEach(function(e){e.root&&((0,S.default)(e.root),e.root=null)}),this._lods.splice()}},{key:"getNodeByName",value:function(e){if(this.ready){var t;return this.root.traverse(function(r){t||r.name==e&&(t=r)}),t}}},{key:"getObjectByName",value:function(e){return this.getNodeByName(e)}},{key:"exportGLTF",value:function(e){return e=e||{},!e.animations&&this.model3js.animations&&(e.animations=this.model3js.animations),b.default.exportGLTF(this.root,e)}},{key:"exportB3DM",value:function(e){return e=e||{},!e.animations&&this.animations&&(e.animations=this.animations),b.default.exportB3DM(this.root,e)}},{key:"exportVISM",value:function(e){return e=e||{},!e.animations&&this.animations&&(e.animations=this.animations),b.default.exportVISM(this.root,e)}},{key:"destroy",value:function(){var e=this.visualizer,t=this.debugVolume;if(this._model3js){var r=this.root;e&&e.remove(r,!0),(0,S.default)(r),this._model3js=null,this.modelScene=null}t&&(e&&e.remove(t,!0),(0,S.default)(t),this.debugVolume=null),this.loader=null,this.visualizer=null,this.manager=null,this._boundingBox=null,this._boundingBoxWC=null,this._boundingSphere=null,this._boundingSphereWC=null,this._instances=null,this._instancedAttributes=null,this._cacheRenderList&&this._cacheRenderList.splice(0),this._cacheRenderList=null,Cesium.destroyObject(this)}}]),t}(x.default);Object.defineProperties(O.prototype,{instances:{get:function(){return this._instances}},instancedAttributes:{get:function(){return this._instancedAttributes}},modelMatrix:{set:function(e){var t=Cesium.Matrix4;this._model3js||(this.modelMatrixNeedsUpdate=!0),e.elements&&(e=e.elements),t.equals(e,this._modelMatrix)||(this._modelMatrix=t.clone(e,this._modelMatrix),this.modelMatrixNeedsUpdate=!0)},get:function(){
return this._modelMatrix}},show:{set:function(e){this._show=e,this.modelScene&&(this.modelScene.visible=e)},get:function(){return this._show}},model3js:{get:function(){return this._model3js}},root:{get:function(){return this._model3js&&(this._model3js.scene||this._model3js)}},gltf:{get:function(){return this.model3js&&this.parser?this.model3js.parser.json:null}},osg:{get:function(){return this.model3js&&this.model3js.osgRoot?this.model3js.osgRoot:null}},animations:{get:function(){return this.model3js?this.model3js.animations:[]}},boundingSphere:{set:function(e){e&&(this._boundingSphere=e,this._boundingSphereWC=Cesium.BoundingSphere.clone(e))},get:function(){return this._boundingSphere}},boundingSphereWC:{get:function(){return this._boundingSphereWC}},boundingBox:{get:function(){return this._boundingBox},set:function(e){e&&(this._boundingBox=e,this._boundingBoxWC=Cesium.AxisAlignedBoundingBox.clone(this.boundingBox))}},boundingBoxWC:{get:function(){return this._boundingBoxWC}}});var R=b.default;O.exportGLTF=R.exportGLTF,O.exportB3DM=R.exportB3DM,O.parseB3DM=R.parseB3DM,O.exportVISM=R.exportVISM,O.prototype.type="MeshVisModel",O.prototype.isMeshVisModel=!0;var I=O;r.default=I},{M_132:2,D_875:4,M_880:6,"._876":17,m_879:22,h_872:189,s_871:193,"3_874":87,M_869:92,m_868:93,o_867:94,C_877:186,"-_873":181,e_870:182,o_878:184,e_1:235,s_2:236,m_131:239,C_129:240,M_0:241,o_130:242}],181:[function(e,t,r){"use strict";var n=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("e_1")),a=n(e("s_2")),o=e("3_885"),s=n(e("D_886")),u=function(){function e(){(0,i.default)(this,e)}return(0,a.default)(e,null,[{key:"exportGLTF",value:function(e,t){return new Promise(function(r,n){try{var i=new o.GLTFExporter;t=t||{},t=Object.assign({embedImages:!1,trs:!1,onlyVisible:!1,binary:!1,maxTextureSize:1/0},t),i.parse(e,function(e){r(e)},t)}catch(e){n(e)}})}},{key:"getPaddedBufferSize",value:function(e){return 4*Math.ceil(e/4)}},{key:"getPaddedBuffer",value:function(e,t){t=t||0;var r=this.getPaddedBufferSize(e.byteLength);if(r!==e.byteLength){var n=new Uint8Array(r);if(n.set(e),0!==t)for(var i=e.byteLength;i<r;i++)n[i]=t;return n}return e}},{key:"exportB3DM",value:function(e,t){var r=t.properties,n=t.featureTableJson?t.featureTableJson:{BATCH_LENGTH:0},i=t.batchTableJson;if(i&&n.BATCH_LENGTH&&r){var a=Object.keys(i),o=Object.keys(r),s=a.length==o.length;if(s=s&&a.length==n.BATCH_LENGTH)for(var u=0;u<o.length;u++){var l=o[u];if(-1==a.indexOf(l)){s=!1;break}}s?(i=null,n.BATCH_LENGTH=0):console.warn("batchTableJson&featureTableJson.BATCH_LENGTH&properties donot have same length")}else(n.BATCH_LENGTH||i&&Object.keys(i)>0||r&&Object.keys(r)>0)&&console.warn("batchTableJson&featureTableJson.BATCH_LENGTH&properties donot have same length");n=JSON.stringify(n);for(var c=new Uint8Array(n.length),f=0;f<n.length;f++)c[f]=n.charCodeAt(f);c=this.getPaddedBuffer(c," ".charCodeAt(0));var d=new Uint8Array(0);t.featureTableBinary&&(d=this.getPaddedBuffer(t.featureTableBinary));var h=new Uint8Array(0),p=new Uint8Array(0);if(i){i=JSON.stringify(i);for(var h=new Uint8Array(i.length),m=0;m<i.length;m++)h[m]=i.charCodeAt(m);h=this.getPaddedBuffer(h," ".charCodeAt(0)),t.batchTableBinary&&(p=this.getPaddedBuffer(t.batchTableBinary))}var v={magic:"b3dm",version:1,byteLength:0,featureTableJSONByteLength:c.length,featureTableBinaryByteLength:d.length,batchTableJSONByteLength:h.length,batchTableBinaryByteLength:p.length};return t=t||{},t.binary=!0,this.exportGLTF(e,t).then(function(e){v.byteLength=e.byteLength+28+v.featureTableJSONByteLength+v.featureTableBinaryByteLength+v.batchTableJSONByteLength+v.batchTableBinaryByteLength;for(var t=0,r=new Uint8Array(v.byteLength),n=new DataView(r.buffer),i=0;i<v.magic.length;i++)n.setUint8(t,v.magic.charCodeAt(i)),t++;return n.setUint32(t,v.version,!0),t+=4,n.setUint32(t,v.byteLength,!0),t+=4,n.setUint32(t,v.featureTableJSONByteLength,!0),t+=4,n.setUint32(t,v.featureTableBinaryByteLength,!0),t+=4,n.setUint32(t,v.batchTableJSONByteLength,!0),t+=4,n.setUint32(t,v.batchTableBinaryByteLength,!0),t+=4,r.set(c,t),t+=c.length,r.set(h,t),t+=h.length,e=new Uint8Array(e),r.set(e,t),r})}},{key:"parseB3DM",value:function(e,t){var r=Cesium,n=r.defaultValue,i=r.getStringFromTypedArray,a=r.Cesium3DTileFeatureTable,o=r.ComponentDatatype,s=n(t,0);t=s;var u=new Uint8Array(e),l=new DataView(e);if("b3dm"!=i(u,t,4))throw new Error("not b3dm");t+=4;var c=l.getUint32(t,!0);if(1!==c)throw new Error("Only Batched 3D Model version 1 is supported.  Version "+c+" is not.");t+=4;var f=l.getUint32(t,!0);t+=4;var d=l.getUint32(t,!0);t+=4;var h=l.getUint32(t,!0);t+=4;var p=l.getUint32(t,!0);t+=4;var m=l.getUint32(t,!0);t+=4;var v;p>=570425344?(t-=8,v=d,p=h,m=0,d=0,h=0,console.warn("b3dm-legacy-header","This b3dm header is using the legacy format [batchLength] [batchTableByteLength]. The new format is [featureTableJsonByteLength] [featureTableBinaryByteLength] [batchTableJsonByteLength] [batchTableBinaryByteLength] from https://github.com/CesiumGS/3d-tiles/tree/master/specification/TileFormats/Batched3DModel.")):m>=570425344&&(t-=4,v=p,p=d,m=h,d=0,h=0,console.warn("b3dm-legacy-header","This b3dm header is using the legacy format [batchTableJsonByteLength] [batchTableBinaryByteLength] [batchLength]. The new format is [featureTableJsonByteLength] [featureTableBinaryByteLength] [batchTableJsonByteLength] [batchTableBinaryByteLength] from https://github.com/CesiumGS/3d-tiles/tree/master/specification/TileFormats/Batched3DModel."));var g;if(0===d)g={BATCH_LENGTH:n(v,0)};else{var y=i(u,t,d);g=JSON.parse(y),t+=d}var _=new Uint8Array(e,t,h);t+=h;var b=new a(g,_);v=b.getGlobalProperty("BATCH_LENGTH"),b.featuresLength=v;var M,x,w=b.getGlobalProperty("RTC_CENTER",o.FLOAT,3);if(p>0){var S=i(u,t,p);M=JSON.parse(S),t+=p,m>0&&(x=new Uint8Array(e,t,m),x=new Uint8Array(x),t+=m)}var T={batchLength:v,batchTableJson:M,batchTableBinary:x},C=s+f-t;if(0===C)throw new Error("glTF byte length must be greater than 0.");var E;return t%4==0?E=new Uint8Array(e,t,C):(console.warn("b3dm-glb-unaligned","The embedded glb is not aligned to a 4-byte boundary."),E=new Uint8Array(u.subarray(t,t+C))),{gltfView:E,featureTable:b,batchTable:T,CESIUM_RTC:w}}},{key:"exportVISM",value:function(e,t){return t=t||{},new s.default(t).parse(e,e.animations||t.animations)}}]),e}();r.default=u},{"3_885":90,D_886:183,e_1:235,s_2:236,M_0:241}],182:[function(e,t,r){"use strict";function n(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(n=function(e){return e?r:t})(e)}function i(e){var t=a();return function(){var r,n=(0,V.default)(e);if(t){var i=(0,V.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,G.default)(this,r)}}function a(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function o(){if(!X){X=!0;var e=THREE;l=e.BufferAttribute,c=e.BufferGeometry,f=1001,d=e.Color,h=2,p=e.FileLoader,m=0,v=e.Group,g=1006,y=1008,_=1007,b=e.Loader,M=e.LoaderUtils,x=e.Mesh,w=e.MeshBasicMaterial,S=e.MeshPhongMaterial,T=e.MeshPhysicalMaterial,C=e.MeshStandardMaterial,E=1002,A=1003,L=1005,P=1004,O=1023,R=1022,I=1e3,D=e.TextureLoader,B=e.Texture,U=e.VertexColors,q="undefined"!=typeof createImageBitmap}}var s=e("M_0"),u=e("M_110");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var l,c,f,d,h,p,m,v,g,y,_,y,b,M,x,w,S,T,C,E,A,L,P,O,R,I,D,B,U,N,k=s(e("e_1")),j=s(e("C_129")),G=s(e("o_130")),V=s(e("m_131")),F=s(e("e_45")),z=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==u(e)&&"function"!=typeof e)return{default:e};var r=n(t);if(r&&r.has(e))return r.get(e);var i={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=a?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(i,o,s):i[o]=e[o]}return i.default=e,r&&r.set(e,i),i}(e("h_894")),H=s(e("-_895")),W=e("3_896"),Y="undefined"==typeof Blob||"undefined"==typeof Image||"undefined"==typeof Document||"undefined"==typeof window,X=!1,q=!1,K=function(e){if(o(),!N){var t,r,n=z.GLEnum,a=(t={},(0,F.default)(t,n.MIRROR,E),(0,F.default)(t,n.CLAMP_TO_EDGE,f),(0,F.default)(t,n.REPEAT,I),t),s=(r={},(0,F.default)(r,n.LINEAR,g),(0,F.default)(r,n.LINEAR_MIPMAP_LINEAR,y),(0,F.default)(r,n.LINEAR_MIPMAP_NEAREST,_),(0,F.default)(r,n.NEAREST,A),(0,F.default)(r,n.NEAREST_MIPMAP_LINEAR,L),(0,F.default)(r,n.NEAREST_MIPMAP_NEAREST,P),r),u={load:function(e,t,r,n,i){var a=this;this.options=Object.assign({loadTexture:!0},i);var o,s=this;o=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:M.extractUrlBase(e),s.manager.itemStart(e);var u=function(t){n?n(t):(console.trace(t),console.error(t)),s.manager.itemError(e),s.manager.itemEnd(e)},l=new p(s.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),"use-credentials"===s.crossOrigin&&l.setWithCredentials(!0),l.load(e,function(r){try{if("osgjson"==e.substr(e.lastIndexOf(".")+1))return"string"!=typeof r&&(r=M.decodeText(r)),r=JSON.parse(r),r=(0,W.parseOsg)(r,o,a.options.loadTexture,a.manager,a.options.imageCache,a.options.textureCache,!1),r.then?r.then(t):t(r);s.parse(r,o,function(e){t(e)},u,a.options),s.manager.itemEnd(e)}catch(e){u(e)}},r,u)},parse:function(e,t,r,n,i){this.options=Object.assign({loadTexture:!0},i);var a;if(e instanceof ArrayBuffer||e.buffer&&e.buffer instanceof ArrayBuffer){if(0==(a=z.readBuffer(e))){var o=(0,W.parseOsg)(e,t,this.options.loadTexture,this.manager,this.options.imageCache,this.options.textureCache,!1);return o.then?o.then(r):r(o)}}else a=e;var s={};this.parseObject(a,t,s,i).then(function(e){r(e)}).catch(function(e){})},setRGBLoader:function(e){return this.rgbLoader=e,this},setTGALoader:function(e){return this.tgaLoader=e,this},setBMPLoader:function(e){return this.bmpLoader=e,this},parseObject:function(e,t,r,n){!this.options&&n&&(n=n||{},this.options=Object.assign({loadTexture:!0,materialType:"basic"},n));var i=this.options.materialType;switch(e.Type){case"Osg::Geode":case"Osg::Group":case"Osg::Node":case"Osg::MatrixTransform":return this.parseNode(e,t,r,i);case"Osg::PagedLOD":return this.parsePagedLOD(e,t,r,i);case"Osg::Geometry":return this.pareseGeometry(e,t,r,i)}},parsePagedLOD:function(e,t,r,n){var i=this,a=new v;a.name=e.Name;var o=e.Children.map(function(e){return i.parseObject(e,t,r)});return a.up.set(0,0,1),a.frustumCulled=!1,Promise.all(o).then(function(e){return e.forEach(function(e){a.add(e)}),a})},parseNode:function(e,t,r){var n=this,i=new v;i.name=e.Name;var a=[];return e.Children&&e.Children.forEach(function(e){var i=n.parseObject(e,t,r);a.push(i)}),i.up.set(0,0,1),i.frustumCulled=!1,Promise.all(a).then(function(e){return e.forEach(function(e){i.add(e)}),i})},pareseGeometry:function(e,t,r,n){var i=this,a=new v;a.name=e.Name,a.up.set(0,0,1),a.frustumCulled=!1;var o,s,u,f,h=e.VertexArray,p=e.NormalArray,m=e.ColorArray,g=e.TexCoordArray;s=new l(h.Value,h.ItemSize),m&&(m.Binding==z.AttributeBinding.BIND_PER_VERTEX?f=new l(m.Value,m.ItemSize):(o=(new d).fromArray(m.Value),m[3])),p&&(u=new l(p.Value,p.ItemSize,p.Normalize));var y=e.StateSet,_=e.PrimitiveSetList.map(function(e,d){var h=g[d];return i.parseMaterial(y,t,r,n).then(function(t){var r=new c;if(r.setAttribute("position",s),h&&r.setAttribute("uv",new l(h.Value,h.ItemSize)),f?(r.setAttribute("color",f),t.vertexColors=U):o&&(t.color=o),e.Indices){var n=e.Indices.Value;if(e.Mode==z.PrimitiveMode.GL_QUADS){for(var d=[],p=0;p<n.length;p+=4){var m=n[p],v=n[p+1],g=n[p+2],y=n[p+3];d.push(m,v,y,v,g,y)}n=new n.constructor(d)}else r.GeometryMode=e.Mode;r.setIndex(new l(n,1))}else r.addGroup(e.First,e.Count),r.GeometryMode=e.Mode;u?r.setAttribute("normal",u):"basic"!=i.options.materialType&&r.computeVertexNormals();var _=new x(r,t);_.vertexColors=!!f,_.receiveShadow=!0,_.castShadow=!0,_.up.set(0,0,1),_.frustumCulled=!1,a.add(_)})});return Promise.all(_).then(function(){return a})},parseMaterial:function(e,t,r,n){var i=this;return new Promise(function(a,o){var s;switch(n){case"phong":s=new S;break;case"standard":s=new C;break;case"physical":s=new T;break;default:s=new w}if(s.side=h,!e)return void a(s);var u=e.RenderingHint;void 0!=u&&null!=u&&(s.transparent=u==z.RenderingHint.TRANSPARENT_BIN);var l=e.AttributeList,c=e.ModeList,f=e.TextureAttributeList;l&&l.forEach(function(e){var t=e.key,r=e.value,n=r.StateAttribute;switch(t.type){case"Osg::Material":i.setMaterialAttribute(s,n);break;case"Osg::StateAttribute":break;case"Osg::ShadeModel":s.flatShading=n.Mode==z.ShadeModelMode.ConstantsFLAT}}),c&&c.forEach(function(e){var t=e.key,r=e.value;z.EnumToString(z.GLEnum,t);switch(t){case z.GLEnum.GL_DEPTH_TEST:s.depthTest=r!=z.StateAttributeValue.OFF;break;case z.GLEnum.GL_BLEND:s.blending=r!=z.StateAttributeValue.OFF}});var d;if(f&&f.length>0){f.length>1&&console.warn("only handle textureAttributeList[0]");var p=f[0].value.StateAttribute;d=i.parseTexture(p,t,r)}d?d.then(function(e){s.map=e,a(s)}).catch(o):a(s)})},setMaterialAttribute:function(e,t){var r=t.EmissionFront||t.EmissionBack;r&&e.emissive&&(e.emissive=(new d).fromArray(r),e.emissiveIntensity=r[3],t.EmissionFrontAndBack||console.warn("only support EmissionFrontAndBack=true"));var n=t.DiffuseFront||t.DiffuseBack;n&&(e.color=(new d).fromArray(n),e.opacity=n[3],t.DiffuseFrontAndBack||console.warn("only support DiffuseFrontAndBack=true"));var i=t.SpecularFront||t.SpecularBack;i&&(e.specular=(new d).fromArray(i),t.SpecularFrontAndBack||console.warn("only support SpecularFrontAndBack=true"));var a=t.ShininessFront||t.ShininessBack;void 0!=a&&null!=a&&(e.shininess=a,t.SpecularFrontAndBack||console.warn("only support SpecularFrontAndBack=true"))},resolveURL:function(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)?e:/^data:.*,.*$/i.test(e)?e:/^blob:.*$/i.test(e)?e:(t+"/"+e).replace("//","/"))},getExtension:function(e){var t=e.lastIndexOf(".");return t>=0?e.substring(t,e.length):""},parseTexture:function(e,t,r){var n=this;return new Promise(function(i,o){function u(){m.anisotropy=e.MaxAnisotropy,m.format=d?R:O,m.wrapS=a[e.WrapS.value],m.wrapT=a[e.WrapT.value],m.magFilter=s[e.MagFilter.value],m.minFilter=s[e.MinFilter.value],v&&URL.revokeObjectURL(p),i(m)}function l(e){o(e)}var c=e.Image;if(c){var f=c.Name;if(r[f])return void i(r[f]);var d=f.search(/\.jpe?g($|\?)/i)>0||0===f.search(/^data\:image\/jpeg/),h=n.getExtension(f).toLowerCase();"."==h[0]&&(h=h.slice(1));var p,m,v;if(c.ImageType==z.ImageType.IMAGE_EXTERNAL)p=n.resolveURL(f,t),Y&&(p={src:f,fileName:p});else if(c.ImageType==z.ImageType.IMAGE_INLINE_FILE)if("bmp"==h||"tga"==h)p=e.Image.Data;else{var g="image/"+h;if(Y||!n.options.loadTexture)p={src:f,fileName:n.resolveURL(f,t),fileBuffer:c.Data};else{var y=new Blob([e.Image.Data],{type:g});p=y}}else m=new DataTexture(c.Data,e.TextureWidth,e.TextureHeight),console.warn("image file "+c.Name+"：unsupport imageType "+z.EnumToString(z.ImageType,c.ImageType));if(Y||!n.options.loadTexture)m||(m=new B(p)),r[f]=m,u();else{if("dds"==h?m=n.ddsLoader.load(p,u,null,l):"rgb"==h?m=n.rgbLoader.load(p,u,null,l):"tga"==h?m=n.tgaLoader.load(p,u,null,l):"bmp"==h&&(m=n.bmpLoader.load(p,u,null,l)),!m)if(p instanceof Blob){if(q)createImageBitmap(p,{imageOrientation:"flipY",premultiplyAlpha:"none"}).then(function(e){m.image=e,u()}).catch(l);else{p=URL.createObjectURL(p);var _=new Image;_.onload=function(){_.a_src=f,m.image=_;try{c.Data=null,URL.revokeObjectURL(p),u()}catch(e){l(e)}c=null},_.onerror=l,_.src=p}m=new B}else m=new D(n.manager).load(p,u,null,l);r[f]=m}}})}};N=(0,H.default)(b,{esConstructor:function(e){return function(e){function t(e){return(0,k.default)(this,t),r.call(this,e)}(0,j.default)(t,e);var r=i(t);return t}(b)},constructor:function(){},prototype:u})}return new N(e)},Z=K;r.default=Z},{"-_895":198,h_894:179,"3_896":185,e_1:235,e_45:237,m_131:239,C_129:240,M_0:241,o_130:242,M_110:245}],183:[function(e,t,r){"use strict";function n(e,t){0==t.length&&(t.byteLength=0);var r=e.length,n=t.byteLength,i=e;i instanceof Uint8Array||(i=new Uint8Array(e.buffer)),i=f.default.getPaddedBuffer(i);var a=i.byteLength;return t.push(i),t.byteLength+=a,{byteOffset:n,count:r}}function i(e,t){return function(r){if("string"==typeof r)return r;if(/^data:/i.test(r.src))return r.src;if("undefined"==typeof HTMLCanvasElement)return r.src;var n;if(r instanceof HTMLCanvasElement)n=r;else if(r instanceof HTMLImageElement&&0==r.embedImages){var i=r.src;if(!i.startsWith("blob:")||e[i])return i}if(!n){void 0===s&&(s=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),s.width=r.width,s.height=r.height;var a=s.getContext("2d");r instanceof ImageData?a.putImageData(r,0,0):a.drawImage(r,0,0,r.width,r.height),n=s}t[r.uuid]=r.fileName;var o=r.embedFormat;return o?n.toDataURL("image/"+o):n.width>2048||n.height>2048?n.toDataURL("image/jpeg",.6):n.toDataURL("image/png")}}function a(e,t){if(Array.isArray(e))e.forEach(function(e){a(e,t)});else for(var r in e)if(e.hasOwnProperty(r)){var n=e[r];n&&n.isTexture&&n.image&&"string"!=typeof n.image&&(n.image.embedImages=t,n.image.embedFormat=1023==n.format?"png":"jpeg",n.image.fileName=n.imageFileName)}}var o=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s,u=o(e("e_1")),l=o(e("s_2")),c=e("o_900"),f=o(e("-_873")),d=e("M_902"),h=o(e("e_903")),p=o(e("s_904")),m=e("h_905"),v=o(e("h_872")),g=o(e("M_132")),y={Float64Array:Float64Array,Float32Array:Float32Array,Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array},_=function(){function e(t){(0,u.default)(this,e),this.options=t||{}}return(0,l.default)(e,[{key:"preProcess",value:function(e){var t,r=this.options,n=r.binary,i=r.embedImages,o=r.forceIndices,s=r.removeUv2,u=r.removeUv3,l=r.removeNormal,c=r.dracoEncode,f=r.dracoMinVertexCount||300;return n&&c&&"undefined"!=typeof DracoEncoderModule&&(t=new d.DRACOExporter,e=e.clone(!0)),e.traverse(function(e){if(e.material&&(a(e.material,i),l||c||o||u)){var r=e.geometry=e.geometry.clone();l?delete r.attributes.normal:r.attributes.normal&&r.userData&&r.userData.NormalBinding&&delete r.attributes.normal;var n=o&&g.default.forceIndices(r,s,u);if(n)e.geometry=n;else if(u&&delete r.attributes.uv3,s&&(delete r.attributes.uv2,e.material.lightMap)){var d=e.material.clone(!0);d.lightMap=null,e.material=d}r=e.geometry,r.userData=Object.assign({},r.userData||{}),delete r.userData.draco;var h=!!t;h&&r.attributes.position.count<f&&(h=!1),h&&(r.attributes.position.count,r.index&&r.index.count,r.userData.draco=t.parse(r),r.userData.draco)}}),e}},{key:"parseGeometries",value:function(e,t,r){function n(e){var r=e.uuid;a[r]||(a[r]=e.toJSON(t))}var i,a=t.geometries,o={},s=[];return e.traverse(function(e){if(e.geometry){var t=e.geometry,r=t.uuid;o[r]||((0==s.length||i.length>=10)&&(i=[],s.push(i)),i.push(t),o[r]=!0)}}),o=null,new v.default(s,function(e){e.forEach(n)}).run(r)}},{key:"parseMaterials",value:function(e,t,r){function n(e){var r=e.uuid;a[r]||(a[r]=e.toJSON(t))}var i,a=t.materials,o={},s=[];return e.traverse(function(e){if(e.material){var t=e.material;t=Array.isArray(t)?t:[t],t.forEach(function(e){var t=e.uuid;o[t]||((0==s.length||i.length>=10)&&(i=[],s.push(i)),i.push(e),o[t]=!0)})}}),o=null,new v.default(s,function(e){e.forEach(n)}).run(r)}},{key:"parseAnimations",value:function(e){console.time("animations.toJSON");var t=[];return e&&e.forEach(function(e){t.push(THREE.AnimationClip.toJSON(e))}),console.timeEnd("animations.toJSON"),t}},{key:"parse",value:function(e,t,r){function n(e){var t=[];for(var r in e){var n=e[r];delete n.metadata,t.push(n)}return t}var a=this,o=this.options.assetSrcs||{},s={};THREE.ImageUtils.getDataURL=i(o,s),e=this.preProcess(e);var u=1,l={total:100,loaded:1};r&&r(0,u,"预处理完成",l);var c,f=e.userData;f&&(c=Object.assign({},f),delete f.uri,delete f.assetSrcs);var d={metadata:{version:4.5,type:"Object",generator:"Object3D.toJSON,VISMExporter"}},h={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{}};return this.parseGeometries(e,h,function(e){l.loaded=1+.5*e,r&&(u=100*l.loaded/l.total,r(e,u,"导出几何体",l))}).then(function(){return l.loaded=51,r&&(u=l.loaded/l.total,r(100,u,"导出几何体",l)),a.parseMaterials(e,h,function(e){l.loaded=51+.48*e,r&&(u=100*l.loaded/l.total,r(e,u,"导出材质",l))})}).then(function(){l.loaded=99,r&&(u=l.loaded/l.total,r(100,u,"导出材质",l)),console.time("scene.toJSON"),d.object=e.toJSON(h).object;var i=n(h.geometries),o=n(h.materials),f=n(h.textures),p=n(h.images),m=n(h.shapes),v=n(h.skeletons);i.length>0&&(d.geometries=i),o.length>0&&(d.materials=o),f.length>0&&(d.textures=f),p.length>0&&(d.images=p),m.length>0&&(d.shapes=m),v.length>0&&(d.skeletons=v),e.userData=c,console.timeEnd("scene.toJSON");var g=a.parseAnimations(t),y={scene:d,animations:g},_=a.generateBuffer(y,s);return r&&setTimeout(function(){l.loaded=100,u=100,r(100,u,"导出完成",l)},10),_})}},{key:"postProcessImages",value:function(e,t,r){for(var i=this.options,a=i.binary,o=i.embedImages,s=i.assetSrcs||{},u=i.imageCache||{},l=i.exportDataURL,f=0;f<e.length;f++){var d=e[f];if(o){if(a){var h="image/jpeg";/image\/png/.test(d.url)&&(h="image/png");var p=d.url.replace(/data:image\/(png|jpeg);base64,/i,""),m=(0,c.toByteArray)(p);d.buffer=n(m,t),d.mimeType=h,delete d.url}}else{if(u[d.uuid]){d.url=u[d.uuid];continue}s[d.url]?d.url=s[d.url]:"function"==typeof l&&(d.url=l(d.url,f,r[d.uuid])),u[d.uuid]=d.url}}}},{key:"postProcessGeometries",value:function(e,t){for(var r=0;r<e.length;r++){var i=e[r],a=i.data,o=i.userData;if(o&&o.draco){var s=o.draco;o.draco=n(s,t),delete i.data}else{var u=a.attributes;for(var l in u)if(u.hasOwnProperty(l)&&u[l]){var c=u[l],f=y[c.type];c.array=new f(c.array),c.array=n(c.array,t)}if(a.index){var d=a.index,h=y[d.type];d.array=new h(d.array),d.array=n(d.array,t)}}}}},{key:"postProcessAnimations",value:function(e,t){e.forEach(function(e){e.tracks.forEach(function(e){var r=new Float32Array(e.times),i=new Float32Array(e.values);e.times=n(r,t),e.values=n(i,t)})})}},{key:"generateBuffer",value:function(e,t){var r=this.options.binary,n=e.scene,i=n.images,a=n.geometries,o=e.animations;Object3D.traverse(n.object,function(e){var t=e.userData;t&&(t=Object.assign({},t),e.userData=t,delete t.transformData),t&&"{}"!=JSON.stringify(t)||delete e.userData});var s="vism",u=[];if(console.time("binary"),r&&(this.postProcessGeometries(a,u),this.postProcessAnimations(o,u)),console.timeEnd("binary"),console.time("binary images"),i&&this.postProcessImages(i,u,t),console.timeEnd("binary images"),console.time("encodeObject"),e=(0,m.encodeObject)(e),console.timeEnd("encodeObject"),console.time("JSON.stringify"),e=JSON.stringify(e),console.timeEnd("JSON.stringify"),r){console.time("write");var l=(0,p.default)(e);l=new Uint8Array(l);for(var c=8+l.length,d=new Uint8Array(c),v=0;v<4;v++)d[v]=s.charCodeAt(v);for(var g=8,y=0;g<c;g++,y++)d[g]=l[y];l=null,d=f.default.getPaddedBuffer(d," ".charCodeAt(0)),c=d.length;return new DataView(d.buffer).setUint32(4,c),u.unshift(d),u=(0,h.default)(u),console.timeEnd("write"),u}return s="json    ",u=(0,p.default)(s+e)}}]),e}();r.default=_},{o_900:218,M_132:2,h_872:189,h_905:192,e_903:203,s_904:206,M_902:89,"-_873":181,e_1:235,s_2:236,M_0:241}],184:[function(e,t,r){"use strict";function n(e){var t=h[e];return t||(t=new u.DRACOLoader,h[e]=t,t.setDecoderPath(e),t.preload()),t}function i(e){var t=THREE,r=t.ObjectLoader;if(!o){var i={Float64Array:Float64Array,Float32Array:Float32Array,Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array};o={load:function(e,r,n,i,a){this.options=Object.assign({loadTexture:!0},a);var o=this,s=t.LoaderUtils.extractUrlBase(e);this.resourcePath=s,e=o.manager.resolveURL(e),o.manager.itemStart(e);var u=function(t){i?i(t):(console.trace(t),console.error(t)),o.manager.itemError(e),o.manager.itemEnd(e)},l=new t.FileLoader(o.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),"use-credentials"===o.crossOrigin&&l.setWithCredentials(!0),l.load(e,function(t){try{o.parse(t,function(e){e._memorySize=t.byteLength,r(e)},u,a),o.manager.itemEnd(e)}catch(e){u(e)}},n,u)},setDracoDecoderPath:function(e){this.dracoLoader?this.dracoDecoderPath!=e&&(this.dracoDecoderPath=e,this.dracoLoader.setDecoderPath(e),this.dracoLoader.preload()):this.dracoLoader=n(e)},setDRACOLoader:function(e){this.dracoLoader=e,this.dracoDecoderPath&&(this.dracoLoader.preload(),this.dracoLoader.setDecoderPath(this.dracoDecoderPath))},parse:function(e,r,n,i){i=i||{},i.imageCache=i.imageCache||{},i.textureCache=i.textureCache||{},this._preloadTexture="boolean"!=typeof i.loadTexture||i.loadTexture,e instanceof ArrayBuffer&&(e=new Uint8Array(e));var a=this.getMagic(e);if("vism"!=a&&"json"!=a)n(new Error("Invalid magic  :"+a));else{var o,s,u=e.buffer.byteLength;try{return"vism"==a?(u=this.getHeaderLength(e),o=e.buffer.slice(8,u),s=e.buffer.slice(u),o=t.LoaderUtils.decodeText(o),e=JSON.parse(o)):(o=e.buffer.slice(8,u),o=t.LoaderUtils.decodeText(o),e=JSON.parse(o)),(0,f.decodeObject)(e),e.animations&&this._parseAnimations(e.animations,s),this._parse(e.scene||e,s,function(t){return t.traverse(function(e){if(e.geometry){var t=e.geometry,r=t.userData;r&&r.draco}}),e.scene&&(e.scene=t,t=e),r&&r(t),t},function(e){n(e)})}catch(e){n(e)}}},_parseAnimations:function(e,t){for(var r=0;r<e.length;r++)for(var n=e[r],i=n.tracks,a=0;a<i.length;a++){var o=i[a],s=o.times,u=o.values,l=s.count,c=s.byteOffset;l&&(o.times=new Float32Array(t,c,l)),l=u.count,c=u.byteOffset,l&&(o.values=new Float32Array(t,c,l))}},_parse:function(e,t,r,n){function i(n){return a.parseImages(e.images,t).then(function(t){var i=a.parseTextures(e.textures,t),o=a.parseMaterials(e.materials,i),s=a.parseObject(e.object,n,o);return e.animations&&(s.animations=a.parseAnimations(e.animations)),void 0!==r&&r(s),s})}var a=this,o=a.parseShapes(e.shapes),s=a.parseGeometries(e.geometries,o,t);return s.then?s.then(i).catch(n):i(s).catch(n)},getHeaderLength:function(e){return new DataView(e.buffer).getUint32(d)},getMagic:function(e){for(var t=[],r=0;r<d;r++)t.push(e[r]);return t=String.fromCharCode.apply(null,t)},parseImages:function(e,r){var n,i=this,a={},o=i.options.imageCache||{},u=i._preloadTexture;if(void 0!==e&&e.length>0){var c=function(e){if(o[e.uuid])return void(a[e.uuid]=o[e.uuid]);var t=e.url;if(Array.isArray(t)){a[e.uuid]=[];return new l.default(t,function(t){var r=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(t)?t:i.resourcePath+t;if(u)return new Promise(function(t,i){var o=n.load(r,t,void 0,i);a[e.uuid].push(o)});a[e.uuid].push(r)}).run()}if(e.buffer){var c=e.buffer,f=c.byteOffset,d=c.count,h=new Uint8Array(r,f,d);t="data:"+e.mimeType+";base64,"+(0,s.fromByteArray)(h)}else t=e.url;var p=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(t)?t:i.resourcePath+t;if(u)return new Promise(function(t,r){var i=n.load(p,t,void 0,r);a[e.uuid]=i,i.uuid=e.uuid});a[e.uuid]=p,o[e.uuid]=a[e.uuid]},f=i.manager||new t.LoadingManager;n=new t.ImageLoader(f),n.setCrossOrigin(i.crossOrigin);var d=[],h=[],p={};e.forEach(function(e){if(o[e.uuid])return void(a[e.uuid]=o[e.uuid]);p[e.uuid]||(p[e.uuid]=!0,(0==h.length||d.length>=200)&&(d=[],h.push(d)),d.push(e))}),p=null;return new l.default(h,function(e){var t=e.map(c);return Promise.all(t)}).run().then(function(){return a})}return Promise.resolve(a)},parseAttributeArray:function(e,t){if(t){var r=e.array,n=r.byteOffset,a=r.count,o=i[e.type];e.array=new o(t,n,a)}},parseDracoGeometries:function(e,r){var n=this;if(e=e.filter(function(e){try{if(!n.isBufferGeometry(e))return e}catch(e){}}),e.length>0){var i=this.dracoLoader,a={attributeIDs:i.defaultAttributeIDs,attributeTypes:i.defaultAttributeTypes,useUniqueIDs:!1},o=[];return e.forEach(function(e){var t=e.userData,n=t.draco,s=n.byteOffset,u=n.count,l=new Uint8Array(r,s,u);l=l.slice().buffer;var c=i.decodeGeometry(l,a);o.push(c)}),Promise.all(o).then(function(r){var n={};return r.forEach(function(r,i){var a=e[i];r.name=a.name,r.userData=a.userData,r.uuid=a.uuid,delete a.userData.draco;var o=r.attributes;if(!o.normal&&a.userData&&a.userData.NormalBinding){for(var s=r.index?3*(c.default.minmax(r.index.array).max+1):o.position.array.length,u=a.userData.NormalArray,l=new Float32Array(3*s),f=0;f<l.length;f+=3)l[f]=u[0],l[f+1]=u[1],l[f+2]=u[2];var d=new t.BufferAttribute(l,3,!1);r.setAttribute("normal",d)}n[r.uuid]=r}),n})}return Promise.resolve({})},isBufferGeometry:function(e){var t=!!e.data;if(!t)return!1;var r=e.data,n=r.attributes;for(var i in n)if(n.hasOwnProperty(i)&&n[i]){var a=n[i];if(!a.array){t=!1;break}}return t},parseBufferGeometries:function(e,t,n){function i(e){var t=e.data,r=t.attributes;for(var i in r)if(r.hasOwnProperty(i)&&r[i]){var a=r[i];s.parseAttributeArray(a,n)}if(t.index){var o=t.index;s.parseAttributeArray(o,n)}if(!r.normal&&e.userData&&e.userData.NormalBinding){for(var u=t.index?3*(c.default.minmax(t.index.array).max+1):r.position.array.length,l=e.userData.NormalArray,f=new Float32Array(u),d=0;d<f.length;d+=3)f[d]=l[0],f[d+1]=l[1],f[d+2]=l[2];r.normal={type:"Float32Array",itemSize:3,normalize:!1,array:f}}}for(var a,o=this,s=this,u=[],f=[],d=0;d<e.length;d++){var h=e[d];this.isBufferGeometry(h)&&((0==u.length||a.length>=500)&&(a=[],u.push(a)),f.push(h),a.push(h))}return 0==u.length?Promise.resolve({}):new l.default(u,function(e){e.forEach(i)}).run().then(function(){return f=r.prototype.parseGeometries.call(o,f,t)})},parseGeometries:function(e,t,r){var n=[this.parseDracoGeometries(e,r),this.parseBufferGeometries(e,t,r)];return Promise.all(n).then(function(e){return Object.assign({},e[0],e[1])})}}}var a=new r(e);return Object.assign(a,o),a}var a=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o,s=e("o_900"),u=e("m_868"),l=a(e("h_872")),c=a(e("m_912")),f=e("h_905"),d=4,h={},p=i;r.default=p},{o_900:218,h_872:189,m_912:191,h_905:192,m_868:93,M_0:241}],185:[function(e,t,r){(function(t){(function(){"use strict";function n(e){for(var t=0,r=e.length;/(\s|\t)+/g.test(e[t])&&t<e.length;)t++;for(var n=e[r-1];/(\s|\t)+/g.test(n)&&r>0;)r--,n=e[r-1];return e.substring(t,r)}function i(e){var t=/\s+/.exec(e),r="",n=e,i=null,i=n[0];return t?(r=e.substr(0,t.index),n=e.substr(t.index+t.length),i=n[n.length-1],{name:r,dataType:i,value:n,row:e}):"}"==e?(i="}",{name:r,dataType:i,value:n,row:e}):void 0}function a(){var e=T.nextRow();return e=n(e),i(e)}function o(e){var t=T.nextBlock();t=n(t),t="["+t.replace(/(\s|\t)+/g,",")+"]";var r=JSON.parse(t),i=U[e];return i||(i=Float32Array),r=new i(r)}function s(e){for(var t=new Array(e),r=0;r<e;r++)t[r]=d();return t}function u(){var e=T.nextRow(),t=n(e).split(/\s+/),r={DrawFunc:t[0],Mode:t[1],First:parseInt(t[2]),Count:parseInt(t[3]),Indices:null};return"DrawArrays"!=r.DrawFunc&&(r.Indices=o()),r}function l(e){for(var t=[];;){var r=T.nextRow(),a=u();if(t.push(a),r=T.nextRow(),r=n(r),e=i(r),"PrimitiveSets"!=e.name)break}return t}function c(e){for(var t=[];;){var r=d();t.push(r);var a=n(T.nextRow(!0));if(e=i(a),"textureUnit"!=e.name)break;a=T.nextRow()}return t}function f(e,t){for(var r,a=e.name,s=[],u=0;;){r=e.value.split(/\s+/),u=3==r.length?1:0;var l={dataType:r[u],count:parseInt(r[u+1]),value:null,Type:"Osg::Array"};if("UniqueID"==r[1]&&(l.UniqueID=r[2],l.dataType=r[3],l.count=parseInt(r[4])),"Use"==l.dataType){var c=r[2];l=N[c]}else T.nextRow(),l.value=o(l.dataType),l.UniqueID&&(N[l.UniqueID]=l);if(s.push(l),e=i(n(T.nextRow(!0))),t&&e.name==t){T.nextRow(!0);for(var d=f(e),h=d[0],p=k[l.dataType],m=new l.value.constructor(h.count*p),v=0;v<h.count;v++)for(var g=h.value[v],y=p*g,_=p*v,b=0;b<p;b++){var M=l.value[y+b];m[_+b]=M}l.value=m,l.count=h.count;var x=T.nextRow(!0);e=i(n(x)),e.name!=a&&(T.cacheRow=x)}
if(e.name!=a)break;"Use"!=l.dataType&&T.nextRow()}return s}function d(){var e={},t={VertexArray:"VertexIndices",TexCoordArray:"TexCoordIndices"},r=a(),i=r.dataType,u=r.name,h=r.value.replace(/\"/g,"");if("Matrix"==u)return o();if("{"==i)e=d(),e.Type="Osg::"+u;else for(e[u]=n(h);T.length>0&&(r=a());)if(i=r.dataType,u=r.name,h=r.value,"Matrix"==u)e[u]=o();else if("PrimitiveSets"==u)e[u]=l(r);else if("textureUnit"==u)e[u]=c(r);else if("VertexArray"==u||"TexCoordArray"==u||"NormalArray"==u||"ColorArray"==u)e[u]=f(r,t[u]);else if("{"==i)e[u]=d(),e[u].Type="Osg::"+u;else{if("}"==i)break;"num_children"==u||"num_drawables"==u?(h=parseInt(h),e[u]=h,e.children=s(h)):(h=h.replace(/\"/g,""),e[u]=h)}return e}function h(e){var t=e.replace(/\s+/g,",");return t=JSON.parse("["+t+"]")}function p(e,t,r,n){if(e){var i=THREE;return C||(C={LINEAR:1006,LINEAR_MIPMAP_LINEAR:1008,LINEAR_MIPMAP_NEAREST:1007,NEAREST:1003,NEAREST_MIPMAP_LINEAR:1005,NEAREST_MIPMAP_NEAREST:1004},E={CLAMP_TO_EDGE:1001,REPEAT:1e3,MIRRORED:1002}),e.map(function(e){if(e.Use)return n[e.Use];var a=e.Texture2D,o=a.UniqueID,s="/"==t[t.length-1]?"":"/",u=a.file,l=t+s+u.replace(/"/g,"").replace(/(\/|\\)+/g,"/"),c=r[l];if(!c){var c=new i.Texture(l),f=u.search(/\.jpe?g($|\?)/i)>0||0===u.search(/^data\:image\/jpeg/);c.format=f?1022:1023,c.magFilter=C[a.mag_filter],c.anisotropy=parseInt(a.maxAnisotropy);var d=C[a.min_filter];c.minFilter=d,1006!=d&&1003!=d||(c.generateMipmaps=!1),c.wrapS=E[a.wrap_s],c.wrapT=E[a.wrap_t],r[l]=c,r.count=r.count?r.count+1:1}return n[o]=c,c})}}function m(e,t){var r=THREE;A||(A={NEVER:0,ALWAYS:1,LESS:2,LEQUAL:3,EQUAL:4,GEQUAL:5,GREATER:6,NOTEQUAL:7}),L||(L={ZERO:200,ONE:201,SRC_COLOR:202,SRC_ALPHA:204,SRC_ALPHA_SATURATE:210,DST_COLOR:208,DST_ALPHA:206,ONE_MINUS_SRC_COLOR:203,ONE_MINUS_SRC_ALPHA:205,ONE_MINUS_DST_COLOR:209,ONE_MINUS_DST_ALPHA:207}),P||(P={FUNC_ADD:100,FUNC_SUBTRACT:101,FUNC_REVERSE_SUBTRACT:102,MIN:103,MAX:104});var n,i=e.Material;if((i.UniqueID||i.uniqueID)&&(n=i.UniqueID||i.uniqueID,j[n]))return j[n];var a=new r.MeshPhongMaterial({side:2});a.name=i.name,"ON"==i.ColorMode&&(a.vertexColors=r.VertexColors);var o=h(i.diffuseColor);a.color=(new r.Color).fromArray(o);var s=h(i.emissionColor);a.emissive=(new r.Color).fromArray(s),a.emissiveIntensity=s[3],a.shininess=parseFloat(i.shininess);var u=h(i.specularColor);if(a.specular=(new r.Color).fromArray(u),n&&(a.userData.uniqueID=n,j[n]=a),"TRANSPARENT_BIN"==e.rendering_hint&&(a.transparent=!0),e.BlendFunc){e.BlendFunc}if("ON"==e.GL_CULL_FACE&&(a.side=0),t&&t.length>0){if(a.map=t[0],t.length>1){var l=t[1];l.minFilter=1006,a.lightMap=l}t.length>2&&t[2]!=a.map&&(a.alphaMap=t[2]),(a.alphaMap||1023==a.map.format||a.opacity<1)&&(a.depthWrite=!a.transparent)}return a}function v(e){var t=3;switch(e.dataType){case"Vec3fArray":case"Vec3dArray":case"Vec3DArray":case"Vec3Array":t=3;break;case"Vec2fArray":case"Vec2dArray":case"Vec2DArray":case"Vec2Array":t=2;break;case"Vec4fArray":case"Vec4dArray":case"Vec4DArray":case"Vec4Array":t=4}var r=e.value;return"string"==typeof r&&(r=new Float32Array((0,D.toByteArray)(r).buffer)),new THREE.BufferAttribute(r,t,e.normalize||e.Normalize)}function g(e,t,r,n){var i=THREE,a=p(e.StateSet.textureUnit,t,r,n),o=m(e.StateSet,a),s=new i.BufferGeometry;if(e.PrimitiveSets.forEach(function(e){"DrawArrays"==e.DrawFunc?s.addGroup(e.First,e.Count):s.setIndex(e.Indices)}),e.ColorArray){var u=e.ColorArray[0],l=v(u);"OVERALL"==e.ColorBinding?o.color=(new i.Color).fromArray(l.value||l.array||l):!l||o.map&&!o.vertexColors||s.setAttribute("color",l)}var c=e.VertexArray[0],f=v(c);if(s.setAttribute("position",f),e.TexCoordArray&&e.TexCoordArray.forEach(function(e,t){var r=v(e);0==t?s.setAttribute("uv",r):s.setAttribute("uv"+(t+1),r)}),e.NormalArray){var d=e.NormalArray[0];if(d=v(d),"OVERALL"==e.NormalBinding){for(var h=new Float32Array(f.count*d.itemSize),g=0;g<h.length;g+=d.itemSize)for(var y=0;y<d.itemSize;y++)h[g+y]=d.array[y];var _=new i.BufferAttribute(h,d.itemSize,d.normalize);s.userData=s.userData||{},s.userData.NormalBinding="OVERALL",s.userData.NormalArray=d.array,s.setAttribute("normal",_)}else if("PER_PRIMITIVE"==e.NormalBinding){for(var b=d.itemSize,M=new Float32Array(f.count*b),x=d.count,w=0,S=0;S<x;S++)for(var T=S*b,C=0;C<3;C++){for(var E=s.index?s.index.array[w]:w,A=E*b,L=0;L<b;L++)M[A+L]=d.array[T+L];w++}var _=new i.BufferAttribute(M,d.itemSize,d.normalize);s.setAttribute("normal",_)}else{var _=d;s.setAttribute("normal",_)}}var P=new i.Mesh(s,o);return P.name=e.name,P}function y(e,t,r,n){var i=new THREE.Group;switch(e.Type){case"Osg::Geode":case"Osg::Group":case"Osg::Node":case"Osg::MatrixTransform":e.referenceFrame&&"RELATIVE"!=e.referenceFrame&&console.warn("unsupport ReferenceFrame"+e.referenceFrame+". use RELATIVE ReferenceFrame"),e.Matrix&&(i.matrix.fromArray(e.Matrix),i.matrix.decompose(i.position,i.quaternion,i.scale),i.matrix.identity()),e.children.forEach(function(e){i.add(y(e,t,r,n))});break;case"Osg::Geometry":i=g(e,t,r,n);break;default:throw new Error("unsupport osg dataType "+e.Type+" ")}return i&&(i.Name=e.name),i}function _(e,t){return new Promise(function(r,n){var i=e.image;if("string"!=typeof i)r(e.image);else if(t&&t[i])e.image=t[i],r(e.image);else{var a=O.load(i,r,n);a._srcUrl=i,a.uuid=THREE.Math.generateUUID(),e.image=a,t&&(t[i]=a)}})}function b(e,t){e&&t(e),e.children&&e.children.forEach(function(e){b(e,t)})}function M(e){return b(e,function(e){if("Osg::Geometry"==e.Type){for(var r in e)if(e.hasOwnProperty(r)&&("VertexArray"==r||"TexCoordArray"==r||"NormalArray"==r||"ColorArray"==r)){var n=e[r];Array.isArray(n)?n.forEach(function(e){"string"!=typeof e.value&&(e.value=void 0!==t?t.from(e.value.buffer).toString("base64"):(0,D.fromByteArray)(new Uint8Array(e.value.buffer)))}):"string"!=typeof n.value&&(n.value=void 0!==t?t.from(n.value.buffer).toString("base64"):(0,D.fromByteArray)(new Uint8Array(n.value.buffer)))}e.PrimitiveSets.forEach(function(e){e.Indices&&(e.Indices=t.from(e.Indices).toString("base64"))})}e.Matrix&&(e.Matrix=Array.from(e.Matrix))}),e}function x(e,t){return T=new B(e),T.onProgress=t,d()}function w(e,t,r,n,i,a,o){var s=THREE,u=a||{},l={};N={},j={},i=i||{},o&&console.time("readOsg"),"string"==typeof e?e=x(e):e instanceof Uint8Array?(e=s.LoaderUtils.decodeText(e),e=x(e)):e instanceof ArrayBuffer&&(e=new Uint8Array(e),e=s.LoaderUtils.decodeText(e),e=x(e)),o&&console.timeEnd("readOsg"),o&&console.time("parseObject");var c=y(e,t,u,l);c.osgRoot=e,o&&console.timeEnd("parseObject");var f=Object.keys(l);if(r&&f.length>0){var d=[];O=new s.ImageLoader(n);for(var h in l)if(l.hasOwnProperty(h)){var p=l[h];d.push(_(p,i))}return a||(u={}),l={},N={},j={},Promise.all(d).then(function(){return c})}return a||(u={}),l={},N={},j={},c}var S=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.osgToJSON=M,r.readOsg=x,r.parseOsg=w;var T,C,E,A,L,P,O,R=S(e("e_1")),I=S(e("s_2")),D=e("o_900"),B=function(){function e(t){(0,R.default)(this,e),this.text=t,this.cacheRow=null,this.totalLength=t.length}return(0,I.default)(e,[{key:"length",get:function(){return this.text.length}},{key:"nextRow",value:function(e){var t=/\r?\n+/.exec(this.text);if(t){if(this.cacheRow){var r=this.cacheRow;this.cacheRow=null}else{var r=this.text.substr(0,t.index);this.text=this.text.substr(t.index+t[0].length),e&&(this.cacheRow=r),this.onProgress&&this.onProgress(this.totalLength-this.length,this.totalLength)}return r}return this.text}},{key:"nextBlock",value:function(){var e=/}\r?\n+/.exec(this.text);if(e){var t=this.text.substr(0,e.index);return this.text=this.text.substr(e.index+e[0].length),this.onProgress&&this.onProgress(this.totalLength-this.length,this.totalLength),t}return this.text}},{key:"onProgress",value:function(e,t){}}]),e}(),U={Vec2Array:Float32Array,Vec3Array:Float32Array,Vec4Array:Float32Array,UByteArray:Uint8Array,ByteArray:Int8Array,UShortArray:Uint16Array,ShortArray:Int16Array,UIntArray:Uint32Array,IntArray:Int32Array},N={},k={Vec3Array:3,Vec2Array:2,Vec4Array:2,UShortArray:1,ShortArray:1,IntArray:1,UIntArray:1},j={}}).call(this)}).call(this,e("buffer").Buffer)},{o_900:218,e_1:235,s_2:236,M_0:241,buffer:248}],186:[function(e,t,r){"use strict";function n(e){e&&e.traverse&&e.traverse(function(e){if(!e.isDestroyed||!e.isDestroyed()){if(e.destroy)return e.pickObject&&delete e.pickObject,e.pickId&&delete e.pickId,void e.destroy();if(!e.isScene&&e.dispose&&e.dispose(),e.dispatchEvent&&e.dispatchEvent({type:"dispose"},e),e.pickObject&&delete e.pickObject,e.pickId&&delete e.pickId,e._actualMesh&&(e._actualMesh.isDestroyed||e._actualMesh.destroy(),delete e._actualMesh.mesh3js,delete e._actualMesh),e.geometry){e.geometry.dispose();var t=e.geometry.attributes;for(var r in t)if(t.hasOwnProperty(r)&&t[r]){var n=t[r];delete n.array,t[r]}delete e.geometry.attributes,delete e.geometry}e.material&&(Array.isArray(e.material)?e.material.forEach(function(e){e.dispose()}):e.material.dispose(),delete e.material)}})}Object.defineProperty(r,"__esModule",{value:!0}),r.default=n},{}],187:[function(e,t,r){"use strict";function n(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(n=function(e){return e?r:t})(e)}function i(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==o(e)&&"function"!=typeof e)return{default:e};var r=n(t);if(r&&r.has(e))return r.get(e);var i={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var u=a?Object.getOwnPropertyDescriptor(e,s):null;u&&(u.get||u.set)?Object.defineProperty(i,s,u):i[s]=e[s]}return i.default=e,r&&r.set(e,i),i}var a=e("M_0"),o=e("M_110");Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"VISMLoader",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(r,"VISMExporter",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(r,"OSGLoader",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(r,"GLTFLoader",{enumerable:!0,get:function(){return f.GLTFLoader}}),Object.defineProperty(r,"DDSLoader",{enumerable:!0,get:function(){return d.DDSLoader}}),Object.defineProperty(r,"TGALoader",{enumerable:!0,get:function(){return h.TGALoader}}),Object.defineProperty(r,"BMPLoader",{enumerable:!0,get:function(){return p.BMPLoader}}),Object.defineProperty(r,"DRACOLoader",{enumerable:!0,get:function(){return m.DRACOLoader}}),Object.defineProperty(r,"RGBELoader",{enumerable:!0,get:function(){return v.RGBELoader}}),Object.defineProperty(r,"BmpDecoder",{enumerable:!0,get:function(){return g.BmpDecoder}}),Object.defineProperty(r,"DRACOExporter",{enumerable:!0,get:function(){return y.DRACOExporter}}),Object.defineProperty(r,"GLTFExporter",{enumerable:!0,get:function(){return _.GLTFExporter}}),Object.defineProperty(r,"MeshVisModel",{enumerable:!0,get:function(){return b.default}}),Object.defineProperty(r,"MeshVisModelUtil",{enumerable:!0,get:function(){return M.default}}),Object.defineProperty(r,"PagedLOD",{enumerable:!0,get:function(){return x.default}}),Object.defineProperty(r,"QuadtreeLOD",{enumerable:!0,get:function(){return w.default}}),Object.defineProperty(r,"QuadtreeLODUtil",{enumerable:!0,get:function(){return S.default}}),Object.defineProperty(r,"QuadtreeNode",{enumerable:!0,get:function(){return T.default}}),Object.defineProperty(r,"QuatreeContentSet",{enumerable:!0,get:function(){return C.default}}),Object.defineProperty(r,"releaseResources",{enumerable:!0,get:function(){return E.default}}),Object.defineProperty(r,"BuildingVector3DLoader",{enumerable:!0,get:function(){return A.default}}),Object.defineProperty(r,"parseOsg",{enumerable:!0,get:function(){return P.parseOsg}}),Object.defineProperty(r,"readOsg",{enumerable:!0,get:function(){return P.readOsg}}),Object.defineProperty(r,"CameraHelper",{enumerable:!0,get:function(){return O.default}}),Object.defineProperty(r,"Cesium3DTileExtension",{enumerable:!0,get:function(){return R.default}}),r.LODUtils=r.Osg=void 0;var s=a(e("._920")),u=a(e("C_921")),l=a(e("o_922")),c=i(e("m_923"));r.Osg=c;var f=e("M_924"),d=e("e_925"),h=e("s_926"),p=e("h_927"),m=e("-_928"),v=e("3_929"),g=e("D_930"),y=e("._931"),_=e("C_932"),b=a(e("o_933")),M=a(e("m_934")),x=a(e("M_935")),w=a(e("e_936")),S=a(e("s_937")),T=a(e("h_938")),C=a(e("-_939")),E=a(e("3_940")),A=a(e("D_941")),L=i(e("._942"));r.LODUtils=L;var P=e("C_943"),O=a(e("o_944")),R=a(e("m_945"))},{m_945:73,D_941:75,o_944:76,"._942":79,M_935:80,e_936:83,s_937:84,h_938:85,"-_939":86,D_930:88,"._931":89,C_932:90,h_927:91,e_925:92,"-_928":93,M_924:94,"3_929":95,s_926:96,m_923:179,o_933:180,m_934:181,o_922:182,C_921:183,"._920":184,C_943:185,"3_940":186,M_0:241,M_110:245}],188:[function(e,t,r){"use strict";function n(e){return 4*Math.ceil(e/4)}function i(e,t){t=t||0;var r=this.getPaddedBufferSize(e.byteLength);if(r!==e.byteLength){var n=new Uint8Array(r);if(n.set(e),0!==t)for(var i=e.byteLength;i<r;i++)n[i]=t;return n}return e}Object.defineProperty(r,"__esModule",{value:!0}),r.getPaddedBufferSize=n,r.getPaddedBuffer=i},{}],189:[function(e,t,r){"use strict";var n=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("e_1")),a=n(e("s_2")),o=function(){function e(t,r){if((0,i.default)(this,e),!t||!t.length)throw new Error("dataList is required");if("function"!=typeof r)throw new Error("workFunc is required");this.dataList=t,this.workFunc=r}return(0,a.default)(e,[{key:"run",value:function(e){var t=this;return new Promise(function(r,n){var i=t.dataList.length,a=0,o=[];!function s(){try{if(0==t.dataList.length)e&&e(100,null),r(o);else{var u=i-t.dataList.length,l=100*u/i,c=t.dataList.shift();e&&e(l,c,u,i);var f=t.workFunc(c,a),d=Array.isArray(f);d||(f=[f]),Promise.all(f).then(function(e){d||!e?o.push(e):o.push(e[0]),a++,requestAnimationFrame(s)}).catch(function(e){o.splice(0),n(e)})}}catch(e){o.splice(0),n(e)}}()})}}]),e}();r.default=o},{e_1:235,s_2:236,M_0:241}],190:[function(e,t,r){"use strict";var n=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("e_1")),a=n(e("s_2")),o=n(e("D_952")),s=n(e("._953")),u=function(){function e(){(0,i.default)(this,e)}return(0,a.default)(e,null,[{key:"layoutMap",value:function(e,t){if("undefined"==typeof MaxRectsPacker)throw new Error("MaxRectsPacker is required. https://www.npmjs.com/package/maxrects-packer");var r=[];e.forEach(function(e,t){r.push({width:e.width,height:e.height,image:e,id:t})});var n={smart:!0,pot:void 0==t||t,square:!1,allowRotation:!1,tag:!1,border:0},i=new MaxRectsPacker.MaxRectsPacker(8192,8192,0,n);return i.addArray(r),i.bins}},{key:"drawPackedMap",value:function(e,t){var r=e.rects,n=e.width,i=e.height,a=document.createElement("canvas");a.width=n,a.height=i;var o=a.getContext("2d");t&&(o.fillStyle=t,o.fillRect(0,0,n,i));for(var s=0;s<r.length;s++){var u=r[s];o.drawImage(u.image,u.x,u.y)}return a}},{key:"clipMap",value:function(e,t,r,n){var i=e.width,a=e.height,o=parseInt(i*(t[2]-t[0])),s=parseInt(a*(t[3]-t[1]));if(o==e.width&&s==e.height&&!n)return e;var u=document.createElement("canvas");u.width=o,u.height=s;var l=u.getContext("2d"),c=t[0]*i,f=t[1]*a;return r&&(f=e.height-f-s),l.drawImage(e,-c,-f),u}},{key:"rotate",value:function(e,t){var r=document.createElement("canvas");r.width=e.width,r.height=e.height;var n=r.getContext("2d");return n.translate(r.width/2,r.height/2),n.rotate(t*Math.PI/180),n.translate(-r.width/2,-r.height/2),n.drawImage(e,0,0),r}},{key:"drawText",value:function(e,t,r){r=r||{};var n=document.createElement("canvas");n.width=e.width,n.height=e.height;var i="number"==typeof r.x?r.x:n.width/2,a="number"==typeof r.y?r.y:n.height/2,o=n.getContext("2d");return o.drawImage(e,0,0),o.fillStyle=r.color,o.font=r.font,o.fillText(t,i,a),n}},{key:"getTexturesFromAtlasFile",value:function(e,t){var r=[],n=new Image;return n.onload=function(){for(var e,i,a=n.height,o=n.width/a,s=0;s<o;s++)e=document.createElement("canvas"),i=e.getContext("2d"),e.height=a,e.width=a,i.drawImage(n,a*s,0,a,a,0,0,a,a),r[s]=e;t&&t(r)},n.src=e,r}},{key:"getCubemapSources",value:function(e,t,r,n){var i=e;if(i.length){var a=["positiveX","negativeX","positiveY","negativeY","positiveZ","negativeZ"];if(1==i.length)this.getTexturesFromAtlasFile(i[0],function(e){if(1==e.length){var t={};a.forEach(function(r,n){t[r]=e[0]}),r(t)}else if(e.length<6)n("单张图片的宽度必须大于等于高度的6倍");else{var i={};e.forEach(function(e,t){i[a[t]]=e}),r(i)}});else if(i.length<6)n("图片数量必须等于6");else{var u={};if(i.forEach(function(e,r){var n=o.default.ChangeExtension(t[r],"").toLowerCase();/(nx|negx)/.test(n)?u.negativeX=e:/(px|posx)/.test(n)?u.positiveX=e:/(ny|negy)/.test(n)?u.negativeY=e:/(py|posy)/.test(n)?u.positiveY=e:/(nz|negz)/.test(n)?u.negativeZ=e:/(pz|posz)/.test(n)&&(u.positiveZ=e)}),!u.positiveX)return void n("找不到【左面】贴图，请确认包含命名为“px.<文件扩展名>”的图片");if(!u.negativeX)return void n("找不到【右面】贴图，请确认包含命名为“nx.<文件扩展名>”的图片");if(!u.negativeZ)return void n("找不到【前面】贴图，请确认包含命名为“nz.<文件扩展名>”的图片");if(!u.positiveZ)return void n("找不到【后面】贴图，请确认包含命名为“pz.<文件扩展名>”的图片");if(!u.positiveY)return void n("找不到【上面】贴图，请确认包含命名为“py.<文件扩展名>”的图片");if(!u.negativeY)return void n("找不到【下面】贴图，请确认包含命名为“ny.<文件扩展名>”的图片");new s.default(a.slice(),function(e){return new Promise(function(t,r){var n=new Image;n.crossOrigin="",n.onload=function(){t(n)},n.onerror=r,n.src=u[e]})}).run().then(function(e){for(var t=0;t<a.length;t++){var n=a[t],i=e[t];u[n]=i}r(u)})}}else n("未找到任何图片")}}]),e}();r.default=u},{"._953":189,D_952:193,e_1:235,s_2:236,M_0:241}],191:[function(e,t,r){"use strict";var n=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("e_1")),a=n(e("s_2")),o=function(){function e(){(0,i.default)(this,e)}return(0,a.default)(e,null,[{key:"add",value:function(e,t){var r,n,i;try{r=e.toString().split(".")[1].length,n=t.toString().split(".")[1].length}catch(e){r=0,n=0}return i=Math.pow(10,Math.max(r,n)),(e*i+t*i)/i}},{key:"sub",value:function(e,t){return this.add(e,-t)}},{key:"mul",value:function(e,t){var r,n,i;try{r=e.toString().split(".")[1].length,n=t.toString().split(".")[1].length}catch(e){r=0,n=0}return i=Math.pow(10,Math.max(r,n)),e*i*(t*i)/(i*i)}},{key:"div",value:function(e,t){if(0==t)return 0;var r,n,i=0,a=0;try{i=e.toString().split(".")[1].length,a=t.toString().split(".")[1].length}catch(e){}return r=Number(e.toString().replace(".","")),n=Number(t.toString().replace(".","")),r/n*Math.pow(10,a-i)}},{key:"minmax",value:function(e,t,r){t=t||0,r=r||1;for(var n=Number.MAX_VALUE,i=-Number.MAX_VALUE,a=t;a<e.length;a+=r){var o=e[a];isNaN(o)||o==1/0||o==-1/0||(n=Math.min(n,o),i=Math.max(i,o))}return{min:n,max:i}}},{key:"findCrossPoint",value:function(e,t,r,n,i,a){var o=e.x,s=t.x,u=r.x,l=n.x,c=e.y,f=t.y,d=r.y,h=n.y,p=f-c,m=o-s,v=o*f-s*c,g=h-d,y=u-l,_=u*h-l*d,b=p*y-g*m;if(0==b)return b;if(i.x=(v*y-_*m)/b,i.y=(p*_-g*v)/b,!a)return b;var M=Math.abs;return M(i.x-(o+s)/2)<=M(s-o)/2&&M(i.y-(c+f)/2)<=M(f-c)/2&&M(i.x-(u+l)/2)<=M(l-u)/2&&M(i.y-(d+h)/2)<=M(h-d)/2?b:0}},{key:"getDigits",value:function(e){var t=e.toString().split(".")[1];return t?t.length:0}},{key:"clampToLine",value:function(e,t,r){var n=Cesium.Cartesian2,i=n.subtract(e,t,new n),a=n.subtract(r,t,new n),o=i.x*a.y-a.x*i.y;if(Math.abs(o)<1e-16)return e;var s=n.magnitude(i);return n.angleBetween(i,a)<1e-16?e:(n.normalize(a,a),n.multiplyByScalar(a,s,a),n.add(t,a,e))}},{key:"distanceToSegment",value:function(e,t,r){var n=Cesium.Cartesian2,i=(Cesium.Math,n.subtract(e,t,new n)),a=n.subtract(r,t,new n),o=n.magnitude(i);if(Math.abs(o)<=1e-16)return o;var s=n.angleBetween(i,a);return o=Math.sin(s)*o}},{key:"circumcircle",value:function(e,t,r){var n,i,a=t.x-e.x,o=t.y-e.y,s=r.x-e.x,u=r.y-e.y,l=a*(e.x+t.x)+o*(e.y+t.y),c=s*(e.x+r.x)+u*(e.y+r.y),f=2*(a*(r.y-t.y)-o*(r.x-t.x)),d=(u*l-o*c)/f,h=(a*c-s*l)/f;n=d-e.x,i=h-e.y;var p=n*n+i*i;return{x:d,y:h,r:Math.sqrt(p),r2:p}}},{key:"pointOnSegment",value:function(e,t,r,n,i){var a=Math.min,o=Math.max,s=Math.abs;n=void 0==n||null==n?1e-8:n,i=void 0==i||null==i?1:i;var u=a(t.x,r.x),l=o(t.x,r.x),c=a(t.y,r.y),f=o(t.y,r.y);if(u-n<=e.x&&e.x<=l+n&&c-n<=e.y&&e.y<=f+n){var d=Cesium.Cartesian2,h=Cesium.Math,p=d.subtract(e,t,new d),m=d.subtract(r,t,new d);if(s(p.x*m.y-m.x*p.y)<1e-16)return!0;var v=d.angleBetween(p,m);return(v=h.toDegrees(v))<=i}return!1}},{key:"pointInPolygon",value:function(e,t){for(var r=t.length,n=e.x,i=e.y,a=!1,o=0,s=r-1;o<r;s=o++){var u=t[o].x,l=t[o].y,c=t[s].x,f=t[s].y;l>i!=f>i&&n<(c-u)*(i-l)/(f-l)+u&&(a=!a)}return a}},{key:"pointOnTriangle",value:function(t,r,n,i){var a=e.pointOnSegment(t,r,n);return!!a&&(!!(a=e.pointOnSegment(t,r,i))&&(a=e.pointOnSegment(t,n,i)))}}]),e}();r.default=o},{e_1:235,s_2:236,M_0:241}],192:[function(e,t,r){"use strict";function n(e,t,r){var n=r.length;return t.has(e)?n=t.get(e):(t.set(e,n),r.push(e)),n}function i(e,t,r){for(var a in e)if(e.hasOwnProperty(a)){if(!Object.isExtensible(e))continue;var o=e[a],s=r[a],u=r.length.toString();if("string"==typeof o&&o.length>u.length||"color"==s||"matrix"==s)"matrix"==s&&(o=o.join(",")),o=t.has(o)?"$"+t.get(o):"$"+n(o,t,r);else if(Array.isArray(o))for(var l=0;l<o.length;l++){var c=o[l];"object"==(0,v.default)(c)&&i(c,t,r)}else"object"==(0,v.default)(o)&&i(o,t,r);e[a]=o}}function a(e,t,r){for(var n=0;n<e.length;n++){var i=e[n];if(Array.isArray(i)){if("number"==typeof i[0])continue;a(i,t,r)}else"object"==(0,v.default)(i)&&s(i,t,r)}}function o(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(Array.isArray(n)){if("number"==typeof n[0])continue;o(n,t)}else"object"==(0,v.default)(n)&&u(n,t)}}function s(e,t,r){var o=!1;t||(t=new Map,r=[],o=!0);for(var u in e)if(e.hasOwnProperty(u)){var l=e[u];(0,_.default)(l)?l=Array.from(l):Array.isArray(l)?a(l,t,r):"object"==(0,v.default)(l)?s(l,t,r):"type"!=u&&"uuid"!=u||(l=n(l,t,r));var c=n(u,t,r);e[c]=l,delete e[u]}return o&&(i(e,t,r),e.codeBook=r,t.clear()),e}function u(e,t){t||(t=e.codeBook,delete e.codeBook);for(var r in e)if(e.hasOwnProperty(r)){var n=e[r],i=t[r];"uuid"==i||"type"==i?n=t[n]:"string"==typeof n&&"$"==n[0]?(n=t[n.slice(1)],"matrix"==i?n=JSON.parse("["+n+"]"):Array.isArray(n)?o(n,t):"object"==(0,v.default)(n)&&u(n,t)):Array.isArray(n)?o(n,t):"object"==(0,v.default)(n)&&u(n,t),e[i||r]=n,i&&delete e[r]}return e}function l(e,t){if("number"==typeof e[0][0]){0==t.length&&(t.byteLength=0);var r=e.length,n=[];e.forEach(function(e){n.push(e[0],e[1])}),n=new Float32Array(n).buffer;var i=n.byteLength,a=t.byteLength;return t.push(n),t.byteLength+=i,{byteOffset:a,count:r}}for(var o=0;o<e.length;o++)e[o]=l(e[o],t);return e}function c(e,t){if("number"==typeof e.byteOffset){var r=e,n=r.byteOffset,i=r.count,a=new Float32Array(t.buffer||t,n,2*i);e=[];for(var o=0;o<a.length;o+=2)e.push([a[o],a[o+1]])}else for(var s=0;s<e.length;s++)e[s]=c(e[s],t);return e}function f(e){console.time("encodeGeojsonCoords");var t=[];return"FeatureCollection"==e.type?e.features.forEach(function(e){e.geometry&&l(e.geometry.coordinates,t)}):"Feature"==e.type&&e.geometry&&l(e.geometry.coordinates,t),console.timeEnd("encodeGeojsonCoords"),console.time("encodeObject"),e=s(e),console.timeEnd("encodeObject"),console.time("mergeBuffers"),e.buffer=(0,b.default)(t),console.timeEnd("mergeBuffers"),console.time("fromByteArray"),e.buffer=(0,g.fromByteArray)(new Uint8Array(e.buffer)),console.timeEnd("fromByteArray"),e}function d(e){if(console.time("decodeObject"),e.codeBook){var t=e.codeBook;for(var r in e)if(e.hasOwnProperty(r)){var n=t[r];n&&(e[n]=e[r],delete e[r])}u(e)}console.timeEnd("decodeObject");var i=e.buffer;if(delete e.buffer,i){if(console.time("toByteArray"),i=(0,g.toByteArray)(i),console.timeEnd("toByteArray"),console.time("decodeGeojsonCoords"),"FeatureCollection"==e.type){e.features.forEach(function(e,t){var r=e.geometry;r&&(r.coordinates=c(r.coordinates,i))})}else if("Feature"==e.type){var a=e.geometry;a&&(a.coordinates=c(a.coordinates,i))}console.timeEnd("decodeGeojsonCoords"),delete e.buffer}return e}function h(e,t,r){r=r||0;var n=e.buffer;if(delete e.buffer,console.time("toByteArray"),n=(0,g.toByteArray)(n),console.timeEnd("toByteArray"),console.time("decodeGeojsonCoords"),"FeatureCollection"==e.type){var i=e.features,a=[],o=[],s=i.length>1e4?i.length/80:i.length/40;return a.push(o),i.forEach(function(e,t){e.geometry&&(o.length>s&&(o=[],a.push(o)),o.push(e))}),new y.default(a,function(e){e.forEach(function(e){var t=e.geometry;t.coordinates=c(t.coordinates,n)})}).run(function(e){t&&t(r+.5*e)}).then(function(){return console.timeEnd("decodeGeojsonCoords"),r=100,t&&t(r),e})}if("Feature"==e.type){var u=e.geometry;u&&(u.coordinates=c(u.coordinates,n))}return console.timeEnd("decodeGeojsonCoords"),Promise.resolve(e)}function p(e,t){if(e.codeBook){console.time("decodeObject");var r=e.codeBook;delete e.codeBook;for(var n in e)if(e.hasOwnProperty(n)){var i=r[n],a=e[n],o=r[a];void 0!==o&&(e[n]=o),i&&(e[i]=e[n],delete e[n])}if("Feature"!=e.type){var s=e.features,l=[],c=[],f=0,d=s.length>1e4?s.length/80:s.length/40;l.push(c);var p=r.indexOf("geometry");return s.forEach(function(e,t){e[p]&&(c.length>d&&(c=[],l.push(c)),c.push(e))}),new y.default(l,function(e){e.forEach(function(e){u(e,r)})}).run(function(e){f=.5*e,t&&t(f)}).then(function(){return console.timeEnd("decodeObject"),f=50,t&&t(f),h(e,t,f)})}u(e)}return e.buffer?h(e):Promise.resolve(e)}var m=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.encodeObjectValues=i,r.encodeObject=s,r.decodeObject=u,r.encodeGeojsonCoords=l,r.decodeGeojsonCoords=c,r.encodeGeojson=f,r.decodeGeojson=d,r.decodeGeojsonCoordsAsync=h,r.decodeGeojsonAsync=p;var v=m(e("M_110")),g=e("s_959"),y=m(e("._953")),_=m(e("-_961")),b=m(e("3_962"))},{s_959:218,"._953":189,"-_961":200,"3_962":203,M_0:241,M_110:245}],193:[function(e,t,r){"use strict";function n(){}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,n.GetExtension=function(e){var t=e.lastIndexOf(".");return t>=0?e.substring(t,e.length):""},n.GetFileName=function(e){var t=e.lastIndexOf("/");return t<0&&(t=e.lastIndexOf("\\"))<0?e:e.substring(t+1,e.length)},n.GetDirectoryName=function(e){var t=e.lastIndexOf("/");return t<0?"":e.substring(0,t)},n.Combine=function(e,t){return e+t},n.ChangeExtension=function(e,t){return e.replace(n.GetExtension(e),t)};var i=n;r.default=i},{}],194:[function(e,t,r){"use strict";var n=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("e_1")),a=n(e("s_2")),o=function(){function e(){(0,i.default)(this,e)}return(0,a.default)(e,null,[{key:"trim",value:function(e,t){var r=0,n=e.length;for(t=t||"(\\s|\\t)+",t=new RegExp(t);t.test(e[r])&&r<e.length;)r++;for(var i=e[n-1];t.test(i)&&n>0;)n--,i=e[n-1];return e.substring(r,n)}},{key:"paddingStart",value:function(e,t){var r=e>=0?"+":"-";e=Math.abs(e),e+="";var n=t-e.length;return e=r+new Array(n).fill("0").join("")+e}}]),e}();r.default=o},{e_1:235,s_2:236,M_0:241}],195:[function(e,t,r){"use strict";function n(e,t,r){if(!e||!t||!r)return console.warn(e,t,r),0;var n=Cesium.Cartesian3,i=n.distance(e,t),a=n.distance(t,r),o=n.distance(e,r),s=(i+a+o)/2;return Math.sqrt(s*(s-i)*(s-a)*(s-o))}Object.defineProperty(r,"__esModule",{value:!0}),r.default=n},{}],196:[function(e,t,r){"use strict";function n(e,t,r,n){var i="_"+t;e[i]=r;var a={get:function(){return this[i]},set:function(t){var r=t!=this[i];this[i]&&this[i].equals&&t&&(r=this[i].equals(t));var a=this[i];this[i]=t,"function"==typeof n&&r&&n(r,e,t,a)}},o={};o[t]=a,Object.defineProperties(e,o)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n;r.default=i},{}],197:[function(e,t,r){"use strict";function n(e){var t=e,r=t[0],n=t[4],i=t[8],a=t[12],o=t[1],s=t[5],u=t[9],l=t[13],c=t[2],f=t[6],d=t[10],h=t[14];return t[3]*(+a*u*f-i*l*f-a*s*d+n*l*d+i*s*h-n*u*h)+t[7]*(+r*u*h-r*l*d+a*o*d-i*o*h+i*l*c-a*u*c)+t[11]*(+r*l*f-r*s*h-a*o*f+n*o*h+a*s*c-n*l*c)+t[15]*(-i*s*c-r*u*f+r*s*d+i*o*f-n*o*d+n*u*c)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=n},{}],198:[function(e,t,r){"use strict";function n(e,t){var r,n=t.constructor,i=t.prototype,a=t.esConstructor;if(e.prototype.constructor.toString().startsWith("class")){r=a(n);for(var o in i)Object.hasOwnProperty.call(i,o)&&(r.prototype[o]=i[o])}else r=function(){e.apply(this,arguments),n.apply(this,arguments)},i.constructor=r,r.prototype=Object.assign(Object.create(e.prototype),i);return r}Object.defineProperty(r,"__esModule",{value:!0}),r.default=n},{}],199:[function(e,t,r){"use strict";var n=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("e_1")),a=n(e("s_2")),o=function(){function e(){(0,i.default)(this,e)}return(0,a.default)(e,null,[{key:"area",value:function(e){for(var t=e.length,r=0,n=t-1,i=0;i<t;n=i++)r+=e[n][0]*e[i][1]-e[i][0]*e[n][1];return.5*r}},{key:"isClockWise",value:function(t){return e.area(t)<0}},{key:"featureEach",value:function(e,t){if("Feature"==e.type)t(e,0);else{e.features;for(var r=0;r<e.features.length;r++){t(e.features[r],r)}}}},{key:"geometryEach",value:function(e,t){var r=e.type;if("Feature"==r||"FeatureCollection"==r)this.featureEach(e,function(e,r){var n=e.geometry;"MultiGeometry"==n.type?n.geometry.forEach(function(e,n){t(e,r,n)}):t(n,r,0)});else{var n=e;"MultiGeometry"==r?n.geometry.forEach(function(e,r){t(e,0,r)}):t(n,0,0)}}},{key:"coordinateEach",value:function(e,t){this.geometryEach(e,function(e,r,n){var i=e.type,a=e.coordinates;"LineString"==i||"MultiPoint"==i?a.forEach(t):"MultiLineString"==i||"Polygon"==i?a.forEach(function(e){e.forEach(t)}):"Point"==i?t(a):"MultiPolygon"==i&&a.forEach(function(e){e.forEach(function(e){e.forEach(t)})})})}},{key:"calcBBox",value:function(e){var t=this,r=[Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE];return this.featureEach(e,function(e){if(e&&e.geometry){var n=e.geometry.bbox;if(n){if(0==n.filter(function(e){if(!isNaN(e))return e}).length)return}var i=[],a=[];t.coordinateEach(e,function(e){i.length>0?(i[0]=Math.min(e[0],i[0]),i[1]=Math.min(e[1],i[1]),a[0]=Math.max(e[0],a[0]),a[1]=Math.max(e[1],a[1])):(i[0]=e[0],i[1]=e[1],a[0]=e[0],a[1]=e[1])}),e.geometry.bbox=[i[0],i[1],a[0],a[1]],r[0]=Math.min(r[0],i[0]),r[1]=Math.min(r[1],i[1]),r[2]=Math.max(r[2],a[0]),r[3]=Math.max(r[3],a[1])}}),r}}]),e}();r.default=o},{e_1:235,s_2:236,M_0:241}],200:[function(e,t,r){"use strict";function n(e){return e instanceof Float32Array||e instanceof Float64Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray}Object.defineProperty(r,"__esModule",{value:!0}),r.default=n},{}],201:[function(e,t,r){"use strict";function n(e,t,r,n,i){var a=t.y-e.y,o=e.x-t.x,s=e.x*t.y-t.x*e.y,u=n.y-r.y,l=r.x-n.x,c=r.x*n.y-n.x*r.y,f=a*l-u*o;return 0==f?f:(i.x=(s*l-c*o)/f,i.y=(a*c-u*s)/f,f)}function i(e,t){var r=(new THREE.Vector2).copy(e).sub(t).normalize();return r=new THREE.Vector2(-r.y,r.x)}function a(e,t,r,a){var s=i(t,e),u=i(e,r);s.multiplyScalar(a),u.multiplyScalar(a);var l=(new THREE.Vector2).copy(s).add(e),c=(new THREE.Vector2).copy(u).add(e),f=(new THREE.Vector2).copy(s).add(t),d=(new THREE.Vector2).copy(u).add(r),h=new THREE.Vector2;if(!n(f,l,c,d,h)){var p=i(t,e);return p.multiplyScalar(a)}var p=h.sub(e);return o(p,a)?(p=i(t,e),p.multiplyScalar(a)):p}function o(e,t){return e=(new THREE.Vector2).copy(e).divideScalar(t),e.length()>2*t}function s(e,t,r,n){var o;return r?t?o=a(e,t,r,n):(o=i(r,e),o.multiplyScalar(n),o):(o=i(t,e),o.multiplyScalar(n),o)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var u=s;r.default=u},{}],202:[function(e,t,r){"use strict";function n(e,t,r,n){n||(n=new Cesium.Matrix4),r=r||u;var l=Cesium.Cartesian3;return o||(o=new l),s||(s=new l),a||(a=new l),l.subtract(t,e,a),l.normalize(a,a),i(a,r,n)}function i(e,t,r){r||(r=new Cesium.Matrix4),t=t||u;var n=r,i=Cesium.Cartesian3;return o||(o=new i),s||(s=new i),e!=a&&(a=i.clone(e)),0===i.magnitudeSquared(a)&&(a.z=1),i.cross(t,a,o),0===i.magnitudeSquared(o)&&(1===Math.abs(t.z)?a.x+=1e-4:a.z+=1e-4,i.normalize(a,a),i.cross(t,a,o)),i.normalize(o,o),i.cross(a,o,s),n[0]=o.x,n[4]=s.x,n[8]=a.x,n[1]=o.y,n[5]=s.y,n[9]=a.y,n[2]=o.z,n[6]=s.z,
n[10]=a.z,n}Object.defineProperty(r,"__esModule",{value:!0}),r.default=n,r.matrix4LookDirection=i;var a,o,s,u={x:0,y:0,z:1}},{}],203:[function(e,t,r){"use strict";function n(e){e=e.map(function(e){return e instanceof DataView||e instanceof Uint8Array?e.buffer:e});var t=0;e.forEach(function(e){return t+=e.byteLength});var r=new Uint8Array(t),n=0;return e.forEach(function(e){r.set(new Uint8Array(e),n),n+=e.byteLength}),r.buffer}Object.defineProperty(r,"__esModule",{value:!0}),r.default=n},{}],204:[function(e,t,r){"use strict";function n(e){var t=[];for(var r in e.defines)if(e.defines.hasOwnProperty(r)){var n=e.defines[r];t.push("#define "+r+" "+n)}return t=t.join("\n")+"\n",e.fragmentShader&&(e.fragmentShader=t+e.fragmentShader),e.vertexShader&&(e.vertexShader=t+e.vertexShader),e}Object.defineProperty(r,"__esModule",{value:!0}),r.default=n},{}],205:[function(e,t,r){"use strict";function n(){s||(s=document.createElement("a"),s.style.display="none",document.body.appendChild(s))}function i(e,t){n(),s.href=URL.createObjectURL(e),s.download=t,s.click()}function a(e,t){i(new Blob([e],{type:"text/plain"}),t)}function o(e,t){i(new Blob([e],{type:"application/octet-stream"}),t)}Object.defineProperty(r,"__esModule",{value:!0}),r.save=i,r.saveString=a,r.saveArrayBuffer=o;var s},{}],206:[function(e,t,r){"use strict";function n(e){if("undefined"!=typeof TextEncoder)return(new TextEncoder).encode(e).buffer;for(var t=new Uint8Array(new ArrayBuffer(e.length)),r=0,n=e.length;r<n;r++){var i=e.charCodeAt(r);t[r]=i>255?32:i}return t.buffer}Object.defineProperty(r,"__esModule",{value:!0}),r.default=n},{}],207:[function(e,t,r){"use strict";function n(e,t,r){if(Array.isArray(e))for(var i=0;i<e.length;i++){var a=e[i];n(a,t,e)}else{t(e,r);var o=e.children;if(!o)return;for(var s=o.length,u=0;u<s;u++){n(o[u],t,e)}}}Object.defineProperty(r,"__esModule",{value:!0}),r.default=n},{}],208:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=function(){function e(e,t){return t.x-e.x}function t(e){var t,r,n,i,a,o=e.length;e:for(;o;)for(r=e[--o],t=e[--o],n=o;n;)if(a=e[--n],i=e[--n],t===i&&r===a||t===a&&r===i){e.splice(o,2),e.splice(n,2),o-=2;continue e}}function r(r){if(r.length<3)return[];r.sort(e);for(var i,a,o,s,u,l,c=r.length-1,f=r[c].x,d=r[0].x,h=r[c].y,p=h;c--;)r[c].y<h&&(h=r[c].y),r[c].y>p&&(p=r[c].y);var m,v=d-f,g=p-h,y=v>g?v:g,_=.5*(d+f),b=.5*(p+h),M=[new n({__sentinel:!0,x:_-20*y,y:b-y},{__sentinel:!0,x:_,y:b+20*y},{__sentinel:!0,x:_+20*y,y:b-y})],x=[],w=[];for(c=r.length;c--;){for(w.length=0,m=M.length;m--;)v=r[c].x-M[m].x,v>0&&v*v>M[m].r?(x.push(M[m]),M.splice(m,1)):(g=r[c].y-M[m].y,v*v+g*g>M[m].r||(w.push(M[m].a,M[m].b,M[m].b,M[m].c,M[m].c,M[m].a),M.splice(m,1)));for(t(w),m=w.length;m;)a=w[--m],i=w[--m],o=r[c],s=a.x-i.x,u=a.y-i.y,l=2*(s*(o.y-a.y)-u*(o.x-a.x)),Math.abs(l)>1e-12&&M.push(new n(i,a,o))}for(Array.prototype.push.apply(x,M),c=x.length;c--;)(x[c].a.__sentinel||x[c].b.__sentinel||x[c].c.__sentinel)&&x.splice(c,1);return x}var n=function(){function e(e,t,r){this.a=e,this.b=t,this.c=r;var n,i,a=t.x-e.x,o=t.y-e.y,s=r.x-e.x,u=r.y-e.y,l=a*(e.x+t.x)+o*(e.y+t.y),c=s*(e.x+r.x)+u*(e.y+r.y),f=2*(a*(r.y-t.y)-o*(r.x-t.x));this.x=(u*l-o*c)/f,this.y=(a*c-s*l)/f,n=this.x-e.x,i=this.y-e.y,this.r=n*n+i*i}return e}();return r}(),i=n;r.default=i},{}],209:[function(e,t,r){"use strict";var n=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"computeArea",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(r,"defineProperty",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(r,"determinant",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(r,"esExtends",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(r,"GenericWorker",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(r,"geojsonHelper",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(r,"ImageUtils",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(r,"isTypedArray",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(r,"lineBufferDir3",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(r,"MathUtils",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(r,"matrix4LookAt",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(r,"mergeBuffers",{enumerable:!0,get:function(){return m.default}}),Object.defineProperty(r,"decodeGeojson",{enumerable:!0,get:function(){return v.decodeGeojson}}),Object.defineProperty(r,"decodeGeojsonAsync",{enumerable:!0,get:function(){return v.decodeGeojsonAsync}}),Object.defineProperty(r,"decodeGeojsonCoords",{enumerable:!0,get:function(){return v.decodeGeojsonCoords}}),Object.defineProperty(r,"decodeGeojsonCoordsAsync",{enumerable:!0,get:function(){return v.decodeGeojsonCoordsAsync}}),Object.defineProperty(r,"decodeObject",{enumerable:!0,get:function(){return v.decodeObject}}),Object.defineProperty(r,"encodeGeojson",{enumerable:!0,get:function(){return v.encodeGeojson}}),Object.defineProperty(r,"encodeGeojsonCoords",{enumerable:!0,get:function(){return v.encodeGeojsonCoords}}),Object.defineProperty(r,"encodeObject",{enumerable:!0,get:function(){return v.encodeObject}}),Object.defineProperty(r,"encodeObjectValues",{enumerable:!0,get:function(){return v.encodeObjectValues}}),Object.defineProperty(r,"parseDefines",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(r,"Path",{enumerable:!0,get:function(){return y.default}}),Object.defineProperty(r,"save",{enumerable:!0,get:function(){return _.save}}),Object.defineProperty(r,"saveArrayBuffer",{enumerable:!0,get:function(){return _.saveArrayBuffer}}),Object.defineProperty(r,"saveString",{enumerable:!0,get:function(){return _.saveString}}),Object.defineProperty(r,"stringToArrayBuffer",{enumerable:!0,get:function(){return b.default}}),Object.defineProperty(r,"StringUtil",{enumerable:!0,get:function(){return M.default}}),Object.defineProperty(r,"traverse",{enumerable:!0,get:function(){return x.default}}),Object.defineProperty(r,"triangulate",{enumerable:!0,get:function(){return w.default}}),Object.defineProperty(r,"getPaddedBuffer",{enumerable:!0,get:function(){return S.getPaddedBuffer}}),Object.defineProperty(r,"getPaddedBufferSize",{enumerable:!0,get:function(){return S.getPaddedBufferSize}});var i=n(e("s_970")),a=n(e("h_971")),o=n(e("-_972")),s=n(e("3_973")),u=n(e("D_974")),l=n(e("._975")),c=n(e("C_976")),f=n(e("o_977")),d=n(e("m_978")),h=n(e("M_979")),p=n(e("e_980")),m=n(e("s_981")),v=e("h_982"),g=n(e("-_983")),y=n(e("3_984")),_=e("D_985"),b=n(e("._986")),M=n(e("C_987")),x=n(e("o_988")),w=n(e("m_989")),S=e("M_990")},{M_990:188,D_974:189,C_976:190,M_979:191,h_982:192,"3_984":193,C_987:194,s_970:195,h_971:196,"-_972":197,"3_973":198,"._975":199,o_977:200,m_978:201,e_980:202,s_981:203,"-_983":204,D_985:205,"._986":206,o_988:207,m_989:208,M_0:241}],210:[function(e,t,r){"use strict";function n(e,t,r){void 0===r&&(r={});for(var n=(0,l.getGeom)(e),i=n.coordinates,c=0,f=0;f<i.length&&!(t>=c&&f===i.length-1);f++){if(c>=t){var d=t-c;if(d){var h=(0,a.default)(i[f],i[f-1])-180;return(0,o.default)(i[f],d,h,r)}return(0,u.point)(i[f])}c+=(0,s.default)(i[f],i[f+1],r)}return(0,u.point)(i[i.length-1])}var i=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=n;var a=i(e("s_992")),o=i(e("h_993")),s=i(e("-_994")),u=e("3_995"),l=e("D_996")},{s_992:211,h_993:212,"-_994":213,"3_995":214,D_996:215,M_0:241}],211:[function(e,t,r){"use strict";function n(e,t,r){if(void 0===r&&(r={}),!0===r.final)return i(e,t);var n=(0,o.getCoord)(e),s=(0,o.getCoord)(t),u=(0,a.degreesToRadians)(n[0]),l=(0,a.degreesToRadians)(s[0]),c=(0,a.degreesToRadians)(n[1]),f=(0,a.degreesToRadians)(s[1]),d=Math.sin(l-u)*Math.cos(f),h=Math.cos(c)*Math.sin(f)-Math.sin(c)*Math.cos(f)*Math.cos(l-u);return(0,a.radiansToDegrees)(Math.atan2(d,h))}function i(e,t){var r=n(t,e);return r=(r+180)%360}Object.defineProperty(r,"__esModule",{value:!0}),r.default=n;var a=e("3_995"),o=e("D_996")},{"3_995":214,D_996:215}],212:[function(e,t,r){"use strict";function n(e,t,r,n){void 0===n&&(n={});var o=(0,a.getCoord)(e),s=(0,i.degreesToRadians)(o[0]),u=(0,i.degreesToRadians)(o[1]),l=(0,i.degreesToRadians)(r),c=(0,i.lengthToRadians)(t,n.units),f=Math.asin(Math.sin(u)*Math.cos(c)+Math.cos(u)*Math.sin(c)*Math.cos(l)),d=s+Math.atan2(Math.sin(l)*Math.sin(c)*Math.cos(u),Math.cos(c)-Math.sin(u)*Math.sin(f)),h=(0,i.radiansToDegrees)(d),p=(0,i.radiansToDegrees)(f);return(0,i.point)([h,p],n.properties)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=n;var i=e("3_995"),a=e("D_996")},{"3_995":214,D_996:215}],213:[function(e,t,r){"use strict";function n(e,t,r){void 0===r&&(r={});var n=(0,i.getCoord)(e),o=(0,i.getCoord)(t),s=(0,a.degreesToRadians)(o[1]-n[1]),u=(0,a.degreesToRadians)(o[0]-n[0]),l=(0,a.degreesToRadians)(n[1]),c=(0,a.degreesToRadians)(o[1]),f=Math.pow(Math.sin(s/2),2)+Math.pow(Math.sin(u/2),2)*Math.cos(l)*Math.cos(c);return(0,a.radiansToLength)(2*Math.atan2(Math.sqrt(f),Math.sqrt(1-f)),r.units)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=e("D_996"),a=e("3_995"),o=n;r.default=o},{"3_995":214,D_996:215}],214:[function(e,t,r){"use strict";function n(e,t,r){void 0===r&&(r={});var n={type:"Feature"};return(0===r.id||r.id)&&(n.id=r.id),r.bbox&&(n.bbox=r.bbox),n.properties=t||{},n.geometry=e,n}function i(e,t,r){switch(void 0===r&&(r={}),e){case"Point":return a(t).geometry;case"LineString":return l(t).geometry;case"Polygon":return s(t).geometry;case"MultiPoint":return h(t).geometry;case"MultiLineString":return d(t).geometry;case"MultiPolygon":return p(t).geometry;default:throw new Error(e+" is invalid")}}function a(e,t,r){if(void 0===r&&(r={}),!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!T(e[0])||!T(e[1]))throw new Error("coordinates must contain numbers");return n({type:"Point",coordinates:e},t,r)}function o(e,t,r){return void 0===r&&(r={}),f(e.map(function(e){return a(e,t)}),r)}function s(e,t,r){void 0===r&&(r={});for(var i=0,a=e;i<a.length;i++){var o=a[i];if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;s<o[o.length-1].length;s++)if(o[o.length-1][s]!==o[0][s])throw new Error("First and last Position are not equivalent.")}return n({type:"Polygon",coordinates:e},t,r)}function u(e,t,r){return void 0===r&&(r={}),f(e.map(function(e){return s(e,t)}),r)}function l(e,t,r){if(void 0===r&&(r={}),e.length<2)throw new Error("coordinates must be an array of two or more positions");return n({type:"LineString",coordinates:e},t,r)}function c(e,t,r){return void 0===r&&(r={}),f(e.map(function(e){return l(e,t)}),r)}function f(e,t){void 0===t&&(t={});var r={type:"FeatureCollection"};return t.id&&(r.id=t.id),t.bbox&&(r.bbox=t.bbox),r.features=e,r}function d(e,t,r){return void 0===r&&(r={}),n({type:"MultiLineString",coordinates:e},t,r)}function h(e,t,r){return void 0===r&&(r={}),n({type:"MultiPoint",coordinates:e},t,r)}function p(e,t,r){return void 0===r&&(r={}),n({type:"MultiPolygon",coordinates:e},t,r)}function m(e,t,r){return void 0===r&&(r={}),n({type:"GeometryCollection",geometries:e},t,r)}function v(e,t){if(void 0===t&&(t=0),t&&!(t>=0))throw new Error("precision must be a positive number");var r=Math.pow(10,t||0);return Math.round(e*r)/r}function g(e,t){void 0===t&&(t="kilometers");var r=O[t];if(!r)throw new Error(t+" units is invalid");return e*r}function y(e,t){void 0===t&&(t="kilometers");var r=O[t];if(!r)throw new Error(t+" units is invalid");return e/r}function _(e,t){return M(y(e,t))}function b(e){var t=e%360;return t<0&&(t+=360),t}function M(e){return e%(2*Math.PI)*180/Math.PI}function x(e){return e%360*Math.PI/180}function w(e,t,r){if(void 0===t&&(t="kilometers"),void 0===r&&(r="kilometers"),!(e>=0))throw new Error("length must be a positive number");return g(y(e,t),r)}function S(e,t,r){if(void 0===t&&(t="meters"),void 0===r&&(r="kilometers"),!(e>=0))throw new Error("area must be a positive number");var n=I[t];if(!n)throw new Error("invalid original units");var i=I[r];if(!i)throw new Error("invalid final units");return e/n*i}function T(e){return!isNaN(e)&&null!==e&&!Array.isArray(e)}function C(e){return!!e&&e.constructor===Object}function E(e){if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be an Array");if(4!==e.length&&6!==e.length)throw new Error("bbox must be an Array of 4 or 6 numbers");e.forEach(function(e){if(!T(e))throw new Error("bbox must only contain numbers")})}function A(e){if(!e)throw new Error("id is required");if(-1===["string","number"].indexOf((0,P.default)(e)))throw new Error("id must be a number or a string")}var L=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.feature=n,r.geometry=i,r.point=a,r.points=o,r.polygon=s,r.polygons=u,r.lineString=l,r.lineStrings=c,r.featureCollection=f,r.multiLineString=d,r.multiPoint=h,r.multiPolygon=p,r.geometryCollection=m,r.round=v,r.radiansToLength=g,r.lengthToRadians=y,r.lengthToDegrees=_,r.bearingToAzimuth=b,r.radiansToDegrees=M,r.degreesToRadians=x,r.convertLength=w,r.convertArea=S,r.isNumber=T,r.isObject=C,r.validateBBox=E,r.validateId=A,r.areaFactors=r.unitsFactors=r.factors=r.earthRadius=void 0;var P=L(e("M_110"));r.earthRadius=6371008.8;var O={centimeters:637100880,centimetres:637100880,degrees:6371008.8/111325,feet:20902260.511392,inches:6371008.8*39.37,kilometers:6371.0088,kilometres:6371.0088,meters:6371008.8,metres:6371008.8,miles:3958.761333810546,millimeters:6371008800,millimetres:6371008800,nauticalmiles:6371008.8/1852,radians:1,yards:6371008.8*1.0936};r.factors=O;var R={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/6371008.8,yards:1.0936133};r.unitsFactors=R;var I={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:3.86e-7,millimeters:1e6,millimetres:1e6,yards:1.195990046};r.areaFactors=I},{M_0:241,M_110:245}],215:[function(e,t,r){"use strict";function n(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if("Feature"===e.type&&null!==e.geometry&&"Point"===e.geometry.type)return e.geometry.coordinates;if("Point"===e.type)return e.coordinates}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return e;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function i(e){if(Array.isArray(e))return e;if("Feature"===e.type){if(null!==e.geometry)return e.geometry.coordinates}else if(e.coordinates)return e.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function a(e){if(e.length>1&&(0,f.isNumber)(e[0])&&(0,f.isNumber)(e[1]))return!0;if(Array.isArray(e[0])&&e[0].length)return a(e[0]);throw new Error("coordinates must only contain numbers")}function o(e,t,r){if(!t||!r)throw new Error("type and name required");if(!e||e.type!==t)throw new Error("Invalid input to "+r+": must be a "+t+", given "+e.type)}function s(e,t,r){if(!e)throw new Error("No feature passed");if(!r)throw new Error(".featureOf() requires a name");if(!e||"Feature"!==e.type||!e.geometry)throw new Error("Invalid input to "+r+", Feature with geometry required");if(!e.geometry||e.geometry.type!==t)throw new Error("Invalid input to "+r+": must be a "+t+", given "+e.geometry.type)}function u(e,t,r){if(!e)throw new Error("No featureCollection passed");if(!r)throw new Error(".collectionOf() requires a name");if(!e||"FeatureCollection"!==e.type)throw new Error("Invalid input to "+r+", FeatureCollection required");for(var n=0,i=e.features;n<i.length;n++){var a=i[n];if(!a||"Feature"!==a.type||!a.geometry)throw new Error("Invalid input to "+r+", Feature with geometry required");if(!a.geometry||a.geometry.type!==t)throw new Error("Invalid input to "+r+": must be a "+t+", given "+a.geometry.type)}}function l(e){return"Feature"===e.type?e.geometry:e}function c(e,t){return"FeatureCollection"===e.type?"FeatureCollection":"GeometryCollection"===e.type?"GeometryCollection":"Feature"===e.type&&null!==e.geometry?e.geometry.type:e.type}Object.defineProperty(r,"__esModule",{value:!0}),r.getCoord=n,r.getCoords=i,r.containsNumber=a,r.geojsonType=o,r.featureOf=s,r.collectionOf=u,r.getGeom=l,r.getType=c;var f=e("3_995")},{"3_995":214}],216:[function(e,t,r){"use strict";function n(e){var t=e[0],r=e[1];return[r[0]-t[0],r[1]-t[1]]}function i(e,t){return e[0]*t[1]-t[0]*e[1]}function a(e,t){return[e[0]+t[0],e[1]+t[1]]}function o(e,t){return[e[0]-t[0],e[1]-t[1]]}function s(e,t){return[e*t[0],e*t[1]]}function u(e,t){var r=e[0],u=n(e),l=t[0],c=n(t),f=i(u,c);return a(r,s(i(o(l,r),c)/f,u))}function l(e,t){return 0===i(n(e),n(t))}function c(e,t){return!l(e,t)&&u(e,t)}function f(e,t,r){if(r=r||{},!(0,v.isObject)(r))throw new Error("options is invalid");var n=r.units;if(!e)throw new Error("geojson is required");if(void 0===t||null===t||isNaN(t))throw new Error("distance is required");var i=(0,m.getType)(e),a=e.properties;switch(i){case"LineString":return d(e,t,n);case"MultiLineString":var o=[];return(0,p.flattenEach)(e,function(e){o.push(d(e,t,n).geometry.coordinates)}),(0,v.multiLineString)(o,a);default:throw new Error("geometry "+i+" is not supported")}}function d(e,t,r){var n=[],i=(0,v.lengthToDegrees)(t,r),a=(0,m.getCoords)(e),o=[];return a.forEach(function(e,t){if(t!==a.length-1){var r=h(e,a[t+1],i);if(n.push(r),t>0){var s=n[t-1],u=c(r,s);!1!==u&&(s[1]=u,r[0]=u),o.push(s[0]),t===a.length-2&&(o.push(r[0]),o.push(r[1]))}2===a.length&&(o.push(r[0]),o.push(r[1]))}}),(0,v.lineString)(o,e.properties)}function h(e,t,r){var n=Math.sqrt((e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1])),i=e[0]+r*(t[1]-e[1])/n,a=t[0]+r*(t[1]-e[1])/n;return[[i,e[1]+r*(e[0]-t[0])/n],[a,t[1]+r*(e[0]-t[0])/n]]}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var p=e("3_1006"),m=e("D_996"),v=e("3_995"),g=f;r.default=g},{"3_995":214,D_996:215,"3_1006":217}],217:[function(e,t,r){"use strict";function n(e,t,r){if(null!==e)for(var i,a,o,s,u,l,c,f,d=0,h=0,p=e.type,m="FeatureCollection"===p,v="Feature"===p,g=m?e.features.length:1,y=0;y<g;y++){c=m?e.features[y].geometry:v?e.geometry:e,f=!!c&&"GeometryCollection"===c.type,u=f?c.geometries.length:1;for(var _=0;_<u;_++){var b=0,M=0;if(null!==(s=f?c.geometries[_]:c)){l=s.coordinates;var x=s.type;switch(d=!r||"Polygon"!==x&&"MultiPolygon"!==x?0:1,x){case null:break;case"Point":if(!1===t(l,h,y,b,M))return!1;h++,b++;break;case"LineString":case"MultiPoint":for(i=0;i<l.length;i++){if(!1===t(l[i],h,y,b,M))return!1;h++,"MultiPoint"===x&&b++}"LineString"===x&&b++;break;case"Polygon":case"MultiLineString":for(i=0;i<l.length;i++){for(a=0;a<l[i].length-d;a++){if(!1===t(l[i][a],h,y,b,M))return!1;h++}"MultiLineString"===x&&b++,"Polygon"===x&&M++}"Polygon"===x&&b++;break;case"MultiPolygon":for(i=0;i<l.length;i++){for(M=0,a=0;a<l[i].length;a++){for(o=0;o<l[i][a].length-d;o++){if(!1===t(l[i][a][o],h,y,b,M))return!1;h++}M++}b++}break;case"GeometryCollection":for(i=0;i<s.geometries.length;i++)if(!1===n(s.geometries[i],t,r))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function i(e,t,r,i){var a=r;return n(e,function(e,n,i,o,s){a=0===n&&void 0===r?e:t(a,e,n,i,o,s)},i),a}function a(e,t){var r;switch(e.type){case"FeatureCollection":for(r=0;r<e.features.length&&!1!==t(e.features[r].properties,r);r++);break;case"Feature":t(e.properties,0)}}function o(e,t,r){var n=r;return a(e,function(e,i){n=0===i&&void 0===r?e:t(n,e,i)}),n}function s(e,t){if("Feature"===e.type)t(e,0);else if("FeatureCollection"===e.type)for(var r=0;r<e.features.length&&!1!==t(e.features[r],r);r++);}function u(e,t,r){var n=r;return s(e,function(e,i){n=0===i&&void 0===r?e:t(n,e,i)}),n}function l(e){var t=[];return n(e,function(e){t.push(e)}),t}function c(e,t){var r,n,i,a,o,s,u,l,c,f,d=0,h="FeatureCollection"===e.type,p="Feature"===e.type,m=h?e.features.length:1;for(r=0;r<m;r++){for(s=h?e.features[r].geometry:p?e.geometry:e,l=h?e.features[r].properties:p?e.properties:{},c=h?e.features[r].bbox:p?e.bbox:void 0,f=h?e.features[r].id:p?e.id:void 0,u=!!s&&"GeometryCollection"===s.type,o=u?s.geometries.length:1,i=0;i<o;i++)if(null!==(a=u?s.geometries[i]:s))switch(a.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===t(a,d,l,c,f))return!1;break;case"GeometryCollection":for(n=0;n<a.geometries.length;n++)if(!1===t(a.geometries[n],d,l,c,f))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===t(null,d,l,c,f))return!1;d++}}function f(e,t,r){var n=r;return c(e,function(e,i,a,o,s){n=0===i&&void 0===r?e:t(n,e,i,a,o,s)}),n}function d(e,t){c(e,function(e,r,n,i,a){var o=null===e?null:e.type;switch(o){case null:case"Point":case"LineString":case"Polygon":if(!1===t((0,b.feature)(e,n,{bbox:i,id:a}),r,0))return!1;return}var s;switch(o){case"MultiPoint":s="Point";break;case"MultiLineString":s="LineString";break;case"MultiPolygon":s="Polygon"}for(var u=0;u<e.coordinates.length;u++){var l=e.coordinates[u],c={type:s,coordinates:l};if(!1===t((0,b.feature)(c,n),r,u))return!1}})}function h(e,t,r){var n=r;return d(e,function(e,i,a){n=0===i&&0===a&&void 0===r?e:t(n,e,i,a)}),n}function p(e,t){d(e,function(e,r,i){var a=0;if(e.geometry){var o=e.geometry.type;if("Point"!==o&&"MultiPoint"!==o){var s,u=0,l=0,c=0;return!1!==n(e,function(n,o,f,d,h){if(void 0===s||r>u||d>l||h>c)return s=n,u=r,l=d,c=h,void(a=0);var p=(0,b.lineString)([s,n],e.properties);if(!1===t(p,r,i,h,a))return!1;a++,s=n})&&void 0}}})}function m(e,t,r){var n=r,i=!1;return p(e,function(e,a,o,s,u){n=!1===i&&void 0===r?e:t(n,e,a,o,s,u),i=!0}),n}function v(e,t){if(!e)throw new Error("geojson is required");d(e,function(e,r,n){if(null!==e.geometry){var i=e.geometry.type,a=e.geometry.coordinates;switch(i){case"LineString":if(!1===t(e,r,n,0,0))return!1;break;case"Polygon":for(var o=0;o<a.length;o++)if(!1===t((0,b.lineString)(a[o],e.properties),r,n,o))return!1}}})}function g(e,t,r){var n=r;return v(e,function(e,i,a,o){n=0===i&&void 0===r?e:t(n,e,i,a,o)}),n}function y(e,t){if(t=t||{},!(0,b.isObject)(t))throw new Error("options is invalid");var r,n=t.featureIndex||0,i=t.multiFeatureIndex||0,a=t.geometryIndex||0,o=t.segmentIndex||0,s=t.properties;switch(e.type){case"FeatureCollection":n<0&&(n=e.features.length+n),s=s||e.features[n].properties,r=e.features[n].geometry;break;case"Feature":s=s||e.properties,r=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":r=e;break;default:throw new Error("geojson is invalid")}if(null===r)return null;var u=r.coordinates;switch(r.type){case"Point":case"MultiPoint":return null;case"LineString":return o<0&&(o=u.length+o-1),(0,b.lineString)([u[o],u[o+1]],s,t);case"Polygon":return a<0&&(a=u.length+a),o<0&&(o=u[a].length+o-1),(0,b.lineString)([u[a][o],u[a][o+1]],s,t);case"MultiLineString":return i<0&&(i=u.length+i),o<0&&(o=u[i].length+o-1),(0,b.lineString)([u[i][o],u[i][o+1]],s,t);case"MultiPolygon":return i<0&&(i=u.length+i),a<0&&(a=u[i].length+a),o<0&&(o=u[i][a].length-o-1),(0,b.lineString)([u[i][a][o],u[i][a][o+1]],s,t)}throw new Error("geojson is invalid")}function _(e,t){if(t=t||{},!(0,b.isObject)(t))throw new Error("options is invalid");var r,n=t.featureIndex||0,i=t.multiFeatureIndex||0,a=t.geometryIndex||0,o=t.coordIndex||0,s=t.properties;switch(e.type){case"FeatureCollection":n<0&&(n=e.features.length+n),s=s||e.features[n].properties,r=e.features[n].geometry;break;case"Feature":s=s||e.properties,r=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":r=e;break;default:throw new Error("geojson is invalid")}if(null===r)return null;var u=r.coordinates;switch(r.type){case"Point":return(0,b.point)(u,s,t);case"MultiPoint":return i<0&&(i=u.length+i),(0,b.point)(u[i],s,t);case"LineString":return o<0&&(o=u.length+o),(0,b.point)(u[o],s,t);case"Polygon":return a<0&&(a=u.length+a),o<0&&(o=u[a].length+o),(0,b.point)(u[a][o],s,t);case"MultiLineString":return i<0&&(i=u.length+i),o<0&&(o=u[i].length+o),(0,b.point)(u[i][o],s,t);case"MultiPolygon":return i<0&&(i=u.length+i),a<0&&(a=u[i].length+a),o<0&&(o=u[i][a].length-o),(0,b.point)(u[i][a][o],s,t)}throw new Error("geojson is invalid")}Object.defineProperty(r,"__esModule",{value:!0}),r.coordAll=l,r.coordEach=n,r.coordReduce=i,r.featureEach=s,r.featureReduce=u,r.findPoint=_,r.findSegment=y,r.flattenEach=d,r.flattenReduce=h,r.geomEach=c,r.geomReduce=f,r.lineEach=v,r.lineReduce=g,r.propEach=a,r.propReduce=o,r.segmentEach=p,r.segmentReduce=m;var b=e("3_995")},{"3_995":214}],218:[function(e,t,r){"use strict";function n(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function i(e){var t=n(e),r=t[0],i=t[1];return 3*(r+i)/4-i}function a(e,t,r){return 3*(t+r)/4-r}function o(e){var t,r,i=n(e),o=i[0],s=i[1],u=new d(a(e,o,s)),l=0,c=s>0?o-4:o;for(r=0;r<c;r+=4)t=f[e.charCodeAt(r)]<<18|f[e.charCodeAt(r+1)]<<12|f[e.charCodeAt(r+2)]<<6|f[e.charCodeAt(r+3)],u[l++]=t>>16&255,u[l++]=t>>8&255,u[l++]=255&t;return 2===s&&(t=f[e.charCodeAt(r)]<<2|f[e.charCodeAt(r+1)]>>4,u[l++]=255&t),1===s&&(t=f[e.charCodeAt(r)]<<10|f[e.charCodeAt(r+1)]<<4|f[e.charCodeAt(r+2)]>>2,u[l++]=t>>8&255,u[l++]=255&t),u}function s(e){return c[e>>18&63]+c[e>>12&63]+c[e>>6&63]+c[63&e]}function u(e,t,r){for(var n,i=[],a=t;a<r;a+=3)n=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),i.push(s(n));return i.join("")}function l(e){for(var t,r=e.length,n=r%3,i=[],a=0,o=r-n;a<o;a+=16383)i.push(u(e,a,a+16383>o?o:a+16383));return 1===n?(t=e[r-1],i.push(c[t>>2]+c[t<<4&63]+"==")):2===n&&(t=(e[r-2]<<8)+e[r-1],i.push(c[t>>10]+c[t>>4&63]+c[t<<2&63]+"=")),i.join("")}r.byteLength=i,r.toByteArray=o,r.fromByteArray=l;for(var c=[],f=[],d="undefined"!=typeof Uint8Array?Uint8Array:Array,h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",p=0,m=h.length;p<m;++p)c[p]=h[p],f[h.charCodeAt(p)]=p;f["-".charCodeAt(0)]=62,f["_".charCodeAt(0)]=63},{}],219:[function(e,t,r){"use strict";function n(e){var t=e.timeRegex;t||(t="yyyyMMddhhmm");var r=t;r=r.replace("yyyy","\\d{4}"),r=r.replace("MM","\\d{2}"),r=r.replace("dd","\\d{2}"),r=r.replace("hh","\\d{2}"),r=r.replace("mm","\\d{2}"),r=r.replace("ss","\\d{2}"),r=new RegExp(r);var n=r.exec(e.fileName);return n&&n.length||(n=r.exec("20"+e.fileName)),n=n&&n.length?parseDate(n[0],t):null,e.timeZone&&(n=n.add("h",e.timeZone)),e.datetime=n,n}function i(e){if(0==e._fileList.length)return void(e.isLoading=!1);var t=e._fileList.shift(),r=e._readOptionsList.shift()||{},n=r.offset,a=r.length,o=r.responseType,s=r.encoding,u=e._deferredList.shift();if(!t||t._aborted)return u&&(delete u.resolve,delete u.reject),void i(e);t.isLoading=!0,e.isLoading=!0,e.currentFileInfo=t,e.hfs.readFile(t,n,a,o,s).then(function(r){t.loaded=!0,t.isLoading=!1,t._aborted||u.resolve(r),t=null,e.currentFileInfo=null,delete u.resolve,delete u.reject,i(e)}).otherwise(function(r){t.isLoading=!1,t=null,e.currentFileInfo=null,u.reject(r),i(e)})}var a=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=a(e("e_1")),s=a(e("s_2")),u=MeteoLib,l=u.HttpFileSystem,c=(u.FileInfo,function(){function e(t){(0,o.default)(this,e),this.hfs=new l({config:t}),this._fileList=[],this._readOptionsList=[],this._deferredList=[],this.isLoading=!1,this.currentFileInfo=null}return(0,s.default)(e,[{key:"readFile",value:function(e,t){if(!this._fileList.includes(e)){this._fileList.push(e),this._readOptionsList.push(t);var r={};this._deferredList.push(r),e._aborted=!1;var n=new Promise(function(e,t){r.resolve=e,r.reject=t});return this.isLoading?e.isWaiting=!0:i(this),n}}},{key:"getFiles",value:function(e){var t=this,r=e.dir,i=e.path,a=e.ext,o=e.startTime,s=e.endTime,u=e.timeRegex,l=e.fromDb;e.timeZone;return new Promise(function(c,f){t.hfs.getFiles(r,i,a,o,s,u,l).then(function(t){0==l?t=t.map(function(t){return t={fileName:t,dir:r,path:i,size:0},t.timeZone=e.timeZone,t.timeRegex=e.timeRegex,n(t),t}):t.forEach(function(e){e.datetime&&(e.datetime=new Date(e.datetime),data.timeZone&&e.datetime.add("h",data.timeZone))}),c(t)}).otherwise(f)})}},{key:"cancelRead",value:function(e){if(e.isLoading)e._aborted=!0;else{var t=this._fileList.indexOf(e);this._fileList.splice(t,1)}}}]),e}());r.default=c},{e_1:235,s_2:236,M_0:241}],220:[function(e,t,r){"use strict";function n(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(n=function(e){return e?r:t})(e)}function i(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==o(e)&&"function"!=typeof e)return{default:e};var r=n(t);if(r&&r.has(e))return r.get(e);var i={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var u=a?Object.getOwnPropertyDescriptor(e,s):null;u&&(u.get||u.set)?Object.defineProperty(i,s,u):i[s]=e[s]}return i.default=e,r&&r.set(e,i),i}var a=e("M_0"),o=e("M_110");Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"HfsFileLoader",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(r,"splitLine",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(r,"IHfsFileLayer",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(r,"MicapsECLayer",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(r,"PUPRadarLayer",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(r,"SateCloudLayer",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(r,"SwanRadarLayer",{enumerable:!0,get:function(){return m.default}}),Object.defineProperty(r,"MicapsUpAirLayer",{enumerable:!0,get:function(){return v.default}}),Object.defineProperty(r,"SurfLayer",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(r,"GeoGridLayer",{enumerable:!0,get:function(){return y.default}}),Object.defineProperty(r,"VectorLayerGroup",{enumerable:!0,get:function(){return _.default}}),Object.defineProperty(r,"Earth",{enumerable:!0,get:function(){return b.Earth}}),Object.defineProperty(r,"LocalSkyBox",{enumerable:!0,get:function(){return b.LocalSkyBox}}),Object.defineProperty(r,"LocalSkyBoxAnimation",{enumerable:!0,get:function(){return b.LocalSkyBoxAnimation}}),Object.defineProperty(r,"ILayer",{enumerable:!0,get:function(){return b.ILayer}}),Object.defineProperty(r,"ImageTileLayer",{enumerable:!0,get:function(){return b.ImageTileLayer}}),Object.defineProperty(r,"TiandituLayer",{enumerable:!0,get:function(){return b.TiandituLayer}}),Object.defineProperty(r,"TiandituImgLayer",{enumerable:!0,get:function(){return b.TiandituImgLayer}}),Object.defineProperty(r,"TiandituTerLayer",{enumerable:!0,get:function(){return b.TiandituTerLayer}}),Object.defineProperty(r,"TiandituVecLayer",{enumerable:!0,get:function(){return b.TiandituVecLayer}}),Object.defineProperty(r,"Vector2dLayer",{enumerable:!0,get:function(){return b.Vector2dLayer}}),Object.defineProperty(r,"HighlightPolygonLayer",{enumerable:!0,get:function(){return b.HighlightPolygonLayer}}),Object.defineProperty(r,"SealandVec2dLayer",{enumerable:!0,get:function(){return b.SealandVec2dLayer}}),Object.defineProperty(r,"HighlightMarkerLayer",{enumerable:!0,get:function(){return b.HighlightMarkerLayer}}),Object.defineProperty(r,"LabelVec2dLayer",{enumerable:!0,get:function(){return b.LabelVec2dLayer}}),Object.defineProperty(r,"CountryVec2dLayer",{enumerable:!0,get:function(){return b.CountryVec2dLayer}}),Object.defineProperty(r,"Vector3dLayer",{enumerable:!0,get:function(){return b.Vector3dLayer}}),Object.defineProperty(r,"C3DTilesLayer",{
enumerable:!0,get:function(){return b.C3DTilesLayer}}),Object.defineProperty(r,"OsgbLayer",{enumerable:!0,get:function(){return b.OsgbLayer}}),Object.defineProperty(r,"GeoMesh",{enumerable:!0,get:function(){return b.GeoMesh}}),Object.defineProperty(r,"GeoPolygonMesh",{enumerable:!0,get:function(){return b.GeoPolygonMesh}}),Object.defineProperty(r,"GeoPolylineMesh",{enumerable:!0,get:function(){return b.GeoPolylineMesh}}),Object.defineProperty(r,"GeoWaterMesh",{enumerable:!0,get:function(){return b.GeoWaterMesh}}),Object.defineProperty(r,"GeoPolylineGeometry",{enumerable:!0,get:function(){return b.GeoPolylineGeometry}}),Object.defineProperty(r,"GeoPolygonGeometry",{enumerable:!0,get:function(){return b.GeoPolygonGeometry}}),Object.defineProperty(r,"ExtrudedPolygonGeometry",{enumerable:!0,get:function(){return b.ExtrudedPolygonGeometry}}),Object.defineProperty(r,"SolidWireframeGeometry",{enumerable:!0,get:function(){return b.SolidWireframeGeometry}}),Object.defineProperty(r,"VectorPolygonGeometry",{enumerable:!0,get:function(){return b.VectorPolygonGeometry}}),Object.defineProperty(r,"SolidWireframeMaterial",{enumerable:!0,get:function(){return b.SolidWireframeMaterial}}),Object.defineProperty(r,"interactive",{enumerable:!0,get:function(){return b.interactive}}),Object.defineProperty(r,"getPoint",{enumerable:!0,get:function(){return b.getPoint}}),Object.defineProperty(r,"getLine",{enumerable:!0,get:function(){return b.getLine}}),Object.defineProperty(r,"getPolyline",{enumerable:!0,get:function(){return b.getPolyline}}),Object.defineProperty(r,"getRactangle",{enumerable:!0,get:function(){return b.getRactangle}}),Object.defineProperty(r,"pickPosition",{enumerable:!0,get:function(){return b.pickPosition}}),Object.defineProperty(r,"MeshVisualizer",{enumerable:!0,get:function(){return M.MeshVisualizer}}),Object.defineProperty(r,"CameraUtils",{enumerable:!0,get:function(){return M.CameraUtils}}),Object.defineProperty(r,"GeometryUtils",{enumerable:!0,get:function(){return M.GeometryUtils}}),Object.defineProperty(r,"RendererUtils",{enumerable:!0,get:function(){return M.RendererUtils}}),Object.defineProperty(r,"computeArea",{enumerable:!0,get:function(){return x.computeArea}}),Object.defineProperty(r,"defineProperty",{enumerable:!0,get:function(){return x.defineProperty}}),Object.defineProperty(r,"determinant",{enumerable:!0,get:function(){return x.determinant}}),Object.defineProperty(r,"esExtends",{enumerable:!0,get:function(){return x.esExtends}}),Object.defineProperty(r,"GenericWorker",{enumerable:!0,get:function(){return x.GenericWorker}}),Object.defineProperty(r,"geojsonHelper",{enumerable:!0,get:function(){return x.geojsonHelper}}),Object.defineProperty(r,"ImageUtils",{enumerable:!0,get:function(){return x.ImageUtils}}),Object.defineProperty(r,"isTypedArray",{enumerable:!0,get:function(){return x.isTypedArray}}),Object.defineProperty(r,"lineBufferDir3",{enumerable:!0,get:function(){return x.lineBufferDir3}}),Object.defineProperty(r,"MathUtils",{enumerable:!0,get:function(){return x.MathUtils}}),Object.defineProperty(r,"matrix4LookAt",{enumerable:!0,get:function(){return x.matrix4LookAt}}),Object.defineProperty(r,"mergeBuffers",{enumerable:!0,get:function(){return x.mergeBuffers}}),Object.defineProperty(r,"parseDefines",{enumerable:!0,get:function(){return x.parseDefines}}),Object.defineProperty(r,"decodeGeojson",{enumerable:!0,get:function(){return x.decodeGeojson}}),Object.defineProperty(r,"decodeGeojsonAsync",{enumerable:!0,get:function(){return x.decodeGeojsonAsync}}),Object.defineProperty(r,"decodeGeojsonCoords",{enumerable:!0,get:function(){return x.decodeGeojsonCoords}}),Object.defineProperty(r,"decodeGeojsonCoordsAsync",{enumerable:!0,get:function(){return x.decodeGeojsonCoordsAsync}}),Object.defineProperty(r,"decodeObject",{enumerable:!0,get:function(){return x.decodeObject}}),Object.defineProperty(r,"encodeGeojson",{enumerable:!0,get:function(){return x.encodeGeojson}}),Object.defineProperty(r,"encodeGeojsonCoords",{enumerable:!0,get:function(){return x.encodeGeojsonCoords}}),Object.defineProperty(r,"encodeObject",{enumerable:!0,get:function(){return x.encodeObject}}),Object.defineProperty(r,"encodeObjectValues",{enumerable:!0,get:function(){return x.encodeObjectValues}}),Object.defineProperty(r,"Path",{enumerable:!0,get:function(){return x.Path}}),Object.defineProperty(r,"save",{enumerable:!0,get:function(){return x.save}}),Object.defineProperty(r,"saveArrayBuffer",{enumerable:!0,get:function(){return x.saveArrayBuffer}}),Object.defineProperty(r,"saveString",{enumerable:!0,get:function(){return x.saveString}}),Object.defineProperty(r,"stringToArrayBuffer",{enumerable:!0,get:function(){return x.stringToArrayBuffer}}),Object.defineProperty(r,"StringUtil",{enumerable:!0,get:function(){return x.StringUtil}}),Object.defineProperty(r,"triangulate",{enumerable:!0,get:function(){return x.triangulate}}),Object.defineProperty(r,"traverse",{enumerable:!0,get:function(){return x.traverse}}),Object.defineProperty(r,"getPaddedBuffer",{enumerable:!0,get:function(){return x.getPaddedBuffer}}),Object.defineProperty(r,"getPaddedBufferSize",{enumerable:!0,get:function(){return x.getPaddedBufferSize}}),r.terrainSampler=r.rasterSampler=void 0;var s=a(e("h_1015")),u=i(e("-_1016"));r.rasterSampler=u;var l=i(e("3_1017"));r.terrainSampler=l;var c=a(e("D_1018")),f=a(e("._1019")),d=a(e("C_1020")),h=a(e("o_1021")),p=a(e("m_1022")),m=a(e("M_1023")),v=a(e("e_1024")),g=a(e("s_1025")),y=a(e("h_1026")),_=a(e("-_1027")),b=e("3_1028"),M=e("D_1029"),x=e("._1030")},{D_1029:39,"3_1028":71,"._1030":209,h_1015:219,h_1026:221,"._1019":222,C_1020:223,e_1024:224,o_1021:225,m_1022:226,s_1025:227,M_1023:228,"-_1027":229,"-_1016":230,D_1018:231,"3_1017":232,M_0:241,M_110:245}],221:[function(e,t,r){"use strict";function n(e){var t=i();return function(){var r,n=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,f.default)(this,r)}}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function a(e){e=e||{};var t=document.createElement("canvas");t.width=64,t.height=64;var r=t.getContext("2d");r.fillStyle=e.bgColor||"#00061a",r.fillRect(0,0,t.width,t.height),r.fillStyle=e.lightColor||"#5076b1";var n=1;r.fillRect(0,0,n,n),r.fillRect(63,0,n,n),r.fillRect(0,63,n,n),r.fillRect(63,63,n,n);for(var i=t.width/17,a=t.height/17,o=a,s=i,u=0;u<16;u++)r.fillRect(s,0,n,n),r.fillRect(s,t.height,n,n),s+=i;for(var l=0;l<16;l++)r.fillRect(0,o,n,n),r.fillRect(t.width,o,n,n),o+=a;r.fillStyle=e.darkColor||"#435a7c",o=0,s=0;for(var n=1,c=0;c<16;c++){s=0;for(var f=0;f<16;f++)r.fillRect(s+4,o+4,n,n),s+=i;o+=a}return t}function o(e){var t=a(e),r=document.createElement("canvas");r.width=256,r.height=256;for(var n=r.getContext("2d"),i=0,o=0;o<=4;o++){for(var s=0,u=0;u<=4;u++)n.drawImage(t,s,i),s+=64;i+=64}return r}var s=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var u=s(e("e_1")),l=s(e("s_332")),c=s(e("C_129")),f=s(e("o_130")),d=s(e("m_131")),h=s(e("h_1037")),p=function(e){function t(e){var n;(0,u.default)(this,t),e=e||{},n=r.call(this,e);var i=e.gridImage||o({bgColor:e.bgColor,lightColor:e.lightColor,darkColor:e.darkColor}),a=!1,s={};n.readyPromise=new Promise(function(e,t){s.resolve=e,s.reject=t}),Object.defineProperties((0,l.default)(n),{ready:{get:function(){return a}}}),"string"!=typeof i&&(a=!0,s.resolve((0,l.default)(n)));var c=new Cesium.GridImageryProvider({minimumLevel:e.minimumLevel,maximumLevel:e.maximumLevel});return c.requestImage=function(e,t,r,n){var o=this;return a?i:Cesium.Resource.fetchImage(i).then(function(e){return i=e,a=!0,s.resolve(o),e}).otherwise(s.reject)},n.provider=c,n}(0,c.default)(t,e);var r=n(t);return t}(h.default);r.default=p},{h_1037:56,s_332:233,e_1:235,m_131:239,C_129:240,M_0:241,o_130:242}],222:[function(e,t,r){"use strict";function n(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=i(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){u=!0,o=e},f:function(){try{s||null==r.return||r.return()}finally{if(u)throw o}}}}function i(e,t){if(e){if("string"==typeof e)return a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(e,t):void 0}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function o(e){if(1==e.fileList.length)e._currentFile=e.fileList[0];else for(var t=1;t<e.fileList.length;t++){var r=e.fileList[t-1],n=e.fileList[t],i=n.datetime-e.currentTime,a=r.datetime-e.currentTime;if(0==i){e._currentFile=n,e._currentIndex=t;break}if(0==a){e._currentFile=r,e._currentIndex=t-1;break}if(i<0){a=Math.abs(a),i=Math.abs(i),e._currentFile=a<=i?r:n,e._currentIndex=a<=i?t-1:t;break}}}var s=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var u,l,c=s(e("e_1")),f=s(e("s_2")),d=function(){function e(t,r){(0,c.default)(this,e),r=r||{},this._fileLoader=t,this.options=Object.assign({dir:"GZData",path:"",fromDb:!1,timeRegex:"yyyyMMddhhmmss"},r),this.fileList=[],this.timeList=[],this.isLoading=!1,this.earth=null,this.colorMap=null,this.rectangle=null,this.name="未命名图层",this.zIndex=r.zIndex||3,this._currentTime=null,this._currentFile=null,this._currentIndex=-1,this._show=!0}return(0,f.default)(e,[{key:"currentTime",get:function(){return this._currentTime},set:function(e){this._currentTime!=e&&(this._currentTime=e,o(this),this.updateLayer())}},{key:"show",get:function(){return this._show},set:function(e){this._show!=e&&(this._show=e)}},{key:"currentFile",get:function(){return this._currentFile}},{key:"channelPath",get:function(){return this.options.path}},{key:"latestTime",get:function(){return this.timeList&&this.timeList.length?this.timeList[this.timeList.length-1]:null}},{key:"updateList",value:function(e,t){var r=this;if(this.isLoading)return this._listPromise;this.isLoading=!0;var i=this.options.timeRegex;return e instanceof Date&&(e=e.format(i)),t instanceof Date&&(t=t.format(i)),e&&(u=e),t&&(l=t),this._listPromise=this._fileLoader.getFiles(Object.assign({},this.options,{path:this.channelPath,startTime:u,endTime:l})).then(function(e){e.sort(function(e,t){return e.datetime-t.datetime}),r.fileList.slice(0),r.timeList.slice(0);var t,i=n(e);try{for(i.s();!(t=i.n()).done;){var a=t.value;r.fileList.push(a),r.timeList.push(a.datetime)}}catch(e){i.e(e)}finally{i.f()}return r.isLoading=!1,r._listPromise=null,r.onListUpdate(r),r}).catch(function(e){r.isLoading=!1,r._listPromise=null,r.onError(e)}),this._listPromise}},{key:"load",value:function(e){return this.earth=e,this.updateList()}},{key:"updateLayer",value:function(e){}},{key:"unload",value:function(e){throw this.earth=null,new Error("IHfsFileLayer：卸载方法未实现")}},{key:"onError",value:function(e){}},{key:"onListUpdate",value:function(e){}}]),e}();r.default=d},{e_1:235,s_2:236,M_0:241}],223:[function(e,t,r){"use strict";function n(e){var t=i();return function(){var r,n=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,f.default)(this,r)}}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function a(e){var t=e.imageryLayer,r=e.earth;t&&(r.imageryLayers.remove(t),t.imageryProvider.destroy(),e.imageryLayer=null)}var o=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=o(e("e_1")),u=o(e("s_2")),l=o(e("s_332")),c=o(e("C_129")),f=o(e("o_130")),d=o(e("m_131")),h=(o(e("h_1048")),o(e("-_1049"))),p=MeteoLib,m=p.GridDataImageryProvider,v=p.RasterImageGenerator,g=p.GridData,y=function(e){function t(e){var n;(0,s.default)(this,t),n=r.call(this,e,{dir:"GZData",path:"ECMWF_LR",ext:"*.000",timeRegex:"yyyyMMddhh",zIndex:4}),n._element="TMP",n._level="850",n._forecastTime="000",n._lastFile=null,n.rectangle=Cesium.Rectangle.fromDegrees(105,24,112,32),n.imageryOptions={maximumLevel:6,isoLine:!0,lineColorType:"single",lineColor:"rgba(40,40,40,0.8)",isoValue:!0,point:!1,maxSamplePointLevel:6,value:!1,fill:!0,interpolate:!1,rectangle:n.rectangle},n.ready=!1;var i={};n.readyPromise=new Promise(function(e,t){i.resolve=e,i.reject=t}),n._deffered=i;var a=null,o=new g;return Object.defineProperties((0,l.default)(n),{gridData:{enumerable:!1,get:function(){return o}},imageryLayer:{enumerable:!1,get:function(){return a},set:function(e){a=e}}}),n}(0,c.default)(t,e);var r=n(t);return(0,u.default)(t,[{key:"show",get:function(){return this._show},set:function(e){this.imageryLayer&&(this._show=e,this.imageryLayer.show=e)}},{key:"channelPath",get:function(){return[this.options.path,this.element,this.level].join("/")}},{key:"element",get:function(){return this._element},set:function(e){this._element!=e&&(this._element=e,this.updateList())}},{key:"level",get:function(){return this._level},set:function(e){this._level!=e&&(this._level=e,this.updateList())}},{key:"forecastTime",get:function(){return this._forecastTime},set:function(e){this._forecastTime!=e&&(this._forecastTime=e,this.options.ext="*."+e,this.updateList())}},{key:"showIsoLine",get:function(){return this.imageryOptions.isoLine},set:function(e){this.imageryOptions.isoLine!=e&&(this.imageryOptions.isoLine=e,this.updateImageryLayer())}},{key:"fill",get:function(){return this.imageryOptions.fill},set:function(e){this.imageryOptions.fill!=e&&(this.imageryOptions.fill=e,this.updateImageryLayer())}},{key:"interpolate",get:function(){return this.imageryOptions.interpolate},set:function(e){this.imageryOptions.interpolate!=e&&(this.imageryOptions.interpolate=e,this.updateImageryLayer())}},{key:"clipperLayer",get:function(){return this.imageryOptions.clipperLayer},set:function(e){e.provider&&(e=e.provider),this.imageryOptions.clipperLayer!=e&&(this.imageryOptions.clipperLayer=e)}},{key:"updateImageryLayer",value:function(){var e=this.imageryLayer,t=this.earth,r=this.currentFile,n=this.gridData;if(a(this),n.familyName){for(var i=n.element,o=v.find(i),s=o.colorMap,u=[],l=n.isolineStartValue,c=n.isolineEndValue,f=n.isolineSpace,d=l;d<=c;d+=f)u.push(d);var h=new m(Object.assign({},this.imageryOptions,{colorMap:s,dataArray:n.dataArray,width:n.width,height:n.height,breaks:u,dataRectangle:Cesium.Rectangle.fromDegrees(n.bbox[0],n.bbox[1],n.bbox[2],n.bbox[3])}));e=t.imageryLayers.addImageryProvider(h),e.show=this._show,this.name=r.fileName,this.colorMap=s,this.imageryLayer=e,h.zIndex=this.zIndex,t.updateOrder(),this.ready=!0,this._deffered.resolve(this)}else{var p=new Error("数据名称为空");this.onError(p),this.ready=!1,this._deffered.resolve(p)}}},{key:"updateLayer",value:function(){var e=this,t=this.currentFile;if(t){var r=this.gridData;if(this._lastFile==this.currentFile)this.updateImageryLayer();else{this._fileLoader.readFile(t).then(function(t){r.loadByteArray(t)?e.updateImageryLayer():e.onError(new Error("格点数据解析失败"))}).catch(function(t){a(e),e.onError(t),e.ready=!1,e._deffered.resolve(t)})}}}},{key:"unload",value:function(){a(this)}}]),t}(h.default);r.default=y},{h_1048:219,"-_1049":222,s_332:233,e_1:235,s_2:236,m_131:239,C_129:240,M_0:241,o_130:242}],224:[function(e,t,r){"use strict";function n(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(n=function(e){return e?r:t})(e)}function i(e){var t=a();return function(){var r,n=(0,y.default)(e);if(t){var i=(0,y.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,g.default)(this,r)}}function a(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function o(e){var t=e.imageryLayer,r=e.earth;t&&(r.imageryLayers.remove(t),t.imageryProvider.destroy(),e.imageryLayer=null)}function s(e,t,r){var n=r.windSymbolType,i=l(e),a=r.meteoSign,o=r.windSymbols;if(o||(o={}),o[n]||(o[n]={}),r.windSymbols=o,!o[n][i]){var s=document.createElement("canvas");s.width=Cesium.defaultValue(r.windSymbolSize,64),s.height=Cesium.defaultValue(r.windSymbolSize,64);var u=s.getContext("2d");if("arrow"==n){var c=i/12,f=c*s.width,d=s.height-f,h=.125*f,p=[[{x:h,y:s.height},{x:h,y:d}],[{x:h-.125*f,y:d+.25*f},{x:h,y:d}],[{x:h+.125*f,y:d+.25*f},{x:h,y:d}]];u.lineWidth=r.meteoSign.lineWidth,u.strokeStyle=r.style.fontColor,p.forEach(function(e){u.beginPath(),u.moveTo(e[0].x,e[0].y),u.lineTo(e[1].x,e[1].y),u.stroke()})}else{var m=a.GetWindCanvas(e);u.drawImage(m,0,0,s.width,s.height)}s._symbolLeft=h,o[n][i]=s}if(o[n][i]){var m=o[n][i],v=Cesium.Math.toRadians(t-180);"arrow"!==n&&(v+=Math.PI);var g=document.createElement("canvas");g.width=2*m.width,g.height=2*m.height;var y=g.getContext("2d"),_=g.width/2,b=g.height/2;return y.translate(_,b),y.rotate(v),y.translate(-_,-b),y.drawImage(m,_-(m._symbolLeft?m._symbolLeft:0),b-m.height),g}}function u(e,t){var r,n=Cesium,i=n.defined,a=n.Color,o=n.writeTextToCanvas,u=e[601],l=e[421],c=e[805],f=e[803],d=e[201],h=e[203],p=e.stationId;i(u)&&i(f)&&(r=u-f);try{void 0!==u&&(u=u.toFixed(0)),void 0!==c&&(c=c.toFixed(0)),void 0!==f&&(f=f.toFixed(0)),void 0!==l&&(l=l.toFixed(0)),void 0!==r&&(r=r.toFixed(0)),u=Number.pad(u,4," "),l=Number.pad(l,4," "),c=Number.pad(c,4," "),f=Number.pad(f,4," "),r=Number.pad(r,4," ");var m=t.style,v={fill:!0,font:"bold "+m.fontSize+"px "+m.fontFamily,stroke:m.labelStroke,strokeWidth:m.labelStrokeWidth,strokeColor:"string"==typeof m.labelStrokeColor?a.fromCssColorString(m.labelStrokeColor):m.labelStrokeColor,fillColor:"string"==typeof m.fontColor?a.fromCssColorString(m.fontColor):m.fontColor};v.fillColor=a.RED,u=o(u,v),v.fillColor="string"==typeof m.fontColor?a.fromCssColorString(m.fontColor):m.fontColor,l=o(l,v),f=o(f,v),c=o(c,v),r=o(r,v),p=o(p,v);var g=document.createElement("canvas"),y=3*p.width,_=4*p.height;g.width=y,g.height=_;var b=g.getContext("2d");if(u.height&&b.drawImage(u,y/3-u.width,0),l.height&&b.drawImage(l,2*y/3,0),f.height&&b.drawImage(f,y/3-f.width,_/3),c.height&&b.drawImage(c,2*y/3,_/3),r.height&&b.drawImage(r,y/3-r.width,2*_/3),b.drawImage(p,2*y/3,2*_/3),d&&h){var M=s(h,d,t),x=Math.max(M.height,g.height),w=Math.max(M.width,g.width),S=document.createElement("canvas");S.height=x,S.width=w,b=S.getContext("2d"),g.width&&g.height&&b.drawImage(g,(w-g.width)/2,(x-g.height)/2),M.width&&M.height&&b.drawImage(M,(w-M.width)/2,(x-M.height)/2)}return b.fillStyle=m.fontColor.toCssColorString(),b.fillRect(b.canvas.width/2-2,b.canvas.height/2-2,4,4),b.canvas}catch(e){console.log(e)}}function l(e){return e<=1.5?1:e<=3.3?2:e<=5.4?3:e<=7.9?4:e<=10.7?5:e<=13.8?6:e<=17.1?7:e<=20.7?8:e<=24.4?9:e<=28.4?10:e<=32.6?11:12}function c(e,t){var r=Object.keys(e.stationDataMap),n=[];return r.forEach(function(r){var i=e.stationDataMap[r];i.stationId=r,i.longitude=i[1],i.latitude=i[2],delete i[1],delete i[2],i.symbol=u(i,t);var a=_.point([i.longitude,i.latitude],i);n.push(a)}),n.length>0?(n=_.featureCollection(n),n.name=e.description+"_"+e.level+e.levelDescription,n):null}var f=e("M_0"),d=e("M_110");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var h=f(e("e_1")),p=f(e("s_2")),m=f(e("s_332")),v=f(e("C_129")),g=f(e("o_130")),y=f(e("m_131")),_=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==d(e)&&"function"!=typeof e)return{default:e};var r=n(t);if(r&&r.has(e))return r.get(e);var i={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=a?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(i,o,s):i[o]=e[o]}return i.default=e,r&&r.set(e,i),i}(e("s_1058")),b=f(e("h_1059")),M=function(e){function t(e){var n;(0,h.default)(this,t),n=r.call(this,e,{dir:"LNData",path:"UPPER_AIR/PLOT/",ext:"*.000",timeRegex:"yyyyMMddhhmmss",zIndex:7}),n._level="100",n.ready=!1;var i={};n.readyPromise=new Promise(function(e,t){i.resolve=e,i.reject=t}),n._deffered=i;var a=new MeteoLib.MeteoSign;n.meteoSign=a,a.lineWidth=3,a.size=64,a.color="black",n.style={showLabel:!0,fontColor:Cesium.Color.BLACK,labelStroke:!1,labelStrokeWidth:4,labelStrokeColor:Cesium.Color.BLACK,showMarker:!1,labelPropertyName:"text",outlineColor:Cesium.Color.BLACK},n._windSymbolType="windShaft",n._windSymbolSize=32,n.windSymbols={};var o=null,s=null,u=new MeteoLib.StationData;return Object.defineProperties((0,m.default)(n),{_featureCollection:{enumerable:!1,get:function(){return o},set:function(e){o=e}},_stationData:{enumerable:!1,get:function(){return u}},imageryLayer:{enumerable:!1,get:function(){return s},set:function(e){s=e}}}),n}(0,v.default)(t,e);var r=i(t);return(0,p.default)(t,[{key:"show",get:function(){return this._show},set:function(e){this.imageryLayer&&(this._show=e,this.imageryLayer.show=e)}},{key:"channelPath",get:function(){return this.options.path+this.level}},{key:"level",get:function(){return this._level},set:function(e){this._level!=e&&(this._level=e,this.updateList())}},{key:"windSymbolType",get:function(){return this._windSymbolType},set:function(e){this._windSymbolType!=e&&(this._windSymbolType=e,this.windSymbols={},this.updateImageryLayer())}},{key:"windSymbolSize",get:function(){return this._windSymbolSize},set:function(e){this._windSymbolSize!=e&&(this._windSymbolSize=e,this.windSymbols={},this.updateImageryLayer())}},{key:"symbolSize",get:function(){return this.meteoSign.size},set:function(e){this.meteoSign.size!=e&&(this.meteoSign.size=e,this.windSymbols={},this.updateImageryLayer())}},{key:"updateImageryLayer",value:function(){var e=this.imageryLayer,t=this.earth,r=this.currentFile,n=this._stationData,i=c(n,this);if(this._featureCollection=i,!(i&&i.features.length>1))return void this.error(new Error("高空填图数据文件为空，不包含任何站点数据"));var a=new CesiumVectorTile.VectorTileImageryProvider({source:i,defaultStyle:this.style,minimumLevel:3,styleFilter:function(e,t){return e.properties.lineWidth?t.lineWidth=e.properties.lineWidth:Cesium.defined(e.properties.symbol)&&(t.markerImage=e.properties.symbol,t.markerImage?(t.pointSize=64,t.showMarker=!0):t.showMarker=!1),t}});e=t.imageryLayers.addImageryProvider(a),e.show=this._show,this.name=r.fileName,this.imageryLayer=e,a.zIndex=this.zIndex,t.updateOrder(),this.ready=!0,this._deffered.resolve(this)}},{key:"updateLayer",value:function(){var e=this,t=this.currentFile;if(t){var r=this._stationData;if(this._lastFile==this.currentFile)this.updateImageryLayer();else{this._fileLoader.readFile(t).then(function(t){r.loadByteArray(t)?e.updateImageryLayer():e.onError(new Error("高空填图数据解析失败"))}).catch(function(t){o(e),e.onError(t),e.ready=!1,e._deffered.resolve(t)})}}}},{key:"unload",value:function(){o(this)}}]),t}(b.default);r.default=M},{s_1058:214,h_1059:222,s_332:233,e_1:235,s_2:236,m_131:239,C_129:240,M_0:241,o_130:242,M_110:245}],225:[function(e,t,r){"use strict";function n(e){var t=i();return function(){var r,n=(0,g.default)(e);if(t){var i=(0,g.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,v.default)(this,r)}}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function a(e){var t=e.imageryLayer,r=e.earth;t&&(r.imageryLayers.remove(t),t.imageryProvider.destroy(),e.imageryLayer=null)}function o(e){var t="";switch(e){case 36:case 37:case 38:t="CR";break;case 41:t="ET";break;case 57:t="VIL";break;default:return}return t}function s(e){switch(e){case 37:return.54;case 36:case 38:case 41:case 57:return 2.2;default:return}}function u(e,t,r,n){var i=Cesium,a=i.Cartographic,o=i.Ellipsoid,s=Cesium.Math;r instanceof a&&(n=r,r=null),r||(r=o.WGS84),n||(n=new a),n=a.fromCartesian(e);var u=new w(s.toDegrees(n.longitude),s.toDegrees(n.latitude)),l=Math.sqrt(Math.pow(t.x,2)+Math.pow(t.y,2)),c=s.toDegrees(Math.atan2(t.x,t.y)),f=x.getMyLatLng(u,l/1e3,c);return n.longitude=s.toRadians(f.m_Longitude),n.latitude=s.toRadians(f.m_Latitude),n.height=0,n}function l(e){for(var t=Cesium,r=t.Cartesian3,n=t.Rectangle,i=(Cesium.Math,e.productSymbology.layers[0].packets[0]),a=i.numberOfRows,o=a,l=e.productDescription.longitude,c=e.productDescription.latitude,f=.3048*e.productDescription.height,d=s(e.msgHeader.code),h=a*d/4+36,p=o*d/4+30,m=r.fromDegrees(l,c,f),v=190,g=190,y=-190,_=-190,b=[h,-h],M=[p,-p],x=0;x<b.length;x++)for(var w=0;w<M.length;w++){var S=new r(1e3*b[x],1e3*M[w],0),T=u(m,S);v=Math.min(v,T.longitude),y=Math.max(y,T.longitude),g=Math.min(g,T.latitude),_=Math.max(_,T.latitude)}return new n(v,g,y,_)}function c(e){var t=o(e),r=null;return"CR"==t?r=M.Radar.R:"ET"==t?r=M.Radar.ET:"VIL"==t&&(r=M.Radar.VIL),r}var f=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var d=f(e("e_1")),h=f(e("s_2")),p=f(e("s_332")),m=f(e("C_129")),v=f(e("o_130")),g=f(e("m_131")),y=(f(e("h_1048")),f(e("-_1049"))),_=MeteoLib,b=_.PupProductFormat,M=_.RasterImageGenerator,x=_.CoordinateHelper,w=_.MyLatLng,S=function(e){function t(e){var n;(0,d.default)(this,t),n=r.call(this,e,{dir:"GZData",path:"SINGLERADAR/PRODUCTS",ext:"*.851",zIndex:6,timeRegex:"yyyyMMdd.hhmmss"}),n._station="贵阳",n._prodCode="CR/38";var i=new b;n.ready=!1;var a={};n.readyPromise=new Promise(function(e,t){a.resolve=e,a.reject=t}),n._deffered=a;var o=null;return Object.defineProperties((0,p.default)(n),{_pupProduct:{enumerable:!1,get:function(){return i}},imageryLayer:{enumerable:!1,get:function(){return o},set:function(e){o=e}}}),n}(0,m.default)(t,e);var r=n(t);return(0,h.default)(t,[{key:"show",get:function(){return this._show},set:function(e){this.imageryLayer&&(this._show=e,this.imageryLayer.show=e)}},{key:"channelPath",get:function(){return[this.options.path,this.station,this.prodCode].join("/")}},{key:"station",get:function(){return this._station},set:function(e){this._station!=e&&(this._station=e,this.updateList())}},{key:"prodCode",get:function(){return this._prodCode},set:function(e){this._prodCode!=e&&(this._prodCode=e,this.updateList())}},{key:"updateImageryLayer",value:function(){var e=this.imageryLayer,t=this.earth,r=this.currentFile,n=this._pupProduct;a(this);var i=c(n.msgHeader.code),o=i.colorMap,s=l(n),u=n.productSymbology.layers[0].packets[0],f=u.numberOfRows,d=f,h=u.colorCodes,p=i.selectColorByIndex;i.selectColorByIndex=!0;var m=i.generate(h,f,d);i.selectColorByIndex=p;var v=new Cesium.SingleTileImageryProvider({url:m,rectangle:s});e=t.imageryLayers.addImageryProvider(v),e.show=this._show,this.name=r.fileName,this.colorMap=o,this.imageryLayer=e,v.zIndex=this.zIndex,t.updateOrder(),this.ready=!0,this._deffered.resolve(this)}},{key:"updateLayer",value:function(){var e=this,t=this.currentFile;if(t){var r=this._pupProduct;if(this._lastFile==this.currentFile)this.updateImageryLayer();else{this._fileLoader.readFile(t).then(function(t){r.loadByteArray(t)?e.updateImageryLayer():e.onError(new Error("PUP雷达产品数据解析失败"))}).catch(function(t){a(e),e.onError(t),e.ready=!1,e._deffered.resolve(t)})}}}},{key:"unload",value:function(){a(this)}}]),t}(y.default);r.default=S},{h_1048:219,"-_1049":222,s_332:233,e_1:235,s_2:236,m_131:239,C_129:240,M_0:241,o_130:242}],226:[function(e,t,r){"use strict";function n(e){var t=i();return function(){var r,n=(0,f.default)(e);if(t){var i=(0,f.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,c.default)(this,r)}}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var a=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=a(e("e_1")),s=a(e("s_2")),u=a(e("s_332")),l=a(e("C_129")),c=a(e("o_130")),f=a(e("m_131")),d=(a(e("h_1048")),a(e("-_1049"))),h=MeteoLib,p=h.AwxSateImageryProvider,m=function(e){function t(e){var n;(0,o.default)(this,t),n=r.call(this,e,{dir:"GZData",path:"SATELLITE/FY4A/L1/CHINA/",ext:"*.awx",zIndex:2}),n._channel="C001",n.ready=!1;var i={};n.readyPromise=new Promise(function(e,t){i.resolve=e,i.reject=t}),n._deffered=i;var a=null;return Object.defineProperties((0,u.default)(n),{imageryLayer:{enumerable:!1,get:function(){return a},set:function(e){a=e}}}),n}(0,l.default)(t,e);var r=n(t);return(0,s.default)(t,[{key:"show",get:function(){return this._show},set:function(e){this.imageryLayer&&(this._show=e,this.imageryLayer.show=e)}},{key:"channelPath",get:function(){return this.options.path+this.channel}},{key:"channel",get:function(){return this._channel},set:function(e){this._channel!=e&&(this._channel=e,this.updateList())}},{key:"updateLayer",value:function(){var e=this,t=this._currentFile;if(t){var r=this.imageryLayer,n=this.earth,i=this.channelPath,a=this.options;r&&(n.imageryLayers.remove(r),r.imageryProvider.destroy(),this.imageryLayer=r=null);var o=t.fileName,s=new p({url:this._fileLoader.hfs.getUrl({dir:a.dir,path:i}),fileName:o});r=n.imageryLayers.addImageryProvider(s),r.show=this._show,s.readyPromise.then(function(){var t=s.imageGenerator;e.colorMap=t.colorMap,e.rectangle=s._dataRectangle,e.ready=!0,e._deffered.resolve(e)}).otherwise(function(t){e._deffered.reject(t)}),this.imageryLayer=r,this.name=t.fileName,s.zIndex=this.zIndex,n.updateOrder()}}},{key:"unload",value:function(){var e=this.imageryLayer,t=this.earth;e&&(t.imageryLayers.remove(e),e.imageryProvider.destroy(),e=null)}}]),t}(d.default);r.default=m},{h_1048:219,"-_1049":222,s_332:233,e_1:235,s_2:236,m_131:239,C_129:240,M_0:241,o_130:242}],227:[function(e,t,r){"use strict";function n(e){var t=i();return function(){var r,n=(0,y.default)(e);if(t){var i=(0,y.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,g.default)(this,r)}}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function a(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=o(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(u)throw a}}}}function o(e,t){if(e){if("string"==typeof e)return s(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(e,t):void 0}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}
function u(e){var t,r=[180,90,-180,-90],n=a(e);try{for(n.s();!(t=n.n()).done;){var i=t.value,o=i.Lon,s=i.Lat;r[0]=Math.min(o,r[0]),r[1]=Math.min(s,r[1]),r[2]=Math.max(o,r[2]),r[3]=Math.max(s,r[3])}}catch(e){n.e(e)}finally{n.f()}return r}function l(e,t,r,n,i){var a=[],o=[],s=[];e.forEach(function(e){var r=parseFloat(e.Lon),n=parseFloat(e.Lat),i=parseFloat(e[t]);a.push(r),o.push(n),s.push(i)});var u=[a,o,s],l=w.CreateGridXY_Num(r[0],r[1],r[2],r[3],n,i),c=w.Interpolation_IDW_Neighbor(u,l[0],l[1],8);c.reverse();for(var f=new Float32Array(n*i),d=0,h=0;h<i;h++)for(var p=0;p<n;p++){var m=c[h][p];f[d++]=m}return f}function c(e){for(var t=e.points,r=e.earth;t.length;){var n=t.shift();r.entities.remove(n)}}function f(e){var t=e.imageryLayer,r=e.earth;t&&(r.imageryLayers.remove(t),t.imageryProvider.destroy(),e.imageryLayer=null)}var d=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var h=d(e("e_1")),p=d(e("s_2")),m=d(e("s_332")),v=d(e("C_129")),g=d(e("o_130")),y=d(e("m_131")),_=d(e("-_1049")),b=MeteoLib,M=b.GridDataImageryProvider,x=b.RasterImageGenerator,w=b.Interpolate,S=b.GridDataColorMap,T=function(e){function t(e){var n;(0,h.default)(this,t),n=r.call(this,e,{dir:"GZData",path:"surf",ext:"*.json",timeRegex:"yyyyMMddhhmmss",zIndex:8}),n._element="MAX_PRE_1h",n._textField="Station_Name",n._interpWidth=256,n._interpHeight=256,n.imageryOptions={zIndex:9,point:!1,pointSize:2,pointColor:Cesium.Color.fromBytes(128,128,128),pointDensity:5,maximumPointDensity:8,value:!1,valueColor:Cesium.Color.fromBytes(128,128,128),valueBackColor:Cesium.Color.TRANSPARENT,valueStroke:!0,valueStrokeWidth:1,valueStrokeColor:Cesium.Color.WHITE,valueFontSize:9,valuePadding:0,isoValue:!0,isoValueColor:Cesium.Color.fromBytes(0,0,0),isoValueBackColor:Cesium.Color.TRANSPARENT,isoValueStroke:!0,isoValueStrokeWidth:4,isoValueStrokeColor:Cesium.Color.fromBytes(228,228,228),isoValueFontSize:12,isoValueFontFamily:"heiti",isoValuePadding:0,isoLine:!0,lineWidth:1,lineDash:[5,0,5,0],lineColorType:"single",fill:!0,interpolate:!0,maximumLevel:8},n._showPoint=!0,n._showText=!1,n._showValue=!0,n._pointGraphics={pixelSize:10,outlineWidth:1.5},n._labelGraphics={horizontalOrigin:Cesium.HorizontalOrigin.CENTER,verticalOrigin:Cesium.VerticalOrigin.BOTTOM,font:"20px sans-serif",fillColor:Cesium.Color.BLACK,pixelOffset:new Cesium.Cartesian2(0,-8)},n._disableDepthTestDistance=null,n.ready=!1;var i={};n.readyPromise=new Promise(function(e,t){i.resolve=e,i.reject=t}),n._deffered=i;var a,o,s=new x({name:"PRE",colorMap:[[-.99999,1,[212,255,192,255],"0~1"],[1,2,[166,240,145,255],"1~2"],[2,4,[59,166,10,255],"2~4"],[4,6,[94,182,254,255],"4~6"],[6,8,[0,2,245,255],"6~8"],[8,10,[2,112,75,255],"8~10"],[10,20,[254,1,242,255],"10~20"],[20,50,[218,79,12,255],"20~50"],[50,65535,[120,1,0,255],">50"]]}),u=new x({name:"RHU",colorMap:[[-20,0,[213,6,55,255],"-20~0"],[0,10,[231,0,0,255],"0~10"],[10,20,[252,38,3,255],"10~20"],[20,30,[247,79,20,255],"20~30"],[30,40,[249,250,212,255],"30~40"],[40,50,[238,252,202,255],"40~50"],[50,60,[64,73,202,255],"50~60"],[60,70,[84,64,182,255],"60~70"],[70,80,[70,33,164,255],"70~80"],[80,90,[51,13,128,255],"80~90"],[90,100,[8,0,0,255],"90~100"]]}),l=new x({name:"TEM",colorMap:[[-66666666,-30,[0,0,255,255],"<-30"],[-30,-28,[0,20,255,255],"-30~-28"],[-28,-24,[0,70,255,255],"-28~-24"],[-24,-22,[0,100,255,255],"-24~-22"],[-22,-20,[0,170,255,255],"-22~-20"],[-20,-18,[0,200,255,255],"-20~-18"],[-18,-16,[0,230,255,255],"-18~-16"],[-16,-14,[0,255,245,255],"-16~-14"],[-14,-12,[0,255,215,255],"-14~-12"],[-12,-10,[0,255,175,255],"-12~-10"],[-10,-8,[0,255,145,255],"-10~-8"],[-8,-6,[0,255,110,255],"-8~-6"],[-6,-4,[0,255,80,255],"-6~-4"],[-4,-2,[0,255,45,255],"-4~-2"],[-2,0,[0,255,15,255],"-2~0"],[0,2,[20,255,0,255],"0~2"],[2,4,[50,255,0,255],"2~4"],[4,6,[90,255,0,255],"4~6"],[6,8,[120,255,0,255],"6~8"],[8,10,[155,255,0,255],"8~10"],[10,12,[185,255,0,255],"10~ 12"],[12,14,[220,255,0,255],"12~14"],[14,16,[255,255,0,255],"14~16"],[16,18,[255,225,0,255],"16~ 18"],[18,20,[255,195,0,255],"18~20"],[20,22,[255,160,0,255],"20~ 22"],[22,24,[255,130,0,255],"20~ 22"],[24,26,[255,100,0,255],"24~ 26"],[26,28,[255,65,0,255],"26~ 28"],[28,30,[255,45,0,255],"28~ 30"],[30,33,[255,37,0,255],"30~ 33"],[33,35,[255,20,0,255],"33~35"],[35,666666666,[255,0,0,255],"35>"]]}),c=null,f=[];return Object.defineProperties((0,m.default)(n),{_dataArray:{enumerable:!1,get:function(){return o},set:function(e){o=e}},_dataset:{enumerable:!1,get:function(){return a},set:function(e){a=e}},imageGenerator:{get:function(){var e=s;switch(this._element){case"TEM":e=l;break;case"RHU":e=u}return e.ready=!0,e}},imageryLayer:{enumerable:!1,get:function(){return c},set:function(e){c=e}},points:{enumerable:!1,get:function(){return f}}}),n}(0,v.default)(t,e);var r=n(t);return(0,p.default)(t,[{key:"element",get:function(){return this._element},set:function(e){this._element!=e&&(this._element=e,this.updateImageryLayer())}},{key:"showIsoLine",get:function(){return this.imageryOptions.isoLine},set:function(e){this.imageryOptions.isoLine!=e&&(this.imageryOptions.isoLine=e,this.updateImageryLayer())}},{key:"fill",get:function(){return this.imageryOptions.fill},set:function(e){this.imageryOptions.fill!=e&&(this.imageryOptions.fill=e,this.updateImageryLayer())}},{key:"showPoint",get:function(){return this._showPoint},set:function(e){this._showPoint!=e&&(this._showPoint=e,this.points.forEach(function(t){t.point.show=e}))}},{key:"showText",get:function(){return this._showText},set:function(e){this._showText!=e&&(this._showText=e,this.updatePointLayer())}},{key:"showValue",get:function(){return this._showValue},set:function(e){this._showValue!=e&&(this._showValue=e,this.updatePointLayer())}},{key:"textField",get:function(){return this._textField},set:function(e){this._textField!=e&&(this._textField=e,this.updatePointLayer())}},{key:"updatePointLayer",value:function(){for(var e=Cesium,t=e.defined,r=e.Cartesian3,n=e.Color,i=this.earth,a=this.imageGenerator,o=a.colorMap,s=this._pointGraphics,u=this._labelGraphics,l=this._showPoint,c=this._showText,f=this._showValue,d=this.element,h=this.textField,p=this._disableDepthTestDistance,m=this.points;m.length;){var v=m.shift();i.entities.remove(v)}this._dataset.DS.forEach(function(e){var a=parseFloat(e.Lon),v=parseFloat(e.Lat),g=parseFloat(e[d]),y=S.getColor(g,o);y=n.fromBytes.apply(null,y);var _=Object.assign(s,{color:y,show:l,disableDepthTestDistance:p}),b=Object.assign(u,{text:"",disableDepthTestDistance:p});c&&h&&t(e[h])&&(b.text+=e[h]+"\r\n"),f&&d&&t(e[d])&&(b.text+=e[d]),b.show=c||f;var M=i.entities.add({position:r.fromDegrees(a,v),point:_,label:b});M.stationData=e,m.push(M)})}},{key:"updateImageryLayer",value:function(){var e=this.imageryLayer,t=this.earth,r=this.currentFile;f(this);for(var n=this.imageGenerator,i=n.colorMap,a=this.bbox,o=Cesium.Rectangle.fromDegrees(a[0],a[1],a[2],a[3]),s=[],u=1;u<i.length;u++){var l=i[u];s.push(l[0])}var c=new M(Object.assign({},this.imageryOptions,{colorMap:i,dataArray:this._dataArray,width:this._interpWidth,height:this._interpHeight,breaks:s,dataRectangle:o}));e=t.imageryLayers.addImageryProvider(c),e.show=this._show,this.name=r.fileName,this.colorMap=i,this.imageryLayer=e,c.zIndex=this.zIndex,t.updateOrder(),this.ready=!0,this._deffered.resolve(this)}},{key:"updateLayer",value:function(){var e=this,t=this.currentFile;if(t)if(this.ready=!1,this._lastFile==this.currentFile)this.updateImageryLayer(),this.updatePointLayer();else{var r=this._fileLoader;r.readFile(t,{responseType:"json"}).then(function(t){e._dataset=t;var r=u(t.DS);if(e._dataArray=l(t.DS,e.element,r,e._interpWidth,e._interpWidth),e.bbox=r,!e.imageGenerator.ready)return new Promise(function(t,r){e.imageGenerator.readyPromise.then(function(){e.updateImageryLayer(),e.updatePointLayer(),t()}).otherwise(r)});e.updateImageryLayer(),e.updatePointLayer()}).catch(function(t){console.error(t),f(e),c(e),e.onError(t),e.ready=!1,e._deffered.resolve(t)})}}},{key:"unload",value:function(){f(this),c(this)}}]),t}(_.default);r.default=T},{"-_1049":222,s_332:233,e_1:235,s_2:236,m_131:239,C_129:240,M_0:241,o_130:242}],228:[function(e,t,r){"use strict";function n(e){var t=i();return function(){var r,n=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,f.default)(this,r)}}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function a(e){var t=e.imageryLayer,r=e.earth;t&&(r.imageryLayers.remove(t),t.imageryProvider.destroy(),e.imageryLayer=null)}var o=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=o(e("e_1")),u=o(e("s_2")),l=o(e("s_332")),c=o(e("C_129")),f=o(e("o_130")),d=o(e("m_131")),h=(o(e("h_1048")),o(e("-_1049"))),p=MeteoLib,m=p.RasterImageGenerator,v=p.SwanRadar,g=function(e){function t(e){var n;(0,s.default)(this,t),n=r.call(this,e,{dir:"GZData",path:"SWAN_PRODUCT/LOCAL/NCRAD/TDMOSAIC",ext:"*.BZ2",timeRegex:"yyyyMMddhhmmss",zIndex:6}),n._level=0,n._lastFile=null,n._levelCount=1,n.ready=!1;var i={};n.readyPromise=new Promise(function(e,t){i.resolve=e,i.reject=t}),n._deffered=i;var a=null,o=null;return Object.defineProperties((0,l.default)(n),{swanRadar:{enumerable:!1,get:function(){return o},set:function(e){o=e}},imageryLayer:{enumerable:!1,get:function(){return a},set:function(e){a=e}}}),n}(0,c.default)(t,e);var r=n(t);return(0,u.default)(t,[{key:"show",get:function(){return this._show},set:function(e){this.imageryLayer&&(this._show=e,this.imageryLayer.show=e)}},{key:"channelPath",get:function(){return this.options.path}},{key:"levelCount",get:function(){return this._levelCount},set:function(e){this._levelCount=e}},{key:"level",get:function(){return this._level},set:function(e){this._level!=e&&(this._level=e,this._lastFile&&this.swanRadar&&this.updateImageryLayer())}},{key:"updateImageryLayer",value:function(){var e=this.imageryLayer,t=this.earth,r=this.currentFile,n=this.swanRadar,i=n.header;a(this);var o=m.Radar.R,s=o.colorMap,u=i.LonNumGrids,l=i.LatNumGrids,c=i.LatNumGrids*i.LonNumGrids,f=this.level*c,d=new Float32Array(n.data.buffer,f,c),h=n.rectangle,p=o.generate(d,u,l),v=new Cesium.SingleTileImageryProvider({url:p,rectangle:h});e=t.imageryLayers.addImageryProvider(v),e.show=this._show,this.name=r.fileName,this.colorMap=s,this.imageryLayer=e,this.rectangle=h,this.levelCount=i.ZNumGrids,v.zIndex=this.zIndex,t.updateOrder(),this.ready=!0,this._deffered.resolve(this)}},{key:"updateLayer",value:function(){var e=this,t=this.currentFile;if(t)if(this.swanRadar&&this._lastFile==t)this.updateImageryLayer();else{var r=this._fileLoader;r.readFile(t).then(function(e){return new Promise(function(r,n){v.load(e,t.fileName).then(r).otherwise(n)})}).then(function(t){e.swanRadar=t,e.updateImageryLayer()}).catch(function(t){console.error(t),a(e),e.onError(t),e.ready=!1,e._deffered.resolve(t)})}}},{key:"unload",value:function(){a(this)}}]),t}(h.default);r.default=g},{h_1048:219,"-_1049":222,s_332:233,e_1:235,s_2:236,m_131:239,C_129:240,M_0:241,o_130:242}],229:[function(e,t,r){"use strict";var n=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("e_1")),a=n(e("s_2")),o=e("o_1098"),s=function(){function e(t){(0,i.default)(this,e),this._theme=t.theme||"dark",this._geoDataServerUrl=t.url||"./Assets",this._show=!0}return(0,a.default)(e,[{key:"show",get:function(){return this._show},set:function(e){if(this._show!=e){var t=this.sealandLayer,r=this.provinceLayer,n=this.countyLayer,i=this.placeNameLayer,a=this.placeName2Layer,o=this.placeName3Layer,s=this.countryLayer;t&&(t.show=e),r&&(r.show=e),n&&(n.show=e),i&&(i.show=e),a&&(a.show=e),o&&(o.show=e),s&&(s.show=e)}}},{key:"load",value:function(e){var t,r,n,i,a,s,u,l=this;t=new o.SealandVec2dLayer({source:geoDataServerUrl+"/vectorData/geojson/sealand.geojson",theme:theme});var c=t.provider.readyPromise.then(function(){return r=new o.HighlightPolygonLayer({source:geoDataServerUrl+"/vectorData/shp/边界数据2017版/BOUA省级行政区域.shp",focusAdminNames:["52"],focusPropertyName:"省域代码",theme:theme}),r.provider.readyPromise}).then(function(){return n=new o.HighlightPolygonLayer({source:geoDataServerUrl+"/vectorData/shp/铜仁市/县界（铜仁）/县界（铜仁）.shp",focusAdminNames:["520621"],focusPropertyName:"PAC",theme:theme,minimumLevel:6}),n.provider.readyPromise}).then(function(){return i=new o.HighlightMarkerLayer({source:geoDataServerUrl+"/vectorData/geojson/placeName.geojson",focusAdminNames:["贵州"],focusPropertyName:"NAME",theme:theme}),i.provider.readyPromise}).then(function(){return a=new o.LabelVec2dLayer({source:geoDataServerUrl+"/vectorData/shp/边界数据2017版/AGNP居民地地名.shp",minimumLevel:12}),a.provider.readyPromise}).then(function(){return s=new o.LabelVec2dLayer({source:geoDataServerUrl+"/vectorData/shp/边界数据2017版/AANP自然地名.shp",minimumLevel:12}),s.provider.readyPromise}).then(function(){return u=new o.CountryVec2dLayer({source:geoDataServerUrl+"/vectorData/shp/边界数据2017版/BOUL国界线.shp",theme:theme}),u.provider.readyPromise}).then(function(){e.addLayer(t),e.addLayer(r),e.addLayer(n),e.addLayer(i),e.addLayer(a),e.addLayer(s),e.addLayer(u),t.show=l.show,r.show=l.show,n.show=l.show,i.show=l.show,a.show=l.show,s.show=l.show,u.show=l.show});return Object.defineProperties(this,{sealandLayer:{get:function(){return t}},provinceLayer:{get:function(){return r}},countyLayer:{get:function(){return n}},placeNameLayer:{get:function(){return i}},placeName2Layer:{get:function(){return a}},placeName3Layer:{get:function(){return s}},countryLayer:{get:function(){return u}}}),c}}]),e}();r.default=s},{o_1098:66,e_1:235,s_2:236,M_0:241}],230:[function(e,t,r){"use strict";function n(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=i(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){u=!0,o=e},f:function(){try{s||null==r.return||r.return()}finally{if(u)throw o}}}}function i(e,t){if(e){if("string"==typeof e)return a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(e,t):void 0}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function o(e,t,r){r=r||{};var i=r.onProgress,a=(0,u.default)(e,r.units,r.interval),o=[],s=[o];return a.positions.forEach(function(e){100==o.length&&(o=[],s.push(o)),o.push(e)}),new l.default(s,function(e){var r,i=n(e);try{for(i.s();!(r=i.n()).done;){var a=r.value;a.value=t.selectPoint(0,a.longitude,a.latitude)}}catch(e){i.e(e)}finally{i.f()}}).run(i).then(function(){return a.values=a.positions.map(function(e){var t=e.value;return delete e.value,t}),a})}var s=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.lineSample=o;var u=s(e("D_1018")),l=s(e("e_1101")),c=MeteoLib;c.RasterDataset},{e_1101:189,D_1018:231,M_0:241}],231:[function(e,t,r){"use strict";function n(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(n=function(e){return e?r:t})(e)}function i(e,t,r){var n=Cesium,i=n.Cartographic,a=Cesium.Math;r=r,t=t||"meters";var o="meters"==t?"kilometers":t,c="meters"==t?1e3:1,f=e.map(function(e){return[a.toDegrees(e.longitude),a.toDegrees(e.latitude)]}),d=s.lineString(f),h=(0,l.default)(f[0],f[1],{units:o}),p=[e[0]],m=[0],v=64;r&&r>0?(r/=c,v=h/r):r=h/v,v%1==0&&(v-=1);for(var g=1;g<v;g++){var y=g*r,_=(0,u.default)(d,y,{units:o});m.push(y*c);var b=_.geometry.coordinates;p.push(i.fromDegrees(b[0],b[1]))}return p.push(e[1]),m.push(h*c),r*=c,{positions:p,distances:m,units:t,interval:r,start:{longitude:f[0][0],latitude:f[0][1]},stop:{longitude:f[1][0],latitude:f[1][1]},values:[]}}var a=e("M_0"),o=e("M_110");Object.defineProperty(r,"__esModule",{value:!0}),r.default=i;var s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==o(e)&&"function"!=typeof e)return{default:e};var r=n(t);if(r&&r.has(e))return r.get(e);var i={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var u=a?Object.getOwnPropertyDescriptor(e,s):null;u&&(u.get||u.set)?Object.defineProperty(i,s,u):i[s]=e[s]}return i.default=e,r&&r.set(e,i),i}(e("-_1104")),u=a(e("3_1105")),l=a(e("D_1106"))},{"3_1105":210,D_1106:213,"-_1104":214,M_0:241,M_110:245}],232:[function(e,t,r){"use strict";function n(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=i(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){u=!0,o=e},f:function(){try{s||null==r.return||r.return()}finally{if(u)throw o}}}}function i(e,t){if(e){if("string"==typeof e)return a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(e,t):void 0}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function o(e,t,r){return s.apply(this,arguments)}function s(){return s=(0,d.default)(f.default.mark(function e(t,r,n){var i,a,o,s,u,l,c,d,p,m,v,g,y,_,b,M,x,w,S,T,C,E;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=Cesium,a=i.Rectangle,o=i.Cartesian2,s=i.Cartographic,u=Cesium.Math,n=n||{},l=n.tileSize||128,c=n.level||13,d=n.maxWidth||14e3,p=n.maxHeight||14e3,m=n.onProgress,v=a.northwest(t),g=a.southeast(t),y=r.tilingScheme.positionToTileXY(v,c,{}),_=r.tilingScheme.positionToTileXY(g,c,{}),b=o.subtract(_,y,{}),M=b.x*l,x=b.y*l,!(M>d||x>p)){e.next=16;break}throw new Error("范围太大，请调整范围");case 16:for(w=new Float32Array(M*x),S=[],T=y.y;T<_.y;T++)for(C=y.x;C<=_.x;C++)S.push({x:C,y:T});return E=new h.default(S,function(e){return new Promise(function(t,n){r.requestTileGeometry(e.x,e.y,c).then(function(n){for(var i=r.tilingScheme.tileXYToRectangle(e.x,e.y,c),a=i.width/(l-1),o=i.height/(l-1),u=(e.y-y.y)*l,f=(e.x-y.x)*l,d=0;d<l;d++)for(var h=u+d,p=0;p<l;p++){var m=f+p,v=h*M+m,g=new s(i.west+p*a,i.north-d*o),_=n.interpolateHeight(i,g.longitude,g.latitude);w[v]=_}t()}).otherwise(function(e){t()})})}),e.next=22,E.run(m);case 22:return e.abrupt("return",{width:M,height:x,data:w,bbox:[u.toDegrees(t.west),u.toDegrees(t.south),u.toDegrees(t.east),u.toDegrees(t.north)]});case 23:case"end":return e.stop()}},e)})),s.apply(this,arguments)}function u(e,t,r){return l.apply(this,arguments)}function l(){return l=(0,d.default)(f.default.mark(function e(t,r,i){var a,o,s,u,l,c,d,m,v,g,y,_,b,M;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=Cesium,o=a.sampleTerrain,i=i||{},s=i.level||13,u=i.onProgress,l=(0,p.default)(t,i.units,i.interval),c=l.positions,d=[],m={},v=n(c);try{for(v.s();!(g=v.n()).done;)y=g.value,_=r.tilingScheme.positionToTileXY(y,s),_=[_.x,_.y].join(","),b=m[_],void 0==b&&(b=d.length,m[_]=b,d[b]=[]),d[b].push(y)}catch(e){v.e(e)}finally{v.f()}return M=new h.default(d,function(e){return new Promise(function(t){o(r,s,e).then(t).otherwise(t)})}),e.next=12,M.run(u);case 12:return l.values=c.map(function(e){return e.height}),e.abrupt("return",l);case 14:case"end":return e.stop()}},e)})),l.apply(this,arguments)}var c=e("M_0");Object.defineProperty(r,"__esModule",{value:!0}),r.rectangleSample=o,r.lineSample=u;var f=c(e("C_1108")),d=c(e("o_1109")),h=c(e("e_1101")),p=c(e("D_1018"))},{e_1101:189,D_1018:231,o_1109:234,M_0:241,C_1108:246}],233:[function(e,t,r){function n(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}t.exports=n,t.exports.default=t.exports,t.exports.__esModule=!0},{}],234:[function(e,t,r){function n(e,t,r,n,i,a,o){try{var s=e[a](o),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function i(e){return function(){var t=this,r=arguments;return new Promise(function(i,a){function o(e){n(u,i,a,o,s,"next",e)}function s(e){n(u,i,a,o,s,"throw",e)}var u=e.apply(t,r);o(void 0)})}}t.exports=i,t.exports.default=t.exports,t.exports.__esModule=!0},{}],235:[function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.exports=n,t.exports.default=t.exports,t.exports.__esModule=!0},{}],236:[function(e,t,r){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}t.exports=i,t.exports.default=t.exports,t.exports.__esModule=!0},{}],237:[function(e,t,r){function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}t.exports=n,t.exports.default=t.exports,t.exports.__esModule=!0},{}],238:[function(e,t,r){function n(e,r,a){return"undefined"!=typeof Reflect&&Reflect.get?(t.exports=n=Reflect.get,t.exports.default=t.exports,t.exports.__esModule=!0):(t.exports=n=function(e,t,r){var n=i(e,t);if(n){var a=Object.getOwnPropertyDescriptor(n,t);return a.get?a.get.call(r):a.value}},t.exports.default=t.exports,t.exports.__esModule=!0),n(e,r,a||e)}var i=e("e_1112");t.exports=n,t.exports.default=t.exports,t.exports.__esModule=!0},{e_1112:244}],239:[function(e,t,r){function n(e){return t.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},t.exports.default=t.exports,t.exports.__esModule=!0,n(e)}t.exports=n,t.exports.default=t.exports,t.exports.__esModule=!0},{}],240:[function(e,t,r){function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}var i=e("s_1113");t.exports=n,t.exports.default=t.exports,t.exports.__esModule=!0},{s_1113:243}],241:[function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}t.exports=n,t.exports.default=t.exports,t.exports.__esModule=!0},{}],242:[function(e,t,r){function n(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return a(e)}var i=e("M_110").default,a=e("-_1115");t.exports=n,t.exports.default=t.exports,t.exports.__esModule=!0},{"-_1115":233,M_110:245}],243:[function(e,t,r){function n(e,r){return t.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},t.exports.default=t.exports,t.exports.__esModule=!0,n(e,r)}t.exports=n,t.exports.default=t.exports,t.exports.__esModule=!0},{}],244:[function(e,t,r){function n(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=i(e)););return e}var i=e("3_1116");t.exports=n,t.exports.default=t.exports,t.exports.__esModule=!0},{"3_1116":239}],245:[function(e,t,r){function n(e){"@babel/helpers - typeof";return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?(t.exports=n=function(e){return typeof e},t.exports.default=t.exports,t.exports.__esModule=!0):(t.exports=n=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t.exports.default=t.exports,t.exports.__esModule=!0),n(e)}t.exports=n,t.exports.default=t.exports,t.exports.__esModule=!0},{}],246:[function(e,t,r){t.exports=e("regenerator-runtime")},{"regenerator-runtime":250}],247:[function(e,t,r){"use strict";function n(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function i(e){var t=n(e),r=t[0],i=t[1];return 3*(r+i)/4-i}function a(e,t,r){return 3*(t+r)/4-r}function o(e){var t,r,i=n(e),o=i[0],s=i[1],u=new d(a(e,o,s)),l=0,c=s>0?o-4:o;for(r=0;r<c;r+=4)t=f[e.charCodeAt(r)]<<18|f[e.charCodeAt(r+1)]<<12|f[e.charCodeAt(r+2)]<<6|f[e.charCodeAt(r+3)],u[l++]=t>>16&255,u[l++]=t>>8&255,u[l++]=255&t;return 2===s&&(t=f[e.charCodeAt(r)]<<2|f[e.charCodeAt(r+1)]>>4,u[l++]=255&t),1===s&&(t=f[e.charCodeAt(r)]<<10|f[e.charCodeAt(r+1)]<<4|f[e.charCodeAt(r+2)]>>2,u[l++]=t>>8&255,u[l++]=255&t),u}function s(e){return c[e>>18&63]+c[e>>12&63]+c[e>>6&63]+c[63&e]}function u(e,t,r){for(var n,i=[],a=t;a<r;a+=3)n=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),i.push(s(n));return i.join("")}function l(e){for(var t,r=e.length,n=r%3,i=[],a=0,o=r-n;a<o;a+=16383)i.push(u(e,a,a+16383>o?o:a+16383));return 1===n?(t=e[r-1],i.push(c[t>>2]+c[t<<4&63]+"==")):2===n&&(t=(e[r-2]<<8)+e[r-1],i.push(c[t>>10]+c[t>>4&63]+c[t<<2&63]+"=")),i.join("")}r.byteLength=i,r.toByteArray=o,r.fromByteArray=l;for(var c=[],f=[],d="undefined"!=typeof Uint8Array?Uint8Array:Array,h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",p=0,m=h.length;p<m;++p)c[p]=h[p],f[h.charCodeAt(p)]=p;f["-".charCodeAt(0)]=62,f["_".charCodeAt(0)]=63},{}],248:[function(e,t,r){(function(t){(function(){"use strict";function t(e){if(e>q)throw new RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return t.__proto__=n.prototype,t}function n(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return s(e)}return i(e,t,r)}function i(e,t,r){if("string"==typeof e)return u(e,t);if(ArrayBuffer.isView(e))return l(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(H(e,ArrayBuffer)||e&&H(e.buffer,ArrayBuffer))return c(e,t,r);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var i=e.valueOf&&e.valueOf();if(null!=i&&i!==e)return n.from(i,t,r);var a=f(e);if(a)return a;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return n.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function a(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function o(e,r,n){return a(e),e<=0?t(e):void 0!==r?"string"==typeof n?t(e).fill(r,n):t(e).fill(r):t(e)}function s(e){return a(e),t(e<0?0:0|d(e))}function u(e,r){if("string"==typeof r&&""!==r||(r="utf8"),!n.isEncoding(r))throw new TypeError("Unknown encoding: "+r);var i=0|p(e,r),a=t(i),o=a.write(e,r);return o!==i&&(a=a.slice(0,o)),a}function l(e){for(var r=e.length<0?0:0|d(e.length),n=t(r),i=0;i<r;i+=1)n[i]=255&e[i];return n}function c(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');var i;return i=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),i.__proto__=n.prototype,i}function f(e){if(n.isBuffer(e)){var r=0|d(e.length),i=t(r);return 0===i.length?i:(e.copy(i,0,0,r),i)}return void 0!==e.length?"number"!=typeof e.length||W(e.length)?t(0):l(e):"Buffer"===e.type&&Array.isArray(e.data)?l(e.data):void 0}function d(e){if(e>=q)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+q.toString(16)+" bytes");return 0|e}function h(e){return+e!=e&&(e=0),n.alloc(+e)}function p(e,t){if(n.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||H(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var r=e.length,i=arguments.length>2&&!0===arguments[2];if(!i&&0===r)return 0;for(var a=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return j(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return F(e).length;default:if(a)return i?-1:j(e).length;t=(""+t).toLowerCase(),a=!0}}function m(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if(r>>>=0,t>>>=0,r<=t)return"";for(e||(e="utf8");;)switch(e){case"hex":return P(this,t,r);case"utf8":case"utf-8":return C(this,t,r);case"ascii":return A(this,t,r);case"latin1":case"binary":return L(this,t,r);case"base64":return T(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function v(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function g(e,t,r,i,a){if(0===e.length)return-1;if("string"==typeof r?(i=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,W(r)&&(r=a?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(a)return-1;r=e.length-1}else if(r<0){if(!a)return-1;r=0}if("string"==typeof t&&(t=n.from(t,i)),n.isBuffer(t))return 0===t.length?-1:y(e,t,r,i,a);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?a?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):y(e,[t],r,i,a);throw new TypeError("val must be string, number or Buffer")}function y(e,t,r,n,i){function a(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}var o=1,s=e.length,u=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;o=2,s/=2,u/=2,r/=2}var l;if(i){var c=-1;for(l=r;l<s;l++)if(a(e,l)===a(t,-1===c?0:l-c)){if(-1===c&&(c=l),l-c+1===u)return c*o}else-1!==c&&(l-=l-c),c=-1}else for(r+u>s&&(r=s-u),l=r;l>=0;l--){for(var f=!0,d=0;d<u;d++)if(a(e,l+d)!==a(t,d)){f=!1;break}if(f)return l}return-1}function _(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var a=t.length;n>a/2&&(n=a/2);for(var o=0;o<n;++o){var s=parseInt(t.substr(2*o,2),16);if(W(s))return o;e[r+o]=s}return o}function b(e,t,r,n){return z(j(t,e.length-r),e,r,n)}function M(e,t,r,n){return z(G(t),e,r,n)}function x(e,t,r,n){return M(e,t,r,n)}function w(e,t,r,n){return z(F(t),e,r,n)}function S(e,t,r,n){return z(V(t,e.length-r),e,r,n)}function T(e,t,r){return 0===t&&r===e.length?Y.fromByteArray(e):Y.fromByteArray(e.slice(t,r))}function C(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var a=e[i],o=null,s=a>239?4:a>223?3:a>191?2:1;if(i+s<=r){var u,l,c,f;switch(s){case 1:a<128&&(o=a);break;case 2:u=e[i+1],128==(192&u)&&(f=(31&a)<<6|63&u)>127&&(o=f);break;case 3:u=e[i+1],l=e[i+2],128==(192&u)&&128==(192&l)&&(f=(15&a)<<12|(63&u)<<6|63&l)>2047&&(f<55296||f>57343)&&(o=f);break;case 4:u=e[i+1],l=e[i+2],c=e[i+3],128==(192&u)&&128==(192&l)&&128==(192&c)&&(f=(15&a)<<18|(63&u)<<12|(63&l)<<6|63&c)>65535&&f<1114112&&(o=f)}}null===o?(o=65533,s=1):o>65535&&(o-=65536,n.push(o>>>10&1023|55296),o=56320|1023&o),n.push(o),i+=s}return E(n)}function E(e){var t=e.length;if(t<=K)return String.fromCharCode.apply(String,e);for(var r="",n=0;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=K));return r}function A(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function L(e,t,r){var n=""
;r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function P(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var i="",a=t;a<r;++a)i+=k(e[a]);return i}function O(e,t,r){for(var n=e.slice(t,r),i="",a=0;a<n.length;a+=2)i+=String.fromCharCode(n[a]+256*n[a+1]);return i}function R(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function I(e,t,r,i,a,o){if(!n.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>a||t<o)throw new RangeError('"value" argument is out of bounds');if(r+i>e.length)throw new RangeError("Index out of range")}function D(e,t,r,n,i,a){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function B(e,t,r,n,i){return t=+t,r>>>=0,i||D(e,t,r,4,3.4028234663852886e38,-3.4028234663852886e38),X.write(e,t,r,n,23,4),r+4}function U(e,t,r,n,i){return t=+t,r>>>=0,i||D(e,t,r,8,1.7976931348623157e308,-1.7976931348623157e308),X.write(e,t,r,n,52,8),r+8}function N(e){if(e=e.split("=")[0],e=e.trim().replace(Z,""),e.length<2)return"";for(;e.length%4!=0;)e+="=";return e}function k(e){return e<16?"0"+e.toString(16):e.toString(16)}function j(e,t){t=t||1/0;for(var r,n=e.length,i=null,a=[],o=0;o<n;++o){if((r=e.charCodeAt(o))>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&a.push(239,191,189);continue}if(o+1===n){(t-=3)>-1&&a.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&a.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&a.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;a.push(r)}else if(r<2048){if((t-=2)<0)break;a.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;a.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;a.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return a}function G(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}function V(e,t){for(var r,n,i,a=[],o=0;o<e.length&&!((t-=2)<0);++o)r=e.charCodeAt(o),n=r>>8,i=r%256,a.push(i),a.push(n);return a}function F(e){return Y.toByteArray(N(e))}function z(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function H(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function W(e){return e!==e}var Y=e("base64-js"),X=e("ieee754");r.Buffer=n,r.SlowBuffer=h,r.INSPECT_MAX_BYTES=50;var q=2147483647;r.kMaxLength=q,n.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()}catch(e){return!1}}(),n.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(n.prototype,"parent",{enumerable:!0,get:function(){if(n.isBuffer(this))return this.buffer}}),Object.defineProperty(n.prototype,"offset",{enumerable:!0,get:function(){if(n.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&n[Symbol.species]===n&&Object.defineProperty(n,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),n.poolSize=8192,n.from=function(e,t,r){return i(e,t,r)},n.prototype.__proto__=Uint8Array.prototype,n.__proto__=Uint8Array,n.alloc=function(e,t,r){return o(e,t,r)},n.allocUnsafe=function(e){return s(e)},n.allocUnsafeSlow=function(e){return s(e)},n.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==n.prototype},n.compare=function(e,t){if(H(e,Uint8Array)&&(e=n.from(e,e.offset,e.byteLength)),H(t,Uint8Array)&&(t=n.from(t,t.offset,t.byteLength)),!n.isBuffer(e)||!n.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var r=e.length,i=t.length,a=0,o=Math.min(r,i);a<o;++a)if(e[a]!==t[a]){r=e[a],i=t[a];break}return r<i?-1:i<r?1:0},n.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},n.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return n.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var i=n.allocUnsafe(t),a=0;for(r=0;r<e.length;++r){var o=e[r];if(H(o,Uint8Array)&&(o=n.from(o)),!n.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(i,a),a+=o.length}return i},n.byteLength=p,n.prototype._isBuffer=!0,n.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)v(this,t,t+1);return this},n.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)v(this,t,t+3),v(this,t+1,t+2);return this},n.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)v(this,t,t+7),v(this,t+1,t+6),v(this,t+2,t+5),v(this,t+3,t+4);return this},n.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?C(this,0,e):m.apply(this,arguments)},n.prototype.toLocaleString=n.prototype.toString,n.prototype.equals=function(e){if(!n.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===n.compare(this,e)},n.prototype.inspect=function(){var e="",t=r.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"},n.prototype.compare=function(e,t,r,i,a){if(H(e,Uint8Array)&&(e=n.from(e,e.offset,e.byteLength)),!n.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===i&&(i=0),void 0===a&&(a=this.length),t<0||r>e.length||i<0||a>this.length)throw new RangeError("out of range index");if(i>=a&&t>=r)return 0;if(i>=a)return-1;if(t>=r)return 1;if(t>>>=0,r>>>=0,i>>>=0,a>>>=0,this===e)return 0;for(var o=a-i,s=r-t,u=Math.min(o,s),l=this.slice(i,a),c=e.slice(t,r),f=0;f<u;++f)if(l[f]!==c[f]){o=l[f],s=c[f];break}return o<s?-1:s<o?1:0},n.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},n.prototype.indexOf=function(e,t,r){return g(this,e,t,r,!0)},n.prototype.lastIndexOf=function(e,t,r){return g(this,e,t,r,!1)},n.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var a=!1;;)switch(n){case"hex":return _(this,e,t,r);case"utf8":case"utf-8":return b(this,e,t,r);case"ascii":return M(this,e,t,r);case"latin1":case"binary":return x(this,e,t,r);case"base64":return w(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,e,t,r);default:if(a)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),a=!0}},n.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var K=4096;n.prototype.slice=function(e,t){var r=this.length;e=~~e,t=void 0===t?r:~~t,e<0?(e+=r)<0&&(e=0):e>r&&(e=r),t<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);var i=this.subarray(e,t);return i.__proto__=n.prototype,i},n.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||R(e,t,this.length);for(var n=this[e],i=1,a=0;++a<t&&(i*=256);)n+=this[e+a]*i;return n},n.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||R(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},n.prototype.readUInt8=function(e,t){return e>>>=0,t||R(e,1,this.length),this[e]},n.prototype.readUInt16LE=function(e,t){return e>>>=0,t||R(e,2,this.length),this[e]|this[e+1]<<8},n.prototype.readUInt16BE=function(e,t){return e>>>=0,t||R(e,2,this.length),this[e]<<8|this[e+1]},n.prototype.readUInt32LE=function(e,t){return e>>>=0,t||R(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},n.prototype.readUInt32BE=function(e,t){return e>>>=0,t||R(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},n.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||R(e,t,this.length);for(var n=this[e],i=1,a=0;++a<t&&(i*=256);)n+=this[e+a]*i;return i*=128,n>=i&&(n-=Math.pow(2,8*t)),n},n.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||R(e,t,this.length);for(var n=t,i=1,a=this[e+--n];n>0&&(i*=256);)a+=this[e+--n]*i;return i*=128,a>=i&&(a-=Math.pow(2,8*t)),a},n.prototype.readInt8=function(e,t){return e>>>=0,t||R(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},n.prototype.readInt16LE=function(e,t){e>>>=0,t||R(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},n.prototype.readInt16BE=function(e,t){e>>>=0,t||R(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},n.prototype.readInt32LE=function(e,t){return e>>>=0,t||R(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},n.prototype.readInt32BE=function(e,t){return e>>>=0,t||R(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},n.prototype.readFloatLE=function(e,t){return e>>>=0,t||R(e,4,this.length),X.read(this,e,!0,23,4)},n.prototype.readFloatBE=function(e,t){return e>>>=0,t||R(e,4,this.length),X.read(this,e,!1,23,4)},n.prototype.readDoubleLE=function(e,t){return e>>>=0,t||R(e,8,this.length),X.read(this,e,!0,52,8)},n.prototype.readDoubleBE=function(e,t){return e>>>=0,t||R(e,8,this.length),X.read(this,e,!1,52,8)},n.prototype.writeUIntLE=function(e,t,r,n){if(e=+e,t>>>=0,r>>>=0,!n){I(this,e,t,r,Math.pow(2,8*r)-1,0)}var i=1,a=0;for(this[t]=255&e;++a<r&&(i*=256);)this[t+a]=e/i&255;return t+r},n.prototype.writeUIntBE=function(e,t,r,n){if(e=+e,t>>>=0,r>>>=0,!n){I(this,e,t,r,Math.pow(2,8*r)-1,0)}var i=r-1,a=1;for(this[t+i]=255&e;--i>=0&&(a*=256);)this[t+i]=e/a&255;return t+r},n.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||I(this,e,t,1,255,0),this[t]=255&e,t+1},n.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||I(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},n.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||I(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},n.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||I(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},n.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||I(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},n.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var i=Math.pow(2,8*r-1);I(this,e,t,r,i-1,-i)}var a=0,o=1,s=0;for(this[t]=255&e;++a<r&&(o*=256);)e<0&&0===s&&0!==this[t+a-1]&&(s=1),this[t+a]=(e/o>>0)-s&255;return t+r},n.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var i=Math.pow(2,8*r-1);I(this,e,t,r,i-1,-i)}var a=r-1,o=1,s=0;for(this[t+a]=255&e;--a>=0&&(o*=256);)e<0&&0===s&&0!==this[t+a+1]&&(s=1),this[t+a]=(e/o>>0)-s&255;return t+r},n.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||I(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},n.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||I(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},n.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||I(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},n.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||I(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},n.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||I(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},n.prototype.writeFloatLE=function(e,t,r){return B(this,e,t,!0,r)},n.prototype.writeFloatBE=function(e,t,r){return B(this,e,t,!1,r)},n.prototype.writeDoubleLE=function(e,t,r){return U(this,e,t,!0,r)},n.prototype.writeDoubleBE=function(e,t,r){return U(this,e,t,!1,r)},n.prototype.copy=function(e,t,r,i){if(!n.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),i||0===i||(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<r&&(i=r),i===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-r&&(i=e.length-t+r);var a=i-r;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(t,r,i);else if(this===e&&r<t&&t<i)for(var o=a-1;o>=0;--o)e[o+t]=this[o+r];else Uint8Array.prototype.set.call(e,this.subarray(r,i),t);return a},n.prototype.fill=function(e,t,r,i){if("string"==typeof e){if("string"==typeof t?(i=t,t=0,r=this.length):"string"==typeof r&&(i=r,r=this.length),void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!n.isEncoding(i))throw new TypeError("Unknown encoding: "+i);if(1===e.length){var a=e.charCodeAt(0);("utf8"===i&&a<128||"latin1"===i)&&(e=a)}}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0);var o;if("number"==typeof e)for(o=t;o<r;++o)this[o]=e;else{var s=n.isBuffer(e)?e:n.from(e,i),u=s.length;if(0===u)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(o=0;o<r-t;++o)this[o+t]=s[o%u]}return this};var Z=/[^+/0-9A-Za-z-_]/g}).call(this)}).call(this,e("buffer").Buffer)},{"base64-js":247,buffer:248,ieee754:249}],249:[function(e,t,r){r.read=function(e,t,r,n,i){var a,o,s=8*i-n-1,u=(1<<s)-1,l=u>>1,c=-7,f=r?i-1:0,d=r?-1:1,h=e[t+f];for(f+=d,a=h&(1<<-c)-1,h>>=-c,c+=s;c>0;a=256*a+e[t+f],f+=d,c-=8);for(o=a&(1<<-c)-1,a>>=-c,c+=n;c>0;o=256*o+e[t+f],f+=d,c-=8);if(0===a)a=1-l;else{if(a===u)return o?NaN:1/0*(h?-1:1);o+=Math.pow(2,n),a-=l}return(h?-1:1)*o*Math.pow(2,a-n)},r.write=function(e,t,r,n,i,a){var o,s,u,l=8*a-i-1,c=(1<<l)-1,f=c>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,h=n?0:a-1,p=n?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,o=c):(o=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-o))<1&&(o--,u*=2),t+=o+f>=1?d/u:d*Math.pow(2,1-f),t*u>=2&&(o++,u/=2),o+f>=c?(s=0,o=c):o+f>=1?(s=(t*u-1)*Math.pow(2,i),o+=f):(s=t*Math.pow(2,f-1)*Math.pow(2,i),o=0));i>=8;e[r+h]=255&s,h+=p,s/=256,i-=8);for(o=o<<i|s,l+=i;l>0;e[r+h]=255&o,h+=p,o/=256,l-=8);e[r+h-p]|=128*m}},{}],250:[function(e,t,r){var n=function(e){"use strict";function t(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}function r(e,t,r,n){var a=t&&t.prototype instanceof i?t:i,o=Object.create(a.prototype),s=new h(n||[]);return o._invoke=l(e,r,s),o}function n(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}function i(){}function a(){}function o(){}function s(e){["next","throw","return"].forEach(function(r){t(e,r,function(e){return this._invoke(r,e)})})}function u(e,t){function r(i,a,o,s){var u=n(e[i],e,a);if("throw"!==u.type){var l=u.arg,c=l.value;return c&&"object"==typeof c&&y.call(c,"__await")?t.resolve(c.__await).then(function(e){r("next",e,o,s)},function(e){r("throw",e,o,s)}):t.resolve(c).then(function(e){l.value=e,o(l)},function(e){return r("throw",e,o,s)})}s(u.arg)}function i(e,n){function i(){return new t(function(t,i){r(e,n,t,i)})}return a=a?a.then(i,i):i()}var a;this._invoke=i}function l(e,t,r){var i=w;return function(a,o){if(i===T)throw new Error("Generator is already running");if(i===C){if("throw"===a)throw o;return m()}for(r.method=a,r.arg=o;;){var s=r.delegate;if(s){var u=c(s,r);if(u){if(u===E)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===w)throw i=C,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=T;var l=n(e,t,r);if("normal"===l.type){if(i=r.done?C:S,l.arg===E)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(i=C,r.method="throw",r.arg=l.arg)}}}function c(e,t){var r=e.iterator[t.method];if(r===v){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=v,c(e,t),"throw"===t.method))return E;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return E}var i=n(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,E;var a=i.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=v),t.delegate=null,E):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,E)}function f(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function d(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function h(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(f,this),this.reset(!0)}function p(e){if(e){var t=e[b];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,n=function t(){for(;++r<e.length;)if(y.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=v,t.done=!0,t};return n.next=n}}return{next:m}}function m(){return{value:v,done:!0}}var v,g=Object.prototype,y=g.hasOwnProperty,_="function"==typeof Symbol?Symbol:{},b=_.iterator||"@@iterator",M=_.asyncIterator||"@@asyncIterator",x=_.toStringTag||"@@toStringTag";try{t({},"")}catch(e){t=function(e,t,r){return e[t]=r}}e.wrap=r;var w="suspendedStart",S="suspendedYield",T="executing",C="completed",E={},A={};t(A,b,function(){return this});var L=Object.getPrototypeOf,P=L&&L(L(p([])));P&&P!==g&&y.call(P,b)&&(A=P);var O=o.prototype=i.prototype=Object.create(A);return a.prototype=o,t(O,"constructor",o),t(o,"constructor",a),a.displayName=t(o,x,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===a||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,o):(e.__proto__=o,t(e,x,"GeneratorFunction")),e.prototype=Object.create(O),e},e.awrap=function(e){return{__await:e}},s(u.prototype),t(u.prototype,M,function(){return this}),e.AsyncIterator=u,e.async=function(t,n,i,a,o){void 0===o&&(o=Promise);var s=new u(r(t,n,i,a),o);return e.isGeneratorFunction(n)?s:s.next().then(function(e){return e.done?e.value:s.next()})},s(O),t(O,x,"Generator"),t(O,b,function(){return this}),t(O,"toString",function(){return"[object Generator]"}),e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=p,h.prototype={constructor:h,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=v,this.done=!1,this.delegate=null,this.method="next",this.arg=v,this.tryEntries.forEach(d),!e)for(var t in this)"t"===t.charAt(0)&&y.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=v)},stop:function(){this.done=!0;var e=this.tryEntries[0],t=e.completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){function t(t,n){return a.type="throw",a.arg=e,r.next=t,n&&(r.method="next",r.arg=v),!!n}if(this.done)throw e;for(var r=this,n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n],a=i.completion;if("root"===i.tryLoc)return t("end");if(i.tryLoc<=this.prev){var o=y.call(i,"catchLoc"),s=y.call(i,"finallyLoc");if(o&&s){if(this.prev<i.catchLoc)return t(i.catchLoc,!0);if(this.prev<i.finallyLoc)return t(i.finallyLoc)}else if(o){if(this.prev<i.catchLoc)return t(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return t(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&y.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,E):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),E},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),d(r),E}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;d(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:p(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=v),E}},e}("object"==typeof t?t.exports:{});try{regeneratorRuntime=n}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}},{}]},{},[220])(220)});